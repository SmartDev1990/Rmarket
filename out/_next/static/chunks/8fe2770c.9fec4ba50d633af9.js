"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3248],{95985:function(t,e,i){i.d(e,{$:function(){return ND},$a:function(){return OT},A:function(){return pT},Aa:function(){return fk},Ba:function(){return yk},Ca:function(){return Dk},D:function(){return _D},Da:function(){return wk},E:function(){return gD},Ea:function(){return Ck},F:function(){return fD},Fa:function(){return kk},G:function(){return xD},Ga:function(){return Tk},H:function(){return vD},Ha:function(){return Sk},I:function(){return CD},Ia:function(){return Rk},Ja:function(){return Fk},K:function(){return ID},Ka:function(){return Ek},La:function(){return n},Ma:function(){return Xk},N:function(){return FD},Na:function(){return Nk},O:function(){return SD},Oa:function(){return Kk},P:function(){return ED},Pa:function(){return Vk},Qa:function(){return eT},R:function(){return AD},Ra:function(){return iT},S:function(){return MD},Sa:function(){return qk},T:function(){return BD},Ta:function(){return nT},U:function(){return zD},Ua:function(){return oT},Va:function(){return rT},W:function(){return PD},Wa:function(){return aT},X:function(){return LD},Xa:function(){return lT},Y:function(){return HD},Ya:function(){return cT},Z:function(){return qD},Za:function(){return dT},_a:function(){return A},a:function(){return v},aa:function(){return GD},ab:function(){return LT},b:function(){return D},ba:function(){return VD},bb:function(){return GT},c:function(){return k},cb:function(){return jT},d:function(){return Pb},da:function(){return KD},db:function(){return zT},e:function(){return av},ea:function(){return XD},eb:function(){return HT},f:function(){return mv},fa:function(){return YD},fb:function(){return qT},g:function(){return kv},ga:function(){return JD},gb:function(){return XT},h:function(){return Tv},ha:function(){return QD},hb:function(){return YT},i:function(){return Ov},ia:function(){return $D},ib:function(){return JT},j:function(){return Zv},ja:function(){return tk},jb:function(){return KT},k:function(){return aw},ka:function(){return ek},kb:function(){return vf},l:function(){return cw},la:function(){return ZD},lb:function(){return QT},m:function(){return dw},ma:function(){return ok},mb:function(){return pC},n:function(){return fw},na:function(){return sk},nb:function(){return fC},o:function(){return xw},oa:function(){return nk},ob:function(){return yC},p:function(){return Cw},pa:function(){return _k},pb:function(){return xC},q:function(){return DD},qa:function(){return ak},qb:function(){return ZT},r:function(){return s},ra:function(){return hk},rb:function(){return vC},s:function(){return Ak},sa:function(){return ck},sb:function(){return wC},t:function(){return Bk},ta:function(){return dk},tb:function(){return HC},u:function(){return Mk},ua:function(){return pk},ub:function(){return ZC},v:function(){return Pk},va:function(){return mk},vb:function(){return QC},w:function(){return Lk},wa:function(){return gk},x:function(){return zk},xa:function(){return xk},y:function(){return mT},z:function(){return gT}});var s,r,n,o,a,l,h,u,c,d=i(34155),_=Object.create,m=Object.defineProperty,g=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyNames,f=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty,x=t=>m(t,"__esModule",{value:!0}),b=(t,e)=>()=>(t&&(e=t(t=0)),e),v=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),w=(t,e)=>{for(var i in x(t),e)m(t,i,{get:e[i],enumerable:!0})},D=t=>((t,e,i)=>{if(e&&"object"===typeof e||"function"===typeof e)for(let s of p(e))y.call(t,s)||"default"===s||m(t,s,{get:()=>e[s],enumerable:!(i=g(e,s))||i.enumerable});return t})(x(m(null!=t?_(f(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t),k=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?g(e,i):e,o=t.length-1;o>=0;o--)(r=t[o])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&m(e,i,n),n},T=(t,e,i)=>(((t,e,i)=>{e in t?m(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!==typeof e?e+"":e,i),i),C=b((()=>{s=t=>{if(t){t.width=1,t.height=1;const e=t.getContext("2d");e&&e.clearRect(0,0,1,1)}}})),R=b((()=>{r={imgly_font_bernier_regular:"imgly_font_sancreek",imgly_font_cheque_regular:"imgly_font_kumar_one_outline",imgly_font_gagalin_regular:"imgly_font_permanent_marker",imgly_font_hagin_caps_thin:"imgly_font_nixie_one",imgly_font_intro_inline:"imgly_font_bungee_inline",imgly_font_nexa_script:"imgly_font_molle",imgly_font_panton_blackitalic_caps:"imgly_font_roboto_black_italic",imgly_font_panton_lightitalic_caps:"imgly_font_roboto_light_italic",imgly_font_perfograma:"imgly_font_codystar",imgly_font_panton_black_caps:"imgly_font_roboto_black",imgly_font_panton_light_caps:"imgly_font_roboto_light",imgly_font_summer_font_light:"imgly_font_sue_ellen_francisco"},n=(t,e=!1)=>r[t]?(e&&console.warn(`Font ${t} was deprecated. Please use ${r[t]} instead.`),r[t]):t})),I=v(((t,e)=>{var i="undefined"!==typeof Element,s="function"===typeof Map,r="function"===typeof Set,n="function"===typeof ArrayBuffer&&!!ArrayBuffer.isView;function o(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){if(t.constructor!==e.constructor)return!1;var a,l,h,u;if(Array.isArray(t)){if((a=t.length)!=e.length)return!1;for(l=a;0!==l--;)if(!o(t[l],e[l]))return!1;return!0}if(s&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(u=t.entries();!(l=u.next()).done;)if(!e.has(l.value[0]))return!1;for(u=t.entries();!(l=u.next()).done;)if(!o(l.value[1],e.get(l.value[0])))return!1;return!0}if(r&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(u=t.entries();!(l=u.next()).done;)if(!e.has(l.value[0]))return!1;return!0}if(n&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if((a=t.length)!=e.length)return!1;for(l=a;0!==l--;)if(t[l]!==e[l])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();if((a=(h=Object.keys(t)).length)!==Object.keys(e).length)return!1;for(l=a;0!==l--;)if(!Object.prototype.hasOwnProperty.call(e,h[l]))return!1;if(i&&t instanceof Element)return!1;for(l=a;0!==l--;)if(("_owner"!==h[l]&&"__v"!==h[l]&&"__o"!==h[l]||!t.$$typeof)&&!o(t[h[l]],e[h[l]]))return!1;return!0}return t!==t&&e!==e}e.exports=function(t,e){try{return o(t,e)}catch(bD){if((bD.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw bD}}})),F=v(((t,e)=>{e.exports=(t,e=1,i)=>{if(i={indent:" ",includeEmptyLines:!1,...i},"string"!==typeof t)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if("number"!==typeof e)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if("string"!==typeof i.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof i.indent}\``);if(0===e)return t;const s=i.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(s,i.indent.repeat(e))}})),S=v((()=>{})),E=v(((t,e)=>{var i=S(),s=/\s+at.*(?:\(|\s)(.*)\)?/,r=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,n="undefined"===typeof i.homedir?"":i.homedir();e.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split("\n").filter((t=>{const e=t.match(s);if(null===e||!e[1])return!0;const i=e[1];return!i.includes(".app/Contents/Resources/electron.asar")&&!i.includes(".app/Contents/Resources/default_app.asar")&&!r.test(i)})).filter((t=>""!==t.trim())).map((t=>e.pretty?t.replace(s,((t,e)=>t.replace(e,e.replace(n,"~")))):t)).join("\n"))})),O=v(((t,e)=>{var i=F(),s=E(),r=class extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError("Expected input to be an Array, got "+typeof t);let e=(t=[...t].map((t=>t instanceof Error?t:null!==t&&"object"===typeof t?Object.assign(new Error(t.message),t):new Error(t)))).map((t=>"string"===typeof t.stack?s(t.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(t))).join("\n");e="\n"+i(e,4),super(e),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:t})}*[Symbol.iterator](){for(const t of this._errors)yield t}};e.exports=r})),A=v(((t,e)=>{var i=O();e.exports=async(t,e,{concurrency:s=1/0,stopOnError:r=!0}={})=>new Promise(((n,o)=>{if("function"!==typeof e)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(s)&&s!==1/0||!(s>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${s}\` (${typeof s})`);const a=[],l=[],h=t[Symbol.iterator]();let u=!1,c=!1,d=0,_=0;const m=()=>{if(u)return;const t=h.next(),s=_;if(_++,t.done)return c=!0,void(0===d&&(r||0===l.length?n(a):o(new i(l))));d++,(async()=>{try{const i=await t.value;a[s]=await e(i,s),d--,m()}catch(i){r?(u=!0,o(i)):(l.push(i),d--,m())}})()};for(let t=0;t<s&&(m(),!c);t++);}))})),B={};w(B,{FragmentPrecision:()=>c,ImageFormat:()=>a,OptionType:()=>l,RenderType:()=>o,RendererType:()=>u,UniformType:()=>h});var M,P,L,z,N,U,G,j=b((()=>{var t,e,i,s;o={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"},a={PNG:"image/png",JPEG:"image/jpeg",RAW:"raw"},(t=l||(l={})).NUMBER="number",t.VECTOR2="vector2",t.COLOR_MATRIX="color-matrix",t.COLOR="color",t.ARRAY="array",t.OBJECT="object",t.STRING="string",t.BOOLEAN="boolean",t.CONFIGURABLE="configurable",t.IMAGE="image",t.FUNCTION="function",t.TEXTURE="texture",t.ALL="*",(e=h||(h={})).SAMPLER2D="sampler2d",e.INT="i",e.INT1="1i",e.INT2="2i",e.INT3="3i",e.INT4="4i",e.FLOAT="f",e.FLOAT1="1f",e.FLOAT2="2f",e.FLOAT_VECTOR2="2fv",e.FLOAT3="3f",e.FLOAT4="4f",e.MAT3="mat3",e.MAT3FV="mat3fv",e.MAT4="mat4",(i=u||(u={})).WEBGL="webgl",i.CANVAS="canvas",(s=c||(c={})).High="highp",s.Medium="mediump",s.Low="lowp"})),V=b((()=>{M=()=>document.createElement("canvas"),P=(t,e)=>{const i=e||M();i.width=t.width,i.height=t.height;const s=i.getContext("2d");if(!s)throw new Error("Cannot render context");return s.clearRect(0,0,i.width,i.height),s.drawImage(t,0,0,t.width,t.height),i}})),W=b((()=>{L=class{constructor(t,e,i){this.width=t,this.height=e,this.data=i}}})),H={};w(H,{glGet:()=>z,webUtils:()=>G});var q,X,Y,J,K,Z,Q,$,tt,et,it,st,rt,nt,ot,at,lt,ht,ut,ct,dt,_t,mt,gt,pt,ft,yt,xt,bt,vt,wt,Dt,kt=b((()=>{V(),C(),W(),z=t=>{const e={preserveDrawingBuffer:!0};return t.getContext("webgl",e)||t.getContext("experimental-webgl",e)},N=()=>{const t=M(),e=z(t),i=e.getParameter(e.MAX_TEXTURE_SIZE),r=e.getExtension("WEBGL_lose_context");return r&&r.loseContext(),s(t),i},U=(t,e)=>{if(e instanceof L)t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.width,e.height,0,t.RGBA,t.UNSIGNED_BYTE,e.data);else{const i=P(e);t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),s(i)}},G={isSupported:()=>Boolean(z(M())),isCanvas:t=>"Canvas"===t.constructor.name||Boolean(t.tagName&&"CANVAS"===t.tagName.toUpperCase()),isImage:t=>Boolean(t.tagName&&"IMG"===t.tagName.toUpperCase()),Image:"undefined"!==typeof window?window.Image:void 0,glMaxTexture:N,glGet:z,createCanvas:M,glResize:(t,e)=>t,glTexImage:U}})),Tt=b((()=>{j(),q=(kt(),H).webUtils,X=q,Y=t=>t._type===u.WEBGL,J=t=>Boolean(t&&"tagName"in t&&t.tagName&&"CANVAS"===t.tagName.toUpperCase()),K=t=>Boolean("tagName"in t&&"IMG"===t.tagName.toUpperCase())})),Ct=b((()=>{Q=Z=class{static head(t){return t[0]}static tail(t){return t.slice(1)}static last(t){return t[t.length-1]}static init(t){return t.slice(0,t.length-1)}static remove(t,e){return t.filter(((t,i,s)=>!e(t,i,s)))}static findIndex(t,e){for(let i=0;i<t.length;i++)if(e(t[i]))return i;return-1}static find(t,e){for(let i=0;i<t.length;i++)if(e(t[i]))return t[i]}static flatten(t){return t.reduce((function(t,e){return t.concat(Array.isArray(e)?Z.flatten(e):e)}),[])}static range(t,e){const i=[];if(e>t)for(let s=t;s<e;s++)i.push(s);return i}static repeat(t,e){const i=[];for(let s=0;s<e;s++)i[s]=t;return i}static zip(t,e){const i=Math.min(t.length,e.length),s=[];for(let r=0;r<i;r++)s[r]=[t[r],e[r]];return s}}})),Rt=b((()=>{$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",tt={encode(t){let e,i,s,r,n,o,a,l="",h=0;do{e=t[h++],i=t[h++],s=t[h++],r=e>>2,n=(3&e)<<4|i>>4,o=(15&i)<<2|s>>6,a=63&s,isNaN(i)?o=a=64:isNaN(s)&&(a=64),l=l+$.charAt(r)+$.charAt(n)+$.charAt(o)+$.charAt(a),e=i=s="",r=n=o=a=""}while(h<t.length);return l},decode(t){let e,i,s,r,n,o,a,l=0;const h=[];if(/[^A-Za-z0-9+/=]/g.exec(t))throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");t=t.replace(/[^A-Za-z0-9+/=]/g,"");do{r=$.indexOf(t.charAt(l++)),n=$.indexOf(t.charAt(l++)),o=$.indexOf(t.charAt(l++)),a=$.indexOf(t.charAt(l++)),e=r<<2|n>>4,i=(15&n)<<4|o>>2,s=(3&o)<<6|a,h.push(e),64!==o&&h.push(i),64!==a&&h.push(s),e=i=s="",r=n=o=a=""}while(l<t.length);return h}}})),It=b((()=>{Tt(),Ct(),Rt(),T(it=et=class{static mapRange(t,e,i){return(t-e.getMin())*i.getLength()/e.getLength()+i.getMin()}static isPlainObject(t){if("object"!==typeof t||!t)return!1;if("function"===typeof Object.getPrototypeOf){const e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}return"[object Object]"===Object.prototype.toString.call(t)}static isMobile(){if("undefined"===typeof navigator)return!1;const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}static isBrowser(){return"undefined"!==typeof window}static values(t){const e=[];for(const i in t)e.push(t[i]);return e}static generateUUID(){let t=(new Date).getTime();return"undefined"!==typeof window.performance&&"function"===typeof window.performance.now&&(t+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?i:3&i|8).toString(16)}))}static resizeVectorToFit(t,e){const i=Math.min(e.x/t.x,e.y/t.y);return t.clone().multiply(i)}static resizeVectorToFill(t,e){const i=t.x/t.y;return i>e.x/e.y?e.clone().set(e.y*i,e.y):e.clone().set(e.x,e.x/i)}static isExtendable(t){return"undefined"!==typeof t&&null!==t&&("object"===typeof t||"function"===typeof t)}static defaults(t,...e){const i={};for(const s in t)i[s]=t[s];for(let s=0;s<e.length;s++){const t=e[s];for(const e in t)"undefined"===typeof i[e]&&(i[e]=t[e])}return i}static deepMerge(t,...e){const i=(t,e)=>{if(void 0===e)return i(null,t);if(Array.isArray(e))return[...e];if(!et.isPlainObject(e))return e;if(!et.isPlainObject(t))return{...e};const s={...t};return Object.keys(e).forEach((r=>{const n=e[r];void 0!==n&&(s[r]=i(t[r],n))})),s};return e.reduce(i,t)}static deepDefaults(t,...e){const i=[...e].reverse();return et.deepMerge(...i,t)}static deepClone(t){const e={};for(const i in t)et.isExtendable(t[i])?e[i]=et.deepClone(t[i]):e[i]=t[i];return e}static extend(t,...e){const i={};for(const s in t)i[s]=t[s];for(let s=0;s<e.length;s++){const t=e[s];for(const e in t)i[e]=t[e]}return i}static clone(t){return this.extend({},t)}static getUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}static createCanvas(){return X.createCanvas()}static isPowerOfTwo(t){return 0===(t.x&t.x-1)&&0===(t.y&t.y-1)}static nextLowestPOT(t){for(let e=1;e<32;e<<=1)t|=t>>e;return t-(t>>1)}static nextHighestPOT(t){t--;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}static moveArrayItem(t,e,i){if(i>=t.length){let e=i-t.length;for(;1+e--;)t.push(void 0)}t.splice(i,0,t.splice(e,1)[0])}static ensureCanvasDimensions(t,e){return(t.width!==e.x||t.height!==e.y)&&(t.width=e.x,t.height=e.y,!0)}static byteArrayToString(t){return t.map((t=>String.fromCharCode(t))).join("")}static clamp(t,e,i){return Math.max(e,Math.min(t,i))}static wildCardMatch(t,e){return new RegExp(`^${e.split("*").join(".*")}$`).test(t)}static flipObject(t){const e={};for(const i in t)e[t[i]]=i;return e}static ISODateString(t){function e(t){return t<10?`0${t}`:t}return`${t.getUTCFullYear()}-${e(t.getUTCMonth()+1)}-${e(t.getUTCDate())}T${e(t.getUTCHours())}:${e(t.getUTCMinutes())}:${e(t.getUTCSeconds())}Z`}static getCrossOriginValue(t){return t?"none"!==t?t:void 0:"anonymous"}static invariant(t,e){if(!t){throw new Error(e)}}static executePromises(t){const e=t.length;let i=0;const s=[],r=[];return new Promise(((n,o)=>{const a=()=>{i++,i>=e&&(r.length<=0?n(s):o(r))},l=t=>{s.push(t),a()},h=t=>{r.push(t),a()};t.forEach((t=>{t.then(l).catch(h)}))}))}},"Array",Q),st=it})),Ft=b((()=>{It(),rt=[{name:"trace",type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{name:"info",type:"log",background:"#BDE5F8",color:"#00529B"},{name:"warn",type:"warn",background:"#FEEFB3",color:"#9F6000"},{name:"error",type:"error",background:"#FFBABA",color:"#D8000C"},{name:"log",type:"log",background:"#EEEEEE",color:"#1f4f6b"}],nt=()=>console&&console.group&&console.groupCollapsed&&console.groupEnd,ot=()=>"undefined"!==typeof navigator&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/),at=(t,e)=>["background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0",`background: ${t}; color: ${e}; line-height: 20px; padding: 4px 0; font-weight: bold`,"background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0"],lt=class{constructor(t="warn",e=rt){this._levels=[...e],this._maxLevel=this.getLevelIndexByName(t),this._consoleFuncs={trace:(...t)=>{nt()?(console.groupCollapsed(...t),console.trace(),console.groupEnd()):console.trace(...t)}},this._levels.forEach((({name:t})=>{this[t]=(e,...i)=>{this._log(t,e,...i)}}))}getLevelIndexByName(t){return st.Array.findIndex(this._levels,(e=>e.name===t))}getLevelObjectByName(t){return st.Array.find(this._levels,(e=>e.name===t))}canLog(t){const e=this.getLevelIndexByName(t);return!(e<0)&&e>=this._maxLevel}setLevel(t){const e=this.getLevelIndexByName(t);e<0||(this._maxLevel=e)}_log(t,e,...i){const s=this.getLevelObjectByName(t);if(!s||!this.canLog(t))return;const{name:r,type:n,background:o,color:a}=s,l=i.filter((t=>void 0!==t)).map((t=>t.toObject?JSON.parse(JSON.stringify(t.toObject())):t)),h=this._consoleFuncs[n]||console[n]?(...t)=>console[n](...t):(...t)=>console.log(...t),u=l.length,c=at(o,a);if(!ot()){const t=l.length;return t<=0?void h(`PhotoEditorSDK | ${e} `):1===t&&"string"===typeof l[0]?void h(`PhotoEditorSDK | ${e} | ${l[0]}`):void h(`PhotoEditorSDK | ${e} | `,...l)}u<=0?h(`%c  %c PhotoEditorSDK %c  %c ${e} %c %c  `,...c):1!==u||"string"!==typeof l[0]?nt()?(console.groupCollapsed(`%c  %c PhotoEditorSDK %c  %c ${e} %c`,...st.Array.init(c)),h(...l),console.groupEnd()):h(`%c  %c PhotoEditorSDK %c  %c ${e} %c`,...st.Array.init(c),...l):h(`%c  %c PhotoEditorSDK %c  %c ${e} %c  ${l[0]}  %c  `,...c)}image(t="",e){{let i=new window.Image;const s=()=>{const{width:e}=i,{height:s}=i;t&&console.log(t),console.log("%c+",`\n        font-size: 1px;\n        padding: 0px ${Math.floor(e/2)}px;\n        line-height: ${s}px;\n        background: url(${i.src});\n        color: transparent;\n        background-repeat: no-repeat;\n        background-size: ${e}px ${s}px;`)};return i.onload=s,e instanceof window.HTMLCanvasElement?i.src=e.toDataURL():e instanceof window.Image?(i=e,s()):"string"===typeof e?i.src=e:this.log(t,e),i}}texture(t="",e){{if(!e)return void this.log(t,"texture: null or undefined");const i=e.getBaseTexture(),s=i.getRenderers(),r=st.Array.find(s,(t=>t&&"webgl"===t.constructor.type)),{width:n,height:o}=i.getFrame();if(r){const e=r.getContext(),s=i.getGLTextureForRenderer(r);this.logGlTexture(e,s,n,o,t)}else ht.image(t,i.getSource())}}logGlTexture(t,e,i=150,s=150,r){{t.bindTexture(t.TEXTURE_2D,e);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);const o=new Uint8Array(i*s*4);t.readPixels(0,0,i,s,t.RGBA,t.UNSIGNED_BYTE,o),t.deleteFramebuffer(n);const a=document.createElement("canvas");a.width=i,a.height=s;const l=a.getContext("2d"),h=l.createImageData(i,s);return h.data.set(o),l.putImageData(h,0,0),ht.image(r,a)}}},ht=new lt("warn"),ut=ht})),St=b((()=>{ct={load(t,e={cors:!0,value:"anonymous"}){return Promise.resolve([t,t]).then((([t,i])=>this._createAndLoadImage(t,i,e)))},loadImage(t,e={cors:!0,value:"anonymous"}){return this._loadWithoutExif(t,e)},_loadWithoutExif:(t,e={cors:!0,value:"anonymous"})=>new Promise(((i,s)=>{const r=new window.Image;r.addEventListener("load",(()=>{i(r)})),r.addEventListener("error",(()=>{s(new Error(`Failed to load image at ${t}`))})),e.cors&&(r.crossOrigin=e.value),r.src=t})),_createAndLoadImage(t,e,i={cors:!0,value:"anonymous"}){return new Promise(((t,s)=>{{const s=this._loadWithoutExif(e,i).then((e=>t(e))),r=new Promise(((t,r)=>{this._loadAsDataURL(e,i).then((e=>{const i=new window.Image;i.addEventListener("load",(()=>{t(i)})),i.src=e,i.rawSource=e})).catch((e=>{s.then((e=>t(e)))}))}));return this._stringEndsWith(e,".svg")?s.then((e=>t(e))):r.then((e=>t(e)))}}))},_stringEndsWith:(t,e,i=t.length)=>((void 0===i||i>t.length)&&(i=t.length),t.substring(i-e.length,i)===e),_loadAsDataURL:(t,e={cors:!0,value:"anonymous"})=>new Promise(((i,s)=>{const r=new XMLHttpRequest;r.onload=function(){const t=new FileReader;t.onloadend=function(){t.error&&s(t.error),i(t.result)},t.readAsDataURL(r.response)},r.open("GET",t),r.responseType="blob",r.withCredentials=e.cors&&"use-credentials"===e.value,r.send()})),loadXHR:(t,e)=>new Promise(((i,s)=>{let r;window.XDomainRequest?(r=new window.XDomainRequest,e&&r.overrideMimeType(e),r.onload=function(){i(r)},r.onerror=function(t){s(t)}):window.XMLHttpRequest&&(r=new window.XMLHttpRequest,e&&r.overrideMimeType(e),r.onreadystatechange=function(t){4===r.readyState&&(200===r.status?i(r):s(new Error(`HTTP Status ${r.status}`)))}),r.open("GET",t,!0),r.send()}))}})),Et=v(((t,e)=>{function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,s,r){e=e||"&",s=s||"=";var n={};if("string"!==typeof t||0===t.length)return n;var o=/\+/g;t=t.split(e);var a=1e3;r&&"number"===typeof r.maxKeys&&(a=r.maxKeys);var l=t.length;a>0&&l>a&&(l=a);for(var h=0;h<l;++h){var u,c,d,_,m=t[h].replace(o,"%20"),g=m.indexOf(s);g>=0?(u=m.substr(0,g),c=m.substr(g+1)):(u=m,c=""),d=decodeURIComponent(u),_=decodeURIComponent(c),i(n,d)?Array.isArray(n[d])?n[d].push(_):n[d]=[n[d],_]:n[d]=_}return n}})),Ot=v(((t,e)=>{var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,s,r){return e=e||"&",s=s||"=",null===t&&(t=void 0),"object"===typeof t?Object.keys(t).map((function(r){var n=encodeURIComponent(i(r))+s;return Array.isArray(t[r])?t[r].map((function(t){return n+encodeURIComponent(i(t))})).join(e):n+encodeURIComponent(i(t[r]))})).join(e):r?encodeURIComponent(i(r))+s+encodeURIComponent(i(t)):""}})),At=v((t=>{t.decode=t.parse=Et(),t.encode=t.stringify=Ot()}));function Bt(t){"string"==typeof t&&(t=Lt(t));var e=function(t,e,i){var s=t.auth,r=t.hostname,n=t.protocol||"",o=t.pathname||"",a=t.hash||"",l=t.query||"",h=!1;s=s?encodeURIComponent(s).replace(/%3A/i,":")+"@":"",t.host?h=s+t.host:r&&(h=s+(~r.indexOf(":")?"["+r+"]":r),t.port&&(h+=":"+t.port)),l&&"object"==typeof l&&(l=e.encode(l));var u=t.search||l&&"?"+l||"";return n&&":"!==n.substr(-1)&&(n+=":"),t.slashes||(!n||i.test(n))&&!1!==h?(h="//"+(h||""),o&&"/"!==o[0]&&(o="/"+o)):h||(h=""),a&&"#"!==a[0]&&(a="#"+a),u&&"?"!==u[0]&&(u="?"+u),{protocol:n,host:h,pathname:o=o.replace(/[?#]/g,encodeURIComponent),search:u=u.replace("#","%23"),hash:a}}(t,dt.default,_t);return""+e.protocol+e.host+e.pathname+e.search+e.hash}function Mt(t,e){var i="string"==typeof t?Lt(t):t;t="object"==typeof t?Bt(t):t;var s=Lt(e),r="";i.protocol&&!i.slashes&&(r=i.protocol,t=t.replace(i.protocol,""),r+="/"===e[0]||"/"===t[0]?"/":""),r&&s.protocol&&(r="",s.slashes||(r=s.protocol,e=e.replace(s.protocol,"")));var n=t.match(ft);n&&!s.protocol&&(t=t.substr((r=n[1]+(n[2]||"")).length),/^\/\/[^/]/.test(e)&&(r=r.slice(0,-1)));var o=new URL(t,pt+"/"),a=new URL(e,o).toString().replace(pt,""),l=s.protocol||i.protocol;return l+=i.slashes||s.slashes?"//":"",!r&&l?a=a.replace(mt,l):r&&(a=a.replace(mt,"")),yt.test(a)||~e.indexOf(".")||"/"===t.slice(-1)||"/"===e.slice(-1)||"/"!==a.slice(-1)||(a=a.slice(0,-1)),r&&(a=r+("/"===a[0]?a.substr(1):a)),a}function Pt(){}function Lt(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),t&&"object"==typeof t&&t instanceof Pt)return t;var s=(t=t.trim()).match(bt);t=s?s[1].replace(/\\/g,"/")+s[2]:t.replace(/\\/g,"/"),Dt.test(t)&&"/"!==t.slice(-1)&&(t+="/");var r=!/(^javascript)/.test(t)&&t.match(vt),n=wt.test(t),o="";r&&(xt.test(r[1])||(o=r[1].toLowerCase(),t=""+r[2]+r[3]),r[2]||(n=!1,xt.test(r[1])?(o=r[1],t=""+r[3]):t="//"+r[3]),3!==r[2].length&&1!==r[2].length||(o=r[1],t="/"+r[3]));var a,l=(s?s[1]:t).match(/^https?:\/\/[^/]+(:[0-9]+)(?=\/|$)/),h=l&&l[1],u=new Pt,c="",d="";try{a=new URL(t)}catch(_){c=_,o||i||!/^\/\//.test(t)||/^\/\/.+[@.]/.test(t)||(d="/",t=t.substr(1));try{a=new URL(t,pt)}catch(p){return u.protocol=o,u.href=o,u}}u.slashes=n&&!d,u.host=a.host===gt?"":a.host,u.hostname=a.hostname===gt?"":a.hostname.replace(/(\[|\])/g,""),u.protocol=c?o||null:a.protocol,u.search=a.search.replace(/\\/g,"%5C"),u.hash=a.hash.replace(/\\/g,"%5C");var _,m=t.split("#");!u.search&&~m[0].indexOf("?")&&(u.search="?"),u.hash||""!==m[1]||(u.hash="#"),u.query=e?dt.default.decode(a.search.substr(1)):u.search.substr(1),u.pathname=d+(r?(_=a.pathname).replace(/['^|`]/g,(function(t){return"%"+t.charCodeAt().toString(16).toUpperCase()})).replace(/((?:%[0-9A-F]{2})+)/g,(function(t,e){try{return decodeURIComponent(e).split("").map((function(t){var e=t.charCodeAt();return e>256||/^[a-z0-9]$/i.test(t)?t:"%"+e.toString(16).toUpperCase()})).join("")}catch(i){return e}})):a.pathname),"about:"===u.protocol&&"blank"===u.pathname&&(u.protocol="",u.pathname=""),c&&"/"!==t[0]&&(u.pathname=u.pathname.substr(1)),o&&!xt.test(o)&&"/"!==t.slice(-1)&&"/"===u.pathname&&(u.pathname=""),u.path=u.pathname+u.search,u.auth=[a.username,a.password].map(decodeURIComponent).filter(Boolean).join(":"),u.port=a.port,h&&!u.host.endsWith(h)&&(u.host+=h,u.port=h.slice(1)),u.href=d?""+u.pathname+u.search+u.hash:Bt(u);var g=/^(file)/.test(u.href)?["host","hostname"]:[];return Object.keys(u).forEach((function(t){~g.indexOf(t)||(u[t]=u[t]||null)})),u}var zt,Nt,Ut=b((()=>{dt=D(At()),_t=/https?|ftp|gopher|file/,pt=(mt="http://")+(gt="w.w"),ft=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,yt=/https?|ftp|gopher|file/,Pt.prototype.parse=Lt,Pt.prototype.format=Bt,Pt.prototype.resolve=Mt,Pt.prototype.resolveObject=Mt,xt=/^https?|ftp|gopher|file/,bt=/^(.*?)([#?].*)/,vt=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,wt=/^([a-z0-9.+-]*:)?\/\/\/*/i,Dt=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i})),Gt=b((()=>{Ut(),5e3,zt="undefined"!==typeof window?window:i.g,Nt=class{constructor(t){this._url=t,this._parsedUrl=Lt(this._url,!0)}_isJSONPRequest(){const{query:t}=this._parsedUrl;for(const e in t){if("?"===t[e])return!0}return!1}load(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()}_loadJSON(){return new Promise(((t,e)=>{let i;zt.XDomainRequest?(i=new zt.XDomainRequest,i.onload=function(){const e=JSON.parse(i.responseText);t(e)},i.onerror=function(t){e(t)},i.open("GET",this._url,!0),i.send()):zt.XMLHttpRequest&&(i=new XMLHttpRequest,i.onreadystatechange=function(s){if(4===i.readyState)if(200===i.status){const e=JSON.parse(i.responseText);t(e)}else e(new Error(`HTTP Status ${i.status}`))},i.open("GET",this._url,!0),i.send())}))}_loadJSONP(){let t=!1,e=!1;const i=`pesdk${Math.round(99999999999999*Math.random())}`;return new Promise(((s,r)=>{const n=this._createJSONPNode(i);zt[i]=i=>{this._removeJSONPNode(n),t||(e=!0,s(i))},zt.setTimeout((()=>{e||(this._removeJSONPNode(n),t=!0,r(new Error("Timeout of 5 seconds exceeded.")))}),5e3)}))}_createJSONPNode(t){const e=this._buildJSONPUrl(t),i=document.querySelector("head"),s=document.createElement("script");return s.src=e,i.appendChild(s),s}_removeJSONPNode(t){t.parentNode.removeChild(t)}_buildJSONPUrl(t){const{query:e}=this._parsedUrl;let i=null;for(const s in e)if("?"===e[s]){i=s;break}return delete this._parsedUrl.search,e[i]=t,Bt(this._parsedUrl)}}})),jt={};w(jt,{ImageLoader:()=>ct,JSONLoader:()=>Nt});var Vt,Wt,Ht,qt,Xt,Yt,Jt,Kt,Zt,Qt,$t,te,ee,ie,se,re,ne,oe,ae=b((()=>{St(),Gt()})),le=b((()=>{Wt=Vt=class{constructor(t,e,i,s=1){this.r=t,this.g=e,this.b=i,this.a=s}toRGBA(){return`rgba(${[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b),this.a.toFixed(2)].join(",")})`}set(t,e,i,s=this.a){return this.r=t,this.g=e,this.b=i,this.a=s,this}toRGB(){return[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b)]}toHex(){return`#${[this._componentToHex(Math.round(255*this.r)),this._componentToHex(Math.round(255*this.g)),this._componentToHex(Math.round(255*this.b))].join("")}`}toGLColor(){return[this.r,this.g,this.b,this.a]}toArray(){return this.toGLColor()}toRGBGLColor(){return[this.r,this.g,this.b]}toHSV(){const t=Math.max(this.r,this.g,this.b),e=Math.min(this.r,this.g,this.b);let i,s;const r=t,n=t-e;if(s=0===t?0:n/t,t===e)i=0;else{switch(t){case this.r:i=(this.g-this.b)/n,this.g<this.b&&(i+=6);break;case this.g:i=(this.b-this.r)/n+2;break;case this.b:i=(this.r-this.g)/n+4}i/=6}return[i,s,r]}fromHSV(t,e,i){return this.copy(Vt.fromHSV(t,e,i)),this}static fromHSV(t,e,i,s=1){let[r,n,o]=[];const a=Math.floor(6*t),l=6*t-a,h=i*(1-e),u=i*(1-l*e),c=i*(1-(1-l)*e);switch(a%6){case 0:r=i,n=c,o=h;break;case 1:r=u,n=i,o=h;break;case 2:r=h,n=i,o=c;break;case 3:r=h,n=u,o=i;break;case 4:r=c,n=h,o=i;break;case 5:r=i,n=h,o=u}return new Vt(r,n,o,s)}static fromArray(t){return new Vt(t[0],t[1],t[2],t[3])}static fromHex(t){const[e,i,s]=t.match(/[0-9A-fa-f]{1,2}/g);return new Vt(parseInt(e,16)/255,parseInt(i,16)/255,parseInt(s,16)/255,1)}clone(){return new Vt(this.r,this.g,this.b,this.a)}cloneRGB(){return new Vt(this.r,this.g,this.b,1)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}minus(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this}divideScalar(t){return this.r/=t,this.g/=t,this.b/=t,this.a/=t,this}clamp(t,e){return this.r=Math.min(Math.max(this.r,t),e),this.g=Math.min(Math.max(this.g,t),e),this.b=Math.min(Math.max(this.b,t),e),this.a=Math.min(Math.max(this.a,t),e),this}mix(t,e){return this.r=(1-e)*this.r+e*t.r,this.g=(1-e)*this.g+e*t.g,this.b=(1-e)*this.b+e*t.b,this.a=(1-e)*this.a+e*t.a,this}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}_componentToHex(t){const e=t.toString(16);return 1===e.length?`0${e}`:e}toString(){return`Color(${this.r}, ${this.g}, ${this.b}, ${this.a})`}static get TRANSPARENT(){return new Vt(0,0,0,0)}static get WHITE(){return new Vt(1,1,1,1)}static get BLACK(){return new Vt(0,0,0,1)}static get RED(){return new Vt(1,0,0,1)}static get BLUE(){return new Vt(0,0,1,1)}static get GREEN(){return new Vt(0,1,0,1)}}})),he=b((()=>{Ft(),12,Ht=class{constructor(){this._maxListeners=12,this._events={},this._pipeDestinations=[]}pipeEvents(t){this._pipeDestinations.push(t)}unpipeEvents(t){const e=this._pipeDestinations.indexOf(t);-1!==e&&this._pipeDestinations.splice(e,1)}on(t,e){if("undefined"===typeof t)throw new Error(`Invalid event type: \`${t}\``);if("function"!==typeof e)throw new TypeError;const i=this._events[t]||(this._events[t]=[]);return-1!==i.indexOf(e)||(i.push(e),this._maxListeners&&i.length>this._maxListeners&&(ut.warn("EventEmitter",`Possible memory leak detected, added ${i.length} \`${t}\` listeners (current limit is ${this._maxListeners})`),"undefined"!==typeof console&&console.trace())),this}once(t,e){if("undefined"===typeof t)throw new Error(`Invalid event type: \`${t}\``);const i=this;return this.on(t,(function s(){i.off(t,s),e.apply(null,arguments)}))}off(t,...e){if("undefined"===typeof t)throw new Error(`Invalid event type: \`${t}\``);if(0===e.length)return this._events[t]=null,this;const i=e[0];if("function"!==typeof i)throw new TypeError;const s=this._events[t];if(!s||!s.length)return this;const r=s.indexOf(i);return-1===r||s.splice(r,1),this}emit(t,...e){if("undefined"===typeof t)throw new Error(`Invalid event type: \`${t}\``);this._pipeDestinations.forEach((i=>{i.emit(t,...e)}));const i=this._events[t];return!(!i||!i.length)&&(i.slice(0).forEach((t=>t.apply(null,e))),!0)}setMaxListeners(t){if(parseInt(t,10)!==t)throw new TypeError;this._maxListeners=t}},qt=Ht})),ue=b((()=>{Ft(),C(),Xt={checkFramebufferStatus(t,e){const i=e.checkFramebufferStatus(e.FRAMEBUFFER),s={[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Incomplete attachment",[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"Missing attachment",[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS]:"Incomplete dimensions",[e.FRAMEBUFFER_UNSUPPORTED]:"Framebuffer unsupported"};i!==e.FRAMEBUFFER_COMPLETE&&ut.warn(t,`Framebuffer incomplete: ${s[i]}`)},determineGPUName(t){let e=null,i=null;t||(i=document.createElement("canvas"),t=i.getContext("experimental-webgl")||i.getContext("webgl"));const r=t&&t.getExtension("WEBGL_debug_renderer_info");return r&&(e=t.getParameter(r.UNMASKED_RENDERER_WEBGL),i&&i.remove()),s(i),e},isGPUBlacklisted:(t,e=null)=>!1}})),ce=b((()=>{Yt=t=>"number"===typeof t})),de=b((()=>{ce(),Jt=t=>t instanceof Qt,Kt=(t,e)=>Jt(t)?{x:t.x,y:t.y}:{x:t,y:Yt(e)?e:t},Zt=(t,e)=>(i,s)=>{const{x:r,y:n}=Kt(i,s);return t.x=e(t.x,r),t.y=e(t.y,n),t},Qt=class{constructor(t=0,e=0){this.add=Zt(this,((t,e)=>t+e)),this.subtract=Zt(this,((t,e)=>t-e)),this.divide=Zt(this,((t,e)=>t/e)),this.multiply=Zt(this,((t,e)=>t*e)),this.x=t,this.y=e}set(t,e){const{x:i,y:s}=Kt(t,e);return this.x=i,this.y=s,this}clone(){return new Qt(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}clamp(t,e){return Yt(t)&&(t=new Qt(t,t)),Yt(e)&&(e=new Qt(e,e)),t&&(this.x=Math.max(t.x,this.x),this.y=Math.max(t.y,this.y)),e&&(this.x=Math.min(e.x,this.x),this.y=Math.min(e.y,this.y)),this}dot(t,e){const{x:i,y:s}=Kt(t,e);return this.x*i+this.y*s}equals(t,e){const{x:i,y:s}=Kt(t,e);return i===this.x&&s===this.y}flip(){const t=this.x;return this.x=this.y,this.y=t,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}floor(){return this.x|=0,this.y|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y)}min(){return Math.min(this.x,this.y)}max(){return Math.max(this.x,this.y)}toObject(){return{x:this.x,y:this.y}}toString(){return`Vector2({ x: ${this.x}, y: ${this.y} })`}roundDecimal(t){return this.x=parseFloat(this.x.toFixed(t)),this.y=parseFloat(this.y.toFixed(t)),this}asArray(t=!1){return t?[this.y,this.x]:[this.x,this.y]}static fromObject(t){return new Qt(t.x,t.y)}static get NULL(){return new Qt(0,0)}}})),_e=b((()=>{de(),$t=class{constructor(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this.reset()}multiply(t){let e,i,s,r,n,o;return e=this.a*t.a+this.b*t.c,i=this.a*t.b+this.b*t.d,s=this.c*t.a+this.d*t.c,r=this.c*t.b+this.d*t.d,n=this.tx*t.a+this.ty*t.c+t.tx,o=this.tx*t.b+this.ty*t.d+t.ty,this.a=e,this.b=i,this.c=s,this.d=r,this.tx=n,this.ty=o,this}applyToVector(t){const{x:e,y:i}=t;return(t=t.clone()).x=this.a*e+this.c*i+this.tx,t.y=this.b*e+this.d*i+this.tx,t}applyInverseToVector(t){const e=1/(this.a*this.d+this.c*-this.b),{x:i,y:s}=t;return(t=t.clone()).x=this.d*e*i+-this.c*e*s+(this.ty*this.c-this.tx*this.d)*e,t.y=this.a*e*s+-this.b*e*i+(-this.ty*this.a+this.tx*this.b)*e,t}rectangleToCoordinates(t,e=new Qt(0,0)){const i=t.width*(1-e.x),s=t.width*-e.x,r=t.height*(1-e.y),n=t.height*-e.y,o=[];return o.push(new Qt(this.a*s+this.c*n+this.tx,this.d*n+this.b*s+this.ty)),o.push(new Qt(this.a*i+this.c*n+this.tx,this.d*n+this.b*i+this.ty)),o.push(new Qt(this.a*i+this.c*r+this.tx,this.d*r+this.b*i+this.ty)),o.push(new Qt(this.a*s+this.c*r+this.tx,this.d*r+this.b*s+this.ty)),o}reset(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}toArray(){const t=[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1];return"undefined"===typeof Float32Array?t:new Float32Array(t)}toString(){return`Matrix({ a: ${this.a}, b: ${this.b}, c: ${this.c}, d: ${this.d}, tx: ${this.tx}, ty: ${this.ty} })`}static get IDENTITY(){return new $t}}})),me=b((()=>{de(),te=class{constructor(t=0,e=0,i=0,s=0){this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=i,this.height=s}set(t,e,i,s){return this.x=t,this.y=e,this.width=i,this.height=s,this}clone(){return new te(this.x,this.y,this.width,this.height)}copy(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}equals(t,e,i,s){return t instanceof te?t.x===this.x&&t.y===this.y&&t.width===this.width&&t.height===this.height:t===this.x&&e===this.y&&i===this.width&&s===this.height}translate(t,e){const{x:i,y:s}=Kt(t,e);return this.x+=i,this.y+=s,this}scale(t,e){const{x:i,y:s}=Kt(t,e);return this.width*=i,this.height*=s,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this}getPosition(){return new Qt(this.x,this.y)}getSize(){return new Qt(this.width,this.height)}insetBy(t,e){return this.x+=t,this.y+=e,this.width-=2*t,this.height-=2*e,this}intersects(t){const e=new Qt(this.x,this.y),i=new Qt(this.x+this.width,this.y+this.height),s=new Qt(t.x,t.y),r=new Qt(t.x+t.width,t.y+t.height);return!(s.x>i.x||e.x>r.x||r.y<e.y||i.y<s.y)}toString(){return`Rectangle({ x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height} })`}static FromDiagonalPoints(t,e){let i=!1;e.x-t.x<0&&(i=!0);const s=i?e:t,r=i?t:e,n=r.x-s.x,o=r.y-s.y;return new te(s.x,s.y,n,o)}}})),ge=b((()=>{Ft(),j(),le(),he(),ue(),_e(),me(),de(),It(),ee=2e3,5,ie=20})),pe=b((()=>{ge(),se=class{constructor(){this._position=new Qt(0,0),this._scale=new Qt(1,1),this._pivot=new Qt(0,0),this._rotation=0,this._lastRotation=null,this._alpha=1,this._visible=!0,this._worldTransform=new $t,this._parent=null,this._shaders=[],this._boundsNeedUpdate=!0,this._bounds=new te(0,0,1,1),this._localBoundsNeedUpdate=!0,this._localBounds=new te(0,0,1,1),this._filterRectangle=new te(0,0,0,0)}renderWebGL(t){ut.warn(this.constructor.name,"`renderWebGL` is abstract and not implemented in inherited class")}renderCanvas(t){ut.warn(this.constructor.name,"`renderCanvas` is abstract and not implemented in inherited class")}updateTransform(){const t=this._parent?this._parent.getWorldTransform():$t.IDENTITY,e=this._worldTransform,i=Math.sin(this._rotation),s=Math.cos(this._rotation);e.a=s*this._scale.x,e.b=i*this._scale.x,e.c=-i*this._scale.y,e.d=s*this._scale.y,e.tx=this._position.x,e.ty=this._position.y,(this._pivot.x||this._pivot.y)&&(e.tx-=this._pivot.x*e.a+this._pivot.y*e.c,e.ty-=this._pivot.x*e.b+this._pivot.y*e.d),e.multiply(t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}addShader(t){this._shaders.push(t)}removeShader(t){const e=this._shaders.indexOf(t);return-1!==e&&(this._shaders.splice(e,1),!0)}removeShaderAt(t){return!!this._shaders[t]&&(this._shaders.splice(t,1),!0)}getBounds(){return this._bounds.clone()}getPosition(){return this._position}setPosition(t,e){this._position.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getScale(){return this._scale}setScale(t,e){this._scale.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getPivot(){return this._pivot}setPivot(t,e){this._pivot.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getRotation(){return this._rotation}setRotation(t){this._rotation=t,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getAlpha(){return this._alpha}setAlpha(t){this._alpha=t}getWorldAlpha(){return this._parent?this._parent.getAlpha()*this._alpha:this._alpha}getWorldTransform(){return this._worldTransform}getParent(){return this._parent}setParent(t){this._parent=t}getFilterRectangle(){return this._filterRectangle}setFilterRectangle(t){this._filterRectangle.copy(t)}isVisible(){return this._visible}setVisible(t){this._visible=t}}})),fe=b((()=>{ge(),pe(),re=class extends se{constructor(){super(),this._children=[],this._filters=[]}addFilter(t){this._filters.push(t)}removeFilter(t){const e=this._filters.indexOf(t);return-1!==e&&(this._filters.splice(e,1),!0)}setFilters(t){this._filters=t}addChild(t){const e=t.getParent();e instanceof re&&e.removeChild(t),t.setParent(this),this._children.push(t)}prependChild(t){const e=t.getParent();e instanceof re&&e.removeChild(t),t.setParent(this),this._children.unshift(t)}hasChild(t){return-1!==this._children.indexOf(t)}removeChild(t){const e=this._children.indexOf(t);-1!==e?(this._children.splice(e,1),t.setParent(null)):ut.info(this.constructor.name,"Tried to remove a child that does not exist")}clearChildren(){this._children=[]}renderWebGL(t){if(!this._visible)return;const e=t.getFilterManager();this._filters&&this._filters.length&&e.pushFilters(this,this._filters),t.getCurrentObjectRenderer().start(),this._renderWebGL(t),this._children.forEach((e=>{e.renderWebGL(t)})),t.getCurrentObjectRenderer().flush(),this._filters&&this._filters.length&&e.popFilters(),t.getCurrentObjectRenderer().start()}_renderWebGL(t){}renderCanvas(t){if(!this._visible)return;const e=t.getFilterManager();this._filters&&this._filters.length&&e.pushFilters(this,this._filters),this._renderCanvas(t),this._children.forEach((e=>{e.renderCanvas(t)})),this._filters&&this._filters.length&&e.popFilters()}_renderCanvas(t){}updateTransform(){super.updateTransform(),this._children.forEach((t=>{t.updateTransform()}))}getLocalBounds(){return this._localBoundsNeedUpdate&&(this._localBoundsNeedUpdate=!1),this._localBounds.clone()}getBounds(){return this._boundsNeedUpdate&&(this._boundsNeedUpdate=!1),this._bounds.clone()}getChildren(){return this._children}getFilters(){return this._filters}dispose(){}}}));function ye(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var xe,be,ve,we,De,ke,Te,Ce,Re,Ie,Fe,Se,Ee,Oe,Ae,Be,Me,Pe,Le,ze,Ne,Ue,Ge,je,Ve,We,He,qe,Xe,Ye=b((()=>{ne=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],oe=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24]})),Je=b((()=>{le(),be=xe=class{constructor(t=1,e=0,i=0,s=0,r=0,n=0,o=1,a=0,l=0,h=0,u=0,c=0,d=1,_=0,m=0,g=0,p=0,f=0,y=1,x=0){this.set(t,e,i,s,r,n,o,a,l,h,u,c,d,_,m,g,p,f,y,x)}set(t,e,i,s,r,n,o,a,l,h,u,c,d,_,m,g,p,f,y,x){this.a=t,this.b=e,this.c=i,this.d=s,this.e=r,this.f=n,this.g=o,this.h=a,this.i=l,this.j=h,this.k=u,this.l=c,this.m=d,this.n=_,this.o=m,this.p=g,this.q=p,this.r=f,this.s=y,this.t=x}reset(){this.a=1,this.b=0,this.c=0,this.d=0,this.e=0,this.f=0,this.g=1,this.h=0,this.i=0,this.j=0,this.k=0,this.l=0,this.m=1,this.n=0,this.o=0,this.p=0,this.q=0,this.r=0,this.s=1,this.t=0}apply(t){const e=this.a*t.r+this.b*t.g+this.c*t.b+this.d*t.a+this.e,i=this.f*t.r+this.g*t.g+this.h*t.b+this.i*t.a+this.j,s=this.k*t.r+this.l*t.g+this.m*t.b+this.n*t.a+this.o,r=this.p*t.r+this.q*t.g+this.r*t.b+this.s*t.a+this.t;return new Wt(e,i,s,r)}multiply(t){let e,i,s,r,n,o,a,l,h,u,c,d,_,m,g,p,f,y,x,b;const v=t,w=this;return e=v.a*w.a+v.b*w.f+v.c*w.k+v.d*w.p,i=v.a*w.b+v.b*w.g+v.c*w.l+v.d*w.q,s=v.a*w.c+v.b*w.h+v.c*w.m+v.d*w.r,r=v.a*w.d+v.b*w.i+v.c*w.n+v.d*w.s,o=v.f*w.a+v.g*w.f+v.h*w.k+v.i*w.p,a=v.f*w.b+v.g*w.g+v.h*w.l+v.i*w.q,l=v.f*w.c+v.g*w.h+v.h*w.m+v.i*w.r,h=v.f*w.d+v.g*w.i+v.h*w.n+v.i*w.s,c=v.k*w.a+v.l*w.f+v.m*w.k+v.n*w.p,d=v.k*w.b+v.l*w.g+v.m*w.l+v.n*w.q,_=v.k*w.c+v.l*w.h+v.m*w.m+v.n*w.r,m=v.k*w.d+v.l*w.i+v.m*w.n+v.n*w.s,p=v.p*w.a+v.q*w.f+v.r*w.k+v.s*w.p,f=v.p*w.b+v.q*w.g+v.r*w.l+v.s*w.q,y=v.p*w.c+v.q*w.h+v.r*w.m+v.s*w.r,x=v.p*w.d+v.q*w.i+v.r*w.n+v.s*w.s,n=v.a*w.e+v.b*w.j+v.c*w.o+v.d*w.t+v.e,u=v.f*w.e+v.g*w.j+v.h*w.o+v.i*w.t+v.j,g=v.k*w.e+v.l*w.j+v.m*w.o+v.n*w.t+v.o,b=v.p*w.e+v.q*w.j+v.r*w.o+v.s*w.t+v.t,this.a=e,this.b=i,this.c=s,this.d=r,this.e=n,this.f=o,this.g=a,this.h=l,this.i=h,this.j=u,this.k=c,this.l=d,this.m=_,this.n=m,this.o=g,this.p=p,this.q=f,this.r=y,this.s=x,this.t=b,this}clone(){const t=new xe;return t.set(this.a,this.b,this.c,this.d,this.e,this.f,this.g,this.h,this.i,this.j,this.k,this.l,this.m,this.n,this.o,this.p,this.q,this.r,this.s,this.t),t}equals(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f&&this.g===t.g&&this.h===t.h&&this.i===t.i&&this.j===t.j&&this.k===t.k&&this.l===t.l&&this.m===t.m&&this.n===t.n&&this.o===t.o&&this.p===t.p&&this.q===t.q&&this.r===t.r&&this.s===t.s&&this.t===t.t}getOffsets(){return[this.e,this.j,this.o,this.t]}toString(){return`ColorMatrix( ${this.a}, ${this.b}, ${this.c}, ${this.d}, ${this.e},\n      ${this.f}, ${this.g}, ${this.h}, ${this.i}, ${this.j},\n      ${this.k}, ${this.l}, ${this.m}, ${this.n}, ${this.o},\n      ${this.p}, ${this.q}, ${this.r}, ${this.s}, ${this.t} )`}toArray(){return"abcdefghijklmnopqrst".split("").map((t=>this[t]))}static get IDENTITY(){return new xe}static createBrightnessMatrix(t){const e=new xe;return e.e=t,e.j=t,e.o=t,e}static createContrastMatrix(t){const e=new xe,i=(1-t)/2;return e.a=e.g=e.m=t,e.e=e.j=e.o=i,e}static createSaturationMatrix(t=1){const e=new xe,i=1-t,s=.213*i,r=.715*i,n=.072*i;return e.a=s+t,e.b=r,e.c=n,e.f=s,e.g=r+t,e.h=n,e.k=s,e.l=r,e.m=n+t,e}static createExposureMatrix(t=0){const e=Math.pow(2,t);return new xe(e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0)}static createLinearMatrix(t=1,e=0){const i=new xe;return i.a=i.g=i.m=t,i.e=i.j=i.o=e,i}}})),Ke=b((()=>{j(),Tt(),le(),he(),Je(),de(),It(),we=ve=class extends qt{constructor(t={},e={}){super(),this.availableOptions={...Object.getPrototypeOf(this).availableOptions,...e},this._onConfigurableUpdate=this._onConfigurableUpdate.bind(this),this._initOptions(t)}_buildConfigError(t){let e="";return this.constructor.name&&(e=`${this.constructor.name}: `),e+=t,new Error(e)}_onOptionsChange(){}validateSettings(){return new Promise(((t,e)=>{for(const i in this.availableOptions){if(this.availableOptions[i].required&&"undefined"===typeof this._options[i])return e(this._buildConfigError(`Option \`${i}\` is required.`))}t()}))}_initOptions(t={}){let e,i,s;this._options={};const r=this;for(e in this.availableOptions){if(s=e.charAt(0).toUpperCase()+e.slice(1),i=this.availableOptions[e],-1===[l.STRING,l.NUMBER,l.BOOLEAN,l.OBJECT,l.VECTOR2,l.COLOR,l.CONFIGURABLE,l.COLOR_MATRIX,l.ARRAY,l.IMAGE,l.FUNCTION,l.ALL].indexOf(i.type))throw this._buildConfigError(`Unknown option type: \`${i.type}\``);if(function(t){r[`set${s}`]=function(e,i,s){r.setOption(t,e,i,s)},r[`get${s}`]=function(){return r.getOption(t)}}(e),i.type===l.CONFIGURABLE&&(this._options[e]=new ve(void 0,i.structure||{}),this._options[e].on("update",this._onConfigurableUpdate)),!(e in t)||"undefined"===typeof t[e])if("undefined"!==typeof i.default){let t=i.default;"function"===typeof i.default&&(t=i.default()),this[`set${s}`](t,!1,!0)}else i.type!==l.CONFIGURABLE&&(this._options[e]=void 0)}for(e in t){if("undefined"===typeof this.availableOptions[e])throw new Error(`Invalid option: ${e}`);"undefined"!==typeof t[e]&&(s=e.charAt(0).toUpperCase()+e.slice(1),this[`set${s}`](t[e],!1,!0))}}set(t,e=!0){Object.keys(t).forEach((e=>{this.setOption(e,t[e],!1)})),this._onOptionsChange(),e&&this.emit("update",this,t)}getOption(t){return this._options[t]}hasOption(t){return!!this.availableOptions[t]}getOptionDefault(t){const e=this.availableOptions[t];if(!e)throw new Error(`Invalid option: ${t}`);return e.default}resetOptions(){this.set(this.getDefaultOptions())}getDefaultOptions(){const t={};for(const e in this.availableOptions){const i=this.availableOptions[e].default;"undefined"!==typeof i&&(t[e]=i)}return t}getOptions(){return{...this._options}}equals(t){const e=t.getOptions();return this.optionsEqual(e)}optionsEqual(t){for(const e in t){const i=t[e];if(!this._optionEquals(e,i))return!1}return!0}_optionEquals(t,e){if("undefined"===typeof this.availableOptions[t])throw new Error(`Invalid option: ${t}`);const i=this.availableOptions[t].type,s=this._options[t];if(s===e)return!0;if("undefined"===typeof e||"undefined"===typeof s)return!1;switch(i){case l.OBJECT:return"function"===typeof s.optionsEqual?s.optionsEqual(e._options):s===e;case l.STRING:case l.NUMBER:case l.BOOLEAN:case l.FUNCTION:case"*":return s===e;case l.VECTOR2:return s.equals(e);case l.COLOR:case l.COLOR_MATRIX:return e.equals(s);case l.CONFIGURABLE:return s.optionsEqual(e);case l.ARRAY:return this._arrayOptionEquals(t,e);case l.IMAGE:return s.src===e.src}}_arrayOptionEquals(t,e){const i=this._options[t];if(e.length!==i.length)return!1;let s=!0;for(let r=0;r<i.length;r++){const t=i[r],n=e[r];if(t instanceof ve){if("undefined"===typeof n||!t.optionsEqual(n)){s=!1;break}}else if(n!==t){s=!1;break}}return s}serializeOptions(t=Object.keys(this._options),e=!1){const i={};return t.forEach((t=>{if("undefined"===typeof this.availableOptions[t])return Log.warn(`Trying to serialize a key that does not exist: ${t}`);!1!==this.availableOptions[t].serializable&&(i[t]=this.serializeOption(t,e))})),i}serializeOption(t,e=!1){const i=this.availableOptions[t],s=i.type,r=this._options[t];if(!r)return r;if(!1===i.serializable)throw new Error(`Option \`${t}\` is not serializable.`);switch(s){case l.STRING:case l.NUMBER:case l.BOOLEAN:case l.OBJECT:case l.FUNCTION:case l.ALL:return r;case l.VECTOR2:return e?r.toObject():r.clone();case l.COLOR:case l.COLOR_MATRIX:return e?r.toArray():r.clone();case l.CONFIGURABLE:return r.serializeOptions(void 0,e);case l.ARRAY:return r.slice(0);case l.IMAGE:return e?r.src:r}}setOption(t,e,i=!0,s=!1){const r=this.availableOptions[t];if(!r)throw new Error(`Invalid option: ${t}`);if("undefined"!==typeof r.setter&&(e=r.setter.call(this,e,s)),"undefined"!==typeof r.validation&&r.validation(e),null===e||"undefined"===typeof e){if(r.required)throw this._buildConfigError(`Option \`${t}\` is required.`);this._options[t]=e}else switch(r.type){case l.STRING:{if(typeof e!==l.STRING)throw this._buildConfigError(`Option \`${t}\` has to be a string.`);const{available:i}=r;if("undefined"!==typeof i&&-1===i.indexOf(e))throw this._buildConfigError(`Invalid value for \`${t}\` (valid values are: ${r.available.join(", ")})`);this._options[t]=e;break}case l.NUMBER:if(typeof e!==l.NUMBER)throw this._buildConfigError(`Option \`${t}\` has to be a number.`);this._options[t]=e;break;case l.BOOLEAN:if(typeof e!==l.BOOLEAN)throw this._buildConfigError(`Option \`${t}\` has to be a boolean.`);this._options[t]=e;break;case l.VECTOR2:if(!(e instanceof Qt)&&("object"!==typeof e||!("x"in e)||!("y"in e)))throw this._buildConfigError(`Option \`${t}\` has to be an instance of Vector2 or an Object holding x and y values.`);this._options[t]=e instanceof Qt?e.clone():Qt.fromObject(e);break;case l.COLOR:if(!(e instanceof Wt))throw this._buildConfigError(`Option \`${t}\` has to be an instance of Color.`);this._options[t]=e;break;case l.COLOR_MATRIX:if(!(e instanceof be))throw this._buildConfigError(`Option \`${t}\` has to be an instance of ColorMatrix.`);this._options[t]=e.clone();break;case l.FUNCTION:if("function"!==typeof e)throw this._buildConfigError(`Option \`${t}\` has to be a function.`);this._options[t]=e;break;case l.OBJECT:case"*":this._options[t]=e;break;case l.IMAGE:{const{Image:i}=X;if("string"===typeof e){const s=new i;K(s)&&(s.crossOrigin=st.getCrossOriginValue(r.crossOrigin)),s.src=e,this._options[t]=s}else{if(!(e instanceof i||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement))throw this._buildConfigError(`Option \`${t}\` has to be an Image, Canvas or String.`);this._options[t]=e}break}case l.CONFIGURABLE:e instanceof ve?this._options[t]=e:this._options[t].set(e);break;case l.ARRAY:if(!(e instanceof Array))throw this._buildConfigError(`Option \`${t}\` has to be an Array.`);this._options[t]=e.slice(0);break;default:throw this._buildConfigError(`Unknown option type: \`${r.type}\``)}i&&(this._onOptionsChange(),this.emit("update",this,{[t]:e}))}_onConfigurableUpdate(...t){this.emit("update",...t)}hasChanges(){const t=this.getDefaultOptions();return!this.optionsEqual(t)}}})),Ze=b((()=>{j(),ge(),ge(),De=class{constructor(t,e,i,s={},r=[]){this._program=null,this._renderer=t,this._vertexSource=e,this._fragmentSource=i,this._uniforms=s,this._uniformLocations={},this._attributes=r,this._attributeLocations={},this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._init()}_init(){this._compile();this._renderer.getContext().useProgram(this._program),this._cacheUniformLocations(),this._cacheAttributeLocations()}_onContextChange(){this._init()}setupBuffers(t,e){const i=this._renderer.getContext();i.bindBuffer(i.ARRAY_BUFFER,t),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e),i.vertexAttribPointer(this._attributeLocations.a_position,2,i.FLOAT,!1,ie,0),i.vertexAttribPointer(this._attributeLocations.a_texCoord,2,i.FLOAT,!1,ie,8),i.vertexAttribPointer(this._attributeLocations.a_color,4,i.UNSIGNED_BYTE,!0,ie,16)}syncUniforms(){Object.keys(this._uniforms).forEach((t=>{this.syncUniform(t)}))}syncUniform(t){const e=this._renderer.getContext(),i=this._uniforms[t],s=this._uniformLocations[t];switch(i.type){case h.SAMPLER2D:case h.INT:case h.INT1:e.uniform1i(s,i.value);break;case h.INT2:e.uniform2i(s,i.value[0],i.value[1]);break;case h.INT3:e.uniform3i(s,i.value[0],i.value[1],i.value[2]);break;case h.INT4:e.uniform4i(s,i.value[0],i.value[1],i.value[2],i.value[3]);break;case h.FLOAT:case h.FLOAT1:e.uniform1f(s,i.value);break;case h.FLOAT2:e.uniform2f(s,i.value[0],i.value[1]);break;case h.FLOAT3:e.uniform3f(s,i.value[0],i.value[1],i.value[2]);break;case h.FLOAT4:e.uniform4f(s,i.value[0],i.value[1],i.value[2],i.value[3]);break;case h.FLOAT_VECTOR2:e.uniform2fv(s,i.value);break;case h.MAT3:case h.MAT3FV:e.uniformMatrix3fv(s,!1,i.value);break;case h.MAT4:e.uniformMatrix4fv(s,!1,i.value);break;default:ut.warn(this.constructor.name,`Unknown uniform type: ${i.type}`)}}_cacheAttributeLocations(){const t=this._renderer.getContext();this._attributes.forEach((e=>{this._program&&(this._attributeLocations[e]=t.getAttribLocation(this._program,e))}))}_cacheUniformLocations(){const t=this._renderer.getContext();Object.keys(this._uniforms).forEach((e=>{if(this._program){const i=t.getUniformLocation(this._program,e);i&&(this._uniformLocations[e]=i)}}))}_addPrecisionToSource(t){const e=this._renderer.getMaxFloatPrecision();let i=c.Medium;return st.isMobile()&&e===c.High&&(i=c.High),`precision ${i} float;\n${t}`}_compile(){const t=this._renderer.getContext(),e=this._compileShader(t.VERTEX_SHADER,this._vertexSource);this._vertexShader=e;const i=this._addPrecisionToSource(this._fragmentSource),s=this._compileShader(t.FRAGMENT_SHADER,i);this._fragmentShader=s;const r=t.createProgram();if(!r)return;t.attachShader(r,e),t.attachShader(r,s),t.linkProgram(r);if(t.getProgramParameter(r,t.LINK_STATUS))this._program=r;else{let e=t.getProgramInfoLog(r);t.isContextLost()&&(e="WebGL context lost"),t.deleteProgram(r),ut.error(this.constructor.name,`WebGL program linking error: ${e}`)}}_compileShader(t,e){const i=this._renderer.getContext(),s=i.createShader(t);if(!s)throw new Error(`Cannot create shared: ${JSON.stringify(t)}`);i.shaderSource(s,e),i.compileShader(s);if(!i.getShaderParameter(s,i.COMPILE_STATUS)){let t=i.getShaderInfoLog(s);i.isContextLost()&&(t="WebGL context lost"),i.deleteShader(s),ut.error(this.constructor.name,`WebGL shader compilation error: ${t}`)}return s}setUniform(t,e,i=!1){this._uniforms[t].value=e,i&&this.syncUniform(t)}setUniforms(t,e=!1){Object.keys(t).forEach((i=>{this._uniforms[i].value=t[i],e&&this.syncUniform(i)}))}getUniforms(){return this._uniforms}getAttributes(){return this._attributes}getAttributeLocations(){return this._attributeLocations}getProgram(){return this._program}dispose(){const t=this._renderer.getContext();t.deleteProgram(this._program),t.deleteShader(this._vertexShader),t.deleteShader(this._fragmentShader),this._renderer.off("context",this._onContextChange)}}})),Qe=b((()=>{ke="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;\n}\n"})),$e=b((()=>{Te="attribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\nuniform mat3 u_projMatrix;\n\nvoid main() {\n  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);\n  v_texCoord = a_texCoord;\n  v_color = vec4(a_color.rgb * a_color.a, a_color.a);\n}\n"})),ti=b((()=>{j(),ge(),Ze(),Qe(),$e(),Ce=new $t,Re={vertexSource:Te,fragmentSource:ke,uniforms:{u_image:{type:h.SAMPLER2D,value:0},u_projMatrix:{type:h.MAT3,value:Ce.toArray()}},attributes:["a_position","a_texCoord","a_color"]},Ie=class extends De{constructor(t,e=Re.vertexSource,i=Re.fragmentSource){super(t,e,i,Re.uniforms,Re.attributes)}}})),ei=b((()=>{Ze(),ti()})),ii=b((()=>{C(),Ye(),j(),Ke(),ge(),ei(),Tt(),Fe=class extends we{constructor(t={},e={}){super(t,e),this._initOptions(t)}_initOptions(t={}){this._shaders=[],this._availableUniforms=Re.uniforms,this._attributes=Re.attributes,this._vertexSource=Re.vertexSource,this._fragmentSource=Re.fragmentSource,this._initUniforms(),super._initOptions(t)}_initUniforms(){this._uniforms={};for(const t in this._availableUniforms){const e=this._availableUniforms[t];this._uniforms[t]={type:e.type,value:e.default||null}}for(const t in this.availableOptions){const e=this.availableOptions[t];e.uniformType?this._uniforms[`u_${t}`]={type:e.uniformType,value:e.default||null}:ut.trace(this.constructor.name,`Option \`${t}\` is missing a \`uniformType\`!`)}}setOption(t,e,i=!0){super.setOption(t,e,i);let s=e;const r=this.availableOptions[t];if(!r.uniformType)return;const n=`u_${t}`;switch(r.type){case l.COLOR:r.uniformType===h.FLOAT4?s=e.toGLColor():r.uniformType===h.FLOAT3&&(s=e.toRGBGLColor());break;case l.VECTOR2:s=[e.x,e.y];break;case l.COLOR_MATRIX:{s=[e.a,e.b,e.c,e.d,e.f,e.g,e.h,e.i,e.k,e.l,e.m,e.n,e.p,e.q,e.r,e.s];const t=[e.e,e.j,e.o,e.t];this._uniforms[`${n}_vec`]={value:t,type:h.FLOAT4}}}this.setUniform(n,s)}setUniform(t,e,i=!1){this._uniforms[t].value=e}setUniforms(t,e=!1){Object.entries(t).forEach((([t,i])=>{this._uniforms[t].value=i,e&&this.syncUniform(t)}))}syncUniform(t){this._shaders.forEach((e=>{e.syncUniform(t)}))}syncUniforms(){this._shaders.forEach((t=>{t.syncUniforms()}))}getShaderForRenderer(t){const{id:e}=t;this._shaders||(this._shaders=[]);let i=this._shaders[e];return i||(i=new De(t,this._vertexSource,this._fragmentSource,this._uniforms,this._attributes),this._shaders[e]=i),i}apply(t,e,i,s=!1){Y(t)?this._applyWebGL(t,e,i,s):this._applyCanvas(t,e,i,s)}_applyWebGL(t,e,i,s=!1){const r=t.getContext(),n=this.getShaderForRenderer(t);t.setRenderTarget(i),s&&i.clear(),t.setShader(n);const o=t.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",o),n.syncUniforms(),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,e.getTexture()),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0)}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=i.getContext();ut.warn(this.constructor.name,"`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`."),n.clearRect(0,0,r.width,r.height),n.drawImage(r,0,0)}dispose(){this._shaders.forEach((t=>t.dispose())),this._shaders=[]}_blurImage(t,e,i){const r=t.getCanvas(),n=Math.min(1,10/(i*Math.min(r.width,r.height))),o=st.createCanvas();o.width=Math.round(r.width*n),o.height=Math.round(r.height*n);const a=o.getContext("2d");a.drawImage(r,0,0,r.width,r.height,0,0,o.width,o.height);const l=i*Math.min(o.width,o.height),h=a.getImageData(0,0,o.width,o.height);!function(t,e,i,s,r,n){if(!(isNaN(n)||n<1)){n|=0;var o,a,l,h,u,c,d,_,m,g,p,f,y,x,b,v,w,D,k,T,C,R,I,F,S,E=t.data,O=n+n+1,A=s-1,B=r-1,M=n+1,P=M*(M+1)/2,L=new ye,z=L;for(l=1;l<O;l++)z=z.next=new ye,l==M&&(S=z);z.next=L;var N=null,U=null;d=c=0;var G=ne[n],j=oe[n];for(a=0;a<r;a++){for(v=w=D=k=_=m=g=p=0,f=M*(T=E[c]),y=M*(C=E[c+1]),x=M*(R=E[c+2]),b=M*(I=E[c+3]),_+=P*T,m+=P*C,g+=P*R,p+=P*I,z=L,l=0;l<M;l++)z.r=T,z.g=C,z.b=R,z.a=I,z=z.next;for(l=1;l<M;l++)h=c+((A<l?A:l)<<2),_+=(z.r=T=E[h])*(F=M-l),m+=(z.g=C=E[h+1])*F,g+=(z.b=R=E[h+2])*F,p+=(z.a=I=E[h+3])*F,v+=T,w+=C,D+=R,k+=I,z=z.next;for(N=L,U=S,o=0;o<s;o++)E[c+3]=I=p*G>>j,0!==I?(I=255/I,E[c]=(_*G>>j)*I,E[c+1]=(m*G>>j)*I,E[c+2]=(g*G>>j)*I):E[c]=E[c+1]=E[c+2]=0,_-=f,m-=y,g-=x,p-=b,f-=N.r,y-=N.g,x-=N.b,b-=N.a,h=d+((h=o+n+1)<A?h:A)<<2,_+=v+=N.r=E[h],m+=w+=N.g=E[h+1],g+=D+=N.b=E[h+2],p+=k+=N.a=E[h+3],N=N.next,f+=T=U.r,y+=C=U.g,x+=R=U.b,b+=I=U.a,v-=T,w-=C,D-=R,k-=I,U=U.next,c+=4;d+=s}for(o=0;o<s;o++){for(w=D=k=v=m=g=p=_=0,f=M*(T=E[c=o<<2]),y=M*(C=E[c+1]),x=M*(R=E[c+2]),b=M*(I=E[c+3]),_+=P*T,m+=P*C,g+=P*R,p+=P*I,z=L,l=0;l<M;l++)z.r=T,z.g=C,z.b=R,z.a=I,z=z.next;for(u=s,l=1;l<=n;l++)c=u+o<<2,_+=(z.r=T=E[c])*(F=M-l),m+=(z.g=C=E[c+1])*F,g+=(z.b=R=E[c+2])*F,p+=(z.a=I=E[c+3])*F,v+=T,w+=C,D+=R,k+=I,z=z.next,l<B&&(u+=s);for(c=o,N=L,U=S,a=0;a<r;a++)E[3+(h=c<<2)]=I=p*G>>j,I>0?(I=255/I,E[h]=_*G>>j,E[h+1]=m*G>>j,E[h+2]=g*G>>j):E[h]=E[h+1]=E[h+2]=0,_-=f,m-=y,g-=x,p-=b,f-=N.r,y-=N.g,x-=N.b,b-=N.a,h=o+((h=a+M)<B?h:B)*s<<2,_+=v+=N.r=E[h],m+=w+=N.g=E[h+1],g+=D+=N.b=E[h+2],p+=k+=N.a=E[h+3],N=N.next,f+=T=U.r,y+=C=U.g,x+=R=U.b,b+=I=U.a,v-=T,w-=C,D-=R,k-=I,U=U.next,c+=s}}}(h,0,0,o.width,o.height,l),a.putImageData(h,0,0),e.getContext().drawImage(o,0,0,o.width,o.height,0,0,r.width,r.height),s(o)}}})),si=b((()=>{Se="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(color.a > 0. ? color.rgb / color.a : vec3(0), color.a);\n}\n"})),ri=b((()=>{ii(),si(),Ee=class extends Fe{constructor(){super(),this._fragmentSource=Se}}})),ni=b((()=>{Oe="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;\n}\n"})),oi=b((()=>{ge(),ii(),ni(),({OptionType:Ae,UniformType:Be}=B),(Me=class extends Fe{constructor(...t){super(...t),this._fragmentSource=Oe}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),{color:a}=this._options,l=n.getImageData(0,0,r.width,r.height),h=o.getImageData(0,0,r.width,r.height),u=r.width*r.height,c=new Wt,d=new Wt;for(let _=0;_<4*u;_+=4){c.set(l.data[_]/255,l.data[_+1]/255,l.data[_+2]/255,l.data[_+3]/255),d.set(h.data[_]/255,h.data[_+1]/255,h.data[_+2]/255,h.data[_+3]/255);const t=d.r+c.a*(c.r-d.r);h.data[_]=255*(t+c.a*(a.r-t));const e=d.g+c.a*(c.g-d.g);h.data[_+1]=255*(e+c.a*(a.g-e));const i=d.b+c.a*(c.b-d.b);h.data[_+2]=255*(i+c.a*(a.b-i))}o.putImageData(h,0,0)}}).prototype.availableOptions={color:{type:Ae.COLOR,default:Wt.WHITE,uniformType:Be.FLOAT4}},Pe=Me})),ai=b((()=>{Le="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\nuniform int u_mode;\nvec3 W = vec3(0.2125, 0.7154, 0.0721);\nconst float EPSILON = 0.0000001;\nvoid main() {\n    vec4 color = texture2D(u_image, v_texCoord); // Is premultiplied.\n    color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha.\n    vec4 newColor;\n    if (u_mode == 0) {\n        newColor = vec4(color.rgb, 1.0); // We use alpha 1.0 becaue color is not premultiplied.\n        newColor *= color.a; // Premultiply the result\n    } else if (u_mode == 1) {\n        newColor = vec4(u_color.rgb, 1.0); // Use alpha 1.0 because it is not premultiplied.\n        newColor *= color.a * u_color.a; // Changed alpha and premultiplied the result.\n    } else if (u_mode == 2) {\n        float luminance = dot(color.rgb, W); // Convert to color to gray value.\n        newColor = vec4(vec3(luminance) * u_color.rgb, 1.0); // Colorize and with alpha 1.0 because it is not premultiplied.\n        newColor *= color.a * u_color.a; // Changed alpha and premultiplied the result.\n    }\n    gl_FragColor = newColor;\n}"})),li=b((()=>{ge(),ii(),ai(),({OptionType:ze,UniformType:Ne}=B),(Ue=class extends Fe{constructor(...t){super(...t),this._fragmentSource=Le}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),{mode:l,color:h}=this._options,{r:u,g:c,b:d,a:_}=h,m=[.2125,.7154,.0721];switch(l){case Ue.MODES.SOLID:for(let t=0;t<r.width*r.height;t++){const e=4*t;a.data[e]+=(255*u-a.data[e])*_,a.data[e+1]+=(255*c-a.data[e+1])*_,a.data[e+2]+=(255*d-a.data[e+2])*_}break;case Ue.MODES.COLORIZED:for(let t=0;t<r.width*r.height;t++){const e=4*t,i=a.data[e]/255*m[0]+a.data[e+1]/255*m[1]+a.data[e+2]/255*m[2],s=new Wt(i*u,i*c,i*d);a.data[e]+=(255*s.r-a.data[e])*_,a.data[e+1]+=(255*s.g-a.data[e+1])*_,a.data[e+2]+=(255*s.b-a.data[e+2])*_}}o.putImageData(a,0,0)}}).MODES={NONE:0,SOLID:1,COLORIZED:2},Ue.prototype.availableOptions={color:{type:ze.COLOR,default:Wt.WHITE,uniformType:Ne.FLOAT4},mode:{type:ze.NUMBER,default:Ue.MODES.NONE,uniformType:Ne.INT}},Ge=Ue})),hi=b((()=>{je="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform sampler2D u_overlayImage;\nuniform int u_blendMode;\nuniform float u_alpha;\n\nconst float EPSILON = 0.000001;\n\nvec4 overlay(vec4 a, vec4 b) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 hardLight(vec4 b, vec4 a) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(b, vec4(result, b.a), u_alpha * a.a);\n}\n\nvec4 softLight(vec4 a, vec4 b) {\n    vec3 result = mix(\n          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),\n          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),\n          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 multiply(vec4 a, vec4 b) {\n    vec3 result = a.rgb * b.rgb;\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 darken(vec4 a, vec4 b) {\n    vec3 result = min(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 lighten(vec4 a, vec4 b) {\n    vec3 result = max(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 screen(vec4 a, vec4 b) {\n    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 colorBurn(vec4 a, vec4 b) {\n    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 normal(vec4 a, vec4 b) {\n    return mix(a, vec4(b.rgb, a.a), u_alpha * b.a);\n}\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);\n\n  vec4 resultColor;\n  if (u_blendMode == 0) {\n    resultColor = normal(color, overlayColor);\n  } else if (u_blendMode == 1) {\n    resultColor = overlay(color, overlayColor);\n  } else if (u_blendMode == 2) {\n    resultColor = hardLight(color, overlayColor);\n  } else if (u_blendMode == 3) {\n    resultColor = softLight(color, overlayColor);\n  } else if (u_blendMode == 4) {\n    resultColor = multiply(color, overlayColor);\n  } else if (u_blendMode == 5) {\n    resultColor = darken(color, overlayColor);\n  } else if (u_blendMode == 6) {\n    resultColor = lighten(color, overlayColor);\n  } else if (u_blendMode == 7) {\n    resultColor = screen(color, overlayColor);\n  } else if (u_blendMode == 8) {\n    resultColor = colorBurn(color, overlayColor);\n  }\n  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);\n}\n"})),ui=b((()=>{ge(),ii(),hi(),({OptionType:Ve,UniformType:We}=B),He=1e-6,(qe=class extends Fe{constructor(...t){super(...t),this._fragmentSource=je,this._lastImage=null}_applyCanvas(t,e,i,s=!1){const r=this._options.overlayTexture.getRenderTarget().getContext(),n=e.getCanvas(),o=e.getContext(),a=i.getContext(),l=o.getImageData(0,0,n.width,n.height),h=r.getImageData(0,0,n.width,n.height),{blendMode:u,alpha:c}=this._options,d=new Wt,_=new Wt,m=new Wt;for(let g=0;g<n.width*n.height*4;g+=4){let t,e,i,s,r,n,o,a,p;switch(d.set(l.data[g]/255,l.data[g+1]/255,l.data[g+2]/255,l.data[g+3]/255),_.set(h.data[g]/255,h.data[g+1]/255,h.data[g+2]/255,h.data[g+3]/255),u){case qe.BLEND_MODES.NORMAL:m.set(d.r+_.a*c*(_.r-d.r),d.g+_.a*c*(_.g-d.g),d.b+_.a*c*(_.b-d.b),d.a);break;case qe.BLEND_MODES.OVERLAY:t=1-2*(1-d.r)*(1-_.r),e=2*d.r*_.r,i=t+(d.r<.5?1:0)*(e-t),s=1-2*(1-d.g)*(1-_.g),r=2*d.g*_.g,n=s+(d.g<.5?1:0)*(r-s),o=1-2*(1-d.b)*(1-_.b),a=2*d.b*_.b,p=o+(d.b<.5?1:0)*(a-o),m.set(d.r+_.a*c*(i-d.r),d.g+_.a*c*(n-d.g),d.b+_.a*c*(p-d.b),d.a);break;case qe.BLEND_MODES.HARD_LIGHT:t=1-2*(1-_.r)*(1-d.r),e=2*_.r*d.r,i=t+(_.r<.5?1:0)*(e-t),s=1-2*(1-_.g)*(1-d.g),r=2*_.g*d.g,n=s+(_.g<.5?1:0)*(r-s),o=1-2*(1-_.b)*(1-d.b),a=2*_.b*d.b,p=o+(_.b<.5?1:0)*(a-o),m.set(d.r+_.a*c*(i-d.r),d.g+_.a*c*(n-d.g),d.b+_.a*c*(p-d.b),d.a);break;case qe.BLEND_MODES.SOFT_LIGHT:t=2*d.r*(1-_.r)+(2*_.r-1)*Math.sqrt(d.r),e=2*d.r*_.r+d.r*d.r*(1-2*_.r),i=t+(_.r<.5?1:0)*(e-t),s=2*d.g*(1-_.g)+(2*_.g-1)*Math.sqrt(d.g),r=2*d.g*_.g+d.g*d.g*(1-2*_.g),n=s+(_.g<.5?1:0)*(r-s),o=2*d.b*(1-_.b)+(2*_.b-1)*Math.sqrt(d.b),a=2*d.b*_.b+d.b*d.b*(1-2*_.b),p=o+(_.b<.5?1:0)*(a-o),m.set(d.r+_.a*c*(i-d.r),d.g+_.a*c*(n-d.g),d.b+_.a*c*(p-d.b),d.a);break;case qe.BLEND_MODES.MULTIPLY:i=d.r*_.r,n=d.g*_.g,p=d.b*_.b,m.set(d.r+_.a*c*(i-d.r),d.g+_.a*c*(n-d.g),d.b+_.a*c*(p-d.b),d.a);break;case qe.BLEND_MODES.DARKEN:i=Math.min(d.r,_.r),n=Math.min(d.g,_.g),p=Math.min(d.b,_.b),m.set(d.r+_.a*c*(i-d.r),d.g+_.a*c*(n-d.g),d.b+_.a*c*(p-d.b),d.a);break;case qe.BLEND_MODES.LIGHTEN:i=Math.max(d.r,_.r),n=Math.max(d.g,_.g),p=Math.max(d.b,_.b),m.set(d.r+_.a*c*(i-d.r),d.g+_.a*c*(n-d.g),d.b+_.a*c*(p-d.b),d.a);break;case qe.BLEND_MODES.SCREEN:i=1-(1-d.r)*(1-_.r),n=1-(1-d.g)*(1-_.g),p=1-(1-d.b)*(1-_.b),m.set(d.r+_.a*c*(i-d.r),d.g+_.a*c*(n-d.g),d.b+_.a*c*(p-d.b),d.a);break;case qe.BLEND_MODES.COLOR_BURN:i=Math.max(0,Math.min(1,1-(1-d.r)/Math.max(_.r,He))),n=Math.max(0,Math.min(1,1-(1-d.g)/Math.max(_.g,He))),p=Math.max(0,Math.min(1,1-(1-d.b)/Math.max(_.b,He))),m.set(d.r+_.a*c*(i-d.r),d.g+_.a*c*(n-d.g),d.b+_.a*c*(p-d.b),d.a)}l.data[g]=255*m.r,l.data[g+1]=255*m.g,l.data[g+2]=255*m.b,l.data[g+3]=255*m.a}a.putImageData(l,0,0)}}).BLEND_MODES={NORMAL:0,OVERLAY:1,HARD_LIGHT:2,SOFT_LIGHT:3,MULTIPLY:4,DARKEN:5,LIGHTEN:6,SCREEN:7,COLOR_BURN:8},qe.prototype.availableOptions={blendMode:{type:Ve.NUMBER,default:qe.BLEND_MODES.NORMAL,uniformType:We.INT},overlayImage:{type:Ve.NUMBER,required:!0,uniformType:We.SAMPLER2D},overlayTexture:{type:Ve.OBJECT,required:!0},alpha:{type:Ve.NUMBER,default:1,uniformType:We.FLOAT}},Xe=qe})),ci={};w(ci,{ColorOverlayFilter:()=>Pe,OverlayFilter:()=>Xe,TintFilter:()=>Ge,UnpremultiplyFilter:()=>Ee});var di,_i,mi,gi,pi,fi,yi,xi,bi,vi,wi,Di,ki,Ti,Ci,Ri,Ii,Fi,Si,Ei,Oi,Ai,Bi,Mi,Pi,Li,zi,Ni,Ui,Gi,ji,Vi,Wi,Hi,qi,Xi,Yi,Ji,Ki=b((()=>{ri(),oi(),li(),ui()})),Zi=b((()=>{var t,e;ge(),Tt(),(t=di||(di={}))[t.Nearest=0]="Nearest",t[t.Linear=1]="Linear",t[t.Bilinear=2]="Bilinear",t[t.Trilinear=3]="Trilinear",(e=_i||(_i={}))[e.ClampToEdge=0]="ClampToEdge",e[e.Repeat=1]="Repeat",e[e.MirroredRepeat=2]="MirroredRepeat",mi={1:"LINEAR",0:"NEAREST",2:"LINEAR_MIPMAP_NEAREST",3:"LINEAR_MIPMAP_LINEAR"},(pi=gi=class extends qt{constructor(t){super(),this._renderers=[],this._glTextures={},this._dirty=!0,this._mipMapping=!1,this._glUnit=0,this._magFilter=gi.DefaultMagFilter,this._minFilter=gi.DefaultMinFilter,this._repeatX=0,this._repeatY=0,this._pixelRatio=1,this._loaded=!1,this._frame=new te(0,0,100,100),this._onSourceLoaded=this._onSourceLoaded.bind(this),this._source=t,this._loadSource()}resizeTo(t){this._frame.width===t.x&&this._frame.height===t.y||(this._frame.width=t.x,this._frame.height=t.y,this._dirty=!0)}_loadSource(){const t=this._source;if(t)return X.isCanvas(t)||t.complete?this._onSourceLoaded():void(t.addEventListener&&t.addEventListener("load",this._onSourceLoaded))}_onSourceLoaded(){this._loaded=!0,this.emit("loaded"),this.update()}_updateGLFilters(){if(!this._source)return;const t=new Qt(this._source.width,this._source.height);st.isPowerOfTwo(t)?(ut.info(this.constructor.name,"Mip-mapping enabled"),this._minFilter=gi.TrilinearFilter,this._mipMapping=!0):(this._minFilter=gi.LinearFilter,this._mipMapping=!1)}update(){this._source&&(this._frame.width===this._source.width&&this._frame.height===this._source.height||(this._frame=new te(0,0,this._source.width,this._source.height),this._dirty=!0),this._updateGLFilters(),this.emit("update"))}getRenderers(){return[...this._renderers]}getGLFilter(t,e){switch(e){case"min":return t[mi[this._minFilter]];case"mag":return t[mi[this._magFilter]]}}isLoaded(){return this._loaded}setLoaded(t){this._loaded=t}getSource(){return this._source}setSource(t){this._source=t}getGLTextureForRenderer(t){return this._glTextures[t.id]}setGLTextureForRenderer(t,e){this._renderers[e.id]=e,this._glTextures[e.id]=t}getFrame(){return this._frame}setFrame(t){this._frame=t}getDimensions(){return new Qt(this._frame.width,this._frame.height)}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){this._pixelRatio=t}getGLUnit(){return this._glUnit}setGLUnit(t){this._glUnit=t}setMinFilter(t){this._minFilter=t}getMinFilter(){return this._minFilter}setMagFilter(t){this._magFilter=t}getMagFilter(){return this._magFilter}setRepeatX(t){this._repeatX=t}getRepeatX(){return this._repeatX}setRepeatY(t){this._repeatY=t}getRepeatY(){return this._repeatY}getGLRepeat(t,e){switch("x"===e?this.getRepeatX():this.getRepeatY()){case 0:return t.CLAMP_TO_EDGE;case 1:return t.REPEAT;case 2:return t.MIRRORED_REPEAT;default:return 0}}isDirty(){return this._dirty}setDirty(t){this._dirty=t}disposeGLTextures(){this._renderers.forEach((t=>{Y(t)&&this.disposeGLTexturesForRenderer(t)}))}disposeGLTexturesForRenderer(t){if(!this._glTextures[t.id])return;t.getContext().deleteTexture(this._glTextures[t.id]),delete this._glTextures[t.id],this._renderers[t.id]||delete this._renderers[t.id]}isMipMappingEnabled(){return this._mipMapping}setMipMappingEnabled(t){this._mipMapping=t}dispose(){this.disposeGLTextures(),this._source=void 0}}).NearestFilter=0,pi.LinearFilter=1,pi.BilinearFilter=2,pi.TrilinearFilter=3,pi.DefaultMagFilter=0,pi.DefaultMinFilter=1,pi.Repeat=1,pi._id=0})),Qi=b((()=>{ge(),Zi(),Tt(),fi=class{constructor(t,e,i,s=X.createCanvas(),r){this._width=t,this._height=e,this._pixelRatio=i,this._baseTexture=new pi,this._canvas=s;const n=r||this._canvas.getContext("2d");if(!n)throw new Error("Cannot get canvas context");this._context=n,this._baseTexture.setSource(this._canvas),this._canvas.width=this._width*this._pixelRatio,this._canvas.height=this._height*this._pixelRatio,this._filterStack=[{renderTarget:this,filters:[]}]}clear(){const t=this._context;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}resizeTo(t){this._baseTexture.resizeTo(t),this._width!==t.x&&(this._width=t.x,this._canvas.width=this._width*this._pixelRatio),this._height!==t.y&&(this._height=t.y,this._canvas.height=this._height*this._pixelRatio)}getCanvas(){return this._canvas}getContext(){return this._context}getFilterStack(){return this._filterStack}getWidth(){return this._width}getHeight(){return this._height}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){this._pixelRatio=t}getDimensions(){return new Qt(this._width,this._height)}getBaseTexture(){return this._baseTexture}dispose(){delete this._canvas,delete this._context,this._baseTexture.dispose()}}})),$i=b((()=>{ge(),Qi(),yi=class{constructor(t){this._renderer=t,this._filterStack=[{renderTarget:t.getCurrentRenderTarget(),filters:[]}],this._textures=[],this._textureFrame=new te(0,0,t.getWidth(),t.getHeight())}resizeTo(t){this._textureFrame.width=t.x,this._textureFrame.height=t.y,this._textures.forEach((e=>e.resizeTo(t)))}pushFilters(t,e){this._currentFrame=t.getBounds();const i=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(i),this._filterStack.push({renderTarget:i,filters:e}),i.clear()}popFilters(){const t=this._filterStack.pop();if(!t)return;const{filters:e,renderTarget:i}=t,s=i,r=this._filterStack[this._filterStack.length-1].renderTarget;if(1===e.length){e[0].apply(this._renderer,s,r),this._textures.push(s)}else this._applyFilters(e,s,r);return e}_applyFilters(t,e,i){let s=e,r=this._getOrCreateRenderTarget(!0);const n=t[t.length-1];t.forEach((t=>{if(t===n)t.apply(this._renderer,s,i);else{t.apply(this._renderer,s,r);const e=s;s=r,r=e}})),this._textures.push(s),this._textures.push(r)}_getOrCreateRenderTarget(t=!1){let e=this._textures.pop();return e||(e=new fi(this._textureFrame.width,this._textureFrame.height,1)),t&&e.clear(),e}setFilterStack(t){this._filterStack=t}dispose(){}}})),ts=v(((t,e)=>{(function(){var t,i,s,r,n,o;"undefined"!==typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:"undefined"!==typeof d&&null!==d&&d.hrtime?(e.exports=function(){return(t()-n)/1e6},i=d.hrtime,r=(t=function(){var t;return 1e9*(t=i())[0]+t[1]})(),o=1e9*d.uptime(),n=r-o):Date.now?(e.exports=function(){return Date.now()-s},s=Date.now()):(e.exports=function(){return(new Date).getTime()-s},s=(new Date).getTime())}).call(t)})),es=b((()=>{ge(),xi="undefined"!==typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):ts(),bi=class{constructor(t){this._context=t,this._tracking=!1;const e=this;for(const i in t){"function"===typeof t[i]?this[i]=function(...s){const r=t[i];if(!e._tracking)return r.apply(t,s);const n=xi(),o=r.apply(t,s),a=xi()-n,l={functionName:i,arguments:s,duration:a};return e._trackedCalls.push(l),o}:this._makePropertyWrapper(i)}}_makePropertyWrapper(t){if(-1!==["_context","_trackedCalls","_tracking"].indexOf(t))return;const e=this._context;this.__defineGetter__(t,(()=>e[t])),this.__defineSetter__(t,(i=>{e[t]=i}))}startFrame(){this._tracking=!0,this._trackedCalls=[]}endFrame(){const t="Rendering";ut.log(t,"Frame rendering results:"),ut.log(t,`Context calls: ${this._trackedCalls.length}`);const e={};this._trackedCalls.forEach((({functionName:t,duration:i})=>{e[t]=e[t]||{totalDuration:0,calls:0},e[t].totalDuration+=i,e[t].calls++}));let i=[];for(const s in e){const t=e[s];t.averageDuration=t.totalDuration/t.calls,i.push({functionName:s,data:t})}i.sort(((t,e)=>e.data.totalDuration-t.data.totalDuration)),i=i.slice(0,3),i.forEach((e=>{ut.log(t,`${e.functionName}: ${e.data.calls} calls, ${e.data.totalDuration.toFixed(2)}ms`)}))}}})),is=b((()=>{ge(),vi=class extends qt{constructor(t=800,e=600,i){super(),this._maxTextureSize=null,this._options={debug:!1,transparent:!1,clearColor:Wt.TRANSPARENT,...i,pixelRatio:1},this.setMaxListeners(0),this._width=t,this._height=e,this._dimensions=new Qt(this._width,this._height),this._maxTextureSize=null,this._pixelRatio=this._options.pixelRatio,this._canvas=this._options.canvas,this._clearColor=this._options.transparent?Wt.TRANSPARENT:this._options.clearColor||Wt.BLACK}setCanvas(t){const e=this._canvas;this._canvas=t,e!==t&&(this._createContext(),this._onBeforeContext(),this._setupContext()),this.resizeTo(new Qt(this._width,this._height))}getCanvas(){return this._canvas}_onBeforeContext(){}resizeTo(t,e=!0){this._width=t.x*this._pixelRatio,this._height=t.y*this._pixelRatio,e&&this._canvas&&(this._canvas.width=this._width,this._canvas.height=this._height,"style"in this._canvas&&(this._canvas.style.width=this._width/this._pixelRatio+"px",this._canvas.style.height=this._height/this._pixelRatio+"px")),this._dimensions=t.clone()}_createContext(){ut.warn(this.constructor.name,"`_createContext` is abstract and not implemented in inherited class")}_setupContext(){ut.warn(this.constructor.name,"`_setupContext` is abstract and not implemented in inherited class")}render(t){ut.warn(this.constructor.name,"`render` is abstract and not implemented in inherited class")}getMaxDimensions(){return null}getContext(){return this._context}getWidth(){return this._dimensions.x}getHeight(){return this._dimensions.y}getDimensions(){return this._dimensions}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){this._pixelRatio=t,this._defaultRenderTarget&&this._defaultRenderTarget.setPixelRatio(t)}getMaxTextureSize(){return this._maxTextureSize}getFilterManager(){return this._filterManager}setFilterManager(t){this._filterManager=t}setClearColor(t){this._clearColor=t}getClearColor(){return this._clearColor}isOfType(t){return this._type===t}dispose(){ut.warn(this.constructor.name,"`dispose` is abstract and not implemented in inherited class")}}})),ss=b((()=>{C(),pe(),ge(),$i(),Qi(),es(),Tt(),is(),({RendererType:wi}=B),(ki=Di=class extends vi{constructor(t=800,e=600,i){super(t,e,{...i}),this.id=0,this.setCanvas((null==i?void 0:i.canvas)||X.createCanvas()),this._type=wi.CANVAS}_createContext(){let t=this._canvas.getContext("2d");if(t)return this._options.debug&&(t=new bi(t)),this.id=Di.contextId++,this._context=t,this.emit("context",t),t}_setupContext(){const t=this._context;"imageSmoothingEnabled"in t?t.imageSmoothingEnabled=!0:["moz","webkit","ms"].forEach((e=>{t[e]&&(t[e]=!0)})),this._defaultRenderTarget=new fi(this._width,this._height,this._pixelRatio,this._canvas,this._context),this.setRenderTarget(this._defaultRenderTarget),this._filterManager=new yi(this)}render(t){const e=this._renderTarget.getContext(),i=t.getParent();t.setParent(new se),t.updateTransform(),i&&t.setParent(i),e.setTransform(1,0,0,1,0,0),e.globalAlpha=1;const{width:s,height:r}=this._canvas;e.clearRect(0,0,s,r),0!==this._clearColor.a&&(e.save(),e.fillStyle=this._clearColor.toRGBA(),e.fillRect(0,0,s,r),e.restore()),this.renderDisplayObject(t,this._renderTarget)}renderDisplayObject(t,e){const i=this._renderTarget;this._filterManager.setFilterStack(e.getFilterStack()),this.setRenderTarget(e),t.renderCanvas(this),this.setRenderTarget(i)}getCurrentRenderTarget(){return this._renderTarget}setRenderTarget(t){this._renderTarget=t}getContext(){return this._renderTarget.getContext()}dispose(){s(this._canvas),this._filterManager.dispose()}}).contextId=0,ki.type=wi.CANVAS})),rs=b((()=>{Ti=t=>{if("undefined"!==typeof window){const{WebGLDebugUtils:e}=window;if(e){const i=(t,i)=>{console.error(`gl.${t}(${e.glFunctionArgsToString(t,i)})`)};t=e.makeDebugContext(t,null,i)}}return t}})),ns=b((()=>{Ci=class{constructor(t){this.vertices=new Float32Array([0,0,100,0,100,100,0,100]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.indices=new Uint16Array([0,1,2,0,3,2]),this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this.vertexBuffer=null,this.indexBuffer=null,this.gl=t,this.initBuffers(),this.uploadBuffers()}map(t,e){const{x:i,y:s}=e;this.uvs[2]=e.width/t.width,this.uvs[4]=this.uvs[2],this.uvs[5]=e.height/t.height,this.uvs[7]=this.uvs[5],this.vertices[0]=i,this.vertices[1]=s,this.vertices[2]=i+e.width,this.vertices[3]=s,this.vertices[4]=this.vertices[2],this.vertices[5]=s+e.height,this.vertices[6]=i,this.vertices[7]=this.vertices[5],this.uploadBuffers()}getVertexBuffer(){return this.vertexBuffer}getIndexBuffer(){return this.indexBuffer}dispose(){this.cleanBuffer()}initBuffers(){const{gl:t}=this;this.cleanBuffer(),this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,128,t.DYNAMIC_DRAW),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)}uploadBuffers(){const{gl:t}=this;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices),t.bufferSubData(t.ARRAY_BUFFER,32,this.uvs),t.bufferSubData(t.ARRAY_BUFFER,64,this.colors)}cleanBuffer(){const{gl:t}=this;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)}}})),os=b((()=>{ge(),Zi(),Ri=class{constructor(t,e,i,s,r=!1){this._renderer=t,this._gl=t.getContext(),this._width=e,this._height=i,this._frame=null,this._pixelRatio=s,this._projectionMatrix=new $t,this._mipMapping=!1,this._baseTexture=new pi;const n=this._baseTexture.getFrame();n.width=e,n.height=i,this._baseTexture.setPixelRatio(s),this._baseTexture.setLoaded(!0),this._framebuffer=null,this._isRoot=r,this._filterStack=[{renderTarget:this,filters:[]}],r||this._initFrameBuffer()}resizeTo(t){this._width=0|t.x,this._height=0|t.y,this._baseTexture.resizeTo(t),this._isRoot||this._resizeTexture(),this._baseTexture.setMinFilter(this._getMinFilter()),this._baseTexture.setMagFilter(this._getMagFilter()),this._calculateProjectionMatrix()}_getMinFilter(){let t=pi.DefaultMinFilter;return this._mipMapping&&(t=pi.TrilinearFilter),t}_getMagFilter(){return pi.DefaultMagFilter}_resizeTexture(){const t=this._gl,e=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this._texture&&(t.deleteTexture(this._texture),this._texture=null),this._texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._texture,0),this._texture&&this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this._renderer._options.debug&&Xt.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",t);const s=new Qt(this._width,this._height);st.isPowerOfTwo(s)?(ut.info("WebGLRenderTarget","Mip-mapping enabled"),this._mipMapping=!0):this._mipMapping=!1,this._baseTexture.setMipMappingEnabled(this._mipMapping)}activate(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),this._calculateProjectionMatrix(),t.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),t.disable(t.STENCIL_TEST)}clear(t=Wt.TRANSPARENT){const e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),this._renderer._options.debug&&Xt.checkFramebufferStatus("WebGLRenderTarget#clear",e),e.clearColor.apply(e,t.toGLColor()),e.clear(e.COLOR_BUFFER_BIT)}_calculateProjectionMatrix(){const t=this._projectionMatrix;t.reset();const e=this._frame||new te(0,0,this._width,this._height),{x:i,y:s}=e;this._isRoot?(t.a=1/this._width*2,t.d=-1/this._height*2,t.tx=-1-i*t.a,t.ty=1-s*t.d):(t.a=1/this._width*2,t.d=1/this._height*2,t.tx=-1-i*t.a,t.ty=-1-s*t.d)}_initFrameBuffer(){const t=this._gl;this._framebuffer&&(t.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(t.deleteTexture(this._texture),this._texture=null),this._framebuffer=t.createFramebuffer(),this._texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._texture),t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._texture,0),this._texture&&this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this.resizeTo(new Qt(this._width,this._height)),this._renderer._options.debug&&Xt.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",t)}getProjectionMatrix(){return this._projectionMatrix}getTexture(){return this._texture}getFrame(){return this._frame}setFrame(t){this._frame=t}getFilterStack(){return this._filterStack}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){this._pixelRatio=t,this._isRoot||this._resizeTexture()}getBaseTexture(){return this._baseTexture}dispose(){const t=this._gl;this._baseTexture.dispose(),this._framebuffer&&(t.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(t.deleteTexture(this._texture),this._texture=null)}}})),as=b((()=>{Ki(),ge(),ns(),Tt(),os(),Ii=class{constructor(t){this._renderer=t,this._filterStack=[],this._currentFrame=null,this._renderTargets=[],this._textureFrame=new te(0,0,t.getWidth(),t.getHeight()),this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._onContextChange()}resizeTo(t){this._textureFrame.width=t.x,this._textureFrame.height=t.y,this._renderTargets.forEach((e=>e.resizeTo(t)))}getFilterStack(){return this._filterStack}setFilterStack(t){this._filterStack=t}_getOrCreateRenderTarget(t=!1){let e=this._renderTargets.pop();return e||(e=new Ri(this._renderer,this._textureFrame.width,this._textureFrame.height,1)),this._currentFrame&&e.setFrame(this._currentFrame),t&&e.clear(),e}pushFilters(t,e){const i=t.getBounds();this._currentFrame=i;const s=t.getFilterRectangle();s.width>0&&s.height>0&&(this._currentFrame=s);const r=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(r);e[0]instanceof Ee?r.clear(this._renderer.getClearColor()):r.clear(),this._filterStack.push({renderTarget:r,filters:e})}popFilters(){const t=this._filterStack.pop();if(!t)return;const{filters:e,renderTarget:i}=t,s=i,r=this._filterStack[this._filterStack.length-1].renderTarget,n=s.getFrame();n&&this._quad.map(this._textureFrame,n);const o=e[0].getShaderForRenderer(this._renderer),a=this._quad.getVertexBuffer(),l=this._quad.getIndexBuffer(),h=this._renderer.getContext();h.bindBuffer(h.ARRAY_BUFFER,a),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,l);const u=o.getAttributeLocations();return h.vertexAttribPointer(u.a_position,2,h.FLOAT,!1,0,0),h.vertexAttribPointer(u.a_texCoord,2,h.FLOAT,!1,0,32),h.vertexAttribPointer(u.a_color,4,h.FLOAT,!1,0,64),this._renderer.updateTexture(s.getBaseTexture(),!1),1===e.length?(e[0].apply(this._renderer,s,r),this._renderTargets.push(s)):this._applyFilters(e,s,r),e}_applyFilters(t,e,i){let s=e,r=this._getOrCreateRenderTarget(!0);this._renderer.updateTexture(r.getBaseTexture(),!1);const n=t[t.length-1];t.forEach((t=>{if(t===n)t.apply(this._renderer,s,i,!0);else{t.apply(this._renderer,s,r,!0);const e=s;s=r,r=e}})),this._renderTargets.push(s),this._renderTargets.push(r)}_onContextChange(){this._renderTargets.length=0,Y(this._renderer)&&(this._quad&&this._quad.dispose(),this._quad=new Ci(this._renderer.getContext()))}dispose(){this._renderer.off("context",this._onContextChange),this._quad&&this._quad.dispose(),this._renderTargets.forEach((t=>{t.dispose()}))}}})),ls=v(((t,e)=>{var i=function(){function t(t){return r.appendChild(t.dom),t}function e(t){for(var e=0;e<r.children.length;e++)r.children[e].style.display=e===t?"block":"none";s=t}var s=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",(function(t){t.preventDefault(),e(++s%r.children.length)}),!1);var n=(performance||Date).now(),o=n,a=0,l=t(new i.Panel("FPS","#0ff","#002")),h=t(new i.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new i.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:r,addPanel:t,showPanel:e,begin:function(){n=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(h.update(t-n,200),t>o+1e3&&(l.update(1e3*a/(t-o),100),o=t,a=0,u)){var e=performance.memory;u.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){n=this.end()},domElement:r,setMode:e}};i.Panel=function(t,e,i){var s=1/0,r=0,n=Math.round,o=n(window.devicePixelRatio||1),a=80*o,l=48*o,h=3*o,u=2*o,c=3*o,d=15*o,_=74*o,m=30*o,g=document.createElement("canvas");g.width=a,g.height=l,g.style.cssText="width:80px;height:48px";var p=g.getContext("2d");return p.font="bold "+9*o+"px Helvetica,Arial,sans-serif",p.textBaseline="top",p.fillStyle=i,p.fillRect(0,0,a,l),p.fillStyle=e,p.fillText(t,h,u),p.fillRect(c,d,_,m),p.fillStyle=i,p.globalAlpha=.9,p.fillRect(c,d,_,m),{dom:g,update:function(l,f){s=Math.min(s,l),r=Math.max(r,l),p.fillStyle=i,p.globalAlpha=1,p.fillRect(0,0,a,d),p.fillStyle=e,p.fillText(n(l)+" "+t+" ("+n(s)+"-"+n(r)+")",h,u),p.drawImage(g,c+o,d,_-o,m,c,d,_-o,m),p.fillRect(c+_-o,d,o,m),p.fillStyle=i,p.globalAlpha=.9,p.fillRect(c+_-o,d,o,n((1-l/f)*m))}}},"object"===typeof e&&(e.exports=i)})),hs=b((()=>{Fi=D(ls()),Si=class{constructor(t){this._context=t,this._domAvailable="undefined"!==typeof document,this._hookIntoContext(),this._textures={},this._framebuffers={},this._programs={},this._shaders={},this._buffers={},this._boundTexture=null,this._id=0,this._enums={},this._setupStats(),this._createEnumMap(),this._updateMemoryStats=this._updateMemoryStats.bind(this),this._updateMemoryStats()}_createEnumMap(){for(const t in this._context){const e=this._context[t];"number"===typeof e&&(this._enums[e]=t)}}_enumValueToString(t){const e=this._enums[t];return"undefined"===typeof e?t:e}_setupStats(){this._domAvailable&&(this._stats=new Fi.default,this._stats.showPanel(3),this._memPanel=this._stats.addPanel(new Fi.default.Panel("MB [WebGL]","#43ADEB","#282828")),this._texPanel=this._stats.addPanel(new Fi.default.Panel("Textures","#43ADEB","#282828")),this._bufPanel=this._stats.addPanel(new Fi.default.Panel("Buffers","#43ADEB","#282828")),this._fboPanel=this._stats.addPanel(new Fi.default.Panel("FBOs","#43ADEB","#282828")),this._prgPanel=this._stats.addPanel(new Fi.default.Panel("Programs","#43ADEB","#282828")),this._shdPanel=this._stats.addPanel(new Fi.default.Panel("Shaders","#43ADEB","#282828")))}_updatePanel(t){if(this._domAvailable){switch(this._stats.begin(),t){case"tex":this._texPanel.update(this.getTexturesCount(),50);break;case"buf":this._bufPanel.update(this.getBuffersCount(),50);break;case"fbo":this._fboPanel.update(this.getFBOCount(),50);break;case"prg":this._prgPanel.update(this.getProgramCount(),50);break;case"shd":this._shdPanel.update(this.getShaderCount(),50)}this._stats.end()}}getTexturesCount(){return Object.keys(this._textures).length}getBuffersCount(){return Object.keys(this._buffers).length}getFBOCount(){return Object.keys(this._framebuffers).length}getProgramCount(){return Object.keys(this._programs).length}getShaderCount(){return Object.keys(this._shaders).length}_updateMemoryStats(){if(!this._domAvailable)return;const t=this._getMemoryUsage()/1e3/1e3;this._memPanel.update(t,400),setTimeout(this._updateMemoryStats,1e3)}_getMemoryUsage(){let t=0;for(const e in this._textures)t+=this._textures[e].memory;for(const e in this._buffers)t+=this._buffers[e].memory;return t}_hookIntoContext(){for(const t in this._context){"function"===typeof this._context[t]?this[t]=function(...e){const i=this._context[t];return this._trackGLCall(i,t,e)}:this._makePropertyWrapper(t)}}_makePropertyWrapper(t){if(-1!==["_context"].indexOf(t))return;const e=this._context;this.__defineGetter__(t,(()=>e[t])),this.__defineSetter__(t,(i=>{e[t]=i}))}_trackGLCall(t,e,i){let s;s=-1!==["texImage2D","bindTexture","createTexture","deleteTexture","createBuffer","bindBuffer","bufferData","deleteBuffer","createFramebuffer","deleteFramebuffer","createProgram","deleteProgram","createShader","deleteShader"].indexOf(e)?this[`_${e}`](i):t.apply(this._context,i);const r=this._context.getError();if(0!==r){let t=i.join(", ");t.length>100&&(t=`${t.substr(0,100)}...`),console.error(new Error(`WebGL Error ${this._enumValueToString(r)} in ${e}(${t})`))}return s}_createProgram(){const t=this._context.createProgram();return t._wmmId=this._id++,this._programs[t._wmmId]=t,this._updatePanel("prg"),t}_deleteProgram([t]){t&&this._programs[t._wmmId]&&(delete this._programs[t._wmmId],this._context.deleteProgram(t),this._updatePanel("prg"))}_createShader([t]){const e=this._context.createShader(t);return e._wmmId=this._id++,this._shaders[e._wmmId]=e,this._updatePanel("shd"),e}_deleteShader([t]){t&&this._shaders[t._wmmId]&&(delete this._shaders[t._wmmId],this._context.deleteShader(t),this._updatePanel("shd"))}_createFramebuffer(){const t=this._context.createFramebuffer();return t._wmmId=this._id++,this._framebuffers[t._wmmId]=t,this._updatePanel("fbo"),t}_deleteFramebuffer([t]){t&&this._framebuffers[t._wmmId]&&(delete this._framebuffers[t._wmmId],this._context.deleteFramebuffer(t),this._updatePanel("fbo"))}_createBuffer(){const t=this._context.createBuffer();return t._wmmId=this._id++,this._buffers[t._wmmId]={buffer:t,memory:0},this._updatePanel("buf"),t}_bindBuffer([t,e]){this._context.bindBuffer(t,e),this._boundBuffer=e._wmmId}_bufferData([t,e,i]){let s;this._context.bufferData(t,e,i),"number"===typeof e?s=e:"byteLength"in e?s=e.byteLength:"length"in e&&(s=e.length),this._buffers[this._boundBuffer].memory=s}_deleteBuffer([t]){t&&this._buffers[t._wmmId]&&(delete this._buffers[t._wmmId],this._context.deleteBuffer(t),this._updatePanel("buf"))}_createTexture(){const t=this._context.createTexture();return t._wmmId=this._id++,this._textures[t._wmmId]={texture:t,memory:0},this._updatePanel("tex"),t}_deleteTexture([t]){t&&this._textures[t._wmmId]&&(delete this._textures[t._wmmId],this._context.deleteTexture(t),this._updatePanel("tex"))}_bindTexture([t,e]){this._context.bindTexture(t,e),this._boundTexture=e._wmmId}_texImage2D(t){let[,,e,i,s,r,,,n]=t;"undefined"===typeof n&&(n=r),this._context.texImage2D.apply(this._context,t);const o=this._calculateByteCountForTexture(e,i,s,n);this._textures[this._boundTexture].memory=o}_calculateByteCountForTexture(t,e,i,s){if(null!==s){if(!("width"in s))return s.length;e=s.width,i=s.height}let r=1;switch(t){case this._context.ALPHA:r=1;break;case this._context.RGB:r=3;break;case this._context.RGBA:r=4}return e*i*r}}})),us=b((()=>{Ei=class{constructor(t){this._renderer=t,this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange)}_onContextChange(){}start(){}stop(){this.flush()}flush(){}dispose(){this._renderer.off("context",this._onContextChange),delete this._renderer}}})),cs=b((()=>{ge(),us(),Oi=class extends Ei{constructor(t){super(t),this._vertexBuffer=null,this._indexBuffer=null,this._maxBatchSize=ee,this._vertices=new ArrayBuffer(4*ee*ie),this._positions=new Float32Array(this._vertices),this._colors=new Uint32Array(this._vertices),this._indices=new Uint16Array(6*ee);for(let e=0,i=0;e<6*ee;e+=6,i+=4)this._indices[e+0]=i+0,this._indices[e+1]=i+1,this._indices[e+2]=i+2,this._indices[e+3]=i+0,this._indices[e+4]=i+2,this._indices[e+5]=i+3;this._sprites=[],this._currentBatchSize=0,this._onContextChange()}render(t){const e=t.getTexture();if(!e)return;const i=e.getFrame();e.getBaseTexture();this._currentBatchSize>=this._maxBatchSize&&this.flush();const s=e.getUVs();if(!s)return;const r=this._currentBatchSize*ie;this._addVertexCoordinates(t,r,i),this._addTextureUVs(t,r,s),this._addColors(t,r),this._sprites[this._currentBatchSize]=t,this._currentBatchSize++}_addColors(t,e){const i=this._colors,s=16777215+(255*t.getWorldAlpha()<<24);i[e+4]=i[e+9]=i[e+14]=i[e+19]=s}_addTextureUVs(t,e,i){const s=this._positions,[r,n,o,a]=i;s[e+2]=r.x,s[e+3]=r.y,s[e+7]=n.x,s[e+8]=n.y,s[e+12]=o.x,s[e+13]=o.y,s[e+17]=a.x,s[e+18]=a.y}_addVertexCoordinates(t,e,i){const s=this._positions,r=t.getWorldTransform(),n=t.getAnchor(),o=r.rectangleToCoordinates(i,n);for(let a=0;a<4;a++)s[e+5*a]=o[a].x,s[e+5*a+1]=o[a].y}_onContextChange(){const t=this._renderer.getContext();this._shader=this._renderer.shaders.default,this._vertexBuffer&&(this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer=null),this._vertexBuffer=t.createBuffer(),this._indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW)}start(){this._vertexBuffer&&this._indexBuffer&&this._shader.setupBuffers(this._vertexBuffer,this._indexBuffer)}flush(){var t;const e=this._renderer,i=e.getContext();if(0===this._currentBatchSize)return;if(this._currentBatchSize>.5*ee)i.bufferSubData(i.ARRAY_BUFFER,0,this._vertices);else{const t=this._positions.subarray(0,this._currentBatchSize*ie);i.bufferSubData(i.ARRAY_BUFFER,0,t)}let s=0,r=null,n=null,o=null,a=null,l=!1,h=!1,u=null,c=0;for(let d=0,_=this._currentBatchSize;d<_;d++){if(u=this._sprites[d],n=null==(t=u.getTexture())?void 0:t.getBaseTexture(),a=u.getShader()||this._shader,l=o!==a,h=r!==n,(h||l)&&(r&&this._renderBatch(r,s,c),c=d,s=0,r=n,l)){o=a,e.setShader(o);const t=e.getCurrentRenderTarget().getProjectionMatrix().toArray();o.setUniform("u_projMatrix",t),o.syncUniforms(),i.activeTexture(i.TEXTURE0)}s++}r&&this._renderBatch(r,s,c),this._currentBatchSize=0,this._sprites=[]}_renderBatch(t,e,i){if(0===e)return;const s=this._renderer,r=s.getContext();let n=t.getGLTextureForRenderer(s);n||(n=s.getOrCreateGLTexture(t)),t.isDirty()&&(s.updateTexture(t),t.setDirty(!1)),r.activeTexture(r.TEXTURE0+t.getGLUnit()),r.bindTexture(r.TEXTURE_2D,n);const o=6*e,a=6*i*2;r.drawElements(r.TRIANGLES,o,r.UNSIGNED_SHORT,a)}dispose(){const t=this._renderer.getContext();this._sprites.forEach((t=>{t.dispose()})),this._vertexBuffer&&(t.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(t.deleteBuffer(this._indexBuffer),this._indexBuffer=null),delete this._vertices,delete this._positions,delete this._colors,delete this._indices,super.dispose()}}})),ds=b((()=>{rs(),C(),j(),pe(),ge(),as(),ei(),es(),Tt(),os(),hs(),is(),us(),cs(),(Bi=Ai=class extends vi{constructor(t=800,e=600,i){super(t,e,i),this.type=u.WEBGL,this.maxTextureDimensions=null,this._type=u.WEBGL,this._onContextLost=this._onContextLost.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.setCanvas(this._options.canvas||X.createCanvas()),this.shaders={default:new Ie(this,void 0,void 0)},this.renderers={sprite:new Oi(this)}}_onContextLost(t){t.preventDefault(),ut.warn(this.constructor.name,"WebGL context has been lost - trying to restore."),this.emit("context-lost")}_onContextCreationError(t){t.preventDefault(),ut.warn(this.constructor.name,`Failed to create WebGL context: ${t.statusMessage||"Unknown error"}`)}_onContextRestored(){ut.warn(this.constructor.name,"WebGL context has been restored. Clearing all textures."),this._createContext(),this._setupContext(),this.emit("context-restored")}_onBeforeContext(){this._filterManager&&this._filterManager.dispose(),this._filterManager=new Ii(this),this._currentObjectRenderer=new Ei(this)}setShader(t){this._currentShader=t,this._context.useProgram(t.getProgram()),this._setAttributesForShader(t)}setCanvas(t){this._canvas&&this._removeContextEventListeners(),super.setCanvas(t),this._addContextEventListeners()}_addContextEventListeners(){J(this._canvas)&&(this._canvas.addEventListener("webglcontextlost",this._onContextLost),this._canvas.addEventListener("webglcontextrestored",this._onContextRestored),this._canvas.addEventListener("webglcontextcreationerror",this._onContextCreationError))}_removeContextEventListeners(){J(this._canvas)&&(this._canvas.removeEventListener("webglcontextlost",this._onContextLost),this._canvas.removeEventListener("webglcontextrestored",this._onContextRestored),this._canvas.removeEventListener("webglcontextcreationerror",this._onContextCreationError))}_setAttributesForShader(t){if(!this._canvas)return;const e=this._context,i=t.getAttributes(),s=t.getAttributeLocations();i.forEach((t=>{const i=s[t];e.enableVertexAttribArray(i)}))}_createContext(){if(!this._canvas)return;let t=X.glGet(this._canvas);return this._options.debug&&Ti(t),this._options.debug&&(t=new bi(t),t=new Si(t)),this.id=Ai.contextId++,this._context=t,this._maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.emit("context",t),t}_setupContext(){const t=this._context;t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this._defaultRenderTarget=new Ri(this,this._width,this._height,this._pixelRatio,!0),this.setRenderTarget(this._defaultRenderTarget),this._getMaxPrecision()}getContext(){return this._context}_getMaxPrecision(){const t=this._context,e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);this._maxFloatPrecision=0!==(null==e?void 0:e.precision)?c.High:c.Medium;const i=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_INT);this._maxIntPrecision=0!==(null==i?void 0:i.rangeMax)?c.High:c.Low}resizeTo(t,e=!0){super.resizeTo(t,e),this._currentRenderTarget&&this._currentRenderTarget.resizeTo(t),this._context=X.glResize(this._context,t)}setRenderTarget(t=this._defaultRenderTarget){this._currentRenderTarget=t,this._currentRenderTarget.activate()}setObjectRenderer(t){this._currentObjectRenderer.stop(),this._currentObjectRenderer=t,this._currentObjectRenderer.start()}render(t){this.setRenderTarget(this._defaultRenderTarget),this._defaultRenderTarget.clear(this._clearColor);const e=t.getParent();t.setParent(new se),t.updateTransform(),e&&t.setParent(e),this.renderDisplayObject(t,this._defaultRenderTarget)}renderDisplayObject(t,e){this.setRenderTarget(e),this._filterManager.setFilterStack(e.getFilterStack()),t.renderWebGL(this),this._currentObjectRenderer.flush()}clear(){const t=this._context;t.clearColor.apply(t,this._clearColor.toGLColor),t.clear(t.COLOR_BUFFER_BIT)}save(){return{renderTarget:this._currentRenderTarget,objectRenderer:this._currentObjectRenderer,filterStack:this._filterManager.getFilterStack()}}restore(t){this.setRenderTarget(t.renderTarget),this._filterManager.setFilterStack(t.filterStack),this._currentObjectRenderer=t.objectRenderer}getOrCreateGLTexture(t){const e=this._context;let i=t.getGLTextureForRenderer(this);return i||(i=e.createTexture(),t.setGLTextureForRenderer(i,this)),i}updateTexture(t,e=!0){const i=t.getSource(),s=this._context,r=t.getGLUnit(),n=this.getOrCreateGLTexture(t);s.activeTexture(s.TEXTURE0+r),s.bindTexture(s.TEXTURE_2D,n),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e&&i&&X.glTexImage(s,i),t.isMipMappingEnabled()?s.generateMipmap(s.TEXTURE_2D):(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,t.getGLRepeat(s,"x")),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,t.getGLRepeat(s,"y"))),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,t.getGLFilter(s,"min")),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,t.getGLFilter(s,"mag")),s.activeTexture(s.TEXTURE0)}getMaxDimensions(){return this.maxTextureDimensions||(this.maxTextureDimensions=X.glMaxTexture(this._context)),this.maxTextureDimensions}getCurrentRenderTarget(){return this._currentRenderTarget}getCurrentObjectRenderer(){return this._currentObjectRenderer}getMaxFloatPrecision(){return this._maxFloatPrecision}getMaxIntPrecision(){return this._maxIntPrecision}dispose(){this._canvas&&s(this._canvas),this._filterManager.dispose(),this._currentObjectRenderer.dispose(),this._defaultRenderTarget.dispose();for(const e in this.shaders)this.shaders[e].dispose(),delete this.shaders[e];this._removeContextEventListeners();const t=this._context.getExtension("WEBGL_lose_context");t&&t.loseContext()}}).contextId=0})),_s=b((()=>{de(),Mi={create:()=>[new Qt(0,0),new Qt(1,0),new Qt(1,1),new Qt(0,1)],updateViaFrames:(t,e,i)=>{const[s,r,n,o]=t;return s.x=e.x/i.width,s.y=e.y/i.height,r.x=(e.x+e.width)/i.width,r.y=e.y/i.height,n.x=(e.x+e.width)/i.width,n.y=(e.y+e.height)/i.height,o.x=e.x/i.width,o.y=(e.y+e.height)/i.height,t}}})),ms=b((()=>{_s(),ge(),Zi(),Pi=class extends qt{constructor(t,e){if(super(),!(t instanceof pi))throw new Error("`baseTexture` should be an instance of BaseTexture");this._uvs=Mi.create(),this._frame=e?e.clone():new te(0,0,1,1),this._frameLocked=Boolean(e),this._onBaseTextureLoaded=this._onBaseTextureLoaded.bind(this),this._onBaseTextureUpdated=this._onBaseTextureUpdated.bind(this),this.setBaseTexture(t)}static fromImage(t){const e=new pi(t);return new Pi(e)}static fromCanvas(t){const e=new pi(t);return new Pi(e)}_onBaseTextureLoaded(){if(!this._frameLocked){const t=this._baseTexture.getFrame().clone();this.setFrame(t)}this._baseTexture.on("update",this._onBaseTextureUpdated)}_onBaseTextureUpdated(){const{width:t,height:e}=this._baseTexture.getFrame();this._frame.width=t,this._frame.height=e,this.emit("update")}_updateUVs(){this._uvs=Mi.updateViaFrames(this._uvs,this._frame,this._baseTexture.getFrame())}getBaseTexture(){return this._baseTexture}setBaseTexture(t){if(this._baseTexture=t,this._baseTexture.isLoaded()){const{width:e,height:i}=t.getFrame();this._frameLocked||(this._frame=new te(0,0,e,i)),this._onBaseTextureLoaded()}else this._baseTexture.once("loaded",this._onBaseTextureLoaded)}getFrame(){return this._frame}setFrame(t){this._frame=t,this._updateUVs()}getWidth(){return this._frame.width}getHeight(){return this._frame.height}getUVs(){return this._uvs}getDimensions(){return new Qt(this._frame.width,this._frame.height)}dispose(t=!0){t&&this._baseTexture.dispose()}}})),gs=b((()=>{j(),ge(),$i(),as(),Qi(),os(),Zi(),ms(),Li=t=>t._type===u.WEBGL,zi=class extends Pi{constructor(t,e=100,i=100,s=1){super(new pi,new te(0,0,e,i)),this._loaded=!0,this._width=e,this._height=i,this._pixelRatio=s,this._renderer=t,this._setupFilterManager(),this._setupBuffer(),this.setBaseTexture(this._renderTarget.getBaseTexture()),this._updateUVs()}_setupFilterManager(){this._filterManager&&this._filterManager.dispose(),Li(this._renderer)?this._filterManager=new Ii(this._renderer):this._filterManager=new yi(this._renderer),this._filterManager.resizeTo(new Qt(this._width,this._height))}_setupBuffer(){this._renderTarget&&this._renderTarget.dispose(),Li(this._renderer)?this._renderTarget=new Ri(this._renderer,this._width,this._height,this._pixelRatio):this._renderTarget=new fi(this._width,this._height,this._pixelRatio)}clear(t){this._renderTarget.clear(t)}resizeTo(t){this._width===t.x&&this._height===t.y||(this._width=t.x,this._height=t.y,this._frame.width=t.x,this._frame.height=t.y,this._renderTarget.resizeTo(t),this._filterManager.resizeTo(t))}render(t){Li(this._renderer)?this._renderWebGL(t):this._renderCanvas(t)}_renderWebGL(t){if(!Li(this._renderer))return;this._renderTarget.activate(),t.getWorldTransform().reset(),t.getChildren().forEach((t=>{t.updateTransform()}));const e=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(t,this._renderTarget),this._renderer.setFilterManager(e)}_renderCanvas(t){if(Li(this._renderer))return;t.getWorldTransform().reset(),t.getChildren().forEach((t=>{t.updateTransform()}));const e=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(t,this._renderTarget),this._renderer.setFilterManager(e)}getRenderTarget(){return this._renderTarget}dispose(){this._renderTarget.dispose(),this._filterManager.dispose(),super.dispose()}}})),ps=b((()=>{Ni={EXPORT:"export",CLOSE:"close",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",EDITOR_READY:"editor:ready",WINDOW_RESIZE:"window:resize",ZOOM_DONE:"editor:zoom_done",HISTORY_UNDO:"history:undo",HISTORY_UPDATED:"history:update",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"},Ui={DEFAULTS:{FILTERS:[{identifier:"imgly_filters_duotone",defaultName:"DuoTone",assetFileName:"duotone",filters:[{identifier:"imgly_duotone_desert",defaultName:"Desert",lightColor:"#e1de9a",darkColor:"#cb2129"},{identifier:"imgly_duotone_peach",defaultName:"Peach",lightColor:"#e9abb8",darkColor:"#0040ff"},{identifier:"imgly_duotone_clash",defaultName:"Clash",lightColor:"#f41a0f",darkColor:"#23007c"},{identifier:"imgly_duotone_plum",defaultName:"Plum",lightColor:"#74d7ff",darkColor:"#23007c"},{identifier:"imgly_duotone_breezy",defaultName:"Breezy",lightColor:"#68fdff",darkColor:"#c20000"},{identifier:"imgly_duotone_deepblue",defaultName:"Deep Blue",lightColor:"#2de9eb",darkColor:"#58007c"},{identifier:"imgly_duotone_frog",defaultName:"Frog",lightColor:"#5bff60",darkColor:"#7f23a9"},{identifier:"imgly_duotone_sunset",defaultName:"Sunset",lightColor:"#f8ea46",darkColor:"#c400be"}]},{identifier:"imgly_filters_bw",assetFileName:"b&w",defaultName:"Black & White",filters:[{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"Greyed",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"Dusty",lutImage:"filters/imgly_lut_dusty_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia",lutImage:"filters/imgly_lut_sepia_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Weathered",lutImage:"filters/imgly_lut_weathered_5_5_128.png"},{identifier:"imgly_lut_sin",defaultName:"Hard Stuff",lutImage:"filters/imgly_lut_hard_stuff_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8}]},{identifier:"imgly_filters_retro",assetFileName:"vintage",defaultName:"Vintage",filters:[{identifier:"imgly_lut_blues",defaultName:"Polaroid",lutImage:"filters/imgly_lut_polaroid_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Sunny 70s",lutImage:"filters/imgly_lut_sunny_70s_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_texas",defaultName:"Oldtimer",lutImage:"filters/imgly_lut_oldtimer_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_celsius",defaultName:"Inferno",lutImage:"filters/imgly_lut_inferno_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_cool",defaultName:"Snappy",lutImage:"filters/imgly_lut_snappy_5_5_128.png"}]},{identifier:"imgly_filters_analog",assetFileName:"smooth",defaultName:"Smooth",filters:[{identifier:"imgly_lut_chest",defaultName:"Chestnut",lutImage:"filters/imgly_lut_chestnut_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_winter",defaultName:"Softly",lutImage:"filters/imgly_lut_softly_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"Pebble",lutImage:"filters/imgly_lut_pebble_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Moss",lutImage:"filters/imgly_lut_moss_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lemon",lutImage:"filters/imgly_lut_lemon_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Green Gap",lutImage:"filters/imgly_lut_green_gap_5_5_128.png"}]},{identifier:"imgly_filters_winter",assetFileName:"cold",defaultName:"Cold",filters:[{identifier:"imgly_lut_elder",defaultName:"Colla",lutImage:"filters/imgly_lut_colla_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Solanus",lutImage:"filters/imgly_lut_solanus_5_5_128.png"},{identifier:"imgly_lut_bleached",defaultName:"Kalmen",lutImage:"filters/imgly_lut_kalmen_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Joran",lutImage:"filters/imgly_lut_joran_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Levante",lutImage:"filters/imgly_lut_levante_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Zephyr",lutImage:"filters/imgly_lut_zephyr_5_5_128.png"}]},{identifier:"imgly_filters_summer",assetFileName:"warm",defaultName:"Warm",filters:[{identifier:"imgly_lut_sunset",defaultName:"Golden",lutImage:"filters/imgly_lut_golden_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Low Fire",lutImage:"filters/imgly_lut_low_fire_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Sunrise",lutImage:"filters/imgly_lut_sunrise_5_5_128.png"},{identifier:"imgly_lut_k2",defaultName:"Flat Black",lutImage:"filters/imgly_lut_flat_black_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_nogreen",defaultName:"Pumpkin",lutImage:"filters/imgly_lut_pumpkin_5_5_128.png"}]},{identifier:"imgly_filters_legacy",defaultName:"Legacy",assetFileName:"legacy",filters:[{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"Hicon",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_lomo",defaultName:"Lomo",lutImage:"filters/imgly_lut_lomo_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:1e3,height:935}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"]}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"]}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"]}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"]}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"]}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"]}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"]}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"]}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"]}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"]}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"]}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"]}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"]}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"]}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"]}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"]}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"]}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"]}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"]}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"]}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"]}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"]}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"]}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"]}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"]}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"]}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"]}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"]}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"]}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"]}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"]}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"]}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"]}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"]}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"]}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"]}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"]}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"]}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"]}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"]}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"]}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"]}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"]}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"]}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"]}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"]}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"]}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"]}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"]}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"]}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"]}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"]}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"]}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}}}));function fs(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function ys(){return new fs(null)}function xs(t,e,i,s,r,n){for(;--n>=0;){var o=e*this[t++]+i[s]+r;r=Math.floor(o/67108864),i[s++]=67108863&o}return r}function bs(t,e,i,s,r,n){for(var o=32767&e,a=e>>15;--n>=0;){var l=32767&this[t],h=this[t++]>>15,u=a*l+h*o;r=((l=o*l+((32767&u)<<15)+i[s]+(1073741823&r))>>>30)+(u>>>15)+a*h+(r>>>30),i[s++]=1073741823&l}return r}function vs(t,e,i,s,r,n){for(var o=16383&e,a=e>>14;--n>=0;){var l=16383&this[t],h=this[t++]>>14,u=a*l+h*o;r=((l=o*l+((16383&u)<<14)+i[s]+r)>>28)+(u>>14)+a*h,i[s++]=268435455&l}return r}function ws(t){return Vi.charAt(t)}function Ds(t,e){var i=Wi[t.charCodeAt(e)];return null==i?-1:i}function ks(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function Ts(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function Cs(t){var e=ys();return e.fromInt(t),e}function Rs(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var s=t.length,r=!1,n=0;--s>=0;){var o=8==i?255&t[s]:Ds(t,s);o<0?"-"==t.charAt(s)&&(r=!0):(r=!1,0==n?this[this.t++]=o:n+i>this.DB?(this[this.t-1]|=(o&(1<<this.DB-n)-1)<<n,this[this.t++]=o>>this.DB-n):this[this.t-1]|=o<<n,(n+=i)>=this.DB&&(n-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,n>0&&(this[this.t-1]|=(1<<this.DB-n)-1<<n)),this.clamp(),r&&fs.ZERO.subTo(this,this)}function Is(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function Fs(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,s=(1<<e)-1,r=!1,n="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this[o]>>a)>0&&(r=!0,n=ws(i));o>=0;)a<e?(i=(this[o]&(1<<a)-1)<<e-a,i|=this[--o]>>(a+=this.DB-e)):(i=this[o]>>(a-=e)&s,a<=0&&(a+=this.DB,--o)),i>0&&(r=!0),r&&(n+=ws(i));return r?n:"0"}function Ss(){var t=ys();return fs.ZERO.subTo(this,t),t}function Es(){return this.s<0?this.negate():this}function Os(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(0!=(e=i-t.t))return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0}function As(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function Bs(){return this.t<=0?0:this.DB*(this.t-1)+As(this[this.t-1]^this.s&this.DM)}function Ms(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function Ps(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function Ls(t,e){var i,s=t%this.DB,r=this.DB-s,n=(1<<r)-1,o=Math.floor(t/this.DB),a=this.s<<s&this.DM;for(i=this.t-1;i>=0;--i)e[i+o+1]=this[i]>>r|a,a=(this[i]&n)<<s;for(i=o-1;i>=0;--i)e[i]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()}function zs(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)e.t=0;else{var s=t%this.DB,r=this.DB-s,n=(1<<s)-1;e[0]=this[i]>>s;for(var o=i+1;o<this.t;++o)e[o-i-1]|=(this[o]&n)<<r,e[o-i]=this[o]>>s;s>0&&(e[this.t-i-1]|=(this.s&n)<<r),e.t=this.t-i,e.clamp()}}function Ns(t,e){for(var i=0,s=0,r=Math.min(t.t,this.t);i<r;)s+=this[i]-t[i],e[i++]=s&this.DM,s>>=this.DB;if(t.t<this.t){for(s-=t.s;i<this.t;)s+=this[i],e[i++]=s&this.DM,s>>=this.DB;s+=this.s}else{for(s+=this.s;i<t.t;)s-=t[i],e[i++]=s&this.DM,s>>=this.DB;s-=t.s}e.s=s<0?-1:0,s<-1?e[i++]=this.DV+s:s>0&&(e[i++]=s),e.t=i,e.clamp()}function Us(t,e){var i=this.abs(),s=t.abs(),r=i.t;for(e.t=r+s.t;--r>=0;)e[r]=0;for(r=0;r<s.t;++r)e[r+i.t]=i.am(0,s[r],e,r,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&fs.ZERO.subTo(e,e)}function Gs(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var s=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,s,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}function js(t,e,i){var s=t.abs();if(!(s.t<=0)){var r=this.abs();if(r.t<s.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=ys());var n=ys(),o=this.s,a=t.s,l=this.DB-As(s[s.t-1]);l>0?(s.lShiftTo(l,n),r.lShiftTo(l,i)):(s.copyTo(n),r.copyTo(i));var h=n.t,u=n[h-1];if(0!=u){var c=u*(1<<this.F1)+(h>1?n[h-2]>>this.F2:0),d=this.FV/c,_=(1<<this.F1)/c,m=1<<this.F2,g=i.t,p=g-h,f=null==e?ys():e;for(n.dlShiftTo(p,f),i.compareTo(f)>=0&&(i[i.t++]=1,i.subTo(f,i)),fs.ONE.dlShiftTo(h,f),f.subTo(n,n);n.t<h;)n[n.t++]=0;for(;--p>=0;){var y=i[--g]==u?this.DM:Math.floor(i[g]*d+(i[g-1]+m)*_);if((i[g]+=n.am(0,y,i,p,0,h))<y)for(n.dlShiftTo(p,f),i.subTo(f,i);i[g]<--y;)i.subTo(f,i)}null!=e&&(i.drShiftTo(h,e),o!=a&&fs.ZERO.subTo(e,e)),i.t=h,i.clamp(),l>0&&i.rShiftTo(l,i),o<0&&fs.ZERO.subTo(i,i)}}}function Vs(t){var e=ys();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(fs.ZERO)>0&&t.subTo(e,e),e}function Ws(t){this.m=t}function Hs(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function qs(t){return t}function Xs(t){t.divRemTo(this.m,null,t)}function Ys(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function Js(t,e){t.squareTo(e),this.reduce(e)}function Ks(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e}function Zs(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Qs(t){var e=ys();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(fs.ZERO)>0&&this.m.subTo(e,e),e}function $s(t){var e=ys();return t.copyTo(e),this.reduce(e),e}function tr(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],s=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[i=e+this.m.t]+=this.m.am(0,s,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function er(t,e){t.squareTo(e),this.reduce(e)}function ir(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function sr(){return 0==(this.t>0?1&this[0]:this.s)}function rr(t,e){if(t>4294967295||t<1)return fs.ONE;var i=ys(),s=ys(),r=e.convert(this),n=As(t)-1;for(r.copyTo(i);--n>=0;)if(e.sqrTo(i,s),(t&1<<n)>0)e.mulTo(s,r,i);else{var o=i;i=s,s=o}return e.revert(i)}function nr(t,e){var i;return i=t<256||e.isEven()?new Ws(e):new Zs(e),this.exp(t,i)}function or(){var t=ys();return this.copyTo(t),t}function ar(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function lr(){return 0==this.t?this.s:this[0]<<24>>24}function hr(){return 0==this.t?this.s:this[0]<<16>>16}function ur(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function cr(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function dr(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),s=Cs(i),r=ys(),n=ys(),o="";for(this.divRemTo(s,r,n);r.signum()>0;)o=(i+n.intValue()).toString(t).substr(1)+o,r.divRemTo(s,r,n);return n.intValue().toString(t)+o}function _r(t,e){this.fromInt(0),null==e&&(e=10);for(var i=this.chunkSize(e),s=Math.pow(e,i),r=!1,n=0,o=0,a=0;a<t.length;++a){var l=Ds(t,a);l<0?"-"==t.charAt(a)&&0==this.signum()&&(r=!0):(o=e*o+l,++n>=i&&(this.dMultiply(s),this.dAddOffset(o,0),n=0,o=0))}n>0&&(this.dMultiply(Math.pow(e,n)),this.dAddOffset(o,0)),r&&fs.ZERO.subTo(this,this)}function mr(t,e,i){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(fs.ONE.shiftLeft(t-1),wr,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(fs.ONE.shiftLeft(t-1),this);else{var s=new Array,r=7&t;s.length=1+(t>>3),e.nextBytes(s),r>0?s[0]&=(1<<r)-1:s[0]=0,this.fromString(s,256)}}function gr(){var t=this.t,e=new Array;e[0]=this.s;var i,s=this.DB-t*this.DB%8,r=0;if(t-- >0)for(s<this.DB&&(i=this[t]>>s)!=(this.s&this.DM)>>s&&(e[r++]=i|this.s<<this.DB-s);t>=0;)s<8?(i=(this[t]&(1<<s)-1)<<8-s,i|=this[--t]>>(s+=this.DB-8)):(i=this[t]>>(s-=8)&255,s<=0&&(s+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==r&&(128&this.s)!=(128&i)&&++r,(r>0||i!=this.s)&&(e[r++]=i);return e}function pr(t){return 0==this.compareTo(t)}function fr(t){return this.compareTo(t)<0?this:t}function yr(t){return this.compareTo(t)>0?this:t}function xr(t,e,i){var s,r,n=Math.min(t.t,this.t);for(s=0;s<n;++s)i[s]=e(this[s],t[s]);if(t.t<this.t){for(r=t.s&this.DM,s=n;s<this.t;++s)i[s]=e(this[s],r);i.t=this.t}else{for(r=this.s&this.DM,s=n;s<t.t;++s)i[s]=e(r,t[s]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function br(t,e){return t&e}function vr(t){var e=ys();return this.bitwiseTo(t,br,e),e}function wr(t,e){return t|e}function Dr(t){var e=ys();return this.bitwiseTo(t,wr,e),e}function kr(t,e){return t^e}function Tr(t){var e=ys();return this.bitwiseTo(t,kr,e),e}function Cr(t,e){return t&~e}function Rr(t){var e=ys();return this.bitwiseTo(t,Cr,e),e}function Ir(){for(var t=ys(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function Fr(t){var e=ys();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Sr(t){var e=ys();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Er(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function Or(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+Er(this[t]);return this.s<0?this.t*this.DB:-1}function Ar(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Br(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=Ar(this[i]^e);return t}function Mr(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function Pr(t,e){var i=fs.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i}function Lr(t){return this.changeBit(t,wr)}function zr(t){return this.changeBit(t,Cr)}function Nr(t){return this.changeBit(t,kr)}function Ur(t,e){for(var i=0,s=0,r=Math.min(t.t,this.t);i<r;)s+=this[i]+t[i],e[i++]=s&this.DM,s>>=this.DB;if(t.t<this.t){for(s+=t.s;i<this.t;)s+=this[i],e[i++]=s&this.DM,s>>=this.DB;s+=this.s}else{for(s+=this.s;i<t.t;)s+=t[i],e[i++]=s&this.DM,s>>=this.DB;s+=t.s}e.s=s<0?-1:0,s>0?e[i++]=s:s<-1&&(e[i++]=this.DV+s),e.t=i,e.clamp()}function Gr(t){var e=ys();return this.addTo(t,e),e}function jr(t){var e=ys();return this.subTo(t,e),e}function Vr(t){var e=ys();return this.multiplyTo(t,e),e}function Wr(){var t=ys();return this.squareTo(t),t}function Hr(t){var e=ys();return this.divRemTo(t,e,null),e}function qr(t){var e=ys();return this.divRemTo(t,null,e),e}function Xr(t){var e=ys(),i=ys();return this.divRemTo(t,e,i),new Array(e,i)}function Yr(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Jr(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Kr(){}function Zr(t){return t}function Qr(t,e,i){t.multiplyTo(e,i)}function $r(t,e){t.squareTo(e)}function tn(t){return this.exp(t,new Kr)}function en(t,e,i){var s,r=Math.min(this.t+t.t,e);for(i.s=0,i.t=r;r>0;)i[--r]=0;for(s=i.t-this.t;r<s;++r)i[r+this.t]=this.am(0,t[r],i,r,0,this.t);for(s=Math.min(t.t,e);r<s;++r)this.am(0,t[r],i,r,0,e-r);i.clamp()}function sn(t,e,i){--e;var s=i.t=this.t+t.t-e;for(i.s=0;--s>=0;)i[s]=0;for(s=Math.max(e-this.t,0);s<t.t;++s)i[this.t+s-e]=this.am(e-s,t[s],i,0,0,this.t+s-e);i.clamp(),i.drShiftTo(1,i)}function rn(t){this.r2=ys(),this.q3=ys(),fs.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function nn(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ys();return t.copyTo(e),this.reduce(e),e}function on(t){return t}function an(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function ln(t,e){t.squareTo(e),this.reduce(e)}function hn(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function un(t,e){var i,s,r=t.bitLength(),n=Cs(1);if(r<=0)return n;i=r<18?1:r<48?3:r<144?4:r<768?5:6,s=r<8?new Ws(e):e.isEven()?new rn(e):new Zs(e);var o=new Array,a=3,l=i-1,h=(1<<i)-1;if(o[1]=s.convert(this),i>1){var u=ys();for(s.sqrTo(o[1],u);a<=h;)o[a]=ys(),s.mulTo(u,o[a-2],o[a]),a+=2}var c,d,_=t.t-1,m=!0,g=ys();for(r=As(t[_])-1;_>=0;){for(r>=l?c=t[_]>>r-l&h:(c=(t[_]&(1<<r+1)-1)<<l-r,_>0&&(c|=t[_-1]>>this.DB+r-l)),a=i;0==(1&c);)c>>=1,--a;if((r-=a)<0&&(r+=this.DB,--_),m)o[c].copyTo(n),m=!1;else{for(;a>1;)s.sqrTo(n,g),s.sqrTo(g,n),a-=2;a>0?s.sqrTo(n,g):(d=n,n=g,g=d),s.mulTo(g,o[c],n)}for(;_>=0&&0==(t[_]&1<<r);)s.sqrTo(n,g),d=n,n=g,g=d,--r<0&&(r=this.DB-1,--_)}return s.revert(n)}function cn(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var s=e;e=i,i=s}var r=e.getLowestSetBit(),n=i.getLowestSetBit();if(n<0)return e;for(r<n&&(n=r),n>0&&(e.rShiftTo(n,e),i.rShiftTo(n,i));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=i.getLowestSetBit())>0&&i.rShiftTo(r,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return n>0&&i.lShiftTo(n,i),i}function dn(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var s=this.t-1;s>=0;--s)i=(e*i+this[s])%t;return i}function _n(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return fs.ZERO;for(var i=t.clone(),s=this.clone(),r=Cs(1),n=Cs(0),o=Cs(0),a=Cs(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(r.isEven()&&n.isEven()||(r.addTo(this,r),n.subTo(t,n)),r.rShiftTo(1,r)):n.isEven()||n.subTo(t,n),n.rShiftTo(1,n);for(;s.isEven();)s.rShiftTo(1,s),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);i.compareTo(s)>=0?(i.subTo(s,i),e&&r.subTo(o,r),n.subTo(a,n)):(s.subTo(i,s),e&&o.subTo(r,o),a.subTo(n,a))}return 0!=s.compareTo(fs.ONE)?fs.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}function mn(t){var e,i=this.abs();if(1==i.t&&i[0]<=Xi[Xi.length-1]){for(e=0;e<Xi.length;++e)if(i[0]==Xi[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<Xi.length;){for(var s=Xi[e],r=e+1;r<Xi.length&&s<Yi;)s*=Xi[r++];for(s=i.modInt(s);e<r;)if(s%Xi[e++]==0)return!1}return i.millerRabin(t)}function gn(t){var e=this.subtract(fs.ONE),i=e.getLowestSetBit();if(i<=0)return!1;var s=e.shiftRight(i);(t=t+1>>1)>Xi.length&&(t=Xi.length);for(var r=ys(),n=0;n<t;++n){r.fromInt(Xi[Math.floor(Math.random()*Xi.length)]);var o=r.modPow(s,this);if(0!=o.compareTo(fs.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<i&&0!=o.compareTo(e);)if(0==(o=o.modPowInt(2,this)).compareTo(fs.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0}var pn=b((()=>{for(Gi={},Gi="undefined"!==typeof window?window.navigator:{},0xdeadbeefcafe,!0,"Microsoft Internet Explorer"==Gi.appName?(fs.prototype.am=bs,ji=30):"Netscape"!=Gi.appName?(fs.prototype.am=xs,ji=26):(fs.prototype.am=vs,ji=28),fs.prototype.DB=ji,fs.prototype.DM=(1<<ji)-1,fs.prototype.DV=1<<ji,52,fs.prototype.FV=Math.pow(2,52),fs.prototype.F1=52-ji,fs.prototype.F2=2*ji-52,Vi="0123456789abcdefghijklmnopqrstuvwxyz",Wi=new Array,Hi="0".charCodeAt(0),qi=0;qi<=9;++qi)Wi[Hi++]=qi;for(Hi="a".charCodeAt(0),qi=10;qi<36;++qi)Wi[Hi++]=qi;for(Hi="A".charCodeAt(0),qi=10;qi<36;++qi)Wi[Hi++]=qi;Ws.prototype.convert=Hs,Ws.prototype.revert=qs,Ws.prototype.reduce=Xs,Ws.prototype.mulTo=Ys,Ws.prototype.sqrTo=Js,Zs.prototype.convert=Qs,Zs.prototype.revert=$s,Zs.prototype.reduce=tr,Zs.prototype.mulTo=ir,Zs.prototype.sqrTo=er,fs.prototype.copyTo=ks,fs.prototype.fromInt=Ts,fs.prototype.fromString=Rs,fs.prototype.clamp=Is,fs.prototype.dlShiftTo=Ms,fs.prototype.drShiftTo=Ps,fs.prototype.lShiftTo=Ls,fs.prototype.rShiftTo=zs,fs.prototype.subTo=Ns,fs.prototype.multiplyTo=Us,fs.prototype.squareTo=Gs,fs.prototype.divRemTo=js,fs.prototype.invDigit=Ks,fs.prototype.isEven=sr,fs.prototype.exp=rr,fs.prototype.toString=Fs,fs.prototype.negate=Ss,fs.prototype.abs=Es,fs.prototype.compareTo=Os,fs.prototype.bitLength=Bs,fs.prototype.mod=Vs,fs.prototype.modPowInt=nr,fs.ZERO=Cs(0),fs.ONE=Cs(1),Kr.prototype.convert=Zr,Kr.prototype.revert=Zr,Kr.prototype.mulTo=Qr,Kr.prototype.sqrTo=$r,rn.prototype.convert=nn,rn.prototype.revert=on,rn.prototype.reduce=an,rn.prototype.mulTo=hn,rn.prototype.sqrTo=ln,Yi=(1<<26)/(Xi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997])[Xi.length-1],fs.prototype.chunkSize=ur,fs.prototype.toRadix=dr,fs.prototype.fromRadix=_r,fs.prototype.fromNumber=mr,fs.prototype.bitwiseTo=xr,fs.prototype.changeBit=Pr,fs.prototype.addTo=Ur,fs.prototype.dMultiply=Yr,fs.prototype.dAddOffset=Jr,fs.prototype.multiplyLowerTo=en,fs.prototype.multiplyUpperTo=sn,fs.prototype.modInt=dn,fs.prototype.millerRabin=gn,fs.prototype.clone=or,fs.prototype.intValue=ar,fs.prototype.byteValue=lr,fs.prototype.shortValue=hr,fs.prototype.signum=cr,fs.prototype.toByteArray=gr,fs.prototype.equals=pr,fs.prototype.min=fr,fs.prototype.max=yr,fs.prototype.and=vr,fs.prototype.or=Dr,fs.prototype.xor=Tr,fs.prototype.andNot=Rr,fs.prototype.not=Ir,fs.prototype.shiftLeft=Fr,fs.prototype.shiftRight=Sr,fs.prototype.getLowestSetBit=Or,fs.prototype.bitCount=Br,fs.prototype.testBit=Mr,fs.prototype.setBit=Lr,fs.prototype.clearBit=zr,fs.prototype.flipBit=Nr,fs.prototype.add=Gr,fs.prototype.subtract=jr,fs.prototype.multiply=Vr,fs.prototype.divide=Hr,fs.prototype.remainder=qr,fs.prototype.divideAndRemainder=Xr,fs.prototype.modPow=un,fs.prototype.modInverse=_n,fs.prototype.pow=tn,fs.prototype.gcd=cn,fs.prototype.isProbablePrime=mn,fs.prototype.square=Wr,Ji=fs}));var fn,yn,xn,bn,vn,wn,Dn,kn,Tn,Cn,Rn,In=b((()=>{})),Fn=b((()=>{fn=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,yn=/^(0|[1-9]\d*)\.(0|[1-9]\d*)(\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,xn=class{get major(){return this._major}get minor(){return this._minor}get patch(){return this._patch}constructor(t,e=!1){const i=e?yn:fn,s=i.exec(t);i.lastIndex=0,this._major=s[1],this._minor=s[2],this._patch=s[3]||0}equals(t){return this._major===t._major&&this._minor===t._minor&&this._patch===t._patch}isMoreRecentThan(t){return!(this._major<t.major)&&(this._major>t.major||!(this._minor<t.minor)&&(this._minor>t.minor||!(this._patch<=t.patch)&&(this._patch>t.patch||void 0)))}}}));var Sn,En,On,An,Bn,Mn,Pn,Ln,zn,Nn=b((()=>{Gt(),pn(),In(),Rt(),Fn(),It(),bn=t=>st.byteArrayToString(tt.decode(t)),"TDNSeVlXTnJQMkZ3YVV0bGVUMD0=","ZW50ZXJwcmlzZV9saWNlbnNl",vn="YXBwX2lkZW50aWZpZXJz","cGxhdGZvcm0=",wn="ZmVhdHVyZXM=",Dn="ZXhwaXJlc19hdA==","ZG9tYWlucw==","YXBpX3Rva2Vu",kn="c2lnbmF0dXJl","dmVyc2lvbg==",Tn=class{constructor(t){this._version="2.4",this._l="string"===typeof t?t.trim():t,this._e=this._parseBigInt("65537",10),this._n=this._parseBigInt("681984042382424091378806337544846672160292647422517223678775230983366046720611873368204040735766698395282492937192783016867164773742859209434481353888637963692711665138989982680829529436715362566735813634679619274059040232728883894511099669775400556584329435375723951309340934658571478665059403241851229195311069345899870108307225910988692123234379186643268583453907260879685992156955936561142314233983397819356937109343127504441076920088455337597736475086676246750168976219763398350254797168313954762459542746440628077261880980924552698138857743609502132632199713575442848784271304503226045319991689413234228439044522583790713890093165912455428688507463773064216328753265963237930998706891042679105987175588970202082466871461192706070321938250462103821558100761330890228135620208935801286878657384108721268761878694436895194628411397454202904351577771506916746612289964053490210990342857409030179406810634136188751670648983222653319056818302012063874664196648868156305696644664362171542503665321455971335955948698828939948786720193132672749776162913092000667953299803216404664087988046584107737900256954976744353601826341965438148646041640662195744770544094748295945844184507459808803114917301124088082458306086473490516969815873631",10),this._parseLicense()}v(){return this._sigValid()&&!this.isExp()}_jsonValid(){try{this._decLic=JSON.parse(this._l)}catch(t){return this._decLic={},!1}return!0}_hostnameValid(){if("undefined"===typeof window)return!0;if(!this._decLic[bn(vn)].length)return!0;const{hostname:t}=window.location;let e=!1;return this._decLic[bn(vn)].forEach((i=>{st.wildCardMatch(t,i)&&(e=!0)})),e}_platformValid(){return"HTML5"===this._decLic[bn("cGxhdGZvcm0=")]}c(){return new Promise(((t,e)=>{const i=this._validateError();null!==i&&e(i),t()}))}validate(){return null===this._validateError()}_validateError(){if("string"!==typeof this._l||!this._jsonValid()){const t=new Error;return t.code="ELICINVFMT",t}if(!this._sigValid()){const t=new Error;return t.code="ELICINV",t}if(!this._hostnameValid()){const t=new Error;return t.code="ELICINVHOST",t}if(!this._platformValid()){const t=new Error;return t.code="ELICINVPLAT",t}if(this.isExp()){const t=new Error;return t.code="ELICEXP",t}return null}isToolAllowed(t){return this._includesFeature(t)}isWhiteLabel(){return this._includesFeature("whitelabel",new xn("2.4",!0))}areCustomAssetsAllowed(){return this._includesFeature("customassets",new xn("2.4",!0))}t(){if(this._decLic.enterprise_license)return Promise.resolve();if(this._includesFeature("noexporttracking",new xn("2.4",!0)))return Promise.resolve();const t=this._decLic[bn("ZG9tYWlucw==")][0]+bn(bn("TDNSeVlXTnJQMkZ3YVV0bGVUMD0="))+this._decLic[bn("YXBpX3Rva2Vu")];return new Nt(t).load().catch((()=>{}))}isENT(){return!!this._decLic&&this._decLic[bn("ZW50ZXJwcmlzZV9saWNlbnNl")]}_sigValid(){return this._verify(this._message,this._sig)}exp(){return!!this._decLic[bn(Dn)]}dl(){return Math.ceil((this._expAt()-Date.now())/864e5)}isExp(t=Date.now()){return null!==this._decLic[bn(Dn)]&&t>this._expAt()}_expAt(){return 1e3*this._decLic[bn(Dn)]}_verify(t,e){let i,s;s=this._encodeMessage(t),i=this._decodeSignature(e),i=i.substr(-64);return s===i}_encodeMessage(t){return function(t){function e(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function i(t,e){return t>>>e|t<<32-e}function s(t,e){return t>>>e}function r(t,e,i){return t&e^~t&i}function n(t,e,i){return t&e^t&i^e&i}function o(t){return i(t,2)^i(t,13)^i(t,22)}function a(t){return i(t,6)^i(t,11)^i(t,25)}function l(t){return i(t,7)^i(t,18)^s(t,3)}function h(t){return i(t,17)^i(t,19)^s(t,10)}return function(t){for(var e="0123456789abcdef",i="",s=0;s<4*t.length;s++)i+=e.charAt(t[s>>2]>>8*(3-s%4)+4&15)+e.charAt(t[s>>2]>>8*(3-s%4)&15);return i}(function(t,i){var s,u,c,d,_,m,g,p,f,y,x=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),b=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),v=new Array(64);t[i>>5]|=128<<24-i%32,t[15+(i+64>>9<<4)]=i;for(var w=0;w<t.length;w+=16){s=b[0],u=b[1],c=b[2],d=b[3],_=b[4],m=b[5],g=b[6],p=b[7];for(var D=0;D<64;D++)v[D]=D<16?t[D+w]:e(e(e(h(v[D-2]),v[D-7]),l(v[D-15])),v[D-16]),f=e(e(e(e(p,a(_)),r(_,m,g)),x[D]),v[D]),y=e(o(s),n(s,u,c)),p=g,g=m,m=_,_=e(d,f),d=c,c=u,u=s,s=e(f,y);b[0]=e(s,b[0]),b[1]=e(u,b[1]),b[2]=e(c,b[2]),b[3]=e(d,b[3]),b[4]=e(_,b[4]),b[5]=e(m,b[5]),b[6]=e(g,b[6]),b[7]=e(p,b[7])}return b}(function(t){for(var e=Array(),i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<24-i%32;return e}(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var s=t.charCodeAt(i);s<128?e+=String.fromCharCode(s):s>127&&s<2048?(e+=String.fromCharCode(s>>6|192),e+=String.fromCharCode(63&s|128)):(e+=String.fromCharCode(s>>12|224),e+=String.fromCharCode(s>>6&63|128),e+=String.fromCharCode(63&s|128))}return e}(t)),8*t.length))}(t)}_decodeSignature(t){let e;return t=tt.decode(t),t=t.map((t=>`0${(255&t).toString(16)}`.slice(-2))).join(""),e=(t=this._parseBigInt(t,16)).modPowInt(this._e,this._n),e=e.toString(16),e}_parseBigInt(t,e){return new Ji(t,e)}_parseLicense(){"string"===typeof this._l&&this._jsonValid()&&(this._sig=this._decLic[bn(kn)]||"",delete this._decLic[bn(kn)],this._sig=this._sig.replace(/[^A-Za-z0-9+/=]/g,""),this._message=this._l.replace(new RegExp(`,"${bn(kn)}":"([^"]*)"`),""))}_includesFeature(t,e=new xn("1.0",!0)){const i=new xn(this._decLic[bn("dmVyc2lvbg==")],!0);return!!e.isMoreRecentThan(i)||this._decLic[bn(wn)]&&-1!==this._decLic[bn(wn)].indexOf(t)}},Cn=class{v(){return!0}c(){return Promise.resolve()}isToolAllowed(t){return!0}isWhiteLabel(){return!1}areCustomAssetsAllowed(){return!0}t(){return Promise.resolve()}isENT(){return!1}exp(){return!1}dl(){return 0}isExp(t=Date.now()){return!1}},Rn=Tn})),Un=b((()=>{Sn="undefined"===typeof window?i.g:window,En=Sn.requestAnimationFrame,On=Sn.cancelAnimationFrame,An=0,Bn=["ms","moz","webkit","o"];for(let t=0;t<Bn.length&&!En;++t)En=Sn[`${Bn[t]}RequestAnimationFrame`],On=Sn[`${Bn[t]}CancelAnimationFrame`]||Sn[`${Bn[t]}CancelRequestAnimationFrame`];En&&(En=En.bind(Sn)),On&&(On=On.bind(Sn)),En||(En=function(t,e){const i=(new Date).getTime(),s=Math.max(0,16-(i-An)),r=setTimeout((function(){t(i+s)}),s);return An=i+s,r}),On||(On=function(t){clearTimeout(t)})})),Gn=b((()=>{Ft(),de(),Mn=class{constructor(t=new Qt(0,0),e=new Qt(1,1),i=new Qt(2,-1),s=new Qt(2,0)){this._p0=t.clone(),this._p1=e.clone(),this._p2=i.clone(),this._p3=s.clone(),this._segments=[],this._length=-1,this._sample=[]}set(t=new Qt(0,0),e=new Qt(1,1),i=new Qt(2,1),s=new Qt(2,0)){this._p0=t.clone(),this._p1=e.clone(),this._p2=i.clone(),this._p3=s.clone()}getLength(){return this._length}calculateSegments(t=100){let e=0,i=0;const s=[],r=1/t;let n=this._p0.clone();for(let o=1;o<=t;o++){const t=[];t.push({t:e,s:i,point:n}),e+=r,e=Math.min(e,1);const o=this.evalAt(e);i+=o.clone().subtract(n).len(),t.push({t:e,s:i,point:o}),s.push(t),n=o}return this._segments=s,this._length=i,i}evalAt(t){t=this.normalizeParameter(t);const e=this._p0.clone().multiply((1-t)**3),i=this._p1.clone().multiply(3*(1-t)*(1-t)*t),s=this._p2.clone().multiply(3*(1-t)*t*t),r=this._p3.clone().multiply(t*t*t);return e.add(i).add(s).add(r)}isInSegment(t,e){return(t=this.normalizeArcLength(t))>=e[0].s&&t<=e[1].s}getArcLengthSegment(t){t=this.normalizeArcLength(t);for(let e=0;e<this._segments.length;e++){const i=this._segments[e];if(this.isInSegment(t,i))return i}return null}normalizeArcLength(t){return Math.max(Math.min(this._length,t),0)}normalizeParameter(t){return Math.max(Math.min(1,t),0)}getParameterForArcLength(t){const e=this.normalizeArcLength(t),i=this.getArcLengthSegment(e);if(!i)return ut.warn("CubicBezierCurve#getParameterForArcLength","Segment not found."),-1;const s=(e-i[1].s)/(i[0].s-i[1].s);return s*i[0].t+(1-s)*i[1].t}evalAtArcLength(t){return this.evalAt(this.getParameterForArcLength(t))}approximateAtArcLength(t){const e=this.normalizeArcLength(t),i=this.getArcLengthSegment(e);if(!i)return-1;const s=(e-i[1].s)/(i[0].s-i[1].s);return i[0].point.clone().multiply(s).add(i[1].point.clone().multiply(1-s))}parameterSample(t=100){const e=1/t,i=[];let s=0;for(let r=0;r<=t+1;r++)i.push(this.evalAt(s)),s+=e;return this._sample=i,[...i]}arcLengthApproxSample(t=100,e=!1,i=!1){const s=this._length/t,r=[];let n=0;for(let o=e?1:0;o<t+1;o++)r.push(this.approximateAtArcLength(n)),n+=s;return i&&r.pop(),this._sample=r,[...r]}}})),jn=b((()=>{Pn=class{constructor(t,e){this.min=t,this.max=e}getMin(){return this.min}getMax(){return this.max}getLength(){return this.max-this.min}contains(t){return this.min<=t&&t<=this.max}}})),Vn=b((()=>{zn=Ln=class{constructor(t,e,i){this.x=t,this.y=e,this.z=i,"undefined"===typeof this.x&&(this.x=0),"undefined"===typeof this.y&&(this.y=0),"undefined"===typeof this.z&&(this.z=0)}set(t,e,i){return this.x=t,this.y=e,this.z=i,this}clone(){return new Ln(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}clamp(t,e){const i=null!==t&&"undefined"!==typeof t,s=null!==e&&"undefined"!==typeof e;return t instanceof Ln||!i||(t=new Ln(t,t,t)),e instanceof Ln||!s||(e=new Ln(e,e,e)),i&&(this.x=Math.max(t.x,this.x),this.y=Math.max(t.y,this.y),this.z=Math.max(t.z,this.z)),s&&(this.x=Math.min(e.x,this.x),this.y=Math.min(e.y,this.y),this.z=Math.min(e.z,this.z)),this}divide(t){return t instanceof Ln?(this.x/=t.x,this.y/=t.y,this.z/=t.z):(this.x/=t,this.y/=t,this.z/=t),this}subtract(t){return t instanceof Ln?(this.x-=t.x,this.y-=t.y,this.z-=t.z):(this.x-=t,this.y-=t,this.z-=t),this}multiply(t){return t instanceof Ln?(this.x*=t.x,this.y*=t.y,this.z*=t.z):(this.x*=t,this.y*=t,this.z*=t),this}add(t){return t instanceof Ln?(this.x+=t.x,this.y+=t.y,this.z+=t.z):(this.x+=t,this.y+=t,this.z+=t),this}equals(t){return t instanceof Ln?t.x===this.x&&t.y===this.y&&t.z===this.z:t===this.x&&t===this.y&&t===this.z}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}fract(){return this.x%=1,this.y%=1,this.z%=1,this}toInt(){return this.x|=0,this.y|=0,this.z|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}min(){return Math.min(Math.min(this.x,this.y),this.z)}max(){return Math.max(Math.max(this.x,this.y),this.z)}toObject(){return{x:this.x,y:this.y,z:this.z}}toString(){return`Vector3({ x: ${this.x}, y: ${this.y}, z: ${this.z} })`}roundDecimal(t){return this.x=parseFloat(this.x.toFixed(t)),this.y=parseFloat(this.y.toFixed(t)),this.z=parseFloat(this.z.toFixed(t)),this}static fromObject(t){return new Ln(t.x,t.y,t.z)}static get NULL(){return new Ln(0,0,0)}}})),Wn={};w(Wn,{ColorMatrix:()=>be,CubicBezierCurve:()=>Mn,Matrix:()=>$t,Range:()=>Pn,Rectangle:()=>te,Vector2:()=>Qt,Vector3:()=>zn});var Hn=b((()=>{Je(),Gn(),_e(),jn(),me(),de(),Vn()})),qn={};w(qn,{Base64:()=>tt,Color:()=>Wt,ColorMatrix:()=>be,Configurable:()=>we,Constants:()=>B,CubicBezierCurve:()=>Mn,Engine:()=>Jn,EventEmitter:()=>qt,Events:()=>Ni,FreeLicenseChecker:()=>Cn,GLUtils:()=>Xt,LicenseChecker:()=>Rn,Log:()=>ut,Matrix:()=>$t,Range:()=>Pn,Rectangle:()=>te,Utils:()=>st,Vector2:()=>Qt,Vector3:()=>zn,cancelAnimationFrame:()=>On,requestAnimationFrame:()=>En});var Xn,Yn,Jn,Kn,Zn,Qn,$n,to,eo,io,so,ro,no,oo,ao,lo,ho,uo,co,_o,mo,go,po,fo,yo,xo,bo,vo,wo=b((()=>{Ft(),ps(),j(),To(),Rt(),le(),Ke(),he(),ue(),Nn(),It(),Un(),Hn()})),Do=b((()=>{fe(),ko(),gs(),wo(),Xn=class{constructor(){this._container=new re,this._sprite=new Yn,this._container.addChild(this._sprite)}render(t,e,i){const s=i.getDimensions(),r=this._getNextHighestPOT(s);this._renderTexture?this._renderTexture.resizeTo(r):this._renderTexture=new zi(t,r.x,r.y);const n=this._renderTexture.getDimensions();this._sprite.setTexture(i),this._sprite.updateTransform(),this._renderTexture.clear(),this._renderTexture.render(this._container),this._updateSprite(t,e,s,n)}_updateSprite(t,e,i,s){e.setTexture(this._renderTexture),this._renderTexture.setFrame(new te(0,0,i.x,i.y))}_getNextHighestPOT(t){return new Qt(st.nextHighestPOT(t.x),st.nextHighestPOT(t.y))}getRenderTexture(){return this._renderTexture}dispose(){this._renderTexture&&(this._renderTexture.dispose(),delete this._renderTexture)}}})),ko=b((()=>{Do(),fe(),ge(),Yn=class extends re{constructor(t){super(),this._shader=null,this._width=0,this._height=0,this._anchor=new Qt(0,0),this._canvasSmoothingEnabled=!0,this._smoothDownscaling=!1,this._onTextureUpdate=this._onTextureUpdate.bind(this),this.setTexture(t)}_onTextureUpdate(){this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}_renderWebGL(t){const e=t.save();this._smoothDownscaling&&(this._potRenderer||(this._potRenderer=new Xn),this._texture&&this._potRenderer.render(t,this,this._texture)),t.restore(e),t.setObjectRenderer(t.renderers.sprite),t.renderers.sprite.render(this)}_renderCanvas(t){if(!this._texture)return;const e=this._worldTransform,i=this._texture.getFrame(),{width:s,height:r}=i,n=t.getCurrentRenderTarget().getPixelRatio(),o=this._anchor.x*-s|0,a=this._anchor.y*-r|0,l=t.getContext();if(l.setTransform(e.a,e.b,e.c,e.d,e.tx*n,e.ty*n),l.globalAlpha=this.getWorldAlpha(),!this._texture)return;const h=this._texture.getBaseTexture(),u=h.getPixelRatio(),c=h.getSource();l.imageSmoothingEnabled=this._canvasSmoothingEnabled,"beforeDraw"in t&&t.beforeDraw(l),l.drawImage(c,0,0,(c.naturalWidth||s)*u,(c.naturalHeight||r)*u,o*n,a*n,s*n,r*n)}isAtPosition(t){if(!this._texture)return;const e=this._worldTransform.applyInverseToVector(t),i=this._texture.getFrame(),{width:s,height:r}=i,n=new Qt(-s,-r);n.multiply(this._anchor);const o=n.clone().add(s,r);return!(e.x<n.x||e.x>o.x||e.y<n.y||e.y>o.y)}getLocalBounds(){if(this._localBoundsNeedUpdate&&this._texture){const t=this._localBounds,e=this._texture.getFrame();t.x=-e.width*this._anchor.x,t.y=-e.height*this._anchor.y,t.width=e.width,t.height=e.height,this._localBoundsNeedUpdate=!1}return this._localBounds.clone()}getBounds(){if(this._boundsNeedUpdate&&this._texture){const t=this._bounds,e=this._texture.getFrame(),i=this._worldTransform,s=this._anchor,r=i.rectangleToCoordinates(e,s);let n=r[0].x,o=r[0].y,a=n,l=o;r.forEach((({x:t,y:e})=>{n=Math.min(n,t),o=Math.min(o,e),a=Math.max(a,t),l=Math.max(l,e)})),t.x=n,t.width=Math.abs(a-n),t.y=o,t.height=Math.abs(l-o),this._boundsNeedUpdate=!1}return this._bounds.clone()}getTexture(){return this._texture}clearTexture(t=!0){this._texture&&(this._texture.off("update",this._onTextureUpdate),t&&this._texture.dispose(),this._texture=null,this._potRenderer&&(t&&this._potRenderer.dispose(),delete this._potRenderer))}setTexture(t){t&&(this._texture&&this._texture.off("update",this._onTextureUpdate),this._potRenderer&&this._potRenderer.getRenderTexture().getBaseTexture().setDirty(!0),this._texture=t,t.getBaseTexture().isLoaded()&&this._onTextureUpdate(),t.on("update",this._onTextureUpdate))}getShader(){return this._shader}setShader(t){this._shader=t}getWidth(){return this._width}setWidth(t){this._texture&&(this._scale.x=t/this._texture.getFrame().width,this._width=t,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0)}getHeight(){return this._height}setHeight(t){this._texture&&(this._scale.y=t/this._texture.getFrame().height,this._height=t,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0)}getDimensions(){return new Qt(this._width,this._height)}getAnchor(){return this._anchor}setAnchor(t,e){this._anchor.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}isSmoothDownscaling(){return this._smoothDownscaling}setSmoothDownscaling(t){this._smoothDownscaling=t}dispose(t=!1,e=!1){this._texture&&this._texture.off("update",this._onTextureUpdate),(t||e)&&this._texture&&this._texture.dispose(e),this._potRenderer&&this._potRenderer.dispose()}}})),To=b((()=>{fe(),Ki(),ii(),$i(),ss(),ds(),ko(),Zi(),gs(),ms(),Qi(),W(),Tt(),os(),Jn={CanvasFilterManager:yi,Container:re,BaseTexture:pi,Texture:Pi,RenderTexture:zi,WebGLRenderTarget:Ri,CanvasRenderTarget:fi,Sprite:Yn,Filter:Fe,Filters:ci,PixelArrayImage:L,autoDetectRenderer:(t,e,i={})=>X.isSupported()?new Bi(t,e,i):new ki(t,e,i),canvasRenderer:(t,e,i={})=>new ki(t,e,i)}})),Co=b((()=>{Kn=class{static current(){return d.env.ENV}static isTest(){return"test"===d.env.ENV}static isDevelopment(){return"development"===d.env.ENV}static isProduction(){return"production"===d.env.ENV||!this.isTest()&&!this.isDevelopment()}}})),Ro=b((()=>{Zn=class{constructor(t){this._head=0,this._buf=t}peekInt8(){return this._buf[this._head]}peekInt16(t=!1){const e=this._buf[this._head],i=this._buf[this._head+1];return t?(i<<8)+e:(e<<8)+i}peekInt24(t=!1){const e=this._buf[this._head],i=this._buf[this._head+1],s=this._buf[this._head+2];return t?(s<<16)+(i<<8)+e:(e<<16)+(i<<8)+s}peekInt32(t=!1){const e=this._buf[this._head],i=this._buf[this._head+1],s=this._buf[this._head+2],r=this._buf[this._head+3];return t?(r<<32)+(s<<16)+(i<<8)+e:(e<<32)+(i<<16)+(s<<8)+r}writeInt8(t){this._buf[this._head]=255&t}writeInt16(t){this._buf[this._head]=t>>8,this._buf[this._head+1]=255&t}readInt8(){const t=this.peekInt8();return this._head+=1,t}readInt16(t=!1){const e=this.peekInt16(t);return this._head+=2,e}readInt24(t=!1){const e=this.peekInt24(t);return this._head+=3,e}readInt32(t=!1){const e=this.peekInt32(t);return this._head+=4,e}readString(t){let e="";for(let i=0;i<t;i++){const t=this.readInt8();e+=String.fromCharCode(t)}return e}getHead(){return this._head}setHead(t){this._head=t}}})),Io=b((()=>{Qn={MARKERS:{SOI:65496,SOS:65498,APP0:65504,APP1:65505,JFIF:65504,EXIF:65505},EXIF_TAGS:{256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"}}})),Fo=b((()=>{Ro(),It(),Io(),({invariant:$n}=st),({MARKERS:to,EXIF_TAGS:eo}=Qn),io=class{constructor(t){this._buf=t,this._stream=new Zn(this._buf),this._stream.setHead(0),this._parse(),this._bigEndian=!1}isValid(){this._stream.setHead(0);if(this._stream.readInt16()!==to.EXIF)return!1;if(!(this._stream.readInt16()>0))return!1;return"Exif"===this._stream.readString(4)}_parse(){if(!this.isValid())return;this._stream.setHead(10);const t=this._stream.getHead();this._bigEndian=!1;const e=this._stream.readInt16();18761===e?this._bigEndian=!1:19789===e?this._bigEndian=!0:$n(!1,"Invalid TIFF data: No endian type found"),$n(42===this._stream.readInt16(!this._bigEndian),"Invalid TIFF data: No 0x002A");const i=this._stream.readInt32(!this._bigEndian);$n(i>=8,"Invalid TIFF data: First IFD offset < 8");const s=t+i,r=this._readTags(this._stream,t,s,this._bigEndian);this._tags=r.tags,this._tagData=r.tagData}getTags(){return this._tags}getTagData(){return this._tagData}setOrientation(t){if(this._tagData.Orientation){const{entryOffset:e}=this._tagData.Orientation;this._stream.setHead(e+8),this._stream.writeInt16(this._bigEndian?t:(255&t)<<8|t>>8&255)}}_readTags(t,e,i,s){t.setHead(i);const r=t.readInt16(!s),n={},o=[];for(let a=0;a<r;a++){const r=i+12*a+2;t.setHead(r);let l,h,u,c=t.readInt16(!s);if(eo[c]){c=eo[c],l=t.readInt16(!s),h=t.readInt32(!s),u=t.readInt32(!s)+e;let i=null;switch(l){case 1:case 7:if(1===h)i=t.readInt8(!s);else{i=[];for(let e=0;e<h;e++)i.push(t.readInt8(!s))}break;case 2:t.setHead(h>4?u:r+8),i=t.readString(h);break;case 3:if(t.setHead(h>2?u:r+8),1===h)i=t.readInt16(!s);else{i=[];for(let e=0;e<h;e++)i.push(t.readInt16(!s))}break;case 4:case 9:if(t.setHead(h>1?u:r+8),1===h)i=t.readInt32(!s);else{i=[];for(let e=0;e<h;e++)i.push(t.readInt32(!s))}break;case 5:case 10:if(t.setHead(u),1===h){i=t.readInt32(!s)/t.readInt32(!s)}else{i=[];for(let e=0;e<h;e++){const e=t.readInt32(!s)/t.readInt32(!s);i.push(e)}}}n[c]=i,o[c]={value:i,numValues:h,entryOffset:r,valueOffset:u,type:l}}}return{tags:n,tagData:o}}getBuffer(){return this._buf}}})),So=b((()=>{Ro(),Io(),({MARKERS:so}=Qn),ro=class{constructor(t){this._buf=t,this._stream=new Zn(this._buf),this._stream.setHead(0)}isValid(){this._stream.setHead(0);if(this._stream.readInt16()!==so.APP0)return!1;if(!(this._stream.readInt16()>=16))return!1;const t=this._stream.readString(4),e=this._stream.readInt8();return"JFIF"===t&&0===e}setUnitDensity(t){this._stream.setHead(11),this._stream.writeInt8(t)}setDensityX(t){this._stream.setHead(12),this._stream.writeInt16(t)}setDensityY(t){this._stream.setHead(14),this._stream.writeInt16(t)}getUnitDensity(){return this._stream.setHead(11),this._stream.readInt8()}getDensityX(){return this._stream.setHead(12),this._stream.readInt16()}getDensityY(){return this._stream.setHead(14),this._stream.readInt16()}getBuffer(){return this._buf}}})),Eo=b((()=>{Ro(),Rt(),Io(),Fo(),So(),It(),({MARKERS:no}=Qn),oo="data:image/jpeg;base64,",ao=new RegExp(`^${oo}`,"i"),ho=lo=class{constructor(t){this._buf=t,this._stream=new Zn(this._buf),this._stream.setHead(0),this._segments=this._sliceIntoSegments(this._buf),this._exifData=new io(this._getMarkerBuffer(no.EXIF)),this._jfifData=new ro(this._getMarkerBuffer(no.JFIF))}static toDataURL(t){return oo+tt.encode(t)}static fromDataURL(t){const e=t.replace(oo,"");return tt.decode(e)}restoreSegmentsInArray(t){return t=this.restoreExifTagsToImageData(t),this.restoreJfifSegmentToImageData(t)}restoreSegments(t){let e=lo.fromDataURL(t);return e=this.restoreSegmentsInArray(e),lo.toDataURL(e)}restoreExifTagsToImageData(t){if(!this._exifData.isValid())return t;const e=this._sliceIntoSegments(t)[1][0],i=t.slice(0,e),s=t.slice(e);let r=i.concat(this._exifData.getBuffer());return r=r.concat(s),r}restoreJfifSegmentToImageData(t){if(!this._jfifData.isValid())return t;const e=this._sliceIntoSegments(t),i=this._findSegment(no.JFIF,e);let s=[];if(!i)return t;{const e=i[0],r=i[1],n=t.slice(0,e),o=t.slice(e,r),a=t.slice(r),l=new ro(o);l.setDensityX(this._jfifData.getDensityX()),l.setDensityY(this._jfifData.getDensityY()),l.setUnitDensity(this._jfifData.getUnitDensity()),s=n.concat(o).concat(a)}return s}restoreExifTags(t){const e=lo.fromDataURL(t),i=this.restoreExifTagsToImageData(e);return lo.toDataURL(i)}restoreJfifSegment(t){if(!this._jfifData.isValid())return t;const e=lo.fromDataURL(t),i=this.restoreJfifSegmentToImageData(e);return lo.toDataURL(i)}setOrientation(t){return this._exifData.setOrientation(t)}static isJPEG(t){return ao.test(t)}static bufferIsJPEG(t){return 255===t[0]&&216===t[1]&&255===t[2]}static fromBase64String(t){const e=t.replace(oo,""),i=tt.decode(e);return new lo(i)}_findSegment(t,e=this._segments){for(let i=0;i<e.length;i++){const s=e[i][0],r=e[i][1];this._stream.setHead(s);if(this._stream.peekInt16()===t)return[s,r]}return!1}_getLastSegment(t=this._segments){return t[t.length-1]}_getMarkerBuffer(t,e=this._segments){const i=this._findSegment(t,e);if(i){const t=i[0],e=i[1];return this._buf.slice(t,e)}return!1}_sliceIntoSegments(t){const e=new Zn(t),i=[];for(;e.getHead()<t.length;){const t=e.readInt16();if(t!==no.SOI){if(t===no.SOS)break;if(!(t>=65280&&t<=65535))throw new Error(`Invalid marker: 0x${t.toString(16)}`);{const t=e.readInt16(),s=e.getHead()+t-2;i.push([e.getHead()-4,s]),e.setHead(s)}}}return this._stream.setHead(0),i}getTags(){return this._exifData.getTags()}getTagData(){return this._exifData.getTagData()}dispose(){this._buf=[],this._segments=[]}}})),Oo=b((()=>{uo="undefined"!==typeof window&&window.Image,co=uo})),Ao=b((()=>{wo(),he(),mo=_o=class extends qt{constructor(t=[]){super(),this._onOperationUpdate=this._onOperationUpdate.bind(this),this._cacheEnabled=!0,this._stack=t,this._stack.forEach((t=>{t.on("update",this._onOperationUpdate)}))}clear(){this.forEach((t=>this.remove(t))),this._stack=[]}hasChanges(){return this._stack.filter((t=>!!t)).some((t=>t.hasChanges()))}_onOperationUpdate(t,e){this.emit(Ni.OPERATION_UPDATED,t,e)}enableCache(){this._cacheEnabled=!0}disableCache(){this._cacheEnabled=!1}forEach(t){return this._stack.filter((t=>!!t)).forEach(t)}render(t,e){const i=e,s=this._stack.filter((t=>!!t)).filter((t=>t.getEnabled()));s.reverse();const r=s.filter((e=>!e.isDirtyForRenderer(t.getRenderer())))[0],n=s.indexOf(r);s.reverse();let o=0;-1!==n&&(o=s.length-n-1);for(let l=0;l<o;l++)ut.info(this.constructor.name,`Skipping ${s[l].constructor.name}`);let a=Promise.resolve(i);for(let l=o;l<s.length;l++){const t=s[l];let e,i;a=a.then((s=>t.render(s).then((s=>(e&&s!==e&&!this._cacheEnabled&&i.disposeRenderTextures(),e=s,i=t,s)))))}return a.then((e=>({outputTexture:e,renderDone:!s.some((e=>e.isDirtyForRenderer(t.getRenderer())))})))}validateSettings(){return Promise.all(this._stack.filter((t=>!!t)).map((t=>t.validateSettings())))}setAllToDirty(t=!1){this.forEach((e=>e.setDirty(!0,t)))}updateDirtinessForRenderer(t){let e=!1;for(let i=0;i<this._stack.length;i++){const s=this._stack[i];s&&(s.isDirtyForRenderer(t)&&(e=!0),e&&s.setDirtyForRenderer(!0,t))}}push(t){this._stack.push(t),t.on("update",this._onOperationUpdate)}pop(){const t=this._stack.pop();t&&(t.off("update",this._onOperationUpdate),t.dispose())}unshift(t){this._stack.unshift(t),t.on("update",this._onOperationUpdate)}clone(){return new _o(this._stack.slice(0))}get(t){return this._stack[t]}getByIdentifier(t){return st.Array.find(this._stack,(e=>e&&e.constructor.identifier===t))}getIndexByIdentifier(t){return st.Array.findIndex(this._stack,(e=>e&&e.constructor.identifier===t))}moveToTop(t){const e=st.Array.findIndex(this._stack,(e=>e&&e.constructor.identifier===t));if(e<0||e===this._stack.length-1)return;const i=this.getByIdentifier(t);this._stack.splice(e,1),this._stack[this._stack.length]=i}set(t,e){this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),this._stack[t]=e,e.on("update",this._onOperationUpdate)}remove(t){const e=this._stack.indexOf(t);-1!==e&&(this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),this._stack.splice(e,1))}removeAt(t){this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),delete this._stack[t]}getStack(){return this._stack}dispose(){this.forEach((t=>{t.dispose()}))}}})),Bo=b((()=>{wo(),go="undefined"!==typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):ts(),po=class{constructor(t,e){this._tag=t,this._name=e,this._start=go()}stop(){const t=go()-this._start,e=Math.round(1e3/t);ut.info(this._tag,`${this._name} took ${t.toFixed(2)}ms (${e} FPS)`)}}})),Mo=b((()=>{Ft(),j(),To(),Ke(),Bo(),(fo=class extends we{constructor(t,e={}){super(e,{enabled:{type:l.BOOLEAN,default:!0,serializable:!1}}),this._sdk=t,this._cacheEnabled=!1,this._dirtiness={},this._sprite=new Jn.Sprite,this._container=new Jn.Container,this._container.addChild(this._sprite)}_onOptionsChange(){this.setDirty(!0)}render(t){if(!this.getEnabled())return ut.info(this.constructor.name,"Disabled - skipping"),Promise.resolve(t);if(!this._renderTexture){const e=t.getDimensions().floor();this._renderTexture=new Jn.RenderTexture(this._sdk.getRenderer(),e.x,e.y)}const e=this._sdk.getRenderer();let i,s;if(ut.canLog("info")&&(s=new po(this.constructor.name,"Rendering")),this.isDirtyForRenderer(e)){this._sprite.setTexture(t);const s=this.getNewDimensions(t.getDimensions()).floor();this._renderTexture.resizeTo(s),this._renderTexture.clear(),i=this._render(t).then(((t=!1)=>(this.setDirtyForRenderer(t,e),this._renderTexture)))}else ut.info(this.constructor.name,"Rendering from cache"),i=Promise.resolve(this._renderTexture);return i.then((t=>(s&&s.stop(),t)))}_render(t){let e;return e=this._sdk.getRenderer().isOfType(u.WEBGL)?this._renderWebGL.bind(this):this._renderCanvas.bind(this),e(t)}_renderWebGL(t){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}_renderCanvas(t){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}getNewDimensions(t){return t.clone()}onBeforeExport(){this.transform&&this._tempTransformChange&&this.transform(this._tempTransformChange),this._onBeforeExport()}onAfterExport(){this.transform&&this._tempInverseTransformChange&&this.transform(this._tempInverseTransformChange),this._onAfterExport()}_onBeforeExport(){}_onAfterExport(){}setTemporaryTransformChange(t,e){this._tempTransformChange=t,this._tempInverseTransformChange=e}reset(){this._dirty=!0,this._glslPrograms={}}isDirtyForRenderer(t){const e=this._dirtiness[t.id];return"undefined"===typeof e||e}setDirtyForRenderer(t,e,i=!1){this._dirtiness[e.id]=t}setDirty(t,e=!1){for(const i in this._dirtiness)this.setDirtyForRenderer(t,{id:i},e)}getSDK(){return this._sdk}getInputDimensions(t=!0){let e,i=this._sdk.getInputDimensions();return t&&i.multiply(this._sdk.getZoom()).floor(),this._sdk.getOperationsStack().forEach((t=>{e||(t!==this?i=t.getNewDimensions(i):e=!0)})),i.floor()}clone(){return new(0,this.constructor)(this._sdk,this.serializeOptions())}disposeRenderTextures(){this._renderTexture&&this._renderTexture.dispose(),this._renderTexture=null}dispose(){this.disposeRenderTextures(),this._sprite.dispose()}}).identifier=null,yo=fo})),Po=b((()=>{wo(),de(),Mo(),({OptionType:xo}=B),(bo=class extends yo{getRotation(){let t=0;switch(this.getTags().Orientation){case 7:case 8:t=-90;break;case 3:case 4:t=-180;break;case 5:case 6:t=90}return t}_getFlipVertically(){const{Orientation:t}=this.getTags();return-1!==[5,7].indexOf(t)}_getFlipHorizontally(){const{Orientation:t}=this.getTags();return-1!==[2,4].indexOf(t)}_getFinalOptions(){return{rotation:this.getRotation(),flipVertically:this._getFlipVertically(),flipHorizontally:this._getFlipHorizontally()}}_render(t){const e=this._getFinalOptions(),i=e.rotation%360*(Math.PI/180);this._sprite.setScale(e.flipHorizontally?-1:1,e.flipVertically?-1:1),this._sprite.setRotation(i),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();const s=this._sprite.getBounds();return this._renderTexture.resizeTo(new Qt(s.width,s.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2)),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(t){const e=this._getFinalOptions();return t=t.clone(),e.rotation%180&&t.flip(),t}applyTo(t){const e=this._getFinalOptions(),i=st.createCanvas();90===Math.abs(e.rotation%180)?(i.width=t.height,i.height=t.width):(i.width=t.width,i.height=t.height);const s=i.getContext("2d"),r=e.rotation*Math.PI/180,n=.5*(i.width-t.width),o=.5*(i.height-t.height);return s.translate(n,o),s.translate(.5*t.width,.5*t.height),s.rotate(r),s.translate(-.5*t.width,-.5*t.height),e.flipVertically&&(s.translate(0,t.height),s.scale(1,-1)),e.flipHorizontally&&(s.translate(t.width,0),s.scale(-1,1)),s.drawImage(t,0,0),i}}).identifier="exif-orientation",bo.prototype.availableOptions={tags:{type:xo.OBJECT,default:{}}},vo=bo})),Lo={};w(Lo,{ExifOrientationOperation:()=>vo});var zo,No,Uo,Go,jo,Vo,Wo,Ho,qo,Xo,Yo,Jo,Ko,Zo,Qo,$o,ta,ea,ia,sa,ra,na,oa,aa,la,ha=b((()=>{Po()})),ua=b((()=>{C(),j(),To(),le(),Ke(),Oo(),It(),(zo=class extends we{constructor(t,e={}){super(e),this._sdk=t}export(){const{imageFormat:t,transparent:e}=this._options,i=t=>t.renderDone?t:this._sdk.render().then((t=>i(t)));return this.validateSettings().then((()=>this._prepareSDK().then((t=>i(t))))).then((i=>{const{outputTexture:s,renderDone:r}=i,n=this._sdk.getRenderer(),o=n.getClearColor();"image/png"===t&&e&&n.setClearColor(new Wt(0,0,0,0));let a=n.getCanvas();return n.isOfType(u.WEBGL)&&(a=this._createCanvasFromTexture(s)),n.setClearColor(o),this._encodeImageFormat(a)})).then((e=>this._restoreExifMetadata(e,t))).then((t=>this._restoreSDK().then((()=>t))))}_restoreExifMetadata(t,e,i){if(e===a.JPEG){const e=this._sdk.getExif();e&&"string"===typeof t&&(t=e.restoreSegments(t))}return Promise.resolve(t)}_encodeAsDataURL(t,e,i){if(st.isBrowser){const r=t.toDataURL(e,i);return s(t),Promise.resolve(r)}try{const r=t.toDataURL(e,i);return s(t),Promise.resolve(r)}catch(wD){return Promise.error(wD)}}_encodeAsHTMLImage(t,e,i){return this._encodeAsDataURL(t,e,i).then((e=>{const i=new co;return i.src=e,s(t),Promise.resolve(i)}))}_encodeAsBuffer(t,e,i){return Promise.reject(new Error("Unsupported platform for RenderType"))}_encodeAsMSBlob(t,e,i){const r=t.msToBlob();return s(t),Promise.resolve(r)}_encodeAsBLOB(t,e,i){return new Promise(((s,r)=>{t.toBlob((t=>{s(t)}),e,i)}))}_encodeImageFormat(t){const{imageFormat:e,quality:i}=this._options;let{renderType:s}=this._options;switch(s===o.BLOB&&t.msToBlob&&!t.toBlob&&(s=o.MSBLOB),s){case o.IMAGE:return this._encodeAsHTMLImage(t,e,i);case o.DATAURL:return this._encodeAsDataURL(t,e,i);case o.BUFFER:return this._encodeAsBuffer(t,e,i);case o.MSBLOB:return this._encodeAsMSBlob(t,e,i);case o.BLOB:return this._encodeAsBLOB(t,e,i)}return Promise.reject(new Error(`Unsupported RenderType: ${s}!`))}_prepareSDK(){const t=this._sdk.getRenderer();this._sdkSettings={dimensions:t.getDimensions().clone(),textureQuality:this._sdk.getTextureQuality(),rendererPixelRatio:t.getPixelRatio(),renderMode:this._sdk.getRenderMode()},this._sdk.setRenderMode("export"),this._sdk.setTextureQuality(1);const e=t.isOfType(u.CANVAS);t.setPixelRatio(1),t.resizeTo(this._sdk.getFinalDimensions(),e),this._sdk.setAllOperationsToDirty(!0);const i=this._sdk.getOperationsStack();return i.forEach((t=>{t.disposeRenderTextures()})),i.disableCache(),this._sdk.render()}_restoreSDK(){this._sdk.getOperationsStack().enableCache(),this._sdk.setRenderMode(this._sdkSettings.renderMode);const t=this._sdk.getRenderer(),e=t.isOfType(u.CANVAS);return t.setPixelRatio(this._sdkSettings.rendererPixelRatio),t.resizeTo(this._sdkSettings.dimensions,e),this._sdk.setTextureQuality(this._sdkSettings.textureQuality),this._sdk.setAllOperationsToDirty(!0),this._sdk.render()}_createCanvasFromTexture(t){const e=this._sdk.getRenderer(),i=this._sdk.getFinalDimensions(),s=this._sdk.getRenderer().getContext(),r=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,r);const n=t.getBaseTexture().getGLTextureForRenderer(e);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0);const o=new Uint8Array(i.x*i.y*4);s.readPixels(0,0,i.x,i.y,s.RGBA,s.UNSIGNED_BYTE,o);let a;if(this._checkPixelsForTransparency(o)){const r=new Jn.Sprite(t);r.setFilters([new Jn.Filters.UnpremultiplyFilter]);const n=new Jn.Container;n.addChild(r),a=new Jn.RenderTexture(e,i.x,i.y),a.render(n);const l=a.getBaseTexture().getGLTextureForRenderer(e);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,l,0),s.readPixels(0,0,i.x,i.y,s.RGBA,s.UNSIGNED_BYTE,o),e.setRenderTarget(),a.dispose()}const l=st.createCanvas();l.width=i.x,l.height=i.y;const h=l.getContext("2d"),u=h.createImageData(i.x,i.y);return u.data.set(o),h.putImageData(u,0,0),s.deleteFramebuffer(r),l}_checkPixelsForTransparency(t){const e=this._sdk.getFinalDimensions(),i=e.x*e.y*4;let s;for(let r=3;r<i;r+=4)if(s=t[r],255!==s)return!0;return!1}}).prototype.availableOptions={renderType:{type:l.STRING,available:st.values(o),default:o.IMAGE},imageFormat:{type:l.STRING,available:st.values(a),default:a.PNG},quality:{type:l.NUMBER,default:.8},transparent:{type:l.BOOLEAN,default:!0}},No=zo})),ca=b((()=>{wo(),Eo(),Oo(),ua(),Ao(),Bo(),ha(),({Rectangle:Uo,Constants:Go,Engine:jo,Utils:Vo,EventEmitter:Wo,Events:Ho,Vector2:qo,Log:Xo,Base64:Yo,Color:Jo}=qn),Ko=t=>Vo.byteArrayToString(Yo.decode(t)),({RenderType:Zo,ImageFormat:Qo,RendererType:$o}=Go),ta=class extends Wo{constructor(t,e={}){if(super(),T(this,"_onContextLost",(()=>{this.emit("context-lost")})),T(this,"_initWatermark",(()=>{this._options.watermark&&this._options.watermark.watermarkURI&&(this._watermarkOperation=this.createOperation("watermark",{watermarkURI:this._options.watermark.watermarkURI,alignment:this._options.watermark.alignment,inset:this._options.watermark.inset,size:this._options.watermark.size,crossOrigin:this._options.crossOrigin}))})),this._onOperationUpdate=this._onOperationUpdate.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.version="3.9.0",this[Ko("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!0,this._preferredRenderer=t,this._options={...e,extensions:{},renderMode:"dynamic",versionCheck:!0,displayWelcomeMessage:!0,image:null,canvas:null,transparent:!1,textureQuality:1,zoom:1,spriteScale:1,rotation:0,smoothDownscaling:!1,smoothUpscaling:!1,crossOrigin:"anonymous",logLevel:"warn",pixelRatio:Math.max("undefined"!==typeof window&&window.devicePixelRatio||1,1)},this._options.smoothUpscaling&&(jo.BaseTexture.DefaultMagFilter=jo.BaseTexture.LinearFilter),this._options.extensions=Object.assign(this._options.extensions,{operations:[],controls:[],languages:[]}),Xo.setLevel(this._options.logLevel),this[Ko("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!1,this[Ko("X29wdGlvbnM=")][Ko("bGljZW5zZQ==")]){const t=qn[Ko("TGljZW5zZUNoZWNrZXI=")];this._l=new t(this[Ko("X29wdGlvbnM=")][Ko("bGljZW5zZQ==")]),this._cv(!0).then((()=>{this._ct()})).catch((t=>{Xo.error(Ko("TGljZW5zaW5n"),t.message)}))}else this[Ko("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!0,this._l=new(qn[Ko("RnJlZUxpY2Vuc2VDaGVja2Vy")]);this._defaultRenderMode=this._options.renderMode,this._renderMode=this._options.renderMode,this._textureQuality=this._options.textureQuality,this._offset=new qo,this._zoom=this._options.zoom,this._spriteScale=this._options.spriteScale,this._rotation=this._options.rotation,this._operations={},this._operationsStack=null,this.setOperationsStack(new mo),this._container=new jo.Container,this._sprite=new jo.Sprite,this._container.addChild(this._sprite),this._inputTexture=this._options.inputTexture,this._currentInputTexture=null,this._currentTexture=null,this._resizedTexture=null,this._resizedContainer=new jo.Container,this._resizedSprite=new jo.Sprite,this._resizedContainer.addChild(this._resizedSprite),this._texturesToDispose=[],this.setSmoothDownscaling(this._options.smoothDownscaling),this._registerOperations(),this._initRenderer();this._renderer.constructor.type;this._options.displayWelcomeMessage,this[Ko("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]&&Xo.log(Ko("VGhlIFBob3RvRWRpdG9yIFNESyBpcyBhIGNvbW1lcmNpYWwgcHJvZHVjdC4gQmVmb3JlIGJlaW5nIGFibGUgdG8gdXNlIGl0IHdpdGhvdXQgbGltaXRhdGlvbnMsIHlvdSBuZWVkIHRvIHVubG9jayB0aGUgU0RLIHdpdGggYSBsaWNlbnNlIGZpbGUuIFlvdSBjYW4gb2J0YWluIGEgdGltZS1saW1pdGVkIGV2YWx1YXRpb24gbGljZW5zZSBieSBzdGFydGluZyBhIHRyaWFsIGF0IGh0dHBzOi8vd3d3LmltZy5seS9zaWdudXAgb3IgeW91IGNhbiBwdXJjaGFzZSBhIGxpY2Vuc2UgYnkgcmVxdWVzdGluZyBhIHF1b3RlIGF0IGh0dHBzOi8vd3d3LmltZy5seS9wcmljaW5nLgoKQmVjYXVzZSB5b3UgZGlkIG5vdCBzcGVjaWZ5IGEgbGljZW5zZSBmaWxlIHlldCwgdGhlIFNESyB3aWxsIG5vdyBkaXNwbGF5IGEgd2F0ZXJtYXJrIGltYWdlIG9uIHRvcCBvZiBhbnkgcGhvdG9zIHlvdSBkaXNwbGF5IG9yIGV4cG9ydCB3aXRoIGl0LiBGb3IgaW5zdHJ1Y3Rpb25zIGZvciBob3cgdG8gdW5sb2NrIHRoZSBTREssIHBsZWFzZSB2aXNpdCBodHRwczovL2ltZy5seS9kb2NzL3Blc2RrL3dlYi9pbnRyb2R1Y3Rpb24vZ2V0dGluZ19zdGFydGVkLg==")),this._options.image&&this.setImage(this._options.image,this._options.exif)}_ct(){if(this._l.exp()){this._l.isExp()?Xo.error(Ko("TGljZW5zaW5n"),Ko("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5Lg==")):Xo.warn(Ko("TGljZW5zaW5n"),Ko("WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu").replace("%d",this._l.dl()))}}_cv(t=!1){return this._l.c().catch((e=>{this[Ko("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!1;let i=Ko("SW52YWxpZCBsaWNlbnNlLg==");throw t&&(i="ELICEXP"===e.code?Ko("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5Lg=="):"ELICINVHOST"===e.code?Ko("VGhlIGJ1bmRsZSBpZGVudGlmaWVycyB0aGF0IHlvdSBzcGVjaWZpZWQgaW4geW91ciBsaWNlbnNlIGZpbGUgZG8gbm90IG1hdGNoIHRoZSBhcHAncyBidW5kbGUgaWRlbnRpZmllci4gUGxlYXNlIHVwZGF0ZSBhbmQgcmVkb3dubG9hZCB5b3VyIGxpY2Vuc2UgZnJvbSB5b3VyIGN1c3RvbWVyIGRhc2hib2FyZCBhdCBodHRwczovL3d3dy5pbWcubHkvbG9naW4u"):"ELICINVPLAT"===e.code?Ko("VGhlIGxpY2Vuc2UgdGhhdCB5b3Ugc3BlY2lmaWVkIGlzIGZvciBhbm90aGVyIHBsYXRmb3JtLiBQbGVhc2UgZG93bmxvYWQgeW91ciBsaWNlbnNlIGZvciB0aGUgd2ViIHBsYXRmb3JtIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cuaW1nLmx5L2xvZ2luLg=="):"ELICINVFMT"===e.code?Ko("SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu").replace("$format",typeof this._options.license):"ELICINV"===e.code?Ko("VGhlIHNpZ25hdHVyZSBvZiB5b3VyIGxpY2Vuc2UgaXMgbm90IHZhbGlkLiBQbGVhc2UgdHJ5IHRvIHJlZG93bmxvYWQgeW91ciBsaWNlbnNlIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cuaW1nLmx5L2xvZ2luLg=="):Ko("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5IHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),e.message=i,new Error(e)}))}_t(){this._l.t()}_fl(){return this[Ko("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]}_onOperationUpdate(...t){this.emit(Ho.OPERATION_UPDATED,...t)}_onContextRestored(){Xo.warn(this.constructor.name,"Trying to re-render after WebGL context has been restored."),this.setAllOperationsToDirty(),this._operationsStack.forEach((t=>{t.disposeRenderTextures()})),this.render()}export(t=Zo.DATAURL,e=Qo.PNG,i=.8,s=!0){return this._cv(!0).then((()=>{this.hasChanges()&&this._t(),this._operationsStack.forEach((t=>{t.onBeforeExport()}));return new No(this,{renderType:t,imageFormat:e,quality:i,transparent:s}).export().then((t=>(this._operationsStack.forEach((t=>{t.onAfterExport()})),Promise.resolve(t))))}))}render(t=!0){if(!this._inputTexture)throw new Error("You need to set an image before calling PhotoEditorSDK#render.");const e=this._renderer.getContext();let i;e.startFrame&&e.startFrame(),Xo.canLog("info")&&(i=new po("\u26a1\u26a1\u26a1","Frame rendering")),Xo.info("\u26a1\u26a1\u26a1","Rendering starts");const s=this._operationsStack;return s.updateDirtinessForRenderer(this._renderer),this._prepareTexture().then((t=>{"export"===this._renderMode&&(t=this._inputTexture),this._currentTexture=t,this._sprite.setTexture(t),this._container.updateTransform()})).then((()=>s.validateSettings())).then((()=>(!this._fl()&&this[Ko("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]||(s.getByIdentifier("license-watermark")?s.moveToTop("license-watermark"):this.createOperation("license-watermark")),s.getByIdentifier("watermark")?s.moveToTop("watermark"):this._initWatermark(),s.render(this,this._currentTexture)))).then((e=>{const{outputTexture:i}=e;switch(this._currentTexture=i,this._sprite.setTexture(this._currentTexture),this._renderMode){case"dynamic":{const t=this._renderer.getDimensions().clone().divide(2).add(this._offset);this._container.setScale(this._zoom/this.getTextureScale(),this._zoom/this.getTextureScale()),this._container.setPosition(t),this._sprite.setAnchor(.5,.5),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(this._rotation);break}case"export":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(0);break;case"adapter":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(1,1),this._sprite.setRotation(0)}return t&&this._renderer.render(this._container),e})).then((t=>(i&&i.stop(),e.endFrame&&e.endFrame(),this._disposeTextures(),t)))}getTextureScale(){return Math.min(1,this._textureQuality*this._options.pixelRatio)}_prepareTexture(){return new Promise(((t,e)=>{const i=this.getTextureScale();if(1===this._textureQuality)return t(this._inputTexture);const s=this.getInputDimensions().multiply(i).floor();let r;this._resizedTexture?this._resizedTexture.getDimensions().equals(s)||(this._resizedTexture.resizeTo(s),r=!0):(this._resizedTexture=new jo.RenderTexture(this._renderer,s.x,s.y),r=!0),r&&(this._resizedSprite.setScale(i,i),this._resizedSprite.setTexture(this._inputTexture),this._resizedTexture.render(this._resizedContainer)),t(this._resizedTexture)}))}_registerOperations(){this._operations={};for(const t in Lo){const e=Lo[t];this._operations[e.identifier]=e}this._operations={...this._operations,...this._options.extensions.operations}}registerOperations(t){t.forEach((t=>{this._operations[t.identifier]=t}))}setAllOperationsToDirty(t=!1){this._operationsStack.setAllToDirty(t)}createOperation(t,e={},i=!0){const s=this._operations[t];if(!s)throw new Error(`No operation with identifier \`${t}\` found.`);const r=new s(this,e);return i&&this.addOperation(r),r}addOperation(t){this._operationsStack.push(t)}removeOperation(t){this._operationsStack.remove(t)}getInputDimensions(){const t=this._inputTexture.getFrame();return new qo(t.width,t.height)}getFinalDimensions(t=!1){let e=this.getInputDimensions();return this._operationsStack.forEach((t=>{t.getEnabled()&&(e=t.getNewDimensions(e))})),t&&e.multiply(this._spriteScale),e.floor()}getOutputDimensions(t=!1){return this.getFinalDimensions(t).clone().multiply(this._zoom).floor()}getOutputTextureDimensions(t=!1){const e=this.getTextureScale();let i=this.getInputDimensions().multiply(e).floor();return this._operationsStack.forEach((t=>{i=t.getNewDimensions(i)})),i}getCrossOrigin(){return Vo.getCrossOrigin(this._options.crossOrigin||"Anonymous")}_initRenderer(){const t={canvas:this._options.canvas,pixelRatio:this._options.pixelRatio,debug:this._options.debug,transparent:this._options.transparent,clearColor:this._options.clearColor};let e,i;if("export"!==this._renderMode&&this._options.canvas){const{canvas:t}=this._options;e=t.width,i=t.height}else if(this._inputTexture){const t=this.getFinalDimensions();e=t.x,i=t.y}else e=1,i=1;switch(this._preferredRenderer){case $o.WEBGL:this._renderer=jo.autoDetectRenderer(e,i,t),this._renderer.on("context-restored",this._onContextRestored),this._renderer.on("context-lost",this._onContextLost);break;case $o.CANVAS:this._renderer=jo.canvasRenderer(e,i,t),this._renderer.on("context-restored",this._onContextRestored);break;default:Xo.warn("PhotoEditorSDK",`PhotoEditorSDK Error: Renderer \`${this._preferredRenderer}\` not supported. Falling back to automatically detected renderer.`),this._renderer=jo.autoDetectRenderer(e,i,t)}}resizeTo(t){this._renderer.resizeTo(t,!0)}reset(){this._operationsStack.clear()}parseExif(t){if(!t)return;let{src:e}=t,i=!1,s=null;if(i=ho.isJPEG(e),s=e,i){let t=null;try{t=ho.fromBase64String(s)}catch(rk){}if(!t)return;return t}}_handleExifOrientation(){const t=this._exif.getTags();if(t&&t.Orientation){const e=1!==t.Orientation&&2!==t.Orientation,i=-1!==[2,4,5,7].indexOf(t.Orientation);if(e||i){if("undefined"===typeof navigator)this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(t);else{const e=window&&window.navigator&&window.navigator.userAgent||"";!e.match(/msie|trident/i)&&-1===e.indexOf("Edge")&&CSS.supports("image-orientation","from-image")||(this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(t))}this._exif.setOrientation(1)}}}correctExifOrientation(t){const e=this.parseExif(t);if(!e)return t;const i=e.getTags();if(i&&i.Orientation){const s=1!==i.Orientation&&2!==i.Orientation,r=-1!==[2,4,5,7].indexOf(i.Orientation);if(s||r){if("undefined"===typeof navigator){const e=this.createOperation("exif-orientation",{},!1);e.setTags(i),t=e.applyTo(t)}else{const e=window&&window.navigator&&window.navigator.userAgent||"";if(e.match(/msie|trident/i)||-1!==e.indexOf("Edge")||!CSS.supports("image-orientation","from-image")){const e=this.createOperation("exif-orientation",{},!1);e.setTags(i),t=e.applyTo(t)}}return e.setOrientation(1),i.Orientation=1,t}}return t}hasImage(){return null!==this._image&&"undefined"!==typeof this._image}getImage(){return this._image}disposeTexture(t){this._texturesToDispose.push(t)}_disposeTextures(){for(let t=0;t<this._texturesToDispose.length;t++)this._texturesToDispose[t].dispose();this._texturesToDispose=[]}setImage(t,e=null,i=null){this._disposeTextures(),this._exifOperation&&(this.removeOperation(this._exifOperation),this._exifOperation=null),this._options.image=t,this._image=t,this._exif=e||this.parseExif(t),this._exif&&this._handleExifOrientation();const s=new jo.BaseTexture(this._image),r=new Uo(0,0,this._image.naturalWidth||this._image.width,this._image.naturalHeight||this._image.height);i&&(r.width=i.x,r.height=i.y),this._resizedTexture&&this._resizedTexture.dispose(),this._resizedTexture=null,this._inputTexture&&this.disposeTexture(this._inputTexture.getBaseTexture()),this._inputTexture=new jo.Texture(s,r),this._currentTexture=this._inputTexture,this._sprite.clearTexture(!1),this._sprite.setTexture(this._inputTexture),this.emit("new-image"),this.setAllOperationsToDirty(!0)}setInputTexture(t){this._inputTexture=t}getCanvas(){return this._renderer.getCanvas()}setCanvas(t){this._renderer.setCanvas(t)}getSprite(){return this._sprite}getContainer(){return this._container}getOperationsStack(){return this._operationsStack}setOperationsStack(t){this._operationsStack&&this._operationsStack.off(Ho.OPERATION_UPDATED,this._onOperationUpdate),this._operationsStack=t,this._operationsStack.on(Ho.OPERATION_UPDATED,this._onOperationUpdate)}getOperations(){return this._operations}getRenderer(){return this._renderer}getOffset(){return this._offset}setOffset(t,e){t instanceof qo?this._offset.copy(t):this._offset.set(t,e)}getRenderMode(){return this._renderMode}setRenderMode(t){this._renderMode=t}getZoom(){return this._zoom}setZoom(t){this._zoom=t,this._container.setScale(this._zoom,this._zoom),this._container.updateTransform()}getTextureQuality(){return"export"===this._renderMode?1:this._textureQuality}setTextureQuality(t){t!==this._textureQuality&&this.setAllOperationsToDirty(!0),this._textureQuality=Math.min(1,t),1===this._textureQuality&&this._resizedTexture&&(this._resizedTexture.dispose(),this._resizedTexture=null)}getSpriteScale(){return this._spriteScale}setSpriteScale(t){this._spriteScale=t,this._sprite.setScale(t,t),this._sprite.updateTransform()}getPixelRatio(){return this._options.pixelRatio}getExif(){return this._exif}getOptions(){return this._options}getInputTexture(){return this._inputTexture}setSmoothDownscaling(t){this._options.smoothDownscaling=t,this._sprite.setSmoothDownscaling(t),this._resizedSprite.setSmoothDownscaling(t)}setRotation(t){this._rotation=t}getRotation(){return this._rotation}hasChanges(){return this.getOperationsStack().hasChanges()}dispose(){this._operationsStack.dispose(),this._renderer.dispose(),this._exif&&this._exif.dispose(),this._resizedTexture&&this._resizedTexture.dispose()}}})),da=b((()=>{Ft(),ae(),j(),To(),Rt(),le(),Ke(),Co(),he(),Eo(),Oo(),Nn(),Hn(),Ao(),It(),ha(),Mo(),ca(),ta.version="3.9.0",ta.Math=Wn,ta.Operations=Lo,ta.Engine=Jn,ta.Color=Wt,ta.LicenseChecker=Rn,ta.Operation=yo,ta.EventEmitter=qt,ta.Utils=st,ta.Env=Kn,ta.OperationsStack=mo,ta.EXIF=ho,ta.Image=co,ta.Configurable=we,ta.Log=ut,ta.Loaders=jt,ta.RenderType=o,ta.ImageFormat=a,ta.OptionType=l,ta.RendererType=u,ta.UniformType=h,ta.Base64=tt,ea={},ta.UI=ea,ia=ta})),_a=b((()=>{da(),da()})),ma=b((()=>{sa="precision highp float;\n\nvarying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nuniform float u_gamma;\nuniform float u_shadows;\nuniform float u_highlights;\nuniform float u_whites;\nuniform float u_blacks;\n\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorOffset;\n\nconst float EPSILON = 0.0000001;\n\nfloat calculateLuminance(vec3 rgb) {\n    // This is the luminance calculation part of the RGB to HSL formular.\n    vec4 p = mix(\n        vec4(rgb.gb, 0.0, -1.0 / 3.0),\n        vec4(rgb.bg, -1.0, 2.0 / 3.0),\n        vec4(rgb.g < rgb.b)\n    );\n\n    vec4 q = mix(\n        vec4(rgb.r, p.yzx),\n        vec4(p.xyw, rgb.r),\n        vec4(rgb.r < p.x)\n    );\n\n    float croma = q.x - min(q.w, q.y);\n    float luminance = q.x - croma * 0.5;\n    return luminance;\n}\n\nvec3 map(vec3 x, float in_min, float in_max, float out_min, float out_max){\n  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n}\n\nvoid main() {\n\n  vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);\n  color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha\n\n  // Apply gamma\n  if (u_gamma != 1.0) {\n    color.rgb = pow(color.rgb, vec3(1.0 / max(u_gamma, EPSILON)));\n  }\n\n  // Apply shadows and highlights\n  float luminance = calculateLuminance(color.rgb);\n\n  float shadow = u_shadows >= 0.0\n    ? clamp(\n          pow(luminance, 1.0 / (u_shadows + 1.0))\n          + pow(luminance, 2.0 / (u_shadows + 1.0)) * -0.76\n          - luminance\n    , 0.0, max(u_shadows, 1.0))\n    : -clamp(\n          pow(luminance, 1.0 / (-u_shadows + 1.0))\n          + pow(luminance, 2.0 / (-u_shadows + 1.0)) * -0.76\n          - luminance\n    , 0.0, max(-u_shadows, 1.0));\n\n  float highlight = u_highlights < 0.0\n    ? clamp(\n          1.0\n          - pow(1.0 - luminance, 1.0 / (1.0 - u_highlights))\n          - pow(1.0 - luminance, 2.0 / (1.0 - u_highlights)) * -0.8\n          - luminance\n     , -1.0, 0.0)\n    : -clamp(\n          1.0\n          - pow(1.0 - luminance, 1.0 / (1.0 + u_highlights))\n          - pow(1.0 - luminance, 2.0 / (1.0 + u_highlights)) * -0.8\n          - luminance\n     , -1.0, 0.0);\n\n  // Bright color need more contrast and dark color need more brightness.\n  // This is to keep saturatation because the color information of a dark colors is lost.\n  float shadowContrast   = shadow * luminance * luminance;\n  float shadowBrightness = shadow - shadowContrast;\n\n  float offset = luminance + shadowContrast + highlight;\n  color.rgb = clamp(offset * ((color.rgb + shadowBrightness) / max(luminance, EPSILON)), 0.0, 1.0);\n  \n  // Apply Color Matrix\n  color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;\n  color.rgb = map(color.rgb, 0.0, 1.0, u_blacks / 2.0, 1.0 + u_whites / 2.0);\n  color = clamp(color, 0.0, 1.0);\n  color.rgb *= color.a; // Reset premultiplied alpha\n\n  gl_FragColor = color;\n}\n"}));function ga(t,e,i,s,r){return(t-e)*(r-s)/(i-e)+s}var pa,fa,ya,xa,ba,va,wa,Da,ka,Ta,Ca,Ra,Ia,Fa,Sa,Ea,Oa,Aa,Ba,Ma,Pa,La,za,Na,Ua,Ga,ja,Va,Wa,Ha,qa,Xa,Ya,Ja,Ka,Za,Qa,$a,tl,el,il,sl,rl,nl,ol,al,ll,hl,ul,cl,dl,_l,ml,gl,pl,fl,yl,xl,bl,vl,wl,Dl,kl,Tl,Cl,Rl,Il,Fl,Sl,El,Ol,Al,Bl,Ml,Pl,Ll,zl,Nl,Ul,Gl,jl,Vl,Wl,Hl,ql,Xl,Yl,Jl,Kl,Zl,Ql=b((()=>{_a(),ma(),({ColorMatrix:ra}=Wn),na=1e-7,oa=t=>(Math.max(t.r,t.g,t.b)+Math.min(t.r,t.g,t.b))/2,(aa=class extends Jn.Filter{constructor(){super(),this._fragmentSource=sa}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),{colorMatrix:l,gamma:h,shadows:u,highlights:c,whites:d,blacks:_}=this._options,m=1!==h,g=0!==u||0!==c;let p=new Wt(0,0,0,0);for(let f=0;f<r.width*r.height;f++){const t=4*f;if(p.r=a.data[t]/255,p.g=a.data[t+1]/255,p.b=a.data[t+2]/255,m&&(p.r=Math.pow(p.r,1/Math.max(h,na)),p.g=Math.pow(p.g,1/Math.max(h,na)),p.b=Math.pow(p.b,1/Math.max(h,na))),g){const t=oa(p),e=u>=0?st.clamp(Math.pow(t,1/(u+1))+-.76*Math.pow(t,2/(u+1))-t,0,Math.max(u,1)):-st.clamp(Math.pow(t,1/(1-u))+-.76*Math.pow(t,2/(1-u))-t,0,Math.max(-u,1)),i=e*t*t,s=e-i,r=t+i+(c<0?st.clamp(1-Math.pow(1-t,1/(1-c))- -.8*Math.pow(1-t,2/(1-c))-t,-1,0):-st.clamp(1-Math.pow(1-t,1/(1+c))- -.8*Math.pow(1-t,2/(1+c))-t,-1,0));p.r=st.clamp(r*((p.r+s)/Math.max(t,na)),0,1),p.g=st.clamp(r*((p.g+s)/Math.max(t,na)),0,1),p.b=st.clamp(r*((p.b+s)/Math.max(t,na)),0,1)}p=l.apply(p).clamp(0,1),p.r=ga(p.r,0,1,_/2,1+d/2),p.g=ga(p.g,0,1,_/2,1+d/2),p.b=ga(p.b,0,1,_/2,1+d/2),a.data[t]=255*p.r,a.data[t+1]=255*p.g,a.data[t+2]=255*p.b}o.putImageData(a,0,0)}}).prototype.availableOptions={gamma:{type:l.NUMBER,default:1,uniformType:h.FLOAT},shadows:{type:l.NUMBER,default:0,uniformType:h.FLOAT},highlights:{type:l.NUMBER,default:1,uniformType:h.FLOAT},whites:{type:l.NUMBER,default:0,uniformType:h.FLOAT},blacks:{type:l.NUMBER,default:0,uniformType:h.FLOAT},colorMatrix:{type:l.COLOR_MATRIX,default:new ra,uniformType:h.MAT4},colorOffset:{type:l.ARRAY,default:[],uniformType:h.FLOAT4}},la=aa})),$l=b((()=>{pa="precision mediump float;\n\n// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE\nuniform sampler2D u_image;\n\n// Size of one pixel == vec2(1.0 / u_image.width, 1.0 / u_image.height)\nuniform vec2 u_pixelDimension;\n\n// Range (-1.0 - 1.0)\nuniform float u_clarity;\n\nvarying vec2 v_texCoord;\n\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorOffset;\n\nconst float EPSILON = 0.000001;\n\nvec4 unpremultiply(vec4 col) {\n    col.rgb /= max(col.a, EPSILON);\n    return col;\n}\n\nvoid main() {\n    vec4 color = texture2D(u_image, v_texCoord);\n    color = unpremultiply(color);\n\n    // L = Left, R = Right, C = Center, T = Top, B = Bottom\n    vec4 colLB = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x, -u_pixelDimension.y));\n    vec4 colLC = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,                 0.0));\n    vec4 colLT = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,  u_pixelDimension.y));\n\n    vec4 colCL = texture2D(u_image, v_texCoord + vec2(                0.0, -u_pixelDimension.y));\n    vec4 colCR = texture2D(u_image, v_texCoord + vec2(                0.0,  u_pixelDimension.y));\n    \n    vec4 colRB = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x, -u_pixelDimension.y));\n    vec4 colRC = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,                 0.0));\n    vec4 colRT = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,  u_pixelDimension.y));\n\n    vec4 mergedColor = color;\n    mergedColor.rgb += unpremultiply(colLB).rgb + unpremultiply(colLC).rgb + unpremultiply(colLT).rgb;\n    mergedColor.rgb += unpremultiply(colCL).rgb + unpremultiply(colCR).rgb;\n    mergedColor.rgb += unpremultiply(colRB).rgb + unpremultiply(colRC).rgb + unpremultiply(colRT).rgb;\n\n    mergedColor /= 9.0;\n\n    float grayValue = clamp(color.r * 0.3 + color.g * 0.59 + color.b * 0.1, 0.111111, 0.999999);\n    // 1.0 and 0.0 result in white not black, therefore we clamp\n\n    // Here we create a function that will map values below 0.1 to 0. Values above 0.2 will be mapped to 1,\n    // and for values between 0.1 and 0.2 it will produce a gradient.\n    // The funtion is mirror at 0.5, meaning values between 0.8 and 0.9 will result in a decending gradient.\n    // And values above 0.9 will be mapped to 0.\n    float frequenceFactor = min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));\n\n    // here we apply the high pass filter. Its strength is determined by the uniform ,\n    // and the frequence factor. That means the only the mid tones are affected by this filter.\n    // Clarity input is ranging from -1 to 1. But we want to strengthen the effect.\n    // Therefore we see this little magic number '3.7'.\n    color.rgb = clamp(color + clamp((color - mergedColor) * u_clarity * 3.7 * frequenceFactor, 0.0, 10.0), 0.0, 1.0).rgb;\n\n    // apply exposure but only to the mid tones.\n    color.rgb = color.rgb * pow(2.0, u_clarity * 0.27 * frequenceFactor);\n\n    // apply contrast and desaturation matrix\n    color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;\n\n    color.rgb *= color.a; // Premultiply alpha\n\n    gl_FragColor = clamp(color, 0.0, 1.0);\n}\n"})),th=b((()=>{_a(),$l(),({Vector2:fa,ColorMatrix:ya}=Wn),(xa=class extends Jn.Filter{constructor(){super(),this._fragmentSource=pa}_applyCanvas(t,e,i,s=!1){const r=i.getContext(),n=e.getCanvas(),o=e.getContext(),{clarity:a}=this._options,{colorMatrix:l}=this._options,h=new Wt(this._options.colorOffset[0],this._options.colorOffset[1],this._options.colorOffset[2],this._options.colorOffset[3]),{width:u}=n,{height:c}=n,d=o.getImageData(0,0,u,c),_=r.createImageData(u,c);this.canvasShader(d,_,a,l,h),r.putImageData(_,0,0)}canvasShader(t,e,i,s,r){const n=(t,e,i)=>Math.min(Math.max(t,e),i),o=(t,e,i)=>{const s=n((i-t)/(e-t),0,1);return s*s*(3-2*s)},a=4*t.width,{length:l}=t.data,h=l-1,u=t.data,c=e.data,d=new Wt,_=2295,m=t=>u[t=(t=t<0?0:t)>h?h:t];for(let g=0;g<l;g+=4){let t=m(g+0),e=m(g+1),r=m(g+2),l=m(g+3);const h=(t+m(g-4-a+0)+m(g-4+0)+m(g-4+a+0)+m(g-a+0)+m(g+a+0)+m(g+4-a+0)+m(g+4+0)+m(g+4+a))/_,u=(e+m(g-4-a+1)+m(g-4+1)+m(g-4+a+1)+m(g-a+1)+m(g+a+1)+m(g+4-a+1)+m(g+4+1)+m(g+4+a+1))/_,p=(r+m(g-4-a+2)+m(g-4+2)+m(g-4+a+2)+m(g-a+2)+m(g+a+2)+m(g+4-a+2)+m(g+4+2)+m(g+4+a+2))/_,f=(l+m(g-4-a+3)+m(g-4+3)+m(g-4+a+3)+m(g-a+3)+m(g+a+3)+m(g+4-a+3)+m(g+4+3)+m(g+4+a+3))/_;t/=255,e/=255,r/=255,l/=255;const y=n(.3*t+.59*e+.1*r,.111111,.999999),x=Math.min(o(1-y,0,.11),o(y,0,.11)),b=3.7*i*x,v=Math.pow(2,.27*i*x),w=n(t+n((t-h)*b,0,10),0,1)*v,D=n(e+n((e-u)*b,0,10),0,1)*v,k=n(r+n((r-p)*b,0,10),0,1)*v,T=n(l+n((l-f)*b,0,10),0,1);d.set(w,D,k,T);const C=s.apply(d).clamp(0,1);c[g+0]=255*C.r,c[g+1]=255*C.g,c[g+2]=255*C.b,c[g+3]=255*C.a}}}).prototype.availableOptions={clarity:{type:l.NUMBER,default:0,uniformType:h.FLOAT},pixelDimension:{type:l.VECTOR2,default:new fa(100,100),uniformType:h.FLOAT2},colorMatrix:{type:l.COLOR_MATRIX,default:new ya,uniformType:h.MAT4},colorOffset:{type:l.ARRAY,default:[],uniformType:h.FLOAT4}},ba=xa})),eh=b((()=>{va="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec2 u_pixelDimension;\nuniform float u_sharpness;\n \nconst float EPSILON = 0.000001;\n \nvoid main() {\n    vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);\n\n    float factor        = mix(0.2, -1.0, float(u_sharpness > 0.0));\n    vec4 sharpenedColor = mix(0.2,  5.0, float(u_sharpness > 0.0)) * color;\n \n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2(-1.0,  0.0)), 0.0, 1.0);\n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0, -1.0)), 0.0, 1.0);\n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0,  1.0)), 0.0, 1.0);\n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 1.0,  0.0)), 0.0, 1.0);\n \n    color.rgb /= max(color.a, EPSILON); // unpremultiply\n    sharpenedColor.rgb /= max(sharpenedColor.a, EPSILON); // unpremultiply\n \n    sharpenedColor = clamp(sharpenedColor, 0.0, 1.0);\n \n    color = clamp(mix(color, sharpenedColor, abs(u_sharpness)), 0.0, 1.0);\n      \n    gl_FragColor = vec4(color.rgb * color.a, color.a); // premultiply\n}"})),ih=b((()=>{_a(),eh(),({Vector2:wa}=Wn),(Da=class extends Jn.Filter{constructor(){super(),this._fragmentSource=va}_applyCanvas(t,e,i,s=!1){const r=i.getContext(),n=e.getCanvas(),o=e.getContext(),{sharpness:a}=this._options,{width:l}=n,{height:h}=n,u=o.getImageData(0,0,l,h),c=r.createImageData(l,h);this.canvasShader(u,c,a),r.putImageData(c,0,0)}canvasShader(t,e,i){const s=(t,e,i)=>Math.min(Math.max(t,e),i),{width:r}=t,{height:n}=t,o=t.data,a=e.data,l=(t,e,i)=>t*(1-i)+e*i,h=t=>s(o[t]/255,0,1),u=(t,e)=>{const i=s(t,0,r-1),o=s(e,0,n-1);return 4*(i+r*o)},c=[],d=[],_=[-1,0,0,1],m=[0,-1,1,0],g=i>0?-1:.2,p=i>0?5:.2,f=Math.abs(i);for(let y=0;y<r;y++)for(let t=0;t<n;t++){const e=u(y,t);c[0]=h(e+0),c[1]=h(e+1),c[2]=h(e+2),c[3]=h(e+3),d[0]=p*c[0]*c[3],d[1]=p*c[1]*c[3],d[2]=p*c[2]*c[3],d[3]=p*c[3];for(let i=0;i<4;i++){const e=u(y+_[i],t+m[i]),s=h(e+3);d[3]+=g*s;for(let t=0;t<3;t++)d[t]+=g*h(e+t)*s}for(let t=0;t<3;t++)d[t]/=Math.max(d[3],1e-6),d[t]=s(d[t],0,1);d[3]=s(d[3],0,1);for(let t=0;t<4;t++)c[t]=s(l(c[t],d[t],f),0,1),a[e+t]=255*c[t]}}}).prototype.availableOptions={sharpness:{type:l.NUMBER,default:0,uniformType:h.FLOAT},pixelDimension:{type:l.VECTOR2,default:new wa(100,100),uniformType:h.FLOAT2}},ka=Da})),sh=b((()=>{Ta="precision mediump float;\n\n// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE\nuniform sampler2D u_image;\n\n// Range (-1.0 - 1.0)\nuniform float u_temperature;\n\nconst lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);\n\nconst mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);\nconst mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);\n\nconst float EPSILON = 0.0000001;\n\nvarying vec2 v_texCoord;\nvoid main() {\n  float temperature = u_temperature;\n  const float tint = 0.0;\n  vec4 source = texture2D(u_image, v_texCoord);\n\n  source.rgb /= max(source.a, EPSILON);   // Revert premultiplied alpha\n\n  vec3 yiq = RGBtoYIQ * source.rgb;\n  yiq.b = clamp(yiq.b + tint*0.5226*0.1, -0.5226, 0.5226);\n  vec3 rgb = YIQtoRGB * yiq;\n\n  vec3 processed = mix(\n    (1.0 - 2.0 * (1.0 - rgb) * (1.0 - warmFilter)),\n    (2.0 * rgb * warmFilter),\n    vec3(rgb.r < 0.5, rgb.g < 0.5, rgb.b < 0.5)\n  );\n\n  vec4 color = vec4(mix(rgb, processed, temperature), source.a);\n\n  color.rgb *= color.a;   // Premultiply alpha again\n\n  gl_FragColor = color;\n}\n"})),rh=b((()=>{_a(),sh(),(Ca=class extends Jn.Filter{constructor(){super(),this._fragmentSource=Ta}_applyCanvas(t,e,i,s=!1){const r=i.getContext(),n=e.getCanvas(),o=e.getContext(),{temperature:a}=this._options,{width:l}=n,{height:h}=n,u=o.getImageData(0,0,l,h),c=r.createImageData(l,h);this.canvasShader(u,c,a),r.putImageData(c,0,0)}canvasShader(t,e,i){const s=(t,e,i)=>Math.min(Math.max(t,e),i),r=(t,e,i)=>t*(1-i)+e*i,n=(t,e)=>[t[0]*e[0]+t[3]*e[1]+t[6]*e[2],t[1]*e[0]+t[4]*e[1]+t[7]*e[2],t[2]*e[0]+t[5]*e[1]+t[8]*e[2]],{length:o}=t.data,a=o-1,l=t.data,h=e.data,u=t=>l[t=(t=t<0?0:t)>a?a:t],c=[.93,.54,0],d=[.299,.587,.114,.596,-.274,-.322,.212,-.523,.311],_=[1,.956,.621,1,-.272,-.647,1,-1.105,1.702];for(let m=0;m<o;m+=4){const t=u(m+0)/255,e=u(m+1)/255,o=u(m+2)/255,a=u(m+3)/255,l=n(d,[t,e,o]);l.z=s(l.z+0,-.5226,.5226);const g=n(_,l),p=[g[0]<.5?2*g[0]*c[0]:1-2*(1-g[0])*(1-c[0]),g[1]<.5?2*g[1]*c[1]:1-2*(1-g[1])*(1-c[1]),g[2]<.5?2*g[2]*c[2]:1-2*(1-g[2])*(1-c[2])];h[m+0]=255*r(g[0],p[0],i),h[m+1]=255*r(g[1],p[1],i),h[m+2]=255*r(g[2],p[2],i),h[m+3]=255*a}}}).prototype.availableOptions={temperature:{type:l.NUMBER,default:0,uniformType:h.FLOAT}},Ra=Ca})),nh=b((()=>{_a(),Ql(),th(),ih(),rh(),({ColorMatrix:Ia}=Wn),(Fa=class extends yo{constructor(...t){super(...t),this._clarityFilter=new ba,this._temperatureFilter=new Ra,this._sharpnessFilter=new ka,this._filter=new la,this._sprite.setFilters([this._clarityFilter,this._temperatureFilter,this._filter])}_render(t){const e=t.getDimensions();e.x=1/e.x,e.y=1/e.y;const i=new Ia;i.multiply(Ia.createSaturationMatrix(-.3*this._options.clarity+1)),i.multiply(Ia.createContrastMatrix(.1*this._options.clarity+1)),this._clarityFilter.set({clarity:this._options.clarity,pixelDimension:e,colorMatrix:i,colorOffset:i.getOffsets()}),this._temperatureFilter.set({temperature:this._options.temperature}),this._sharpnessFilter.set({sharpness:this._options.sharpness,pixelDimension:e});const s=new Ia;s.multiply(Ia.createExposureMatrix(this._options.exposure)),s.multiply(Ia.createSaturationMatrix(this._options.saturation+1)),s.multiply(Ia.createContrastMatrix((this._options.contrast>0?2*this._options.contrast:this._options.contrast)+1)),s.multiply(Ia.createBrightnessMatrix(this._options.brightness)),this._filter.set({gamma:this._options.gamma,shadows:this._options.shadows,highlights:this._options.highlights,whites:this._options.whites,blacks:this._options.blacks,colorMatrix:s,colorOffset:s.getOffsets()});const r=[];return 0!==this._options.clarity&&r.push(this._clarityFilter),0!==this._options.sharpness&&r.push(this._sharpnessFilter),0!==this._options.temperature&&r.push(this._temperatureFilter),r.push(this._filter),this._sprite.setFilters(r),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._clarityFilter.dispose(),this._temperatureFilter.dispose(),this._sharpnessFilter.dispose()}}).identifier="adjustments",Fa.prototype.availableOptions={brightness:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},saturation:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},contrast:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},gamma:{type:l.NUMBER,default:1,minValue:.5,midValue:1,maxValue:2},exposure:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},shadows:{type:l.NUMBER,default:0,minValue:-2,midValue:0,maxValue:2},highlights:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},clarity:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},whites:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},blacks:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},temperature:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},sharpness:{type:l.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1}},ia.Operations.AdjustmentsOperation=Fa,Sa=Fa})),oh=b((()=>{Ea="/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n    float radius = u_blurRadius;\n\n    const float steps = 30.0;\n\n    for (float t = -steps; t <= steps; t++) {\n        float percent = (t + offset - 0.5) / steps;\n        float weight = 1.0 - abs(percent);\n\n        // Somehow `sample` is a keyword in headless-gl\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n}\n"})),ah=b((()=>{_a(),oh(),({Vector2:Oa}=Wn),(Aa=class extends Jn.Filter{constructor(...t){super(...t),this._fragmentSource=Ea,this._lastBlurRadius=null,this._lastDimensions=new Oa(0,0),this._blurredRenderTarget=new Jn.CanvasRenderTarget(100,100,1)}_applyCanvas(t,e,i,s=!1,r=null){if("low"===this._options.blurQuality)return void this._renderLQBlur(t,e,i,s);const n=e.getCanvas(),o=e.getContext(),a=i.getContext();this._lastBlurRadius===this._options.blurRadius&&a.drawImage(n,0,0);const l=o.getImageData(0,0,n.width,n.height),h=a.getImageData(0,0,n.width,n.height);let u=this._options.blurRadius;const{delta:c}=this._options;for(let d=0;d<n.width;d++)for(let t=0;t<n.height;t++){const e=4*(d+t*n.width);let i=0,s=0,o=0,a=0,_=0;r&&(u=r(d/n.width,t/n.height));const m=this._random(d,1-t/n.height);for(let r=-30;r<=30;r++){const e=(r+m-.5)/30,h=1-Math.abs(e),g=c.x*e*u,p=c.y*e*u,f=Math.max(Math.min(d+g,n.width-1),0),y=Math.max(Math.min(t+p,n.height-1),0),x=4*(Math.round(y)*n.width+Math.round(f)),b=l.data[x+3],v=b*l.data[x],w=b*l.data[x+1],D=b*l.data[x+2];i+=v*h,s+=w*h,o+=D*h,a+=b*h,_+=h}i/=_,s/=_,o/=_,a/=_,h.data[e]=i/a,h.data[e+1]=s/a,h.data[e+2]=o/a,h.data[e+3]=a}a.putImageData(h,0,0),this._lastDimensions.copy(new Oa(n.width,n.height))}_renderLQBlur(t,e,i,s){const r=e.getDimensions(),n=!this._lastDimensions.equals(r);this._blurredRenderTarget.setPixelRatio(e.getPixelRatio()),this._blurredRenderTarget.resizeTo(e.getDimensions()),i.setPixelRatio(e.getPixelRatio()),i.resizeTo(e.getDimensions()),(this._lastBlurRadius!==this._options.blurRadius||n)&&(this._blurImage(e,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius);i.getContext().drawImage(this._blurredRenderTarget.getCanvas(),0,0),this._lastDimensions.copy(r)}_random(t,e){const i=12.9898*t+78.233*e,s=i-3.14*Math.floor(i/3.14),r=43758.5453*Math.sin(s);return r-Math.floor(r)}}).prototype.availableOptions={blurRadius:{type:l.NUMBER,default:30,uniformType:h.FLOAT},delta:{type:l.VECTOR2,default:new Oa(1,1),uniformType:h.FLOAT2},texSize:{type:l.VECTOR2,default:new Oa(100,100),uniformType:h.FLOAT2},blurQuality:{type:l.STRING,default:"low"}},Ba=Aa})),lh=b((()=>{_a(),ah(),({Vector2:Ma}=Wn),(Pa=class extends yo{constructor(...t){super(...t),this._lastBlurRadius=this._options.blurRadius;const e={blurQuality:{type:l.STRING}};this._horizontalFilter=new Ba({},e),this._verticalFilter=new Ba({},e),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Ma(.5,.5)),this._verticalFilter.setDelta(new Ma(-.5,.5)),this._filter=new Ba({},e)}_renderWebGL(t){return this._renderBlur(t)}_renderCanvas(t){return this._options.highQualityCanvasBlur?this._renderBlur(t):this._renderLQCanvasBlur(t)}_renderBlur(t){const e=t.getDimensions(),i=e.min(),{blurRadius:s}=this._options,r={blurRadius:s*i,texSize:e,blurQuality:"high"};return this._horizontalFilter.set(r),this._verticalFilter.set(r),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(t){const{blurRadius:e}=this._options,i=t.getDimensions();return this._filter.set({blurRadius:e,texSize:i,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}transform(t){const e=this.getBlurRadius(),i=t.applyToRelativeSize(e);this.set({blurRadius:i},!1)}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}).identifier="blur",Pa.prototype.availableOptions={blurRadius:{type:l.NUMBER,default:.025},highQualityCanvasBlur:{type:l.BOOLEAN,default:!1}},ia.Operations.BlurOperation=Pa,La=Pa})),hh=b((()=>{za="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_filteredImage;\nuniform float u_intensity;\n\nvoid main() {\n  vec4 color0 = texture2D(u_image, v_texCoord);\n  vec4 color1 = texture2D(u_filteredImage, v_texCoord);\n  gl_FragColor = mix(color0, color1, u_intensity);\n}\n"})),uh=b((()=>{_a(),hh(),(Na=class extends Jn.Filter{constructor(){super(),this._fragmentSource=za}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=i.getContext(),{filteredCanvas:o}=this._options;n.save(),n.drawImage(r,0,0),n.globalAlpha=this._options.intensity,n.drawImage(o,0,0),n.restore()}}).prototype.availableOptions={filteredImage:{type:l.NUMBER,default:1,uniformType:h.INT},filteredCanvas:{type:l.OBJECT,default:null},intensity:{type:l.NUMBER,default:1,uniformType:h.FLOAT}},Ua=class{constructor(t=1){this._intensity=t,this._stack=[],this._dirtiness={},this._renderTextures={},this._container=new Jn.Container,this._sprite=new Jn.Sprite,this._container.addChild(this._sprite),this._blendFilter=new Na}push(t){this._stack.push(t)}clear(){this._stack=[]}render(t,e,i){if(this.isEmpty())return Promise.resolve();const s=t.getRenderer();this._sprite.setTexture(e);let r=this._renderTextures[s.id];if(!r){const e=t.getSprite().getTexture().getFrame();r=new Jn.RenderTexture(t.getRenderer(),e.width,e.height),this._renderTextures[s.id]=r}const n=i.getDimensions();r.resizeTo(n);const o=this.isDirtyForRenderer(s);if(o){this._stack.forEach((e=>{e.update(t)}));const e=this._stack.map((t=>t.getFilter()));this._sprite.setFilters(e),r.render(this._container),this.setDirtyForRenderer(!1,s)}if(this._blendFilter.setIntensity(this._intensity),s.isOfType(u.CANVAS))this._blendFilter.setFilteredCanvas(r.getRenderTarget().getCanvas());else if(s.isOfType(u.WEBGL)){const t=r.getBaseTexture();t.setGLUnit(this._blendFilter.getFilteredImage()),s.updateTexture(t,!1)}return this._sprite.setFilters([this._blendFilter]),i.clear(Wt.TRANSPARENT),i.render(this._container),o&&this.disposeRenderTextures(),Promise.resolve()}setIntensity(t){this._intensity=t}isEmpty(){return 0===this._stack.length}isDirtyForRenderer(t){return t.id in this._dirtiness||(this._dirtiness[t.id]=!0),this._dirtiness[t.id]}setDirtyForRenderer(t,e){this._dirtiness[e.id]=t}setDirty(t){for(const e in this._dirtiness)this._dirtiness[e]=t}disposeRenderTextures(){for(const t in this._renderTextures)this._renderTextures[t].dispose(),delete this._renderTextures[t]}dispose(){this.disposeRenderTextures(),this._stack.forEach((t=>t.dispose())),this._stack=[],this._blendFilter.dispose(),this._sprite.dispose()}}})),ch=b((()=>{_a(),uh(),(Ga=class extends we{constructor(t={},e={}){super(t,{intensity:{type:l.NUMBER,default:1,setter(t){return this._stack&&this._stack.setIntensity(t),t}},dirty:{type:l.BOOLEAN,default:!0},...e}),this._stack=new Ua(this._options.intensity)}render(t,e,i){return this._stack.render(t,e,i).then((t=>(this.setDirty(!1),t)))}setDirtyForRenderer(t,e){this._stack.setDirtyForRenderer(t,e)}disposeRenderTextures(){this._stack.disposeRenderTextures()}dispose(){this._stack.dispose()}}).identifier=null,Ga.isIdentity=!1,Ga.displayName=null,Ga.PrimitivesStack=Ua,ja=Ga})),dh=b((()=>{Va="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_brightness;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;\n}\n"})),_h=b((()=>{_a(),Wa=class extends we{update(){}getFilter(){return this._filter}dispose(){this._filter&&(this._filter.dispose(),this._filter=null)}}})),mh=b((()=>{_a(),dh(),_h(),(Ha=class extends Jn.Filter{constructor(){super(),this._fragmentSource=Va}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height);let{brightness:l}=this._options;if(0!==l){l*=255;for(let t=0;t<r.width*r.height;t++){const e=4*t;a.data[e]+=l,a.data[e+1]+=l,a.data[e+2]+=l}o.putImageData(a,0,0)}else o.putImageData(a,0,0)}}).prototype.availableOptions={brightness:{type:l.NUMBER,default:0,uniformType:h.FLOAT}},(qa=class extends Wa{constructor(...t){super(...t),this._filter=new Ha}update(){this._filter.setBrightness(this._options.brightness)}}).prototype.availableOptions=Ha.prototype.availableOptions,Xa=qa})),gh=b((()=>{Ya="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_contrast;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);\n}\n"})),ph=b((()=>{_a(),gh(),_h(),(Ja=class extends Jn.Filter{constructor(){super(),this._fragmentSource=Ya}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),{contrast:l}=this._options;if(1!==l){for(let t=0;t<r.width*r.height;t++){const e=4*t;a.data[e]=(a.data[e]-127)*l+127,a.data[e+1]=(a.data[e+1]-127)*l+127,a.data[e+2]=(a.data[e+2]-127)*l+127}o.putImageData(a,0,0)}}}).prototype.availableOptions={contrast:{type:l.NUMBER,default:1,uniformType:h.FLOAT}},(Ka=class extends Wa{constructor(...t){super(...t),this._filter=new Ja}update(){this._filter.setContrast(this._options.contrast)}}).prototype.availableOptions=Ja.prototype.availableOptions,Za=Ka})),fh=b((()=>{Qa="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorMatrixOffset;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = texColor * u_colorMatrix + u_colorMatrixOffset;\n}\n"})),yh=b((()=>{_a(),fh(),_h(),({ColorMatrix:$a}=Wn),(tl=class extends Jn.Filter{constructor(){super(),this._fragmentSource=Qa}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),{colorMatrix:l}=this._options;let h=new Wt(0,0,0,0);for(let u=0;u<r.width*r.height;u++){const t=4*u;h.r=a.data[t]/255,h.g=a.data[t+1]/255,h.b=a.data[t+2]/255,h=l.apply(h),a.data[t]=255*h.r,a.data[t+1]=255*h.g,a.data[t+2]=255*h.b}o.putImageData(a,0,0)}}).prototype.availableOptions={colorMatrix:{type:l.COLOR_MATRIX,default:new $a,uniformType:h.MAT4},colorMatrixOffset:{type:l.ARRAY,default:[],uniformType:h.FLOAT4}},(el=class extends Wa{constructor(...t){super(...t),this._filter=new tl}update(){this._filter.setColorMatrix(this._options.colorMatrix)}}).prototype.availableOptions=tl.prototype.availableOptions,il=el})),xh=b((()=>{sl="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_desaturation;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec3 grayXfer = vec3(0.3, 0.59, 0.11);\n  vec3 gray = vec3(dot(grayXfer, texColor.xyz));\n  gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);\n}\n"})),bh=b((()=>{_a(),xh(),_h(),(rl=class extends Jn.Filter{constructor(){super(),this._fragmentSource=sl}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),l=[.3,.59,.11],{desaturation:h}=this._options;for(let u=0;u<r.width*r.height;u++){const t=4*u,e=l[0]*a.data[t]/255+l[1]*a.data[t+1]/255+l[2]*a.data[t+2]/255;a.data[t]+=(255*e-a.data[t])*h,a.data[t+1]+=(255*e-a.data[t+1])*h,a.data[t+2]+=(255*e-a.data[t+2])*h}o.putImageData(a,0,0)}}).prototype.availableOptions={desaturation:{type:l.NUMBER,default:1,uniformType:h.FLOAT}},(nl=class extends Wa{constructor(...t){super(...t),this._filter=new rl}update(){this._filter.setDesaturation(this._options.desaturation)}}).prototype.availableOptions=rl.prototype.availableOptions,ol=nl})),vh=b((()=>{al='precision highp float;\n\nuniform sampler2D u_image;\nuniform vec4 u_lightColor;\nuniform vec4 u_darkColor;\nuniform float u_intensity;\nvarying vec2 v_texCoord;\n\nconst float EPSILON = 0.0000001;\nconst vec3 GRAYSCALE_WEIGHTS = vec3(0.2126, 0.7152, 0.0722);\n\nvec4 duotoneKernel(vec4 sampledCol, vec4 light, vec4 dark, float intensity) {\n  vec4 color = clamp(sampledCol, 0.0, 1.0);\n  color.rgb /= max(color.a, EPSILON);\n  color = clamp(color, 0.0, 1.0); // necessary to get rid of all extended sRGB issues with OpenGL ES\n \n  // Apply intensity as "symmetric gamma"\n  if (intensity > 0.0) {\n    color.rgb = 1.0 - pow(1.0 - color.rgb, vec3(max(intensity + 1.0, EPSILON)));\n  } else {\n    color.rgb = pow(color.rgb, vec3(max(-intensity + 1.0, EPSILON)));\n  }\n \n  // Colorimetric (perceptual luminance-preserving) RGB to grayscale conversion\n  // https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale\n  float luminance = dot(GRAYSCALE_WEIGHTS, color.rgb);\n \n  // Apply DuoTone\n  vec4 duotone = mix(dark, light, clamp(luminance, 0.0, 1.0));\n  duotone.a *= color.a;\n  \n  duotone.rgb *= duotone.a;\n\n  return duotone;\n}\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = duotoneKernel(texColor, u_lightColor, u_darkColor, u_intensity);\n}'})),wh=b((()=>{_a(),vh(),_h(),(ll=class extends Jn.Filter{constructor(){super(),this._fragmentSource=al}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),{lightColor:l,darkColor:h,intensity:u}=this._options;for(let c=0;c<r.width*r.height;c++){const t=4*c,e=a.data[t]/255,i=a.data[t+1]/255,s=a.data[t+2]/255,r=a.data[t+3]/255,n=new Wt(e,i,s,r),o=this._duoToneKernel(n,l,h,u);a.data[t]=255*o.r,a.data[t+1]=255*o.g,a.data[t+2]=255*o.b,a.data[t+3]=255*o.a}o.putImageData(a,0,0)}_duoToneKernel(t,e,i,s){if(t.clone().clamp(0,1),s>0){const e=Math.max(s+1,1e-7);t.r=1-Math.pow(1-t.r,e),t.g=1-Math.pow(1-t.g,e),t.b=1-Math.pow(1-t.b,e)}else{const e=Math.max(1-s,1e-7);t.r=Math.pow(t.r,e),t.g=Math.pow(t.g,e),t.b=Math.pow(t.b,e)}const r=.2126*t.r+.7152*t.g+.0722*t.b,n=Math.min(Math.max(r,0),1),o=i.clone().mix(e,n);return o.a*=t.a,o}}).prototype.availableOptions={lightColor:{type:l.COLOR,default:Wt.RED,uniformType:h.FLOAT4},darkColor:{type:l.COLOR,default:Wt.BLACK,uniformType:h.FLOAT4},intensity:{type:l.NUMBER,default:.5,uniformType:h.FLOAT}},(hl=class extends Wa{constructor(...t){super(...t),this._filter=new ll}update(){this._filter.setLightColor(this._options.lightColor),this._filter.setDarkColor(this._options.darkColor);const t=2*this._options.intensity-1;this._filter.setIntensity(t)}}).prototype.availableOptions=ll.prototype.availableOptions,ul=hl})),Dh=b((()=>{cl="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec3 u_gamma;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec3 rgb = vec3(texColor.r, texColor.g, texColor.b);\n  rgb = pow(rgb, u_gamma);\n  gl_FragColor = vec4(rgb * texColor.a, texColor.a);;\n}\n"})),kh=b((()=>{_a(),Dh(),_h(),(dl=class extends Jn.Filter{constructor(){super(),this._fragmentSource=cl}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),{gamma:l}=this._options,h=new Float32Array(256);for(let d=0;d<256;d++)h[d]=255*Math.pow(d/255,l.r);const u=new Float32Array(256);for(let d=0;d<256;d++)u[d]=255*Math.pow(d/255,l.g);const c=new Float32Array(256);for(let d=0;d<256;d++)c[d]=255*Math.pow(d/255,l.b);for(let d=0;d<r.width*r.height;d++){const t=4*d;a.data[t]=h[a.data[t]],a.data[t+1]=u[a.data[t+1]],a.data[t+2]=c[a.data[t+2]]}o.putImageData(a,0,0)}}).prototype.availableOptions={gamma:{type:l.COLOR,default:Wt.WHITE,uniformType:h.FLOAT3}},(_l=class extends Wa{constructor(...t){super(...t),this._filter=new dl}update(){this._filter.setGamma(this._options.gamma)}}).prototype.availableOptions=dl.prototype.availableOptions,ml=_l})),Th=b((()=>{gl="varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nuniform vec3 u_color;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n\n  vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);\n  textureCoord /= 0.75;\n\n  float d = 1.0 - dot(textureCoord, textureCoord);\n  d = clamp(d, 0.2, 1.0);\n  vec3 newColor = texColor.rgb * d * u_color.rgb;\n  gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);\n}\n"})),Ch=b((()=>{_a(),Th(),_h(),(pl=class extends Jn.Filter{constructor(){super(),this._fragmentSource=gl}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),{color:l}=this._options;let h;for(let u=0;u<r.width;u++)for(let t=0;t<r.height;t++){const e=4*(r.width*t+u),i=(u/r.width-.5)/.75,s=(t/r.height-.5)/.75;h=1-(i*i+s*s),h=Math.min(Math.max(h,.1),1),a.data[e]*=h*l.r,a.data[e+1]=a.data[e+1]*(h*l.g),a.data[e+2]=a.data[e+2]*(h*l.b),a.data[e+3]=255}o.putImageData(a,0,0)}}).prototype.availableOptions={color:{type:l.COLOR,default:Wt.WHITE,uniformType:h.FLOAT3}},(fl=class extends Wa{constructor(...t){super(...t),this._filter=new pl}update(){this._filter.setColor(this._options.color)}}).prototype.availableOptions=pl.prototype.availableOptions,yl=fl})),Rh=b((()=>{xl="varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  texColor.b = texColor.g * 0.33;\n  texColor.r = texColor.r * 0.6;\n  texColor.b += texColor.r * 0.33;\n  texColor.g = texColor.g * 0.7;\n  gl_FragColor = texColor;\n}\n"})),Ih=b((()=>{_a(),Rh(),_h(),bl=class extends Jn.Filter{constructor(){super(),this._fragmentSource=xl}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height);for(let l=0;l<r.width;l++)for(let t=0;t<r.height;t++){const e=4*(r.width*t+l);a.data[e+2]=.33*a.data[e+1],a.data[e]*=.6,a.data[e+2]+=.33*a.data[e],a.data[e+1]=.7*a.data[e+1],a.data[e+3]=255}o.putImageData(a,0,0)}},vl=class extends Wa{constructor(...t){super(...t),this._filter=new bl}}})),Fh=b((()=>{wl="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nvec3 W = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float luminance = dot(texColor.rgb, W);\n  gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);\n}\n"})),Sh=b((()=>{_a(),Fh(),_h(),Dl=class extends Jn.Filter{constructor(){super(),this._fragmentSource=wl}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height);for(let l=0;l<r.width;l++)for(let t=0;t<r.height;t++){const e=4*(r.width*t+l),i=.2125*a.data[e]+.7154*a.data[e+1]+.0721*a.data[e+2];a.data[e]=i,a.data[e+1]=i,a.data[e+2]=i}o.putImageData(a,0,0)}},kl=class extends Wa{constructor(...t){super(...t),this._filter=new Dl}}})),Eh=b((()=>{Tl="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_lookupTable;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;\n  float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;\n  float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;\n\n  gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);\n}\n"})),Oh=b((()=>{_a(),Eh(),_h(),(Cl=class extends Jn.Filter{constructor(...t){super(...t),this._fragmentSource=Tl}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),l=this._options.lookupTableData;for(let h=0;h<r.width*r.height;h++){const t=4*h,e=a.data[t];a.data[t]=l[4*e];const i=a.data[t+1];a.data[t+1]=l[1+4*i];const s=a.data[t+2];a.data[t+2]=l[2+4*s]}o.putImageData(a,0,0)}}).prototype.availableOptions={lookupTable:{type:l.NUMBER,default:1,uniformType:h.INT},lookupTableData:{type:l.ARRAY,default:[]}},Rl=class extends Wa{constructor(...t){super(...t),this._filter=new Cl({lookupTable:this._options.textureGLUnit}),this._textures={},this._renderers={}}update(t){const e=t.getRenderer();e.isOfType(u.WEBGL)?this._updateWebGLTexture(t):e.isOfType(u.CANVAS)&&this._filter.setLookupTableData(this._options.data)}_updateWebGLTexture(t){if("undefined"===typeof this._options.data)throw new Error("LookupTable: No data specified.");const e=new Uint8Array(this._options.data),i=t.getRenderer(),{id:s}=i;this._renderers[s]=i,this._textures[s]||(this._textures[s]=new Jn.BaseTexture);const r=this._textures[s],n=new Jn.PixelArrayImage(256,1,e);r.setSource(n),r.setGLUnit(this._options.textureGLUnit),i.isOfType(u.WEBGL)&&i.updateTexture(r)}dispose(){super.dispose();for(const t in this._textures)this._textures[t].dispose(),delete this._textures[t];delete this._options.data}}})),Ah=b((()=>{Il="/**\n * Based off of GPUImage's LookupFilter:\n * https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageLookupFilter.m\n */\n\nvarying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_lookupTable;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float blueColor = texColor.b * 63.0;\n\n  vec2 quad1;\n  quad1.y = floor(floor(blueColor) / 8.0);\n  quad1.x = floor(blueColor) - (quad1.y * 8.0);\n\n  vec2 quad2;\n  quad2.y = floor(ceil(blueColor) / 8.0);\n  quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n\n  vec2 texCoord1;\n  texCoord1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);\n  texCoord1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);\n\n  vec2 texCoord2;\n  texCoord2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);\n  texCoord2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);\n\n  vec4 newColor1 = texture2D(u_lookupTable, texCoord1);\n  vec4 newColor2 = texture2D(u_lookupTable, texCoord2);\n\n  vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n  gl_FragColor = mix(texColor, vec4(newColor.rgb, texColor.w), texColor.a);\n}\n"})),Bh=b((()=>{_a(),Ah(),_h(),({Vector2:Fl}=Wn),3,(Sl=class extends Jn.Filter{constructor(){super(),this._precomputeQuads(),this._fragmentSource=Il}_precomputeQuads(){this._quads=[];for(let t=0;t<256;t++){const e=t/255*63,i=new Fl;i.y=.125*(0|e)|0,i.x=(0|e)-8*i.y,this._quads.push(i)}}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=this._options.lookupTableImage,l=this._createImageCanvas(a).getContext("2d"),h=n.getImageData(0,0,r.width,r.height),u=l.getImageData(0,0,a.width,a.height),c=new Fl;for(let d=0;d<r.width*r.height*4;d+=4){const t=h.data[d],e=h.data[d+1],i=h.data[d+2],s=h.data[d+3]/255,r=this._quads[i],n=64;c.x=r.x*n,c.y=r.y*n,c.x+=Math.floor(t/4),c.y+=Math.floor(e/4);const o=4*(a.width*c.y+c.x)|0;let l=u.data[o];l=t*(1-s)+l*s;let _=u.data[o+1];_=e*(1-s)+_*s;let m=u.data[o+2];m=i*(1-s)+m*s,h.data[d]=l,h.data[d+1]=_,h.data[d+2]=m}o.putImageData(h,0,0)}_createImageCanvas(t){const e=st.createCanvas();e.width=t.width,e.height=t.height;return e.getContext("2d").drawImage(t,0,0),e}}).prototype.availableOptions={lookupTable:{type:l.NUMBER,default:3,uniformType:h.INT},lookupTableImage:{type:l.IMAGE,uniformType:null}},(El=class extends Wa{constructor(...t){super(...t),this._filter=new Sl,this._textures={}}update(t){const e=t.getRenderer();e.isOfType(u.WEBGL)?this._updateWebGLTexture(t):e.isOfType(u.CANVAS)&&this._filter.setLookupTableImage(this._options.image)}_updateWebGLTexture(t){const e=t.getRenderer(),{id:i}=e;this._textures[i]||(this._textures[i]=new Jn.BaseTexture);const s=this._textures[i];s.setSource(this._options.image),s.setGLUnit(3),e.updateTexture(s)}dispose(){super.dispose();for(const t in this._textures)delete this._textures[t]}}).prototype.availableOptions={image:{type:l.IMAGE}},Ol=El})),Mh=b((()=>{Al="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_saturation;\n\nconst vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float luminance = dot(texColor.rgb, luminanceWeighting);\n\n  vec3 greyScaleColor = vec3(luminance);\n\n  gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);\n}\n"})),Ph=b((()=>{_a(),Mh(),_h(),(Bl=class extends Jn.Filter{constructor(){super(),this._fragmentSource=Al}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height),{saturation:l}=this._options;for(let h=0;h<r.width;h++)for(let t=0;t<r.height;t++){const e=4*(r.width*t+h),i=.2125*a.data[e]+.7154*a.data[e+1]+.0721*a.data[e+2];a.data[e]=i*(1-l)+a.data[e]*l,a.data[e+1]=i*(1-l)+a.data[e+1]*l,a.data[e+2]=i*(1-l)+a.data[e+2]*l}o.putImageData(a,0,0)}}).prototype.availableOptions={saturation:{type:l.NUMBER,default:0,uniformType:h.FLOAT}},(Ml=class extends Wa{constructor(...t){super(...t),this._filter=new Bl}update(){this._filter.setSaturation(this._options.saturation)}}).prototype.availableOptions=Bl.prototype.availableOptions,Pl=Ml})),Lh=b((()=>{Ll="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec3 u_color;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec4 overlayVec4 = vec4(u_color, texColor.a);\n  gl_FragColor = max(overlayVec4 * texColor.a, texColor);\n}\n"})),zh=b((()=>{_a(),Lh(),_h(),(zl=class extends Jn.Filter{constructor(){super(),this._fragmentSource=Ll}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height);for(let l=0;l<r.width;l++)for(let t=0;t<r.height;t++){const e=4*(r.width*t+l);a.data[e]=Math.max(255*this._options.color.r,a.data[e]),a.data[e+1]=Math.max(255*this._options.color.g,a.data[e+1]),a.data[e+2]=Math.max(255*this._options.color.b,a.data[e+2])}o.putImageData(a,0,0)}}).prototype.availableOptions={color:{type:l.COLOR,default:Wt.WHITE,uniformType:h.FLOAT3}},(Nl=class extends Wa{constructor(...t){super(...t),this._filter=new zl}update(){this._filter.setColor(this._options.color)}}).prototype.availableOptions=zl.prototype.availableOptions,Ul=Nl})),Nh=b((()=>{_a(),Oh(),(Gl=class extends Rl{constructor(...t){super(...t),this._options.rgbControlPoints||(this._options.rgbControlPoints={red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}),this._updateLookupTable()}_updateLookupTable(){const t=this._calculateSplineCurve(this._options.rgbControlPoints.red),e=this._calculateSplineCurve(this._options.rgbControlPoints.green),i=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(t,e,i)}_buildLookupTable(t,e,i){const s=[];for(let r=0;r<256;r++)s.push(Math.min(Math.max(r+t[r],0),255)),s.push(Math.min(Math.max(r+e[r],0),255)),s.push(Math.min(Math.max(r+i[r],0),255)),s.push(255);return s}_calculateSplineCurve(t){t=t.sort((function(t,e){return t[0]>e[0]}));const e=this._getSplineCurve(t),i=e[0];let s;if(i[0]>0)for(s=0;s<i[0];s++)e.unshift([0,0]);const r=[];for(s=0;s<e.length;s++){const t=e[s],i=[t[0],t[0]];let n=Math.sqrt(Math.pow(i[0]-t[0],2)+Math.pow(i[1]-t[1],2));i[1]>t[1]&&(n=-n),r.push(n)}return r}_getSplineCurve(t){const e=this._secondDerivative(t),i=e.length,s=[];let r;for(r=0;r<i;r++)s[r]=e[r];const n=[];for(r=0;r<i-1;r++){const e=t[r],i=t[r+1];for(let t=e[0];t<i[0];t++){const o=(t-e[0])/(i[0]-e[0]),a=1-o,l=o,h=i[0]-e[0];let u=a*e[1]+l*i[1]+h*h/6*((a*a*a-a)*s[r]+(l*l*l-l)*s[r+1]);u>255?u=255:u<0&&(u=0),n.push([t,u])}}return 255===n.length&&n.push(t[t.length-1]),n}_secondDerivative(t){const e=t.length;if(e<=0||1===e)return null;const i=[],s=[];let r,n;for(i[0]=[0,1,0],r=1;r<e-1;r++){const e=t[r-1],n=t[r],o=t[r+1];i[r]=i[r]||[],i[r][0]=(n[0]-e[0])/6,i[r][1]=(o[0]-e[0])/3,i[r][2]=(o[0]-n[0])/6,s[r]=(o[1]-n[1])/(o[0]-n[0])-(n[1]-e[1])/(n[0]-e[0])}for(s[0]=0,s[e-1]=0,i[e-1]=[0,1,0],r=1;r<e;r++)n=i[1][0]/i[r-1][1],i[r][1]-=n*i[r-1][2],i[r][0]=0,s[r]-=n*s[r-1];for(r=e-2;r>0;r--)n=i[r][2]/i[r+1][1],i[r][1]-=n*i[r+1][0],i[r][2]=0,s[r]-=n*s[r+1];const o=[];for(r=0;r<e;r++)o[r]=s[r]/i[r][1];return o}}).prototype.availableOptions={rgbControlPoints:{type:l.OBJECT},controlPoints:{type:l.ARRAY,default:[]},textureGLUnit:{type:l.NUMBER,default:1}},jl=Gl})),Uh=b((()=>{Vl="varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;\n  gray -= 0.2;\n  gray = clamp(gray, 0.0, 1.0);\n  gray += 0.15;\n  gray *= 1.4;\n  gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);\n}\n"})),Gh=b((()=>{_a(),Uh(),_h(),Wl=class extends Jn.Filter{constructor(){super(),this._fragmentSource=Vl}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),a=n.getImageData(0,0,r.width,r.height);for(let l=0;l<r.width;l++)for(let t=0;t<r.height;t++){const e=4*(r.width*t+l);let i=a.data[e]/255*.3+a.data[e+1]/255*.3+a.data[e+2]/255*.3;i-=.2,i=Math.max(0,Math.min(1,i)),i+=.15,i*=1.4,i*=255,a.data[e]=i,a.data[e+1]=i,a.data[e+2]=i}o.putImageData(a,0,0)}},Hl=class extends Wa{constructor(...t){super(...t),this._filter=new Wl}}})),jh=b((()=>{ql="precision highp float;\n\nuniform sampler2D u_image;\n\nuniform sampler2D u_lookupTable;\n\nuniform float u_resolution;     // Texture-Resolution, must be power of 2: 64, 128, 256, 512, 1024, 2048, 4096\nuniform float u_horizontalTileCount; // Horizontal Blue Tiles\nuniform float u_verticalTileCount; // Vertical Blue Tiles\n\nvarying vec2 v_texCoord;\n\nconst float EPSILON = 0.000001;\n\n// Try to get the exact pixel of the lut map image\nvec3 lutColor(int texPosX, int texPosY) {\n    return texture2D(u_lookupTable, (0.5 / u_resolution) + vec2(float(texPosX), float(texPosY)) / u_resolution).rgb;\n}\n\nvec3 bilinearInterpolate(vec3 cRfGf, vec3 cRfGc, vec3 cRcGf, vec3 cRcGc, float redFract, float greenFract) {\n    return mix(mix(cRfGf, cRcGf, redFract), mix(cRfGc, cRcGc, redFract), greenFract);\n}\n\nvoid main() {\n    vec4 inputColor = clamp(texture2D(u_image, v_texCoord.xy), 0.0, 1.0);\n\n    vec3 sourceColor = vec3(inputColor.rgb / max(inputColor.a, EPSILON)); \n\n    vec3 ranges = vec3(\n        floor(u_resolution / u_horizontalTileCount - 1.0),\n        floor(u_resolution / u_verticalTileCount - 1.0),\n        floor(u_horizontalTileCount * u_horizontalTileCount - 1.0)\n    );\n    \n    vec3 tmp = sourceColor * ranges;\n    ivec3 floors = ivec3(tmp);\n    ivec3 ceils = ivec3(ceil(tmp));\n    vec3 fracts = fract(tmp);\n\n    // Map tile index to tile pixel pos.\n    ivec2 pixelsPerTile = ivec2(\n        u_resolution / u_horizontalTileCount, \n        u_resolution / u_verticalTileCount\n      );\n\n    ivec2 tileFloor; // Blue tile index\n    tileFloor.y = floors.z / int(u_horizontalTileCount);\n    tileFloor.x = (floors.z - (tileFloor.y * int(u_horizontalTileCount)));\n\n    ivec2 tileCeil; // Blue tile index\n    tileCeil.y = ceils.z / int(u_horizontalTileCount);\n    tileCeil.x = (ceils.z - (tileCeil.y * int(u_horizontalTileCount)));\n    \n    tileFloor *= pixelsPerTile;\n    tileCeil *= pixelsPerTile; \n    \n    \n    // Interpolate between red and green\n    vec3 lutColorFB = bilinearInterpolate(\n        lutColor(tileFloor.x + floors.x, tileFloor.y + floors.y),\n        lutColor(tileFloor.x + floors.x, tileFloor.y + ceils.y),\n        lutColor(tileFloor.x + ceils.x,  tileFloor.y + floors.y),\n        lutColor(tileFloor.x + ceils.x,  tileFloor.y + ceils.y),\n        fracts.x, fracts.y\n    );\n    vec3 lutColorCB = bilinearInterpolate(\n        lutColor(tileCeil.x + floors.x, tileCeil.y + floors.y),\n        lutColor(tileCeil.x + floors.x, tileCeil.y + ceils.y),\n        lutColor(tileCeil.x + ceils.x,  tileCeil.y + floors.y),\n        lutColor(tileCeil.x + ceils.x,  tileCeil.y + ceils.y),\n        fracts.x, fracts.y\n    );\n\n    // Interpolate between the blue values\n    vec3 interpolation = mix(lutColorFB, lutColorCB, fracts.z);\n\n    // Round Color Values to prevent that for ex. 254.999999 is cutting to 254 instead of 255;\n    interpolation = clamp(floor(interpolation * 255. + .5) / 255., 0.0, 1.0);\n\n    gl_FragColor = vec4(interpolation.rgb * inputColor.a, inputColor.a);\n}\n"})),Vh=b((()=>{_a(),jh(),_h(),({Vector2:Xl,Vector3:Yl}=Wn),3,(Jl=class extends Jn.Filter{constructor(){super(),this._precomputeQuads(),this._fragmentSource=ql}_precomputeQuads(){this._quads=[];for(let t=0;t<256;t++){const e=t/255*63,i=new Xl;i.y=.125*(0|e)|0,i.x=(0|e)-8*i.y,this._quads.push(i)}}_applyCanvas(t,e,i,s=!1){const{resolution:r,horizontalTileCount:n,verticalTileCount:o}=this._options,a=e.getCanvas(),l=e.getContext(),h=i.getContext(),u=this._options.lookupTableImage,c=this._createImageCanvas(u).getContext("2d");let d={width:128,height:128};r?d={width:r,height:r}:u.width&&u.height&&(d={width:u.width,height:u.height});const _=l.getImageData(0,0,a.width,a.height),m=c.getImageData(0,0,d.width,d.height),g=new Yl(d.width/n-1|0,d.height/o-1|0,n*o-1|0),p=new Wt,f=new Wt,y=new Wt,x=new Wt,b=new Wt,v=new Wt,w=new Wt,D=new Wt,k=new Xl,T=new Xl,C=(t,e,i,s)=>{t.r=e.r*(1-s)+i.r*s,t.g=e.g*(1-s)+i.g*s,t.b=e.b*(1-s)+i.b*s},R=(t,e,i)=>{e=.5+e|0;const s=4*((i=.5+i|0)*d.width+e);t.r=m.data[s]/255,t.g=m.data[s+1]/255,t.b=m.data[s+2]/255,t.a=m.data[s+3]/255},I=new Wt,F=new Wt,S=(t,e,i,s,r,n,o)=>{C(I,e,s,n),C(F,i,r,n),C(t,I,F,o)},E=new Xl(d.width,d.height).divide(n,o).floor();for(let O=0;O<a.width*a.height*4;O+=4){p.set(_.data[O]/255,_.data[O+1]/255,_.data[O+2]/255,_.data[O+3]/255);const t=new Yl(p.r*g.x,p.g*g.y,p.b*g.z),e=t.clone().floor().toInt(),i=t.clone().ceil().toInt(),s=t.clone().fract();k.y=e.z/n|0,k.x=e.z-k.y*n|0,T.y=i.z/n|0,T.x=i.z-T.y*n|0,k.multiply(E),T.multiply(E),R(b,k.x+e.x,k.y+e.y),R(v,k.x+e.x,k.y+i.y),R(w,k.x+i.x,k.y+e.y),R(D,k.x+i.x,k.y+i.y),S(y,b,v,w,D,s.x,s.y),R(b,T.x+e.x,T.y+e.y),R(v,T.x+e.x,T.y+i.y),R(w,T.x+i.x,T.y+e.y),R(D,T.x+i.x,T.y+i.y),S(x,b,v,w,D,s.x,s.y),C(f,y,x,s.z),_.data[O]=Math.ceil(255*f.r),_.data[O+1]=Math.ceil(255*f.g),_.data[O+2]=Math.ceil(255*f.b)}h.putImageData(_,0,0)}_createImageCanvas(t){const e=st.createCanvas();e.width=t.width,e.height=t.height;return e.getContext("2d").drawImage(t,0,0),e}}).prototype.availableOptions={lookupTable:{type:l.NUMBER,default:3,uniformType:h.INT},lookupTableImage:{type:l.IMAGE,uniformType:null},resolution:{type:l.NUMBER,uniformType:h.FLOAT},horizontalTileCount:{type:l.NUMBER,default:5,uniformType:h.FLOAT},verticalTileCount:{type:l.NUMBER,default:5,uniformType:h.FLOAT}},(Kl=class extends Wa{constructor(...t){super(...t),this._filter=new Jl,this._textures={}}update(t){const e=t.getRenderer();e.isOfType(u.WEBGL)?this._updateWebGLTexture(t):e.isOfType(u.CANVAS)&&this._filter.setLookupTableImage(this._options.image);const{resolution:i,verticalTileCount:s,horizontalTileCount:r,image:n}=this._options;this._filter.set({resolution:i||n.width,verticalTileCount:s,horizontalTileCount:r})}_updateWebGLTexture(t){const e=t.getRenderer(),{id:i}=e;this._textures[i]||(this._textures[i]=new Jn.BaseTexture);const s=this._textures[i];s.setSource(this._options.image),s.setGLUnit(3),s.setMinFilter(Jn.BaseTexture.NearestFilter),e.updateTexture(s)}dispose(){super.dispose();for(const t in this._textures)delete this._textures[t]}}).prototype.availableOptions={image:{type:l.IMAGE},resolution:{type:l.NUMBER},horizontalTileCount:{type:l.NUMBER,default:5},verticalTileCount:{type:l.NUMBER,default:5}},Zl=Kl})),Wh={};w(Wh,{Brightness:()=>Xa,ColorMatrixPrimitive:()=>il,Contrast:()=>Za,Desaturation:()=>ol,DuoTone:()=>ul,Gamma:()=>ml,Glow:()=>yl,Gobblin:()=>vl,Grayscale:()=>kl,LookupTable:()=>Rl,LookupTableImage:()=>Ol,Saturation:()=>Pl,SoftColorOverlay:()=>Ul,ThreeDLookupTableImage:()=>Zl,ToneCurve:()=>jl,X400:()=>Hl});var Hh,qh,Xh,Yh,Jh,Kh,Zh,Qh,$h,tu,eu,iu,su,ru,nu,ou,au,lu,hu,uu,cu,du,_u,mu,gu,pu,fu,yu,xu,bu,vu,wu,Du,ku,Tu,Cu,Ru,Iu,Fu,Su,Eu,Ou,Au,Bu,Mu,Pu,Lu,zu,Nu,Uu,Gu,ju,Vu,Wu,Hu,qu,Xu,Yu,Ju,Ku,Zu,Qu,$u,tc,ec,ic,sc,rc=b((()=>{mh(),ph(),yh(),bh(),wh(),kh(),Ch(),Ih(),Sh(),Oh(),Bh(),Ph(),zh(),Nh(),Gh(),Vh()})),nc=b((()=>{ch(),rc(),(Hh=class extends ja{constructor(...t){super(...t),this._stack.push(new Xa({brightness:0}))}render(t,e,i){return this._stack.isEmpty()&&this._stack.push(new Xa({brightness:0})),super.render(t,e,i)}}).isIdentity=!0,Hh.identifier="identity",qh=Hh})),oc=b((()=>{ch(),rc(),(Xh=class extends ja{constructor(...t){super(...t),this._stack.push(new Za({contrast:.63})),this._stack.push(new Xa({brightness:.12})),this._stack.push(new jl({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}))}}).identifier="a15",Yh=Xh})),ac=b((()=>{ch(),rc(),(Jh=class extends ja{constructor(...t){super(...t),this._stack.push(new ol({desaturation:.5})),this._stack.push(new jl({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}))}}).identifier="breeze",Kh=Jh})),lc=b((()=>{ch(),rc(),(Zh=class extends ja{constructor(...t){super(...t),this._stack.push(new kl)}}).identifier="bw",Qh=Zh})),hc=b((()=>{ch(),rc(),($h=class extends ja{constructor(...t){super(...t),this._stack.push(new kl),this._stack.push(new Za({contrast:1.5}))}}).identifier="bwhard",tu=$h})),uc=b((()=>{ch(),rc(),(eu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}))}}).identifier="celsius",iu=eu})),cc=b((()=>{ch(),rc(),(su=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}))}}).identifier="chest",ru=su})),dc=b((()=>{_a(),ch(),rc(),(nu=class extends ja{constructor(...t){super(...t,{intensity:{type:l.NUMBER,default:.5,required:!0,setter(t){return this._filterPrimitive&&(this._filterPrimitive.setIntensity(t),this._stack.setIntensity(1)),this._dirty=!0,t}}}),this._filterPrimitive=new ul({lightColor:this._options.lightColor||Wt.WHITE,darkColor:this._options.darkColor||Wt.BLACK,intensity:this._options.intensity||.5}),this._stack.push(this._filterPrimitive)}}).prototype.availableOptions={lightColor:{type:l.COLOR,default:Wt.WHITE,required:!0,setter(t){return this._filterPrimitive&&this._filterPrimitive.setLightColor(t),this.setDirty&&this.setDirty(!0),t}},darkColor:{type:l.COLOR,default:Wt.BLACK,required:!0,setter(t){return this._filterPrimitive&&this._filterPrimitive.setDarkColor(t),this.setDirty&&this.setDirty(!0),t}},intensity:{type:l.NUMBER,default:.5,required:!0}},nu.identifier="duotone",ou=nu})),_c=b((()=>{ch(),rc(),(au=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}))}}).identifier="fixie",lu=au})),mc=b((()=>{ch(),rc(),(hu=class extends ja{constructor(...t){super(...t),this._stack.push(new Pl({saturation:1.35})),this._stack.push(new Za({contrast:1.1}))}}).identifier="food",uu=hu})),gc=b((()=>{ch(),rc(),(cu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}))}}).identifier="fridge",du=cu})),pc=b((()=>{ch(),rc(),(_u=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}))}}).identifier="front",mu=_u})),fc=b((()=>{ch(),rc(),(gu=class extends ja{constructor(...t){super(...t),this._stack.push(new Za({contrast:1.1})),this._stack.push(new jl({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}))}}).identifier="glam",pu=gu})),yc=b((()=>{ch(),rc(),(fu=class extends ja{constructor(...t){super(...t),this._stack.push(new vl)}}).identifier="gobblin",yu=fu})),xc=b((()=>{ch(),rc(),(xu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]})),this._stack.push(new Pl({saturation:.9}))}}).identifier="k1",bu=xu})),bc=b((()=>{_a(),ch(),rc(),(vu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]})),this._stack.push(new Ul({color:new Wt(40/255,40/255,40/255)}))}}).identifier="k2",wu=vu})),vc=b((()=>{ch(),rc(),(Du=class extends ja{constructor(...t){super(...t),this._stack.push(new Pl({saturation:.5}))}}).identifier="k6",ku=Du})),wc=b((()=>{ch(),rc(),(Tu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]})),this._stack.push(new Pl({saturation:.7}))}}).identifier="kdynamic",Cu=Tu})),Dc=b((()=>{ch(),rc(),(Ru=class extends ja{constructor(...t){super(...t),this._stack.push(new ol({desaturation:.4})),this._stack.push(new jl({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}))}}).identifier="lenin",Iu=Ru})),kc=b((()=>{ch(),rc(),(Fu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}))}}).identifier="lomo",Su=Fu})),Tc=b((()=>{ch(),rc(),(Eu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}))}}).identifier="mellow",Ou=Eu})),Cc=b((()=>{_a(),ch(),rc(),({ColorMatrix:Au}=Wn),(Bu=class extends ja{constructor(...t){super(...t);const e=new Au(.8158218291630716,0,0,0,-.01779810181190647,0,.8098360655737704,0,0,.0916393442622953,0,0,.4596336773932402,0,.12760574782432707,0,0,0,1,0);this._stack.push(new il({colorMatrix:e}));const i=new Wt(.8,.6,.9);this._stack.push(new ml({gamma:i}))}}).identifier="metal",Mu=Bu})),Rc=b((()=>{ch(),rc(),(Pu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}})),this._stack.push(new yl)}}).identifier="morning",Lu=Pu})),Ic=b((()=>{ch(),rc(),(zu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]},textureGLUnit:2})),this._stack.push(new jl({controlPoints:[[0,0],[117,151],[189,217],[255,255]],textureGLUnit:3})),this._stack.push(new ol({desaturation:.65}))}}).identifier="orchid",Nu=zu})),Fc=b((()=>{ch(),rc(),(Uu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}})),this._stack.push(new Pl({saturation:.8})),this._stack.push(new Za({contrast:1.5}))}}).identifier="pola",Gu=Uu})),Sc=b((()=>{ch(),rc(),(ju=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}})),this._stack.push(new Pl({saturation:.8})),this._stack.push(new Za({contrast:1.5}))}}).identifier="pola669",Vu=ju})),Ec=b((()=>{ch(),rc(),(Wu=class extends ja{constructor(...t){super(...t),this._stack.push(new ol({desaturation:.65})),this._stack.push(new jl({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}))}}).identifier="quozi",Hu=Wu})),Oc=b((()=>{ch(),rc(),(qu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}})),this._stack.push(new yl)}}).identifier="semired",Xu=qu})),Ac=b((()=>{ch(),rc(),(Yu=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]},textureGLUnit:2})),this._stack.push(new jl({controlPoints:[[0,0],[55,20],[158,191],[255,255]],textureGLUnit:3}))}}).identifier="sunny",Ju=Yu})),Bc=b((()=>{ch(),rc(),(Ku=class extends ja{constructor(...t){super(...t),this._stack.push(new jl({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}))}}).identifier="texas",Zu=Ku})),Mc=b((()=>{ch(),rc(),(Qu=class extends ja{constructor(...t){super(...t),this._stack.push(new Hl)}}).identifier="x400",$u=Qu})),Pc=b((()=>{_a(),ch(),rc(),(tc=class extends ja{constructor(...t){super(...t),this._lutPrimitive=new Ol({image:this._options.image}),this._stack.push(this._lutPrimitive)}}).prototype.availableOptions={image:{type:l.IMAGE,required:!0,setter(t){return this._lutPrimitive&&this._lutPrimitive.setImage(t),this.setDirty(!0),t}}},tc.identifier="lut",ec=tc})),Lc=b((()=>{_a(),ch(),rc(),(ic=class extends ja{constructor(...t){super(...t);const{image:e,resolution:i,verticalTileCount:s,horizontalTileCount:r}=this._options;this._lutPrimitive=new Zl({image:e,resolution:i,verticalTileCount:s,horizontalTileCount:r}),this._stack.push(this._lutPrimitive)}}).prototype.availableOptions={image:{type:l.IMAGE,required:!0,setter(t){return this._lutPrimitive&&this._lutPrimitive.setImage(t),this.setDirty(!0),t}},resolution:{type:l.NUMBER},horizontalTileCount:{type:l.NUMBER,default:5},verticalTileCount:{type:l.NUMBER,default:5}},ic.identifier="3d-lut",sc=ic})),zc={};w(zc,{A15Filter:()=>Yh,BWFilter:()=>Qh,BWHardFilter:()=>tu,BreezeFilter:()=>Kh,CelsiusFilter:()=>iu,ChestFilter:()=>ru,DuoToneFilter:()=>ou,FixieFilter:()=>lu,FoodFilter:()=>uu,FridgeFilter:()=>du,FrontFilter:()=>mu,GlamFilter:()=>pu,GobblinFilter:()=>yu,IdentityFilter:()=>qh,K1Filter:()=>bu,K2Filter:()=>wu,K6Filter:()=>ku,KDynamicFilter:()=>Cu,LUTFilter:()=>ec,LeninFilter:()=>Iu,LomoFilter:()=>Su,MellowFilter:()=>Ou,MetalFilter:()=>Mu,MorningFilter:()=>Lu,OrchidFilter:()=>Nu,Pola669Filter:()=>Vu,PolaFilter:()=>Gu,QuoziFilter:()=>Hu,SemiredFilter:()=>Xu,SunnyFilter:()=>Ju,TexasFilter:()=>Zu,ThreeDLUTFilter:()=>sc,X400Filter:()=>$u});var Nc,Uc,Gc,jc,Vc,Wc,Hc,qc,Xc,Yc,Jc,Kc,Zc,Qc,$c,td,ed,id,sd,rd,nd,od,ad,ld,hd,ud,cd,dd,_d,md,gd,pd,fd,yd,xd,bd,vd,wd,Dd,kd,Td,Cd,Rd,Id,Fd,Sd,Ed,Od,Ad,Bd,Md,Pd,Ld,zd,Nd,Ud,Gd,jd,Vd,Wd,Hd,qd,Xd,Yd,Jd,Kd,Zd,Qd,$d,t_,e_,i_,s_,r_,n_,o_,a_,l_,h_,u_,c_,d_,__,m_,g_,p_,f_,y_,x_,b_,v_,w_,D_,k_,T_,C_,R_,I_,F_,S_,E_,O_,A_,B_,M_,P_,L_,z_,N_,U_,G_,j_,V_,W_,H_,q_,X_,Y_,J_,K_,Z_,Q_,$_,tm,em,im,sm,rm,nm,om,am,lm,hm,um,cm,dm,_m,mm,gm,pm,fm,ym,xm,bm,vm,wm,Dm,km,Tm,Cm,Rm,Im,Fm,Sm,Em,Om,Am,Bm,Mm,Pm,Lm,zm,Nm,Um,Gm,jm,Vm,Wm,Hm,qm,Xm,Ym,Jm,Km,Zm,Qm,$m,tg,eg,ig,sg,rg,ng,og=b((()=>{nc(),oc(),ac(),lc(),hc(),uc(),cc(),dc(),_c(),mc(),gc(),pc(),fc(),yc(),xc(),bc(),vc(),wc(),Dc(),kc(),Tc(),Cc(),Rc(),Ic(),Fc(),Sc(),Ec(),Oc(),Ac(),Bc(),Mc(),Pc(),Lc()})),ag=b((()=>{_a(),og(),ch(),nc(),rc(),(Nc=class extends yo{_render(t){return this._selectedFilter.render(this._sdk,t,this._renderTexture)}render(t){return this._selectedFilter.getDirty()&&this.setDirty(!0),this.getEnabled()?super.render(t):(this.setDirtyForRenderer(!1,this._sdk.getRenderer()),Promise.resolve(t))}setDirtyForRenderer(t,e){super.setDirtyForRenderer(t,e),this._selectedFilter.setDirtyForRenderer(t,e)}disposeRenderTextures(){super.disposeRenderTextures(),this._selectedFilter&&this._selectedFilter.disposeRenderTextures()}dispose(){super.dispose(),this._selectedFilter&&this._selectedFilter.dispose()}restoreSnapshot(t){const e={...t};if(delete e.filter,t.filter){const e=t.filter.constructor;"3d-lut"===e.identifier?this.setFilter(new e({image:t.filter.getImage(),resolution:t.filter.getResolution(),horizontalTileCount:t.filter.getHorizontalTileCount(),verticalTileCount:t.filter.getVerticalTileCount()})):"duotone"===e.identifier?this.setFilter(new e({lightColor:t.filter.getLightColor(),darkColor:t.filter.getDarkColor(),intensity:t.filter.getIntensity()})):this.setFilter(new e)}this.set(e)}resetToDefaultFilterIntensity(){const t=this._selectedFilter&&this._selectedFilter.availableOptions,e=t&&t.intensity.default;this.setIntensity(e||1)}}).identifier="filter",Nc.prototype.availableOptions={identifier:{type:l.STRING,default:"identity"},intensity:{type:l.NUMBER,default:1,setter(t){return this._selectedFilter&&this._selectedFilter.setIntensity(t),t}},filter:{type:l.OBJECT,default:new qh,setter(t){return this._selectedFilter&&(this._selectedFilter.dispose(),this._selectedFilter=null),this._selectedFilter=t,"undefined"!==typeof this._options.intensity&&this._selectedFilter.set({intensity:this._options.intensity}),t}}},Nc.FilterPrimitives=Wh,Nc.Filters=zc,Nc.Filter=ja,ia.Operations.FilterOperation=Nc,Uc=Nc})),lg=b((()=>{_a(),(Gc=class extends yo{constructor(...t){super(...t),this._flipContainer=new Jn.Container}_render(t){const{outputResolution:e,flipHorizontally:i,flipVertically:s}=this._options;if(i||s){const e=t.getDimensions();this._flipRenderTexture?this._flipRenderTexture.resizeTo(e):(this._flipRenderTexture=new Jn.RenderTexture(this._sdk.getRenderer(),e.x,e.y),this._flipSprite=new Jn.Sprite(this._flipRenderTexture),this._flipContainer.addChild(this._flipSprite));const r=i?-1:1,n=s?-1:1;this._flipSprite.setScale(r,n),this._flipSprite.setPivot(0,0),this._flipSprite.setPosition(e.x*(1-r)*.5,e.y*(1-n)*.5),this._flipRenderTexture.clear(),this._flipRenderTexture.render(this._container),this._renderTexture.render(this._flipContainer)}else this._renderTexture.render(this._container);return Promise.resolve()}}).identifier="flip",Gc.prototype.availableOptions={flipHorizontally:{type:l.BOOLEAN,default:!1},flipVertically:{type:l.BOOLEAN,default:!1}},ia.Operations.FlipOperation=Gc,jc=Gc})),hg=b((()=>{_a(),({Vector2:Vc}=Wn),(Wc=class extends yo{constructor(...t){super(...t),this._colorOverlayFilter=new Jn.Filters.ColorOverlayFilter({color:this.getTintColor()}),this._frameContainer=new Jn.Container,this._resetSprites(),this._options.frame&&this._createSpritesForFrame(this._options.frame)}_resetSprites(){this._spriteGroups={top:{},left:{},right:{},bottom:{}},this._sprites=[],this._repeatSprites={top:[],left:[],right:[],bottom:[]}}_createSpritesForFrame(t){if(!t)return this._disposeSprites();const{imageGroups:e,layoutMode:i}=t;this._layoutMode=i||"horizontal-inside",this._disposeSprites(),["top","left","right","bottom"].forEach((t=>{"undefined"!==typeof e[t]&&["start","mid","end"].forEach((i=>{if("undefined"===typeof e[t][i])return;let s=e[t][i];"image"in s&&(s=s.image);const r=Jn.Texture.fromImage(s),n=new Jn.Sprite(r);this._spriteGroups[t][i]=n,this._sprites.push(n),this._frameContainer.addChild(n)}))}))}_render(t){const e=this._renderTexture.getDimensions();return this._options.frame&&(this._colorOverlayFilter.setColor(this.getTintColor()),this._updateSprites(t)),this._frameRenderTexture?this._frameRenderTexture.resizeTo(e):(this._frameRenderTexture=new Jn.RenderTexture(this._sdk.getRenderer(),e.x,e.y),this._frameSprite=new Jn.Sprite(this._frameRenderTexture),this._container.addChild(this._frameSprite)),this._frameSprite.setAlpha(this._options.alpha),this._options.frame&&this._options.frame.tintable?this._frameSprite.setFilters([this._colorOverlayFilter]):this._frameSprite.setFilters([]),this._frameRenderTexture.clear(),this._frameRenderTexture.render(this._frameContainer),this._renderTexture.render(this._container),Promise.resolve()}_updateSprites(t){const e=t.getDimensions();this._frameWidth=Math.ceil(t.getDimensions().min()*this._options.scale),this._updateHorizontalSpriteGroup(t,"top",0),this._updateHorizontalSpriteGroup(t,"bottom",e.y-this._frameWidth),this._updateVerticalSpriteGroup(t,"left",0),this._updateVerticalSpriteGroup(t,"right",e.x-this._frameWidth)}_updateHorizontalSpriteGroup(t,e,i=0){const s=t.getDimensions(),r="vertical-inside"===this._layoutMode,n=this._spriteGroups[e].start,o=this._spriteGroups[e].mid,a=this._spriteGroups[e].end;let l,h,u=0,c=0;if(n){l=n.getTexture().getDimensions(),h=l.y/l.x,u=Math.floor(this._frameWidth/h);const t=new Vc(0,i);t.x=r?this._frameWidth:0,n.setPosition(t),n.setHeight(this._frameWidth),n.setWidth(u)}if(a){l=a.getTexture().getDimensions(),h=l.y/l.x,c=Math.floor(this._frameWidth*h);const t=new Vc(s.x-c,i);t.x-=r?this._frameWidth:0,a.setPosition(t),a.setHeight(this._frameWidth),a.setWidth(c)}if(o){l=o.getTexture().getDimensions(),h=l.y/l.x;const t=new Vc(u,i);let n=s.x-u-c;if(r&&(t.x+=this._frameWidth,n-=2*this._frameWidth),o.setPosition(t),o.setWidth(n),o.setHeight(this._frameWidth),"repeat"===this._options.frame.imageGroups[e].mid.mode){const i=this._frameWidth/h,s=Math.ceil(n/i);let r=0;if(-1!==s){let i=Math.round(n/s);o.setWidth(i),r+=i,this._ensureRepeatSpritesExist(s-1,e,o);for(let o=0;o<s-1;o++){i=Math.round((n-r)/(s-o-1));const a=this._repeatSprites[e][o],l=t.clone().add(r,0).floor();a.setPosition(l),a.setWidth(i),a.setHeight(this._frameWidth),r+=i}}}}}_ensureRepeatSpritesExist(t,e,i){i.getTexture().setMaxListeners(t+1);const s=this._repeatSprites[e].length;if(t>s){const r=t-s;for(let t=0;t<r;t++){const t=new Jn.Sprite(i.getTexture());this._repeatSprites[e].push(t),this._frameContainer.addChild(t),this._sprites.push(t)}}else if(t<s){this._repeatSprites[e].splice(t).forEach((t=>{const e=this._sprites.indexOf(t);-1!==e&&(this._sprites.splice(e,1),this._frameContainer.removeChild(t),t.dispose())}))}}_updateVerticalSpriteGroup(t,e,i=0){const s=t.getDimensions(),r="horizontal-inside"===this._layoutMode,n=this._spriteGroups[e].start,o=this._spriteGroups[e].mid,a=this._spriteGroups[e].end;let l,h,u=0,c=0;if(n){l=n.getTexture().getDimensions(),h=l.y/l.x,u=Math.floor(this._frameWidth*h);const t=new Vc(i,0);t.y=r?this._frameWidth:0,n.setPosition(t),n.setWidth(this._frameWidth),n.setHeight(u)}if(a){l=a.getTexture().getDimensions(),h=l.y/l.x,c=Math.floor(this._frameWidth*h);const t=new Vc(i,s.y-c);t.y-=r?this._frameWidth:0,a.setPosition(t),a.setWidth(this._frameWidth),a.setHeight(c)}if(o){l=o.getTexture().getDimensions(),h=l.y/l.x;const t=new Vc(i,u);let n=s.y-u-c;if(r&&(t.y+=this._frameWidth,n-=2*this._frameWidth),o.setPosition(t),o.setHeight(n),o.setWidth(this._frameWidth),"repeat"===this._options.frame.imageGroups[e].mid.mode){const i=this._frameWidth*h,s=Math.ceil(n/i);let r=0;if(-1!==s){let i=Math.round(n/s);o.setHeight(i),r+=i,this._ensureRepeatSpritesExist(s-1,e,o);for(let o=0;o<s-1;o++){i=Math.round((n-r)/(s-o-1));const a=this._repeatSprites[e][o],l=t.clone().add(0,r).floor();a.setPosition(l),a.setHeight(i),a.setWidth(this._frameWidth),r+=i}}}}}_disposeSprites(){this._sprites.forEach((t=>{this._frameContainer.removeChild(t),t.getTexture().dispose(),t.dispose()})),this._resetSprites()}dispose(){super.dispose(),this._disposeSprites(),this._colorOverlayFilter&&this._colorOverlayFilter.dispose(),this._frameRenderTexture&&this._frameRenderTexture.dispose()}static validateFrame(t){if(!t)return;const{imageGroups:e,layoutMode:i}=t;if("string"!==typeof t.identifier)throw new Error("Frame needs a property `identifier` of type String.");if("object"!==typeof t.imageGroups)throw new Error("Frame needs a property `imageGroups` of type Object.");const s=t=>{const{start:i,end:s,mid:r}=e[t];if("undefined"!==typeof e[t]){if("object"!==typeof e[t])throw new Error(`Frame: \`imageGroups.${t}\` needs to be of type Object.`);if("undefined"!==typeof i&&!(i instanceof co||"undefined"!==typeof HTMLImageElement&&i instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${t}.start\` needs to be of type Image.`);if("undefined"!==typeof r&&!(i instanceof co||"undefined"!==typeof HTMLImageElement&&i instanceof HTMLImageElement)&&"object"!==typeof r)throw new Error(`Frame: \`imageGroups.${t}.mid\` needs to be of type Image or Object.`);if("undefined"!==typeof s&&!(s instanceof co||"undefined"!==typeof HTMLImageElement&&s instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${t}.end\` needs to be of type Image.`)}};if("undefined"!==typeof i&&-1===["vertical-inside","horizontal-inside"].indexOf(i))throw new Error("Frame: `layoutMode` must be one of vertical-inside, horizontal-inside");if("undefined"!==typeof tintable&&"boolean"!==typeof tintable)throw new Error("Frame: `tintable` needs to be of type Boolean.");s("top"),s("left"),s("right"),s("bottom")}}).identifier="frame",Wc.prototype.availableOptions={frame:{type:l.OBJECT,validation:Wc.validateFrame,setter(t,e){return e||this._createSpritesForFrame(t),t},default:null},alpha:{type:l.NUMBER,default:1},tintColor:{type:l.COLOR,default:new Wt(1,1,1,0)},scale:{type:l.NUMBER,default:.1}},ia.Operations.FrameOperation=Wc,Hc=Wc})),ug=b((()=>{qc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAAAAADRE4smAAAsTElEQVR4Ae1d4bHjOM5ECAgBISgEZLDOwMrAysDMwMpAzkCTAUNQCAyBIfCr2ifI1DNh+c1tfTMg3b9udtZXC7tJdgMgCP8foJAUBIJx92eoEy5puAKkHH1jX0AchqoJcLwGlv1fDVAnyKtfQMoB1WLQKBBCyuCgVvQhvQGoF3RPb2Bs/AsgEDS6BqbGvwACaHsT+AV1AK/4W18AQy3gCxTAR2vAQxW4xHSD3/kC/qlI9NK7hqg6H8SLspiPv4C+kv0v6ouZQuUEEMfndUtcOQH6qJ9nR2sg1kD+FSdQ4GLS4MA82B+uZvJJRQXkFwT8uRp2VQl99xuGiOyTX4//+AuYqtj/BBGPiVITATjtEel4pdRFAJ/2uP08K9KBYXwPaT5OC9Vlg/kneQ0cUwHcQvz6F7BAXVuA/3GNsG8ofqBQmw3uUg7dCglcZQSgJHizvO1qy4OM3wPCH64BV1fnR8QfdkqAcWD86Q86KP9+o/EjGMfwrhVSpPPUWvy9YoMbsEIqAVrSgXBSCFC3FdK/sV+txc/Kv93OEpgrawiYfybsSWkIaMcK3SurB1P8Ufyk2OB2rNCoEKCV+BW2tGOFXG2N0RiUkkgZUfmumrFCfW0EgNOPKlxB6YtvQAcqRrix+BfFBjdjhVgnQL3xk+cyWwYQVG6FLjOs6PTjotaSCF5T8iUXJLSo3gqxT4kLPig6BKheB1/+/dvzEwGi/KParSDN+arAtMFTA/Gz3+8KTiF/tVZoaxx034zwwlAPvsc/7cifx+8U8tdqhfqwXxVihOMAgnp1sJA/lzu9Tv4KrRD7fFVki2VE+IuB3anvT0z/Y/x9KBRKexPkJ+77njv835YA3kvuaPm79z+6zDGtiP5Mv1sSObMv7gr8l5MfkMclCZaJf9sK0TUWd4U58N8b/NWnb5jo9+KPShM4EvzN4DGmPcL5p1ZIgVghhr8VNBZjuP4P8Rsr/fReGW72UyukIKDJeRYz/rQkoiAYHWkSTz+2QgrOVq657bG8xYAlHWBEQzcdf+OH43SAcPp7o3/N3un34zeS98Vbeonu51ZIYCHve/tPhvl4e+QXdP/JMB9KOkRN/42gJf0ni5eiNfILzjH9J4t3NLn/0QH737etzhj5Bdf0GhP9XlXMRt2Lwu+TX4/fUtH3+t+Jl0H/Co3+/hPmQomPjJQV8iu//9Hi5fk3rJAnU3VMnfyXeJzI8HbIL7i8vf+RT8m9a4WsFH3vzzFPzo3LM/mXlN6P3wT5NeXqJ+fmIP/9+0xJfHsJ2Cj69tqap/BE/lILG49z8CMXCGWl6Bu0Ne/2//19LDa942lalvlMZUKNaOBhA0Xw4578xZQQzvJT0y5+Qx0PFz1b2ZXThFxMoF0LVsh3IDCSALqjPg1QwEX6hC1Wp5DfxAqIp+MyiS/rx+m7FQps7l7j+E6O3Jf1Y8DdPxXy23IAsXunTHIqH6BD/k/lJDGlABaN/Epd5FpuBD5ZIL8gHJd8TkGr6VIoN8J6cc/Gwqf3aoRz+dMRBLNDm62c03s1wshlBe0en2GLQ84mhfyaTOQKZl7e9RWg1ggnVO4D/TJ+q5UV8mstLX0Fjz/E1wW/Uo/EoGb9gu1O5vhWgTzqBGAwAER9C3RKj4SqlIO5sacEpPNfJ38OBstHAIdJlwD/vDXk3wNYPQLwFmHO/6wE9rKwPWilv2DkcRNWy9esng45olr9PhuYbQ+JtQ3Qq4VdTSo6S+FvZ5pXNSC/1+NL2ZdkpuNXDjTI42f9BNPj90ohMRh42UyYqhRuemUJ6GJ3MLMC5ECDlAaFAPG9MnEoN9IFMvCymaxUhQCjniXL0ZeXiTPR8Qqi449nNnL5ik8oCqURDb1l7RQCeM0kRX2jGIKBxP8lJgHk8XdpB1eO32F8ofV49H6+oKWXfVIkpRkCi0sgcP/qpOhn7ye2sfmlBLmKobK8FbB0RATbo037qCazx9dL4L4WtXtrCS/dzcLuN4yvbcy4bmzRMgHQv0hmDOoSEB044pMaYMvsh10I/nUqE4fCRjFazfaWWNwdXF7tu8JGgXbHdwkBgvK3DgowvQFq15WGstWLeFw0DaYn14DEf/zwn1ozNoZRKWm8//Bfb3i0JZYJIPHHN24BX5NxDfjqzdrhjQkGFCxvgaFIgHRTVsd01DR5tj7OX0D7M0CXeLiYrvneiwSQ0h0fzoK4Ku0AhhBfpbTno1kQtNh+7HZQCOA1hRToVUnU2Z/jK2BtpsFVSaLZ1ECsEECPP02kNgQGsj/NXxBUkxDOek+UA2NAjQABdZPkXX/qR68PSrG8BjYM+t+G+XLq+zEqrDGFRSFAcppE0jGBRWAqI6JmE3WQ9Unu8BS/SwewpADZB3p/eNdNqXtbHXOHt3Q9ssHwvJ6X9CYCWah7BDq+AK1YoUO4v7/j5Xpgg+FZB1Os4/cXyRo6RQWqVnCs4fdnr031jBoBJH6u4vfvo+bks5KPL2d9vPXfP/frE2rFkCWmBCVR36djeAQ7Qx4HbXKRi0VVg0s6RBysdLwspKjA6FKCoqrrjZ9+eE97XBUn5IdyXMcMCJ2dmn8gpSDIIUH5dz2F4zlxpobcXpU1AF6p/45mh9yyks0tqMChT6DUfynYnHCqXuCasOiEmLXUxhBNDrnFosWJXdEG/wIPapf/EEwOeew0AbdQcQ08VQb4cFh6OMNfC3XC97lUDInAcNfiB3IFCsSRrOV5BYEKTsg/uV5/MC7cn420O+mH4JAnPlCLv/BcQvQXNFbvVhiQrQFwL9YK3UPKEUa2NOFBYQDv7JF7md1EdrMPIYRlujDaerNSV+5Z0AwYXia4u370SwghzGNPxjL9Snsb7u4vY1B0sFW4N6a8nnK+99YrvDr/leaeZdf3zjXEj1d+a9bt9fsa8HJwmn6+mafCAa8L4fu++uHtlzgvMS1lHagwIORrgBUrZAXkc/EejvP3w/7A72zHL2p9KEhh9SS857ZHt0I2Nr+9cuHjCk73Le0xWo4faM7Fi8SnY8anNaBbIRObn3bFWU8JbfFGoEL8wRT/47a2VSnsn05CzoTwgRUyUvSKqPW9h+fhlz4JYJAzwaYO7PPgOk0KB/d9H8QkiGDXCtFccHmFzMY+umu+QmASX2AvfmVqcYnRw/CNAVnEnS0rpBe9WOV/950BfRJALAoHYZOxtJcqhSP2307CMd/ubVohWf7H/Hffyts3SgJYI/UmdeC91KWqMLqLiiz4VSSTN8j/k6YDI+KeLXNGgKHUCBjPNtNeuhRm9SnIWBSOHu2lfXX+T2qNBNJUEA4zGU376lLY6z0O3TOZ4mCc/4Uit1MIEOX/TG93MPTEmS6FWWOAeL7BzstmgkGb51AocisMgE3uDAr5jZX/dSmMGgN+fSuReDJ3zUsw61ZQYUA2KNIL+U3Bvy+FtUeR445Mgc3zX81suCIBpJDEOvkrkcLajLDu8YE41ML/U0kf9CUCxE04LDr565DCYh2VxC/FEcEWKCqxKEVujs8E2HIeevD1SOHiPvgL7H4Dig9Si9xdeCZADzoqk8JlBkQQVMN/vchL4YkAE+ioTAorDOgq4n8ijRsLFBgAevW3Vil8XP21rwOVMAsMAL32V6UUVh74a4v/uRkG/U3LOqWwMCPqN32sTz0LKjduz6MOQc/7ViqFV3RRz/tWy//0/DAC6KhZCstJeFz3qq0kJhiVza8RKSwMsL//6SUxhf8Cp2x+DUhhAS0D1IGT4mtf9vs6ZfNrRQofo9KSmIrWpDA0wf/3+30blMI6Ki6JKfxvUwq/j6q6IxW0I4W7tvgfj940b0wK+w5qRFAHeTtlvGGbUjgw6KjUB0VlvF2DUjg6bJD/vbL5tSeFp5r5T/pkOK9sfo1JYc/N8l/Z/JqSwvHcMP/vyubXkBRmhHpx3B3JoKANHdgAlO5IDQ1JYQUf/rcmhQUf/rcqhVsAxWb5r0hhT9AU3NGzNm1J4cAN8l/J+zYohaOD9tD/DZvfnyUe/3n+I8Ifg//jmx/58Oel8B/N+/Z/cu/hP7z54e2Pdx5STOEEfwzs/2zn3f3PHv7zX9B5ODj80zJs+pPzY/nPZ2Ju0CrEifEn/laBsc0cHLYXv/IN9E3m4Pp43WViTtAY8Ba3aWON5aBlbvuMz/ETNIJrfFxG4awdA7GJ6LNHqfL4Ox8RWgCG3ZNU960d4xKnlkpwgTIrSHhrxw/E7DaK6KD5a2PklhLQoXsUJZfYkB9Y8iepxAr5NmryMq81PMSvU14eqBf37QsI9O2emkeoFnilx0Ocp7AdgxhaqUjy7WF9fP9gADexAK4xzY8dcKAHA06///KAwSc7ZQ/E/nEO+tpvIsmUJd52QL/NXcKv+MOp+txHSml57IH/iBgaVkZ4qt/6+G0HjCgMWAi4bvLnfn/Y9sARoM+e5lu4kfhlB2S4xM0O9tRKE27ETQUC3pMwAIdm4pcdcPZJMEETkNKnJMBvMQn+qTrvG1OcSF7rcPtGvFC/9cOrT2m5kGTAut3LJUvlhz/N35+gpWz06Ii01H74c5CDLit94sP29YFrJn9MgnMW/yC2r3p0Pr90MmzZzlCr7dMf645Z/Czjh6ov+n67f71I6fMuJ38D5J8uX0d+v/I+rDtggMohNic697Xgs9LnIJaoWuD2sJ4YgCmLP3z54KpB4FehIwWvTqzQ15dT+eE/SLCS650yK3iv/hoe+Yji+0T2sjBhAqxXAIjyjbj6PiHAmFnhE9du/f4N8+H7vPwP6YJ1VP3hL/HTVgeQ+CO1cfh3m+85i+hZrdDYgvL14vtWLzjRGn/1RV8vJn/1PYPPHtzoK099bQl+3l++li9gEPdfd+pLCL8kwfbizFz34S+hFudwTQSC6lNfJymBtTSD4ZYEAfP4fWil4yskgcvvX8dx/Yula2XulNuXAF1sYgOA8fvYPfF9dK99A5D4w2nO4xcrTN5zI1f9PIv4391+7MOI9ccfHK6kn9+4/VkhJYaFt6CPbz8i16J888O9EP8vRS8PUAl4waf+t+Xw9ieHiJUo3/Acv89aoEnRyxGrSX255/dIhk0HRYdKwuxWS9F3F3+/i39hvVTsqkl9RVL6/4DTiHrCrKsj7RUH0OLHF59yWE3qy3dPfkiWd/fiU1xH3nfCkh90x58yD17KGR6pg+gJsypsYU5jhAx3PX4RhvHfT3FXw0VXh/IFvDf6xT0WAF7R8JAT9+hz9f4p/tAdTQbqvOXZGLj7nS9xeIpx1oLbbMIlJmdV+fot/q9N/Vv8+gEvNgFvpnXgJQ6yBZwK8/5C8nx0TYa9yEeTh/9Z6n1TfJr3h8W0FxLhI/5oeEjc+ovLiJv5WfTwAOVvQGSyIJ6sKt8t/jcFbf81lvUs8RuWwXSXXzyvf+BhxiSk9HVNhvRP2VK+nBf7jz8ldyS6/FNosugr7L2r87aVT8k1GfmUtS+A/I6582O0Q3c7/pQwYFTkowWcQj5imzJPc+GDTwmmVT4tIiYMYc74fpL4py9ZwMfk37eLiZiwBIyZ9esyT8OKpxHJkGOQazIiJuyAokg39om3+C9Rv+zRxfV37/u7XBTL5WNAm/Nt8RrD5mlo1j2NNMdF11+CXJRaFPloJf5/A172I45id5j56cQ5B7ONUlLs4vBlfk+Zp5mV/f9pKNgAbPCRenfakh8hyineHwpaKYlmi4GA7clgvjjHWzhLklPcK88OKdURvy4Bb+uxIuwdpBTE/GdKwB/L4HwgbFwvRnr5lC31u9AWsZSzOP+DQKmOyP8Om3x0aGa8LaxVXr9nLms05svk5wt9i19uxpJ8ythN3yC716OcNWq1LR5nP55R/pVI24youB4GExrq94Z11+e0tfmwJ4B7isML4TtRPhAXZukXcnEwlfoSeDH/538NzgyAMXnWPxSuu6oBytGB0bMp6w8Sv/R90vzvH9Gh1iMu2lAG4kohBE3NxpYk1ipc+REOh6+Oz4KTpSVtWDBrlOu3wUhkavOLad3HNvN/jXrH55QyxO4R/1XCN1f09bxecxw3KS/aRp2MKBDbs2QjE60giFeTfYwkfhl1qc+EFwTxTp1fTYAZIEmT5+bn/N78zqT//hucVAAvsnnYwJbp+ueh5kni1zUsbbnyPmTxC5ylAZ9LbmM7Ocn5oJx1F4tLd8n8+DwZbsb5cN7kS1u677TJYD38WTKHYnsFg62WxyGzsZeNv/5lEgtlLE6W+SFTv79k8ANmQz6zfm+vkR+3Y4PyE5SAraW9HotXbOwqhxhkL3CofAGn/DqEX/8w2kp99WvRY0tjMWT85fJVT1688D/sOgdZrPDZ3E3fEcXGbk99fDl75b7DWVa9yxPBYbOCZGrMwcIy2DKsNlCGvKPiF3mVABFWeKmdREuN4FK+9ZSVAPOcL7LyqSDdkmOuiMJXGjywpc1PjrgxzwPozucqtT2UnXJHAHCewAzu+zy9S3uMimbK58B5UdKbifDO1kXvEXclcJi6+yvlG5LEL1bn4QjAGih71pe7VQpHpiDfjP61RQLOloBkfkwhT10PUv8BD8BBL9/KtoEwbicF4GIsfKV5fZPCTu9kRMkMSMmUHhVwNvqmLV5jOq2LG9IZAHsEBYMk/8XxTMyXYC3zozWvbxVd4sMJIbzSJ1z4tJ4lRvnPIT2sIKSIr56D4rTFP37PgxlE3ugRsnn3BZDb7YHJ56lCo6PxwiP6dP7iP5QzGBzWfDBmme/F/O+fp65G3Iq+xQUg3T6DeMUBurgvhhge+BN4lXLgFL8o9n5JaZLh8LP92VicZ3ul6KtVfRda9f64HhVdSAJPhvkfnZwJUd0nRfGNKXknR2UfzN8BH/eZ6+GstkmL4ospDXHd9Ogek1yFsQiSSrZc9iJVLQoD+pQiSfwAXe8ujGAXIoVfYsgz/D6lsd9kL/LF9WSc/x28GX+6/ssZHlTRY9cKvoTPTvoxpQBeoU1l/BcsW5p8wpiSsxu/fo/7JfjRJDz0KSWULJB5DBLIYfzrybeElDxYjl8J7o3LUotL6UsD93Cv5EkUeePmHbXopQUmAsxS9K0AXkzgYdZ4cFuZgGIlM+F5LQe+Fb8wgIFiPVOB6R0PtzoflyRp5ORT1uFVD1+In4Lsl4xQDbq3s8Y3EcQIyLXwH99Xiw5oEfnXGsT59dI/2Wj8uMiR0RrE+XRRJEOb8cM4QJPgrXY8c8vxtwtxfk3HP0G7wCgjENoExRQYWoaTJ1EaxeCgbaCBw98KPvjggw8++OCDDz744IMPPvjggw8++OCDDz744IMP8NZD22APDeMaU9sEIN9w+4k81dAu8CpjdxqAPoqpVcgYcmyY/A01oOlz+Klh8rdLAJqTgNokv+AXtAH9AT5ul/zN3kAKSdDiDaQh5QjQHkLK0TfH/+YJsKQcAzSGLuWIrd6/EbRnhCntAO1hVAZWt4KYchBA2yqoPSMcWifAqXECzClHB82hS40ZYTzrGqiNPAjvosSUY2kh7xsIHnAt2WCpe11VFRQaKPru3W7fFAGk7hVIUUGxhaJvyq/dc8rhWql7hbOigmonvyB0xUSAa6bulW5YVEFYPfkFcg4244Kk7iUIVFJBVD/5BQs9H4FTE0VfwbWggromyJ+fg0vK4Nso+u6kUFe/ERbyP+EmR2DlBOh8KiMwANXvgygkBYFgbMEGu6ThCqAQoI0vIA6DToAm1sBCoYWGAPLqF9CIDR40CoTQhhHuQ3oDUC/ont7A2PgXQCBodA1MjX8BBND2JvCrmrwHvvsFVGqD+aJUw17DV5P3vcHvfAH/VCR66V1DVJ0P4kVZzMdfQF9R3tfrjlBHqMfxedUS106APurn2dEaiBUVPU6gwMWkwdVU9wov14iCCsgvCPhzNTxWJfTdbxgiqqjo637uCKeqir4RD4hSGQE47RHpYKVURwBfKHf+cA10NdzyEMwHaaHqbDD/JK+BYyqAW4hf/wIWqGsL8D+uEfYtxK9/AaGqez5ihXS4yghA6RuGHzYKhLou++pWSF0Drq7Oj4g/7JQA48D40x900P/9FuNHMI7hXSukSOeptfh73QY3YIV0ArSiA+GkEKBuK6R/Y79ai5/1f7uRJTBX1hAw/0zYk94Q0IgVuldWD6b4o/hJt8GNWKFRJ0AT8etsacQKudoaozHoJZECov5dtWGF+toIAKcfVbiC3hDQhg7UjXAb8S+6DW7DCrFCgKrjJ89ltgwgqNwKXWZlXK4QoNaSiEyL8SUXJLSo3gqxT4kLPig6BKhcB8u0mPMTAaL8o9qtIM35qsC0wVMD8bPf7wpOIX+1VmhrHHTfjPDCFc4AFkw5+XfxO4X8tVqhPuxXhRjhOICgXh0s5M/lTq+Qv04rxD5fFdliGRH+YmB36vsT0/8Yfx8KhdLeBPmJ+77nDv+3JYD3kjta/u79jy5zTCuiP9PvlkTO7Iu7Av/l5AfkcUmCZeLftkJ0jcVdYQ789wZ/9YXZZr8Vf1SawJHgbwaPsTje7n0rpEKsEMPfChqLMVz/h/iNlX56rww3+6kVUhDQ5DyLGX9aElEQjI40iacfWyEFZ1OzTTcs+LMX0RSMaGm87c9/OE4HCKe/fbK/hun34zeS98Vbeonu51ZIYCHve/tPhvl4e+QXdP/JMB9KOkRN/42gJf0ni5eiNfILzjH9J4t3NLn/0QH737etzhj5Bdf0GhP9XlXMRt2Lwu+TX4/fUtH3+t+Jl0H/Co3+/hPmQomPjJQJ8uu//9Hi5fk3rJAnU3VMnfyXeJzI8HbIL7i8vf+RT8m9a4WsFH3vzzFPzo3LM/mXlN6I3xL5NeXqJ+fmIP/9+0xJfHsJ2Cj69tqap/BE/lILG49z8CMXCGWl6Bu0Ne/2//19LDa942lalvlMZUKNaOBhA0Xw4578xZQQzvsXoSR+Qx0PFz1b2ZXThFxMoF0LVsh3IDCSALqjPg1QwEX6hC1WZ4L8ygqIp+MyiS/rx+m7FQps7l7j+E6O3Jf1Y8DdPxXy23IAsXunTHIqH6BD/k/lJDGlABaN/Epd5FpuBD4J+S0gHJd8TkGr6VIoN8J6cc/Gwqf3aoRz+dMRBLNDm62c03s1wshlBe0en2GLQ84mjfyKTOQKZl7e9RWg1ggnVO4D/TJ+q5U18istLX0Fjz9EreCnP4E5qFm/YLuTOb5VII86ARgMAFHfAp3aI6Eo5WBu7CkB6fzXyZ+DwfIRwGHSJcA/bw359wBWjwC8RZjzP2uBvSpsD1rpLxh53ITV8jWrp0OOqFa/zwZm20NibQP0emFXkYrOUvjbmeZVDcjv9fhS9iWZ6fiVAw3y+Fk/wfT4vVJIDAZeNhOmKoWbXlsCqtgdzKwAOdAgpUEhQHyvTBzKjXSBDLxsJitVIcCoZ8ly9OVl4kx0vILo+OOZjVy+4hOKQmlEQ29ZO4UAXjNJUd8ohmAg8X+JSQB5/F3awZXjdxhfaD0evZ8vaOllnxRJaYbA4hII3L86KfrZ+4ltbH4pQa5iqCxvBSwdEcH2aNM+qsns8fUSuK9F7d5gwktxs7D7DeNrGzOuG1u0TAD0L5IZg7oERAeO+KQG2DL7YReCf53KxKGwUYxWs70lFncHl1f7rrBRoN3xXUKAoPytgwIMb4D6daWhbPUiHhdNg+nJNSDxHz/8p9aMjWFUShrvP/zXGx5tiWUCSPzxjVvA12RcA756tHh4Y4IBBctbYCgSIN2U1TEdNU2erY/zF9D+DNAlHi6ma773IgGkdMeHsyCuSjuAIcRXKe35aBYELbYfux0UAnhNIQV6VRJ19uf4ClibaXBVkmg2NRArBNDjTxOpDYGB7E/zFwTVJISz3hPlwBhQI0BA3SR515/60WuDUmyvgQ2D/rdhvpz6fowKa0xhUQiQnC6RNExgEZjKiKjbRA1kfZI7PMXv0gEsKUD2gd4f3nXT694mx9zhLV2PbDA8r+clvYlAFuoegY4vQCtW6BDu7+94uR7YYHjWwRTr+P1FsoZOVYGKFRxr+P3Za1M9o0YAiZ+r+P37qDj5vOTjy1kfb/33z/36hFoxZIkpQUnU9+kYHsHOkMdBm1zkYlHV4JIOEQcrHS8LKSowupSgqOp646cf3tMeV8UJ+aEc1zEDQmen5h9IKQhySFD+XU/heE6cqSG3V2UNgFfqv6PZIbesZHMLKnDoEyj1XwomJ5zqF7gmLDohZi21MUSTQ26xaHFiV7TBv8CD2uU/BJNDHjtNwC1UXANPlQE+HJYezvDXQp3wfS4VQyIw3LX4gVyBAnEka3leQaCCE/JPrtcfjAv3ZyPtTvohOOSJDyzErz2XEP0FbdW7FQbkawDci7VC95ByhJEtTXhQGMA7e+ReZjeR3exDCGGZLozW3qxUlHseNAOGlwnurh/9EkII89iTsUy/0t6Gu/vLGBQdbBXujSmvp5zvvfUKr85/pbln2fW9cw3x45XfmnV7/b4GvBycpp9v5qlwwOtC+L6vfnj7Jc5LTEtZByoMCPkaYMUKWQH5XLyH4/z9sD/wO9vxi1ofClJYPQnvue1RrJCZzW+vXPi4gtN9S3uMluMHmnPxIvHpmPFpDShWyMjmp15x1lNCW7wRqBB/MMX/uK1tVQr7p5OQMyF8YIWMFL0ian3v4Xn4pU8CGORMsKkD+zy4TpPCwX3fBzEJIti1QjQXXF4hs7GP7pqvEJjEFxiLX59aXGL0MHxjQBZxZ84KKUUvVvnffWdAnwQQi8JB2GQs7aVK4Yj9t5NwzLZ7o1ZIlv8x/9238vaNkgDWSL1JHXgvdakqjO6iIgt+FcnkDfL/pOnAiLhny5wRYCg1AsazzbSXLoVZfQoyFoWjR3tpX53/k1ojgTQVhMNMRtO+uhT2eo9D90ymOBjnf6HI7RQCRPk/09odTD1xpkth1hggnm+w87KZYNDmORSK3AoDYJM7g0J+Y+V/XQqjxoBf30oknsxd8xLMuhVUGJANivRCflPw70th7VHkuCNTYPP8VzMbrkgAKSSxQv56pLA2I6x7fCAOtfD/VNIHfYkAcRMOi0L+aqSwWEcl8UtxRLAFikosSpGb4zMBtpyHEnxVUri4D/4C5Ruw7IOUIncXngnQg4L6pHCZAREENfFfKfJSeCLABDoqk8IKA7qK+J9I48YCBQaAXv2tVQofV3/t60AlzAIDQK/9VSuF9Qf+GuF/boZBf9OyTikszIjaTR/7U8+Cyo3b86hD0PO+lUrhFV1U8r418z89P4wAOqqVwnISHte9KiyJCUZl82tECgsD7O9/eklM4b/AKZtfA1JYQMsAdeCk+NqX/b5O2fxakcIHqLckpqI1KQxN8P/9ft/mpLCOqktiCv/blMLvo6ruSAXtSOGuLf7HozfNG5PCvoMaEdRB3k4Zb9imFA4MCur1QVEZb9egFI4OG+R/r2x+7UnhqWb+kz4ZziubX2NS2HOz/Fc2v6akcDw3zP+7svk1JIUZoWocdEcyKGhABzYAvTtSQ0NSWMGH/61J4Q//Bc1J4YZAsU3+61LYEzQFd/SsTVtSOHCD/Ffyvg1K4eigPfTK5tcQuG3++9Y2P+Ur8Nwy/6ODhkExhRM0i7tsfu1icNgy/2eGD+zDMhAaByI0DPIB2kbfsgbDmxSiWwV7aURoErNy/aSxXNwErYKU6yetpeP5E3/bW4BvL+724le+gb7JQmwfr7ty3Kk99Ru7PBcdsDXlm2Z8jp+gBci77UNejnINpQSu2cukefydb8QPYNi9S3rfenIvcWqpDytQZgUJb+34gZhdSRYdNH9tjNxSF0LoHp1pS2zIDyz5u6RihXwbjZkytD88xK/Tn5+qFPftCwj0bViBR6gWeKXHa+ynsB2DGFppS+Pbw/r4/sEAbmIBXGOaHzvgQA8GnH7/+SmD77bLHoj94xz0tV9Hl1GbvO2Afhu+iV/xh1P1uY+U0vLYA/8RMTSsjPBUv/Xx2w4YURiwEHDd5M/9/rDtgSNAn73PvHAj8csOyHCJmx3sqZX204ibCgS8J2EADs3ELzvg7JNgaqv0KQnwW0yCf6rO+8YUJ5In29z+Nkao3/rh1ae0XEgyYN3u+bql8sOfZtnlJH7K5s+PSEvthz8HOeiy0ic+bF8fuGbyxyQ4Z/EP1ds+Qefzm8fDlu0MVds+QR/SAzGLn2UGZQstjxscwCKlz7uc/A2Qf7p8Hfn9yvuw7oABKofYnOjc14LPSp+DWKJqgdvrymIApiz+8OWDqwaBX4WOFLw6sUJfX07lh/8gwUqud8qs4L3668jkI4rvE9nLwoQJsF4BIMo3ovi+lQBjZoVPXLv1+zfMh+/z8j+kC9ZR9Ye/xE9bHUDij9TG4d9tvucsome1QmMLyteL71u94ERr/NUXfb2Y/NX3DD57da2vPPW1Jfh5P4FHvoChbvcvqS8h/JI2yLODc92Hv4RaHMY6EQiqT32dpATW0iCuWxIEzOP3oZWOr5AELh/CE8f1L5auleGjbl8CdLGJDQDG77OXxffRvfYNQOIPpzmPX6wwec+NXPXzLOJ/d/uxDyPWH39wuJJ+fuP2Z4WUGBbegj6+/Yhci/LND/dC/L8UvTxAJeAFn/rflsPbnxwiVqJ8w3P8PmuBJkUvR6wm9eWeH6UbNh0UHSoJs1stRd9d/P0u/oX1UrGrJvUVSen/A04j6gmzro60VxxAix9ffMphNakv3z35IVne3YtPcR153wlLftAdf8o8eClneKQOoifMqrCFOY0RMtz1+EUYxn8/xV0NF10dyhfw3ugX91gAeEXDQ07co8/V+6f4Q3c0Gajzlmdj4O53vsThKcZZC26zCZeYnFXl67f4vzb1b/HrB7zYBLyZ1oGXOMgWcCrM+wvJ89E1GfYiH00e/mep903xad4fFtNeSISP+KMoJbsTHmXEzfwseniA8jcgMlkQT1aV7xb/m4K2/5rNf5b4Dctgussvntc/8DBjElL6uiZD+qdsKV/Oi/3Hn5I7El3+KTRZ9BX23oXK9Oan5JqMfMraF0B+x9z5Mdqhux1/ShgwavLRAE4hf2eFMk9z4YNPCaZVPi0iJgxhzvh+kvinL1nAx+Tft4uJmLAEjJn16zJPw+JpFMmQY5BrMvbGRVMU6cY+8Rb/JeqXPbq4/u59f5eLYrl8DGhzvi1eY9g8Dc26p5HmuOj6S5CLUosmH43E/2/Ay37EUewOMz+dOOdgtlFKil0cvszvKfM0s7L/Pw0FG3L56DuwAXfakh8hyineHwpaKYlmi4GA7clgvjjHWzhLklPcK29PKtURvy4Bb+vFSuwdpBTE/GdKwB/L4HwgbFwvRnr5lC31u9AWsZSzOP+DQKmOyP8Om3x0aGa8LaxVXr9nLms05svk5wt9i19uxpJ8ythN3yC716OcNWq1LR5nP55R/pVI24youB4GExrq94Z11+e0tfmwJ4B7isML4TtRPhAXZukXcnEwlfoSeDH/538NzgyAMXnWPxSuu6oBytGB0bMp6w8Sv/R90vzvH9Gh1iMu2lAG4kohBE3NxpYk1ipc+REOh6+Oz4KTpSVtWDBrlOu3wUhkavOLad3HNvN/jXrH55QyxO4R/1XCN1f09bxecxw3KS/aRp2MKBDbs+QjE40giFeTfYwkfhl1qc+EFwTxTp1fTYAZIEmT5+bn/N78zqT//hucVAAvsnnYwJbp+ueh5kni1zUsbbnyPmTxC5ylAZ9LbmM7Ocn5oJx1F4tLd8n8+DwZbsb5cN7kS1u677TJYD38WTKHYnsFg62WxyGzsZeNv/5lEgtlLE6W+SFTv79k8ANmQz6zfm+vkR+3Y4PyE5SAraW9HotXbOwqhxhkL3CofAGn/DqEX/8w2kp99WvRY0tjMWT85fJVT1688D/sOgdZrPDZ3E3fEcXGbk99fDl75b7DWVa9yxPBYbOCZGrMwcIy2DKsNlCGvKPiF3mVABFWeKmdREuN4FK+9ZSVAPOcL7LyqSDdkmOuiMJXGjywpc1PjrgxzwPozucqtT2UnXJHAHCewAzu+zy9S3uMimbK58B5UdKbifDO1kXvEXclcJi6+yvlG5LEL1bn4QjAGih71pe7VQpHpiDfjP61RQLOl4BkfiwhT10PUv8BD8BBL9/KtoEwbicF4GIpfL15fZPCTu9kRMkMSMmUHhVwNvqmLV5jOq2LG9IZAHsEBYMk/8XxTMyXYCvzozevbxVd4sMJIbzSJ1z4tJ4lRvnPIT2sIKSIr56D4rTFP37PgxlE3ugRsnn3BZDb7YHJ56lCo6PxwiP6dP7iP5QzGBzWfDBmme/F/O+fp65G3Iq+xQUg3T6DeMUBurgrhlge+BN4lXLgFL8o9n5JaZLh8LP92VicZ3ul6KtVfRda9f64HhVdSAJPhvkfnZwJUd0nRfGNKXknR2UfzN8BH/eZ6+GstkmL4ospDXHd9Ogek1yFsQiSSrZc9iJVLQoD+pQiSfwAXe8ujGAXIoVfYsgz/D6lsd9kL/LF9WSc/x28GX+6/ssZHlTRY9cKvoTPTvoxpQBeoU1l/BcsW5p8wpiSMx2/co/7JfjRJDz0KSWULJB5DIeBSPzrybeElDyYjV8P7o3LUotL6UsD93Cv5EkUeePmHbXopQUmAsxS9K0AXkzgYdZ4cFuZgGIlM+F5LQe+Fb8wgIFiPVOB6R0PtzoflyRp5ORT1uFVD1+In4Lsl4xQDbq3s8Y3EcQIyLXwH99Xiw5oEfnXGsT59dI/2Wj8uMiR0RrE+XRRJEOb8cM4QJPgrXY8c8vxNwtxfm3HP0G7wCgjENoExRQYWoaTJ1EaxeCgbaC5w/+DDz744IMPPvjggw8++OCDDz744IMPDABvPbQN9tAwrjG1TQDyDdceZU53u8CrzFxoAPocjlYhM2ixXfK31H2gD2GmhsnfLgFoTgJqk/yCX9AMlNeXuF3yN9t+HpKgxfbzIeUI0B5CytE3x//mCbCkHAM0hi7liK02XwvaM8KUdoD2MCrTSltBTDkIoG0V1J4RDq0T4NQ4AeaUo4Pm0KXGjDCeFQ3UTB6Ed1FiyrG0kPcNBA+4lmyw1L2uqgoKLRR9d263b4oAUvcKpKig2ELRN+V3LjnlcK3UvcJZUUG1k18QumIiwDVT90o3LKogrJ78AjkHm3FBUvcSBCqpIKqf/IKFno/AqYmir+BaUEFdE+TPz8ElZfBtFH13Uqir3wgL+Z9wkyOwcgJ0PpURGID+qA/6P9HpZtdg1QgHAAAAAElFTkSuQmCC"})),cg=b((()=>{Xc="uniform sampler2D u_image;\nuniform sampler2D u_watermarkTex;\n\nvarying vec2 v_texCoord;\n\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  vec4 watermarkColor = texture2D(u_watermarkTex, v_texCoord);\n\n  if (watermarkColor.r > 0.8) {\n    gl_FragColor = mix(color, watermarkColor, 0.3);\n  } else {\n    gl_FragColor = color;\n  }\n}\n"})),dg=b((()=>{_a(),cg(),(Yc=class extends Jn.Filter{constructor(...t){super(...t),this._fragmentSource=Xc}_applyWebGL(t,e,i,s=!1){const r=t.getContext(),{canvas:n}=r,o=this.getShaderForRenderer(t),a=e.getFrame(),l=this._watermarkCanvas;l&&a.width===l.width&&a.height===l.height||this._createWatermarkCanvas(a.width,a.height);const h=Jn.Texture.fromCanvas(this._watermarkCanvas),u=h.getBaseTexture();t.updateTexture(u),u.setGLUnit(1),t.setRenderTarget(i),s&&i.clear(),t.setShader(o);const c=t.getCurrentRenderTarget().getProjectionMatrix().toArray();o.setUniform("u_projMatrix",c),o.syncUniforms(),r.uniform1i(r.getUniformLocation(o.getProgram(),"u_watermarkTex"),1),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,e.getTexture()),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,u.getGLTextureForRenderer(t)),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),h.dispose()}_createWatermarkCanvas(t,e){const i=this._options.watermarkImage,s=st.createCanvas();s.width=t,s.height=e;const r=s.getContext("2d"),n=r.createPattern(i,"repeat");r.fillStyle=n,r.fillRect(0,0,s.width,s.height),this._watermarkCanvas=s,this._watermarkContext=r}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext();this._options.watermarkImage;this._createWatermarkCanvas(r.width,r.height);const a=n.getImageData(0,0,r.width,r.height),l=this._watermarkContext.getImageData(0,0,r.width,r.height),h=new Wt,u=new Wt,c=new Wt;for(let d=0;d<r.width*r.height*4;d+=4)h.set(a.data[d]/255,a.data[d+1]/255,a.data[d+2]/255,a.data[d+3]/255),u.set(l.data[d]/255,l.data[d+1]/255,l.data[d+2]/255,l.data[d+3]/255),u.r>.8?c.copy(h.clone().mix(u,.3)):c.copy(h),a.data[d]=255*c.r,a.data[d+1]=255*c.g,a.data[d+2]=255*c.b,a.data[d+3]=255*c.a;o.putImageData(a,0,0)}}).prototype.availableOptions={watermarkImage:{type:l.OBJECT,required:!0}}})),_g=b((()=>{_a(),ug(),dg(),(Jc=class extends yo{constructor(...t){super(...t),T(this,"_applyWatermarkFilter",(()=>(this._watermarkFilter||(this._watermarkFilter=new Yc({watermarkImage:this._watermarkImage})),this._sprite.setFilters([this._watermarkFilter]),this._renderTexture.render(this._container),Promise.resolve()))),T(this,"_loadWatermarkImage",(()=>this._watermarkImage?Promise.resolve():new Promise(((t,e)=>{this._watermarkImage=new co,this._watermarkImage.onload=t,this._watermarkImage.src=qc})))),this._watermarkFilter=null,this._watermarkImage=null}_render(t){return this._loadWatermarkImage().then(this._applyWatermarkFilter)}dispose(){this._watermarkFilter&&this._watermarkFilter.dispose(),super.dispose()}}).identifier="license-watermark",Jc.prototype.availableOptions={},ia.Operations.LicenseWatermarkOperation=Jc,Kc=Jc})),mg=b((()=>{Zc="/*!\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform vec2 u_controlPoint1;\nuniform vec2 u_controlPoint2;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    vec2 vector = u_controlPoint2 - u_controlPoint1;\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    float radius = smoothstep(0.0, 1.0,\n      abs(\n        clamp(dot(v_texCoord - u_controlPoint1, vector) / dot(vector, vector), 0.0, 1.0)\n      )\n    ) * u_blurRadius;\n\n    for (float t = -30.0; t <= 30.0; t++) {\n      float percent = (t + offset - 0.5) / 30.0;\n      float weight = 1.0 - abs(percent);\n      vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n      color += _sample * weight;\n      total += weight;\n    }\n\n    gl_FragColor = color / total;\n}\n"})),gg=b((()=>{_a(),ah(),mg(),({Vector2:Qc}=Wn),($c=class extends Jn.Filter{constructor(...t){super(...t),this._fragmentSource=Zc,this._lastBlurRadius=null,this._lastControlPoint1=new Qc,this._lastControlPoint2=new Qc,this._blurFilter=new Ba,this._blurredRenderTarget=new Jn.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new Jn.CanvasRenderTarget(100,100,1)}_applyCanvas(t,e,i,s=!1){if("low"===this._options.blurQuality)return void this._renderLQBlur(t,e,i,s);const r=e.getDimensions(),n=!i.getDimensions().equals(r);if(e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n){const n=new Qc(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(n);const o={blurRadius:this._options.blurRadius,texSize:r},a=(t,e,i)=>Math.min(Math.max(t,e),i),l=(t,e,i)=>{const s=a((i-t)/(e-t),0,1);return s*s*(3-2*s)},h=this._options.controlPoint2.clone().subtract(this._options.controlPoint1.clone()),{blurRadius:u}=this._options,c=(t,e)=>l(0,1,Math.abs(a(new Qc(t,e).subtract(this._options.controlPoint1).dot(h)/h.dot(h),0,1)))*u;this._blurFilter.set(o),this._blurFilter._applyCanvas(t,e,i,s,c),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(t,e,i,s=!1){const r=e.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(r);this._blurredRenderTarget.setPixelRatio(e.getPixelRatio()),this._blurredRenderTarget.resizeTo(e.getDimensions()),this._maskRenderTarget.setPixelRatio(e.getPixelRatio()),this._maskRenderTarget.resizeTo(e.getDimensions());const o=!this._lastControlPoint1.equals(this._options.controlPoint1)||!this._lastControlPoint2.equals(this._options.controlPoint2)||n,a=e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;o&&(this._renderMask(),this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone()),a&&(this._blurImage(e,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(e,i)}_renderMask(){const t=this._maskRenderTarget.getCanvas(),e=this._maskRenderTarget.getContext(),i=new Qc(t.width,t.height),s=this._options.controlPoint1.clone().multiply(i),r=this._options.controlPoint2.clone().multiply(i),n=e.createLinearGradient(s.x,s.y,r.x,r.y);n.addColorStop(0,"#FFFFFF"),n.addColorStop(1,"#000000"),e.fillStyle=n,e.fillRect(0,0,t.width,t.height)}_applyMask(t,e){const i=e.getContext(),s=t.getCanvas(),r=t.getContext(),n=this._blurredRenderTarget.getContext(),o=this._maskRenderTarget.getContext(),a=r.getImageData(0,0,s.width,s.height),l=a.data,h=n.getImageData(0,0,s.width,s.height).data,u=o.getImageData(0,0,s.width,s.height).data;let c;for(let d=0;d<s.width*s.height*4;d+=4)c=u[d]/255,l[d]=c*l[d]+(1-c)*h[d],l[d+1]=c*l[d+1]+(1-c)*h[d+1],l[d+2]=c*l[d+2]+(1-c)*h[d+2];i.putImageData(a,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}}).prototype.availableOptions={blurRadius:{type:l.NUMBER,default:30,uniformType:h.FLOAT},controlPoint1:{type:l.VECTOR2,default:new Qc(0,.5),uniformType:h.FLOAT2},controlPoint2:{type:l.VECTOR2,default:new Qc(1,.5),uniformType:h.FLOAT2},delta:{type:l.VECTOR2,default:new Qc(1,1),uniformType:h.FLOAT2},texSize:{type:l.VECTOR2,default:new Qc(100,100),uniformType:h.FLOAT2}},td=$c})),pg=b((()=>{_a(),gg(),({Vector2:ed}=Wn),(id=class extends yo{constructor(...t){super(...t),this._lastBlurRadius=this._options.blurRadius,this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone();const e={blurQuality:{type:l.STRING}};this._horizontalFilter=new td({},e),this._verticalFilter=new td({},e),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new ed(.5,.5)),this._verticalFilter.setDelta(new ed(-.5,.5)),this._filter=new td({},e)}rotate(t){const{controlPoint1:e}=this._options,{controlPoint2:i}=this._options;90===t?(e.flip(),e.x=1-e.x,i.flip(),i.x=1-i.x):-90===t&&(e.flip(),e.y=1-e.y,i.flip(),i.y=1-i.y),this.set({controlPoint1:e,controlPoint2:i})}flip(t){const{controlPoint1:e}=this._options,{controlPoint2:i}=this._options;switch(t){case"horizontal":e.x=1-e.x,i.x=1-i.x;break;case"vertical":e.y=1-e.y,i.y=1-i.y}this.set({controlPoint1:e,controlPoint2:i})}transform(t){const e={};["controlPoint1","controlPoint2"].forEach((i=>{const s=this.getOption(i);e[i]=t.applyToRelativePoint(s)})),["blurRadius"].forEach((i=>{const s=this.getOption(i);e[i]=t.applyToRelativeSize(s)})),this.set(e,!1)}_renderWebGL(t){return this._renderBlur(t)}_renderCanvas(t){return this._options.highQualityCanvasBlur?this._renderBlur(t):this._renderLQCanvasBlur(t)}_renderBlur(t){const e=t.getDimensions(),i=e.min(),{blurRadius:s,controlPoint1:r,controlPoint2:n}=this._options,o={blurRadius:s*i,controlPoint1:r.clone(),controlPoint2:n.clone(),texSize:e,blurQuality:"high"};return this._horizontalFilter.set(o),this._verticalFilter.set(o),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(t){const e=t.getDimensions(),{blurRadius:i,controlPoint1:s,controlPoint2:r}=this._options;return this._filter.set({blurRadius:i,controlPoint1:s.clone(),controlPoint2:r.clone(),texSize:e,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}).identifier="linear-focus",id.prototype.availableOptions={controlPoint1:{type:l.VECTOR2,default:new ed(0,.5)},controlPoint2:{type:l.VECTOR2,default:new ed(1,.5)},blurRadius:{type:l.NUMBER,default:.025},highQualityCanvasBlur:{type:l.BOOLEAN,default:!1}},ia.Operations.LinearFocusOperation=id,sd=id})),fg=b((()=>{rd="/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform float u_gradientSize;\nuniform float u_size;\nuniform vec2 u_start;\nuniform vec2 u_end;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    vec2 normal = normalize(vec2(u_start.y - u_end.y, u_end.x - u_start.x));\n    float radius = smoothstep(0.0, 1.0,\n      (abs(\n        dot(v_texCoord * u_texSize - u_start, normal)\n      ) - u_size) / u_gradientSize\n    ) * u_blurRadius;\n\n    for (float t = -30.0; t <= 30.0; t++) {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n}\n"})),yg=b((()=>{_a(),ah(),fg(),({Vector2:nd}=Wn),(od=class extends Jn.Filter{constructor(...t){super(...t),this._fragmentSource=rd,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastStart=new nd,this._lastEnd=new nd,this._blurFilter=new Ba,this._blurredRenderTarget=new Jn.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new Jn.CanvasRenderTarget(100,100,1)}_applyCanvas(t,e,i,s=!1){if("low"===this._options.blurQuality)return void this._renderLQBlur(t,e,i,s);const r=e.getDimensions(),n=!i.getDimensions().equals(r);if(e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n){const n=new nd(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(n);const o={blurRadius:this._options.blurRadius,texSize:r},a=(t,e,i)=>Math.min(Math.max(t,e),i),l=(t,e,i)=>{const s=a((i-t)/(e-t),0,1);return s*s*(3-2*s)},{blurRadius:h,gradientSize:u,size:c,start:d,end:_,texSize:m}=this._options,g=new nd(d.y-_.y,_.x-d.x);g.divide(g.len());const p=(t,e)=>l(0,1,(Math.abs(m.clone().multiply(t,e).subtract(d).dot(g))-c)/u)*h;this._blurFilter.set(o),this._blurFilter._applyCanvas(t,e,i,s,p),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(t,e,i,s=!1){const r=e.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(r);this._blurredRenderTarget.setPixelRatio(e.getPixelRatio()),this._blurredRenderTarget.resizeTo(e.getDimensions()),this._maskRenderTarget.setPixelRatio(e.getPixelRatio()),this._maskRenderTarget.resizeTo(e.getDimensions());const o=!this._lastStart.equals(this._options.start)||!this._lastEnd.equals(this._options.end)||this._lastGradientRadius!==this._options.size||n,a=e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;o&&(this._renderMask(),this._lastStart=this._options.start.clone(),this._lastEnd=this._options.end.clone(),this._lastGradientRadius=this._options.size),a&&(this._blurImage(e,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(e,i)}_renderMask(){const t=this._maskRenderTarget.getCanvas(),e=this._maskRenderTarget.getContext(),i=this._maskRenderTarget.getPixelRatio(),s=new nd(t.width,t.height),r=this._options.size*s.min()*i,n=this._options.gradientSize*s.min()*i,o=this._options.start.clone().multiply(s),a=this._options.end.clone().multiply(s).clone().subtract(o),l=o.clone().add(a.clone().divide(2)),h=a.len(),u=a.clone().divide(h),c=l.clone().add((r+n)*u.y,-(r+n)*u.x),d=l.clone().add(-(r+n)*u.y,(r+n)*u.x),_=e.createLinearGradient(c.x,c.y,d.x,d.y),m=d.clone().subtract(c).len();_.addColorStop(0,"#000000"),_.addColorStop(n/2/m,"#FFFFFF"),_.addColorStop(1-n/2/m,"#FFFFFF"),_.addColorStop(1,"#000000"),e.fillStyle=_,e.fillRect(0,0,t.width,t.height)}_applyMask(t,e){const i=e.getContext(),s=t.getCanvas(),r=t.getContext(),n=this._blurredRenderTarget.getContext(),o=this._maskRenderTarget.getContext(),a=r.getImageData(0,0,s.width,s.height),l=a.data,h=n.getImageData(0,0,s.width,s.height).data,u=o.getImageData(0,0,s.width,s.height).data;let c;for(let d=0;d<s.width*s.height*4;d+=4)c=u[d]/255,l[d]=c*l[d]+(1-c)*h[d],l[d+1]=c*l[d+1]+(1-c)*h[d+1],l[d+2]=c*l[d+2]+(1-c)*h[d+2];i.putImageData(a,0,0)}dispose(){super.dispose(),this._blurFilter.dispose()}}).prototype.availableOptions={blurRadius:{type:l.NUMBER,default:30,uniformType:h.FLOAT},size:{type:l.NUMBER,default:50,uniformType:h.FLOAT},gradientSize:{type:l.NUMBER,default:50,uniformType:h.FLOAT},start:{type:l.VECTOR2,default:new nd(0,.5),uniformType:h.FLOAT2},end:{type:l.VECTOR2,default:new nd(1,.5),uniformType:h.FLOAT2},delta:{type:l.VECTOR2,default:new nd(1,1),uniformType:h.FLOAT2},texSize:{type:l.VECTOR2,default:new nd(100,100),uniformType:h.FLOAT2}},ad=od})),xg=b((()=>{_a(),yg(),({Vector2:ld}=Wn),(hd=class extends yo{constructor(...t){super(...t),this._lastBlurRadius=this._options.blurRadius,this._lastSize=this._options.size,this._lastGradientSize=this._options.gradientSize;const e={blurQuality:{type:l.STRING}};this._horizontalFilter=new ad({},e),this._verticalFilter=new ad({},e),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new ld(.5,.5)),this._verticalFilter.setDelta(new ld(-.5,.5)),this._filter=new ad({},e),this._renderBlur.bind(this)}rotate(t){const{start:e}=this._options,{end:i}=this._options;90===t?(e.flip(),e.x=1-e.x,i.flip(),i.x=1-i.x):-90===t&&(e.flip(),e.y=1-e.y,i.flip(),i.y=1-i.y),this.set({start:e,end:i})}flip(t){const{start:e}=this._options,{end:i}=this._options;switch(t){case"horizontal":e.x=1-e.x,i.x=1-i.x;break;case"vertical":e.y=1-e.y,i.y=1-i.y}this.set({start:e,end:i})}transform(t){const e={};["start","end"].forEach((i=>{const s=this.getOption(i);e[i]=t.applyToRelativePoint(s)})),["blurRadius","size","gradientSize"].forEach((i=>{const s=this.getOption(i);e[i]=t.applyToRelativeSize(s)})),this.set(e,!1)}_renderWebGL(t){return this._renderBlur(t)}_renderCanvas(t){return this._options.highQualityCanvasBlur?this._renderBlur(t):this._renderLQCanvasBlur(t)}_renderBlur(t){const e=t.getDimensions(),i=e.min(),s=this._options.start.clone(),r=this._options.end.clone(),{blurRadius:n,size:o,gradientSize:a}=this._options,l={blurRadius:n*i,size:o*i,gradientSize:a*i,start:s.clone().multiply(e),end:r.clone().multiply(e),texSize:e,blurQuality:"high"};return this._horizontalFilter.set(l),this._verticalFilter.set(l),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(t){const e=t.getDimensions(),{blurRadius:i,size:s,gradientSize:r,start:n,end:o}=this._options;return this._filter.set({blurRadius:i,gradientSize:r,size:s,start:n.clone(),end:o.clone(),texSize:e,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}).identifier="mirrored-focus",hd.prototype.availableOptions={start:{type:l.VECTOR2,default:new ld(0,.5)},end:{type:l.VECTOR2,default:new ld(1,.5)},blurRadius:{type:l.NUMBER,default:.025},size:{type:l.NUMBER,default:.1},gradientSize:{type:l.NUMBER,default:.1},highQualityCanvasBlur:{type:l.BOOLEAN,default:!1}},ia.Operations.MirroredFocusOperation=hd,ud=hd})),bg=b((()=>{_a(),({Vector2:cd}=Wn),(dd=class extends yo{_render(t){const e=this._options.rotation%360,i=e*(Math.PI/180),s=90===e||270===e,r=this._options.flipHorizontally!==this._options.flipVertically,n=s&&r?!this._options.flipVertically:this._options.flipVertically,o=s&&r?!this._options.flipHorizontally:this._options.flipHorizontally;this._sprite.setScale(o?-1:1,n?-1:1),this._sprite.setRotation(i),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();const a=this._sprite.getBounds();return this._renderTexture.resizeTo(new cd(a.width,a.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2).round()),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(t){return t=t.clone(),this._options.rotation%180&&t.flip(),t}flip(t){const{rotation:e}=this._options;switch(90!==e&&270!==e||(t="vertical"===t?"horizontal":"vertical"),t){case"vertical":this.setFlipVertically(!this.getFlipVertically());break;case"horizontal":this.setFlipHorizontally(!this.getFlipHorizontally())}}}).identifier="orientation",dd.prototype.availableOptions={rotation:{type:l.NUMBER,default:0,validation(t){if(t%90!==0)throw new Error("OrientationOperation: `rotation` has to be a multiple of 90.")},setter:t=>(t+360)%360},flipVertically:{type:l.BOOLEAN,default:!1},flipHorizontally:{type:l.BOOLEAN,default:!1}},ia.Operations.OrientationOperation=dd,_d=dd})),vg=b((()=>{_a(),({Vector2:md}=Wn),(gd=class extends yo{constructor(...t){super(...t),this._flipContainer=new Jn.Container}_render(t){const{position:e,rotation:i,scale:s,pivot:r,outputResolution:n}=this._options,o=this._sdk.getTextureScale(),a=n.clone().multiply(o).ceil();return this._renderTexture.resizeTo(a),this._sprite.setRotation(i),this._sprite.setPosition(e),this._sprite.setPivot(r),this._sprite.setScale(s),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(t){const e=this._sdk.getTextureScale();return this._options.outputResolution.clone().multiply(e).ceil()}}).identifier="output",gd.prototype.availableOptions={position:{type:l.VECTOR2,default:new md(0,0)},rotation:{type:l.NUMBER,default:0},scale:{type:l.VECTOR2,default:new md(1,1)},pivot:{type:l.VECTOR2,default:new md(0,0)},outputResolution:{type:l.VECTOR2,default:new md(100,100)}},ia.Operations.OutputOperation=gd,pd=gd})),wg=b((()=>{_a(),({OverlayFilter:fd}=Jn.Filters),({Vector2:yd}=Wn),4,(xd=class extends yo{constructor(...t){super(...t),this._overlayTexture=Jn.Texture.fromImage(this._options.image),this._overlayContainer=new Jn.Container,this._overlaySprite=new Jn.Sprite,this._overlaySprite.setTexture(this._overlayTexture),this._overlaySprite.setAnchor(0,0),this._overlayContainer.addChild(this._overlaySprite),this._overlayFilter=new Jn.Filters.OverlayFilter({overlayImage:this._overlayTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayTexture}),this._sprite.setFilters([this._overlayFilter]),this._renderedOverlaySprite=new Jn.Sprite,this._renderedOverlayContainer=new Jn.Container,this._renderedOverlayContainer.addChild(this._renderedOverlaySprite),this._overlayRendered=!1,this._lastInputDimensions=new yd(0,0)}setOption(t,e){if(super.setOption(t,e),"image"===t&&e&&this._sdk){const t=this._sdk.getRenderer(),i=this._overlayTexture.getBaseTexture();i.setSource(e),t.isOfType(u.WEBGL)&&t.updateTexture(i),this._overlayRendered=!1}}_render(t){const e=t.getDimensions(),{image:i,alpha:s,blendMode:r}=this._options;return i?(this._overlayRendered&&this._lastInputDimensions.equals(e)||(this._renderOverlayToRenderTexture(t),this._overlayRendered=!0,this._lastInputDimensions.copy(e)),this._overlayFilter.set({blendMode:r,overlayImage:this._overlayRenderTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayRenderTexture,alpha:s}),this._sprite.setFilters([this._overlayFilter]),this._renderTexture.render(this._container),Promise.resolve()):(this._sprite.setFilters([]),this._renderTexture.render(this._container),Promise.resolve())}_renderOverlayToRenderTexture(t){const e=this._sdk.getRenderer(),i=t.getDimensions();this._overlayRenderTexture||(this._overlayRenderTexture=new Jn.RenderTexture(e,i.x,i.y),this._renderedOverlaySprite.setTexture(this._overlayRenderTexture));const{width:s,height:r}=this._options.image,n=st.resizeVectorToFill(new yd(s,r),i),{flipHorizontally:o,flipVertically:a}=this._options,l=o?-1:1,h=a?-1:1;this._overlaySprite.setWidth(n.x*l),this._overlaySprite.setHeight(n.y*h),this._overlaySprite.setPosition(i.x*(1-l)*.5,i.y*(1-h)*.5);const c=this._overlayRenderTexture.getBaseTexture();this._overlayRenderTexture.resizeTo(i),e.isOfType(u.WEBGL)&&(c.setGLUnit(4),e.updateTexture(c,!1)),this._overlayRenderTexture.render(this._overlayContainer)}dispose(){super.dispose(),this._overlaySprite&&this._overlaySprite.dispose(),this._overlayRenderTexture&&this._renderedOverlaySprite.dispose(),this._overlayFilter&&this._overlayFilter.dispose(),this._overlayTexture&&this._overlayTexture.dispose(),this._overlayRenderTexture&&this._overlayRenderTexture.dispose(),this._renderedOverlaySprite&&this._renderedOverlaySprite.dispose()}}).identifier="overlay",xd.BLEND_MODES=fd.BLEND_MODES,xd.prototype.availableOptions={identifier:{type:l.STRING},image:{type:l.IMAGE},blendMode:{type:l.NUMBER,default:fd.BLEND_MODES.MULTIPLY,available:Object.keys(fd.BLEND_MODES).map((t=>fd.BLEND_MODES[t]))},alpha:{type:l.NUMBER,default:1},flipHorizontally:{type:l.BOOLEAN,default:!1},flipVertically:{type:l.BOOLEAN,default:!1}},ia.Operations.OverlayOperation=xd,bd=xd})),Dg=b((()=>{vd="/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_radius;\nuniform float u_blurRadius;\nuniform float u_gradientRadius;\nuniform vec2 u_position;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nconst float blurSteps = 30.0;\nconst float EPSILON = 0.000000001;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    vec2 coord = v_texCoord * u_texSize;\n    vec2 diff = coord - u_position;\n    float dist = sqrt(diff.x * diff.x + diff.y * diff.y);\n\n    float blurPercentage = smoothstep( \n      0.0, 1.0,\n      (abs(dist) - u_radius) / u_gradientRadius\n    );\n\n    float radius = blurPercentage * u_blurRadius;\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    for (float t = -blurSteps; t <= blurSteps; t++) {\n        float percent = (t + offset - 0.5) / blurSteps;\n        float weight = 1.0 - abs(percent);\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / max(total, EPSILON);\n}\n"})),kg=b((()=>{_a(),ah(),Dg(),({Vector2:wd}=Wn),(Dd=class extends Jn.Filter{constructor(...t){super(...t),this._fragmentSource=vd,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastPosition=new wd,this._blurFilter=new Ba,this._blurredRenderTarget=new Jn.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new Jn.CanvasRenderTarget(100,100,1)}_applyCanvas(t,e,i,s=!1){if("low"===this._options.blurQuality)return void this._renderLQBlur(t,e,i,s);const r=e.getDimensions(),n=!i.getDimensions().equals(r),{blurRadius:o,position:a,texSize:l,gradientRadius:h}=this._options;if(e.getBaseTexture().isDirty()||this._lastBlurRadius!==o||n){const n=new wd(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(n);const u={blurRadius:o,texSize:r},c=(t,e,i)=>Math.min(Math.max(t,e),i),d=(t,e,i)=>{const s=c((i-t)/(e-t),0,1);return s*s*(3-2*s)},_=(t,e)=>d(0,1,(Math.abs(l.clone().multiply(t,e).subtract(a).len())-this._options.radius)/(2*h))*o;this._blurFilter.set(u),this._blurFilter._applyCanvas(t,e,i,s,_),this._lastBlurRadius=o}}_renderLQBlur(t,e,i,s=!1){const r=e.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(r);this._blurredRenderTarget.setPixelRatio(e.getPixelRatio()),this._blurredRenderTarget.resizeTo(e.getDimensions()),this._maskRenderTarget.setPixelRatio(e.getPixelRatio()),this._maskRenderTarget.resizeTo(e.getDimensions());const o=!this._lastPosition.equals(this._options.position)||this._lastGradientRadius!==this._options.gradientRadius||n,a=e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;o&&(this._renderMask(),this._lastPosition=this._options.position.clone(),this._lastGradientRadius=this._options.gradientRadius),a&&(this._blurImage(e,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(e,i)}_renderMask(){const t=this._maskRenderTarget.getCanvas(),e=this._maskRenderTarget.getContext(),i=new wd(t.width,t.height),s=this._maskRenderTarget.getPixelRatio(),r=this._options.position.clone().multiply(i);let{radius:n,gradientRadius:o}=this._options;n*=t.height,o*=t.height;const a=e.createRadialGradient(r.x,r.y,0,r.x,r.y,(n+o)*s);a.addColorStop(0,"#FFFFFF"),a.addColorStop(n/(n+o),"#FFFFFF"),a.addColorStop(1,"#000000"),e.fillStyle=a,e.fillRect(0,0,i.x,i.y)}_applyMask(t,e){const i=e.getContext(),s=t.getCanvas(),r=t.getContext(),n=this._blurredRenderTarget.getContext(),o=this._maskRenderTarget.getContext(),a=r.getImageData(0,0,s.width,s.height),l=a.data,h=n.getImageData(0,0,s.width,s.height).data,u=o.getImageData(0,0,s.width,s.height).data;let c;for(let d=0;d<s.width*s.height*4;d+=4)c=u[d]/255,l[d]=c*l[d]+(1-c)*h[d],l[d+1]=c*l[d+1]+(1-c)*h[d+1],l[d+2]=c*l[d+2]+(1-c)*h[d+2];i.putImageData(a,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}}).prototype.availableOptions={blurRadius:{type:l.NUMBER,default:30,uniformType:h.FLOAT},radius:{type:l.NUMBER,default:50,uniformType:h.FLOAT},gradientRadius:{type:l.NUMBER,default:25,uniformType:h.FLOAT},position:{type:l.VECTOR2,default:new wd(.5,.5),uniformType:h.FLOAT2},delta:{type:l.VECTOR2,default:new wd(1,1),uniformType:h.FLOAT2},texSize:{type:l.VECTOR2,default:new wd(100,100),uniformType:h.FLOAT2}},kd=Dd})),Tg=b((()=>{_a(),kg(),({Vector2:Td}=Wn),(Cd=class extends yo{constructor(...t){super(...t),this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius;const e={blurQuality:{type:l.STRING}};this._horizontalFilter=new kd({},e),this._verticalFilter=new kd({},e),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Td(.5,.5)),this._verticalFilter.setDelta(new Td(-.5,.5)),this._filter=new kd({},e)}rotate(t){const{position:e}=this._options;90===t?(e.flip(),e.x=1-e.x):-90===t&&(e.flip(),e.y=1-e.y),this.set({position:e})}flip(t){const{position:e}=this._options;switch(t){case"horizontal":e.x=1-e.x;break;case"vertical":e.y=1-e.y}this.set({position:e})}transform(t){const e={},i=this.getPosition();e.position=t.applyToRelativePoint(i),["radius","blurRadius","gradientRadius"].forEach((i=>{const s=this.getOption(i);e[i]=t.applyToRelativeSize(s)})),this.set(e,!1)}_renderWebGL(t){return this._renderBlur(t)}_renderCanvas(t){return this._options.highQualityCanvasBlur?this._renderBlur(t):this._renderLQCanvasBlur(t)}_renderBlur(t){const e=t.getDimensions(),i=e.min(),{position:s,blurRadius:r,radius:n,gradientRadius:o}=this._options,a={blurRadius:r*i,radius:n*i,gradientRadius:o*i,position:s.clone().multiply(e),texSize:e,blurQuality:"high"};return this._horizontalFilter.set(a),this._verticalFilter.set(a),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(t){const{blurRadius:e,radius:i,gradientRadius:s,position:r}=this._options,n=t.getDimensions();return this._filter.set({blurRadius:e,radius:i,gradientRadius:s,position:r,texSize:n,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}).identifier="radial-focus",Cd.prototype.availableOptions={position:{type:l.VECTOR2,default:new Td(.5,.5)},radius:{type:l.NUMBER,default:.25},gradientRadius:{type:l.NUMBER,default:.125},blurRadius:{type:l.NUMBER,default:.025},highQualityCanvasBlur:{type:l.BOOLEAN,default:!1}},ia.Operations.RadialFocusOperation=Cd,Rd=Cd})),Cg=b((()=>{Id="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_filterImage;\nuniform sampler2D u_maskImage;\n\nvoid main() {\n  vec4 color0 = texture2D(u_image, v_texCoord);\n  vec4 color1 = texture2D(u_filterImage, v_texCoord);\n  vec4 mask = texture2D(u_maskImage, v_texCoord);\n  gl_FragColor = mix(color0, color1, mask);\n}\n"})),Rg=b((()=>{_a(),Cg(),(Fd=class extends Jn.Filter{constructor(){super(),this._fragmentSource=Id}_applyCanvas(t,e,i,s=!1){const r=e.getCanvas(),n=e.getContext(),o=i.getContext(),{maskCanvas:a,filterCanvas:l}=this._options,h=a.getContext("2d"),u=l.getContext("2d"),c=h.getImageData(0,0,r.width,r.height).data,d=n.getImageData(0,0,r.width,r.height),_=d.data,m=u.getImageData(0,0,r.width,r.height).data;let g;for(let p=0;p<r.width*r.height*4;p+=4)g=c[p]/255,_[p]=g*m[p]+(1-g)*_[p],_[p+1]=g*m[p+1]+(1-g)*_[p+1],_[p+2]=g*m[p+2]+(1-g)*_[p+2];o.putImageData(d,0,0)}}).prototype.availableOptions={maskImage:{type:l.NUMBER,default:1,uniformType:h.INT},maskCanvas:{type:l.OBJECT,default:null},filterImage:{type:l.NUMBER,default:2,uniformType:h.INT},filterCanvas:{type:l.OBJECT,default:null}},Sd=Fd})),Ig=b((()=>{_a(),({Vector2:Ed}=Wn),Od=class extends we{constructor(t,e){super(e),this._isDisposed=!1,this._operation=t,this._dirtiness={},this.id=st.getUUID(),this._renderTextures={},this._identitySprite=new Jn.Sprite,this._sprite=new Jn.Sprite,this._hitTestSprite=new Jn.Sprite,this._renderers=[]}applyScale(t){}applyRotation(t){const e=this._operation.getInputDimensions();let i=180*this.getRotation()/Math.PI;i+=t,this.setRotation(i*Math.PI/180);const s=(t+360)%360*Math.PI/180,r=Math.cos(s),n=Math.sin(s),o=this._options.position.clone().subtract(.5).multiply(e),a=new Ed(o.x*r-o.y*n,o.x*n+o.y*r).divide(e.clone().flip());this.setPosition(new Ed(.5,.5).add(a))}applyFlip(t){const e=this.getPosition().clone();switch(t){case"horizontal":e.x=1-this._options.position.x;break;case"vertical":e.y=1-this._options.position.y}this.setPosition(e)}applyTransform(t){const e={};e.rotation=t.applyToRotation(this.getRotation()),e.position=t.applyToRelativePoint(this.getPosition()),this._options.dimensions&&(e.dimensions=t.applyToDimensions(this.getDimensions())),this.set(e,!1)}getDisplayObject(){return this._sprite}getHitTestDisplayObject(){return this._sprite}_getTexture(){throw new Error("Sprite#_getTexture is abstract and not implemented in child class.")}_prepareRenderTexture(t){if(this._renderTexture)this._renderTexture.clear();else{const e=this._getTexture();this._renderTextureContainer=new Jn.Container,this._renderTextureSprite=new Jn.Sprite(e),this._renderTextureContainer.addChild(this._renderTextureSprite),this._renderTexture=this._getRenderTexture(t.getRenderer(),e.getDimensions())}}_rendersToRenderTexture(t){return t.getOptions().smoothDownscaling&&t.getRenderer().isOfType(u.WEBGL)}_optionEquals(t,e){return"type"===t||super._optionEquals(t,e)}update(t,e){this._isDisposed||(this._rendersToRenderTexture(t)&&(this._prepareRenderTexture(t),this._renderToRenderTexture(t)),this._updateSprite(e))}_updateSprite(t){[this._sprite,this._hitTestSprite].forEach((e=>{if(!e.getTexture())return;e.setAnchor(this._options.anchor),e.setPosition(this._options.position.clone().multiply(t)),"undefined"!==typeof this._options.alpha&&e.setAlpha(this._options.alpha);let{dimensions:i}=this._options;i&&(i=i.clone().multiply(this._operation.getSDK().getTextureScale()),e.setWidth(i.x),e.setHeight(i.y)),e.updateTransform();const s=e.getTexture().getFrame(),r=new Ed(s.width,s.height);e.setPivot(this._options.pivot.clone().multiply(r)),e.setRotation(this._options.rotation),e.updateTransform()}))}_renderToRenderTexture(t){const e=this._getTexture().getDimensions(),i=this._getRenderTexture(t.getRenderer(),e),s=e.clone();if(this._options.smoothDownscaling&&(s.x=st.nextHighestPOT(s.x),s.y=st.nextHighestPOT(s.y)),this._renderTexture.resizeTo(s),this._renderTexture.render(this._renderTextureContainer),this._options.smoothDownscaling){const t=s.clone().subtract(e.x,e.y).divide(s),r=i.getUVs().getUVs();r[0].x=r[3].x=0,r[1].x=r[2].x=1-t.x,r[0].y=r[1].y=0,r[2].y=r[3].y=1-t.y}this._sprite.setTexture(i)}isDirtyForRenderer(t){return t.id in this._dirtiness||(this._dirtiness[t.id]=!0),this._dirtiness[t.id]}setDirtyForRenderer(t,e){this._renderers[e.id]=e,this._dirtiness[e.id]=t}setDirty(t){for(const e in this._dirtiness)this.setDirtyForRenderer(t,this._renderers[e])}_getRenderTexture(t,e=new Ed(100,100)){return this._renderTextures[t.id]||(this._renderTextures[t.id]=new Jn.RenderTexture(t,e.x,e.y,1)),this._renderTextures[t.id]}dispose(){this._isDisposed=!0;for(const t in this._renderTextures)this._renderTextures[t].dispose()}canBeDuplicated(){return!0}canBeDeleted(){return!0}canMaskCanvas(){return!1}canAdjustPadding(){return!1}canBeTakenToFront(){return!0}canBeFlippedHorizontally(){return!0}}})),Fg=b((()=>{_a(),({Vector2:Ad}=Wn),(Bd=class extends we{constructor(...t){super(...t),this._lastOptions={},this._lastInputDimensions=new Ad(0,0),this._brush=null}getBrushImage(t){if(this._brush&&this.optionsEqual(this._lastOptions)&&t.equals(this._lastInputDimensions))return this._brush;const{image:e,size:i}=this._options;e.width=e.height=Math.ceil(i*t.min());const s=st.createCanvas();s.width=e.width,s.height=e.height;const r=s.getContext("2d");r.drawImage(e,0,0,s.width,s.height);const n=this._tintImageData(r.getImageData(0,0,s.width,s.height),s.width,s.height);return r.putImageData(n,0,0),this._lastOptions=this.serializeOptions(["size","color"]),this._brush=s,this._lastInputDimensions=t.clone(),s}_tintImageData(t){const{color:e}=this._options;for(let i=0;i<t.data.length;i+=4)t.data[i]+=(255*e.r-t.data[i])*e.a,t.data[i+1]+=(255*e.g-t.data[i+1])*e.a,t.data[i+2]+=(255*e.b-t.data[i+2])*e.a;return t}clone(){return new(0,this.constructor)(this._options)}}).prototype.availableOptions={identifier:{type:l.STRING},image:{type:l.IMAGE},size:{type:l.NUMBER,default:.05},color:{type:l.COLOR,default:Wt.RED}}})),Sg=b((()=>{_a(),Fg(),(Md=class extends Bd{getBrushImage(t){if(this._brush&&this.optionsEqual(this._lastOptions)&&t.equals(this._lastInputDimensions))return this._brush;let{size:e,hardness:i,color:s}=this._options;const r=st.createCanvas();r.width=r.height=Math.ceil(e*t.min());const n=r.getContext("2d");if(s=s.clone(),s.a=1,1===r.width)n.fillStyle=s.toRGBA(),n.fillRect(0,0,1,1);else{const t=n.createRadialGradient(r.width/2,r.height/2,Math.min(r.width/2-1,r.width/2*i),r.width/2,r.height/2,r.width/2);t.addColorStop(0,s.toRGBA());const e=s.clone();e.a=0,t.addColorStop(1,e.toRGBA()),n.fillStyle=t,n.fillRect(0,0,r.width,r.height)}return this._lastOptions=this.serializeOptions(["size","color","hardness"]),this._brush=r,this._lastInputDimensions=t.clone(),r}}).identifier="imgly_brush_radial",Md.prototype.availableOptions={...Bd.prototype.availableOptions,hardness:{type:l.NUMBER,default:1}}})),Eg=b((()=>{_a(),({Vector2:Pd,CubicBezierCurve:Ld}=Wn),zd=class{constructor(t,e,i=3){this._path=t,this._drawnCanvases=[],this._position=e,this._smooth=i}getBezierCurve(t,e,i,s){if(!e)return null;let r,n,o,a;s?(r=(s.x-e.x)/this._smooth,n=(s.y-e.y)/this._smooth):(r=(i.x-e.x)/this._smooth,n=(i.y-e.y)/this._smooth),t?(o=(i.x-t.x)/this._smooth,a=(i.y-t.y)/this._smooth):(o=(i.x-e.x)/this._smooth,a=(i.y-e.y)/this._smooth);const l=e.clone().add(o,a),h=i.clone().subtract(r,n);return new Ld(e,l,h,i)}renderToCanvas(t,e,i,s,r,n=1){if(-1!==this._drawnCanvases.indexOf(e))return;const o=new Pd(e.width,e.height),a=e.getContext("2d"),l=this._position.clone().multiply(o),h=s?s.getPosition().clone().multiply(o):null,u=i?i.getPosition().clone().multiply(o):null,c=r?r.getPosition().clone().multiply(o):null,d=(l.clone().subtract(h).len(),t.width/10),_=this.getBezierCurve(u,h,l,c);let m;if(_){_.calculateSegments(20);const t=_.getLength();m=_.arcLengthApproxSample(Math.ceil(t/d))}else m=[l];for(let g=0;g<m.length;g++){const e=m[g];let i=.5*t.width/(2*d);i*=1-n,i=1/(1+i),a.globalAlpha=i,a.drawImage(t,e.x-t.width/2,e.y-t.height/2,t.width,t.height)}a.globalAlpha=1,this._drawnCanvases.push(e)}setPosition(t){this._position=t}getPosition(){return this._position.clone()}setDirty(){this._drawnCanvases=[]}}})),Og=b((()=>{_a(),Eg(),(Nd=class extends we{constructor(t,e,i){super(e),this._operation=t,this._canvas=i||st.createCanvas(),this._context=this._canvas.getContext("2d")}serializeOption(t,e=!1){return"controlPoints"===t?this._options.controlPoints.map((t=>{const i=t.getPosition();return e?i.toObject():i.clone()})):super.serializeOption(t,e)}_optionEquals(t,e){if("controlPoints"===t){const{controlPoints:t}=this._options;for(let i=0,s=t.length;i<s;i++)if(!t[i].getPosition().equals(e[i]))return!1;return!0}return super._optionEquals(t,e)}render(t){const{controlPoints:e,size:i}=this._options;if(e.length<2)return;const s=this.getBrush(),r=s&&s.getHardness?s.getHardness():1;let n,o,a,l;st.ensureCanvasDimensions(this._canvas,t),this._brush&&this._lastBrushSize===i&&t.equals(this._brushInputDimensions)||(this._brushInputDimensions=t.clone(),this._lastBrushSize=i);for(let h=0;h<e.length;h++)n=e[h-2],o=e[h-1],a=e[h],l=e[h+1],a.renderToCanvas(this._options.brush.getBrushImage(t),this._canvas,n,o,l,r)}_createBrush(t){let{size:e,hardness:i,color:s}=this._options;const r=st.createCanvas();r.width=r.height=Math.ceil(e*t.min());const n=r.getContext("2d");if(s=s.clone(),s.a=1,1===r.width)n.fillStyle=s.toRGBA(),n.fillRect(0,0,1,1);else{const t=n.createRadialGradient(r.width/2,r.height/2,Math.min(r.width/2-1,r.width/2*i),r.width/2,r.height/2,r.width/2);t.addColorStop(0,s.toRGBA());const e=s.clone();e.a=0,t.addColorStop(1,e.toRGBA()),n.fillStyle=t,n.fillRect(0,0,r.width,r.height)}return r}addControlPoint(t){const e=new zd(this,t);this._options.controlPoints.push(e),this.emit("update",this)}getCanvas(){return this._canvas}setCanvas(t){this._canvas=t,this._context=t.getContext("2d")}setDirty(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._options.controlPoints.forEach((t=>{t.setDirty()}))}forEachControlPoint(t){this._options.controlPoints.forEach(t)}renderToCanvas(t){const e=t.getContext("2d");e.save(),e.globalAlpha=this._options.brush.getColor().a,e.drawImage(this._canvas,0,0),e.restore()}getCanvasDimensions(){return this._canvasDimensions}}).prototype.availableOptions={id:{type:l.STRING,default:()=>st.getUUID()},brush:{type:l.OBJECT,required:!0},controlPoints:{type:l.ARRAY,default:[]},closed:{type:l.BOOLEAN,default:!1}},Ud=Nd})),Ag=b((()=>{_a(),Ig(),Fg(),Sg(),Og(),({Vector2:Gd}=Wn),(jd=class extends Od{constructor(...t){super(...t),this._persistedPaths=[],this._outputCanvasDirty=!0,this._outputCanvas=st.createCanvas(),this._outputContext=this._outputCanvas.getContext("2d"),this._persistCanvas=st.createCanvas(),this._persistContext=this._persistCanvas.getContext("2d"),this._nextCanvas=st.createCanvas(),this._texture=Jn.Texture.fromCanvas(this._outputCanvas),this._sprite.setTexture(this._texture),this._onPathUpdate=this._onPathUpdate.bind(this)}applyFlip(t){this._options.paths.forEach((e=>{e.forEachControlPoint((e=>{const i=e.getPosition().clone();switch(t){case"horizontal":i.x=1-i.x;break;case"vertical":i.y=1-i.y}e.setPosition(i)})),e.setDirty(!0)})),this._reset()}applyRotation(t){this._options.paths.forEach((e=>{e.forEachControlPoint((e=>{const i=e.getPosition().clone();90===t?(i.flip(),i.x=1-i.x):-90===t&&(i.flip(),i.y=1-i.y),e.setPosition(i)})),e.setDirty(!0)})),this._reset()}applyTransform(t){let e=null;this._options.paths.forEach((i=>{i.forEachControlPoint((e=>{e.setPosition(t.applyToRelativePoint(e.getPosition()))}));const s=i.getBrush();s!==e&&(s.setSize(t.applyToRelativeSize(s.getSize())),e=s),i.setDirty(!0)})),this._reset()}clearCanvas(){if(!this._outputCanvas)return;this._outputCanvasDirty=!0;const{width:t,height:e}=this._outputCanvas;this._outputContext.clearRect(0,0,t,e)}clearPersistCanvas(){if(!this._persistCanvas)return;const{width:t,height:e}=this._persistCanvas;this._persistContext.clearRect(0,0,t,e)}serializeOptions(t,e=!1){const i=super.serializeOptions(t,e);return t||(i.type="brush"),i}serializeOption(t,e=!1){return"paths"===t?this._options.paths.map((t=>t.serializeOptions(void 0,e))):super.serializeOption(t,e)}createPath(t){const e=new Ud(this._operation,{brush:t},this._nextCanvas);return e.on("update",this._onPathUpdate),this._options.paths.push(e),this.setDirty(!0),e}_onPathUpdate(){this._operation.setDirty(!0),this.setDirty(!0)}_onPathPersist(t){t.renderToCanvas(this._persistCanvas),this._nextCanvas=t.getCanvas();this._nextCanvas.getContext("2d").clearRect(0,0,this._nextCanvas.width,this._nextCanvas.height),this._persistedPaths.push(t)}_getTexture(){return this._texture}setDirtyForRenderer(t,e,i=!1){super.setDirtyForRenderer(t,e,i),t&&i&&(this._persistedPaths=[],this.clearPersistCanvas(),this._options.paths.forEach((t=>{t.setDirty(!0)})))}setDirty(t,e=!1){for(const i in this._dirtiness)this.setDirtyForRenderer(t,this._renderers[i],e)}render(t){const e=this._operation.getSDK().getRenderer();this.isDirtyForRenderer(e)&&(st.ensureCanvasDimensions(this._outputCanvas,t),st.ensureCanvasDimensions(this._persistCanvas,t),this._options.paths.forEach((e=>{e.render(t),e.getClosed()&&-1===this._persistedPaths.indexOf(e)&&this._onPathPersist(e)})),this.clearCanvas(),this._outputContext.drawImage(this._persistCanvas,0,0),this._options.paths.forEach((t=>{t.getClosed()||t.renderToCanvas(this._outputCanvas)})),this.setDirtyForRenderer(!1,e))}update(t,e){e&&(st.ensureCanvasDimensions(this._outputCanvas,e),st.ensureCanvasDimensions(this._persistCanvas,e),this._texture.getBaseTexture().update()),this.render(e);const i=t.getRenderer();i.isOfType(u.WEBGL)&&i.updateTexture(this._texture.getBaseTexture()),super.update(t,e)}_reset(){this._persistedPaths=[],this._operation&&this._operation.setDirty(!0),this.setDirty(!0),this.clearCanvas(),this.clearPersistCanvas()}getCanvas(){return this._outputCanvas}_createRadialBrush(){return new Md}_getTempCanvas(){return this._nextCanvas}dispose(){super.dispose(),this._texture&&this._texture.getBaseTexture().dispose()}}).prototype.availableOptions={id:{type:l.STRING,default:()=>st.getUUID()},position:{type:l.VECTOR2,default:new Gd(0,0)},scale:{type:l.VECTOR2,default:new Gd(1,1)},anchor:{type:l.VECTOR2,default:new Gd(0,0)},pivot:{type:l.VECTOR2,default:new Gd(0,0)},rotation:{type:l.NUMBER,default:0},paths:{type:l.ARRAY,default:[],setter(t){return t=t.map((t=>{if(t instanceof Ud)return t;const{brush:e,closed:i}=t,s=new Ud(this._operation,{brush:e,closed:i},this._nextCanvas);return t.controlPoints.forEach((t=>{s.addControlPoint(t)})),s})),this._reset(),t}}},jd.type="brush",jd.Brush=Bd,jd.Path=Ud,jd.Brushes={RadialBrush:Md},Vd=jd})),Bg=b((()=>{_a(),ah(),Rg(),Ag(),({Vector2:Wd}=Wn),(Hd=class extends yo{constructor(...t){super(...t);const e=this._sdk.getRenderer();this._lastBlurRadius=null,this._blurredRenderTexture=new Jn.RenderTexture(e,100,100,1),this._maskRenderTexture=new Jn.RenderTexture(e,100,100,1),this._brushSprite=new Vd(this),this._brushSpriteContainer=new Jn.Container;const i=this._brushSprite.getDisplayObject();if(this._brushSpriteContainer.addChild(i),this._outputSprite=new Jn.Sprite,this._outputContainer=new Jn.Container,this._outputContainer.addChild(this._outputSprite),this._maskFilter=new Sd,e.isOfType(u.WEBGL)){this._horizontalFilter=new Ba,this._verticalFilter=new Ba,this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Wd(1,1)),this._verticalFilter.setDelta(new Wd(-1,1));let t=this._maskRenderTexture.getBaseTexture();t.setGLUnit(this._maskFilter.getMaskImage()),e.updateTexture(t,!1),t=this._blurredRenderTexture.getBaseTexture(),t.setGLUnit(this._maskFilter.getFilterImage()),e.updateTexture(t,!1)}else e.isOfType(u.CANVAS)&&(this._blurFilter=new Ba,this._sprite.setFilters([this._blurFilter]),this._maskFilter.setMaskCanvas(this._maskRenderTexture.getRenderTarget().getCanvas()),this._maskFilter.setFilterCanvas(this._blurredRenderTexture.getRenderTarget().getCanvas()));this._outputSprite.setFilters([this._maskFilter])}flip(t){this._brushSprite.applyFlip(t),this.setDirty(!0,!0),this._lastBlurRadius=null}rotate(t){this._brushSprite.applyRotation(t),this.setDirty(!0,!0),this._lastBlurRadius=null}transform(t,e){this._brushSprite.applyTransform(t,e),this.setDirty(!0,!0),this._lastBlurRadius=null}_render(t){return this._renderBlur(t),this._renderMask(t),this._outputSprite.setTexture(t),this._renderTexture.render(this._outputContainer),Promise.resolve()}_renderMask(t){const e=t.getDimensions();this._maskRenderTexture.getDimensions().equals(e)||this._maskRenderTexture.resizeTo(e),this._brushSprite.update(this._sdk,e),this._maskRenderTexture.clear(Wt.BLACK),this._maskRenderTexture.render(this._brushSpriteContainer);const i=this._sdk.getRenderer();i.isOfType(u.WEBGL)&&i.updateTexture(this._maskRenderTexture.getBaseTexture(),!1)}_renderBlur(t){const e=t.getDimensions(),i=this._blurredRenderTexture.getDimensions();i.equals(e)||this._blurredRenderTexture.resizeTo(e);const{blurRadius:s}=this._options;if(this._lastBlurRadius!==s||!i.equals(e)){const t=this._sdk.getRenderer();let i;if(t.isOfType(u.WEBGL)){i={blurRadius:s*e.min(),texSize:e},this._horizontalFilter.set(i),this._verticalFilter.set(i)}else t.isOfType(u.CANVAS)&&(i={blurRadius:s},this._blurFilter.set(i));this._blurredRenderTexture.render(this._container),this._lastBlurRadius=s}const r=this._sdk.getRenderer();r.isOfType(u.WEBGL)&&r.updateTexture(this._blurredRenderTexture.getBaseTexture(),!1)}getBrush(){return this._brushSprite}createPath(t,e=1){const i=new Vd.Brushes.RadialBrush({size:t,hardness:e,color:Wt.WHITE}),s=this._brushSprite.createPath(i);return this._options.paths.push(s),this.setDirty(!0),s}setDirtyForRenderer(t,e,i){super.setDirtyForRenderer(t,e,i),this._brushSprite.setDirtyForRenderer(t,e,i)}dispose(){super.dispose();this._sdk.getRenderer().isOfType(u.WEBGL)?(this._verticalFilter.dispose(),this._horizontalFilter.dispose()):this._blurFilter.dispose(),this._brushSprite.dispose(),this._maskFilter.dispose(),this._blurredRenderTexture.dispose(),this._maskRenderTexture.dispose()}hasChanges(){return!0}}).identifier="selective-blur",Hd.prototype.availableOptions={blurRadius:{type:l.NUMBER,default:.05},paths:{type:l.ARRAY,default:[],setter(t){return this._brushSprite&&this._brushSprite.setPaths(t),t}}},ia.Operations.SelectiveBlurOperation=Hd,qd=Hd})),Mg=b((()=>{_a(),Ql(),Ig(),({Vector2:Xd,ColorMatrix:Yd}=Wn),(Jd=class extends Od{constructor(...t){super(...t);const{image:e}=this._options,i=e.src||e.filePath||e.toDataUrl&&e.toDataURL();this._isSVG=i&&(!!i.match(/\w+\.svg(?=\?|$)/i)||i.match(/data:image\/svg/i)),this._isSVG&&(this._canvas=st.createCanvas(),this._context=this._canvas.getContext("2d"),this._options.smoothDownscaling=!1),e&&this._onImageUpdate(),this._tintFilter=new Jn.Filters.TintFilter,this._adjustmentsFilter=new la,this._lastRenderedDimensions=Xd.NULL,this._lastRenderedInputDimensions=Xd.NULL,this._onOptionsChange=this._onOptionsChange.bind(this),this._options.adjustments.on("update",this._onOptionsChange)}applyScale(t){this.setDimensions(this.getDimensions().multiply(t))}serializeOptions(t,e=!1){const i=super.serializeOptions(t,e);return t||(i.type="sticker"),i}_rendersToRenderTexture(t){return this._options.smoothDownscaling&&!this._isSVG&&t.getRenderer().isOfType(u.WEBGL)||this._hasAdjustments()||"none"!==this._options.tintMode}_getTexture(){return this._inputTexture}update(t,e){const{dimensions:i,image:s}=this._options;i.equals(Xd.NULL)&&i.set(s.width,s.height),this._sprite.setSmoothDownscaling(!this._isSVG&&this.getSmoothDownscaling());if((!this._lastRenderedInputDimensions.equals(e)||!this._lastRenderedDimensions.equals(i)||this._lastRenderedImage!==s)&&this._isSVG&&t.getRenderer().isOfType(u.WEBGL)){s.width=Math.round(i.x),s.height=Math.round(i.y);const t=4096,e=s.width/s.height;s.width>t&&(s.width=t,s.height=Math.round(s.width/e)),s.height>t&&(s.height=t,s.width=Math.round(s.height*e)),this._canvas.width=s.width,this._canvas.height=s.height,this._context.clearRect(0,0,s.width,s.height),this._context.drawImage(s,0,0,s.width,s.height),this._inputTexture.getBaseTexture().update()}this._rendersToRenderTexture(t)&&this._prepareRenderTexture(t);const r=[];if(this._rendersToRenderTexture(t)){if(this._hasAdjustments()){r.push(this._adjustmentsFilter);const{adjustments:t}=this._options,e=new Yd;e.multiply(Yd.createBrightnessMatrix(t.getBrightness())),e.multiply(Yd.createSaturationMatrix(t.getSaturation())),e.multiply(Yd.createContrastMatrix(t.getContrast())),this._adjustmentsFilter.set({colorMatrix:e})}this._options.tintMode&&"none"!==this._options.tintMode&&(r.push(this._tintFilter),this._tintFilter.set({mode:Jn.Filters.TintFilter.MODES[this._options.tintMode.toUpperCase()],color:this._options.tintColor}),this._sprite.getTexture()&&this._sprite.getTexture()._baseTexture&&this._sprite.getTexture()._baseTexture.setDirty(!0)),this._renderTextureSprite.setFilters(r)}this._rendersToRenderTexture(t)?this._renderToRenderTexture(t):this._sprite.setTexture(this._inputTexture),this._updateSprite(e),this._applyFlip(),this._lastRenderedDimensions.copy(i),this._lastRenderedInputDimensions.copy(e),this._lastRenderedImage=s}_applyFlip(){const t=this._sprite.getScale(),{flipHorizontally:e,flipVertically:i}=this._options;(e&&t.x>0||!e&&t.x<0)&&(t.x*=-1),(i&&t.y>0||!i&&t.y<0)&&(t.y*=-1),this._sprite.setScale(t)}applyFlip(t){super.applyFlip(t);const e={rotation:this._options.rotation},i=-1*(e.rotation/Math.PI*180);switch(e.rotation=i*Math.PI/180,t){case"horizontal":e.flipHorizontally=!this._options.flipHorizontally,this.set(e);break;case"vertical":e.flipVertically=!this._options.flipVertically,this.set(e)}}_hasAdjustments(){const{adjustments:t}=this._options;return 0!==t.getBrightness()||1!==t.getSaturation()||1!==t.getContrast()}_onImageUpdate(){let t=this._options.image;const e=this._operation.getSDK().getRenderer();this._isSVG&&e.isOfType(u.WEBGL)&&(t=this._canvas),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._inputTexture=Jn.Texture.fromImage(t),this._identitySprite.setTexture(this._inputTexture),this._sprite.setTexture(this._inputTexture),this._renderTexture&&(this._renderTextureSprite.setTexture(this._inputTexture),this._renderTexture.resizeTo(this._inputTexture.getDimensions())),this.setDirty(!0)}scalesUniformly(){return"keepAspect"===this._options.resizeMode}setOption(t,e,i=!0){super.setOption(t,e,i),"image"===t&&this._identitySprite&&this._onImageUpdate()}_onOptionsChange(){const t=this._dirtiness;for(const e in t)t[e]=!0}dispose(){super.dispose(),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._tintFilter.dispose(),this._adjustmentsFilter.dispose(),this._options.adjustments.off("updated",this._onOptionsChange)}}).prototype.availableOptions={id:{type:l.STRING,default:()=>st.getUUID()},identifier:{type:l.STRING,default:""},image:{type:l.IMAGE,required:!0},position:{type:l.VECTOR2,default:Xd.NULL},dimensions:{type:l.VECTOR2,default:Xd.NULL},anchor:{type:l.VECTOR2,default:new Xd(0,0)},pivot:{type:l.VECTOR2,default:new Xd(.5,.5)},rotation:{type:l.NUMBER,default:0},flipHorizontally:{type:l.BOOLEAN,default:!1},flipVertically:{type:l.BOOLEAN,default:!1},smoothDownscaling:{type:l.BOOLEAN,default:!1},tintColor:{type:l.COLOR,default:Wt.WHITE},tintMode:{type:l.STRING,default:"none",available:["none","solid","colorized"]},resizeMode:{type:l.STRING,default:"keepAspect",available:["keepAspect","unrestricted"]},alpha:{type:l.NUMBER,default:1},adjustments:{type:l.CONFIGURABLE,structure:{brightness:{type:l.NUMBER,default:0},saturation:{type:l.NUMBER,default:1},contrast:{type:l.NUMBER,default:1}}}},Jd.type="sticker",Kd=Jd})),Pg=b((()=>{T(Qd=Zd=class{constructor(t){this._seed=void 0===t?Zd.TimeSeed():t}seed(t){this._seed=void 0===t?Zd.TimeSeed():t}next(){let t=0|this._seed;const e=t/Zd.SEED_DIVIDER|0,i=t%Zd.SEED_DIVIDER|0;return t=Zd.SEED_LOW_MULTIPLY*i-Zd.SEED_HIGH_MULTIPLY*e,t<=0&&(t+=Zd.MAX),-1===t&&(t=Zd.MAX-1),this._seed=t,t}nextInRange(t,e){return void 0===e&&(e=t,t=0),t+this.next()%(e-t+1)}nextBool(t=1,e=1){return this.nextInRange(t+e-1)>=t}static TimeSeed(){return Date.now()}pickNext(t){return Array.isArray(t)?t[this.next()%t.length]:null}},"MAX",2147483647),T(Qd,"SEED_DIVIDER",127773),T(Qd,"SEED_LOW_MULTIPLY",16807),T(Qd,"SEED_HIGH_MULTIPLY",2836)})),Lg=b((()=>{_a(),({Rectangle:$d}=Wn),t_=class{constructor(t=0,e=0){this.width=t,this.height=e}set(t,e){this.width=t,this.height=e}aspect(){return this.width/this.height}rectangle(t,e){return new $d(t,e,this.width,this.height)}clone(){return new t_(this.width,this.height)}scale(t,e){return void 0===e&&(e=t),this.width*=t,this.height*=e,this}copy(t){return this.width=t.width,this.height=t.height,this}fitInWidthWithOther(t,e=new t_){return this.copy(t_.fitTwoInWidth(t,this,e)[0]),this}static fitTwoInWidth(t,e,i){const s=e.width*i.height+e.height*i.width,r=i.height*t/s,n=e.width*r,o=e.height*r;return[new t_(n,o),new t_(t-n,o)]}}})),zg=b((()=>{_a(),e_=D(A()),(i_=class extends we{async loadImages(t){return(0,e_.default)(t,(async t=>this.addImage(t.path,t.fullPath,t.image)))}addImage(t,e,i,s="anonymous"){const r=this.getImages();return i?(r[t]={fullPath:e,image:i},Promise.resolve({fullPath:e,image:i})):new Promise(((n,o)=>{(i=new co).onload=()=>{r[t]={fullPath:e,image:i},n({fullPath:e,image:i})},i.crossOrigin=st.getCrossOriginValue(s),i.onerror=o,i.src=e}))}getImage(t){const e=this.getImages()[t];return e?e.image:null}getVariation(t){return this.getFonts()[t]}addFont(t,e){return this.getFonts()[t]=e,e}}).prototype.availableOptions={images:{type:l.OBJECT,default:{}},fonts:{type:l.OBJECT,default:{}}},s_=new i_})),Ng=b((()=>{_a(),Lg(),zg(),r_=(t,e,i,s)=>{const r=i*(4*s)+4*e;return{r:t[r],g:t[r+1],b:t[r+2],a:t[r+3]}},n_=t=>t.a<=254,o_=(t,e,i)=>{let s=!0;for(let r=0;r<i;r++){const n=r_(t,r,e,i);if(!n_(n)){s=!1;break}}return s},a_=(t,e,i,s,r=!1)=>{let n=0;for(let o=s+1;o<i;o++)if(o_(t,o,e)){if(r)break}else n=o-s+1;return n},l_=(t,e,i,s,r=!1)=>{let n=0;for(let o=s-1;o>=0;o--)if(o_(t,o,e)){if(r)break}else n=s-o;return n},h_=(t,e,i,s,r)=>{t.beginPath(),t.moveTo(e,i),t.lineTo(s,r),t.stroke()},u_=(t,e,i,s,r="red")=>{t.save(),t.strokeStyle=r,h_(t,i,e,s,e),t.restore()},c_=(t,e,i,s,r,n="blue")=>{t.save(),t.strokeStyle=n,t.strokeRect(e,i,s,r),t.restore()},(d_=class extends we{constructor(t){super(t);const e=s_.getVariation(this.getFontIdentifier());e||ut.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.set({fontVariation:e}),this._metrics=null,this._canvas=st.createCanvas(),this._context=this._canvas.getContext("2d"),this._isDirty=!0}_onOptionsChange(){this._isDirty=!0}setOption(t,e,i=!0,s=!1){super.setOption(t,e,i,s),"fontIdentifier"!==t||s||this.updateFontVariation()}updateFontVariation(){const t=s_.getVariation(this.getFontIdentifier());return t||ut.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(t),t}setOptions(t={}){this._options={...this._options,...t},this._isDirty=!0}_applyTextOptions(t=this._context,e={}){const{fontSize:i,fontVariation:s,lineHeight:r,textColor:n,alignment:o}={...this._options,...e},{fontStyle:a,fontWeight:l,fontFamily:h}=s.serializeOptions();t.font=`${a} ${l} ${i}px / ${r} ${h}`,t.fillStyle=n,t.textBaseline="alphabetic",t.textAlign=o||"left"}getTextMetrics(){return this._metrics&&!this._isDirty||this._calculateTextMetrics(),{...this._metrics}}getSizeValue(){return this._metrics&&!this._isDirty||this._calculateTextMetrics(),new t_(this._metrics.width,this._metrics.height)}fitWidth(t){if(!this.getFontVariation())return void ut.warn("TextDesignFont#fitText: missing font variation");this._applyTextOptions(this._context,{fontSize:50});const e=t/this._context.measureText(this.getText()).width,i=Math.floor(50*e);return this.setFontSize(i),this._calculateTextMetrics(),this.getTextMetrics()}fitHeight(t){if(!this.getFontVariation())return void ut.warn("TextDesignFont#fitText: missing font variation");const e=t/this._calculateTextMetrics({fontSize:50}).height,i=Math.floor(50*e);return this.setFontSize(i),this._calculateTextMetrics(),this.getTextMetrics()}_calculateTextMetrics(t={}){const e=this._canvas,i=this._context,s={...this._options,...t},r=this.getText();this._applyTextOptions(i,s);const n=Math.ceil(i.measureText(r).width),o=Math.floor(n+2*s.fontSize),a=Math.floor(3*s.fontSize);e.width=o,e.height=a;const l=Math.floor(s.fontSize),h=Math.floor(.6*a);this._applyTextOptions(i,s),i.fillText(r,l,h);const u=i.getImageData(0,0,e.width,e.height).data,c=l_(u,o,0,h,this._options.excludeAccents),d=a_(u,o,a,h,this._options.excludeAccents),_=n,m=c+d;return this._metrics={width:_,height:m,ascender:c,descender:d},this._isDirty=!1,{...this._metrics}}draw(t=this._context,e=0,i=0,s,r=!1){t.save(),this._metrics&&!this._isDirty||this._calculateTextMetrics(),this._applyTextOptions(t,s),t.fillText(this.getText(),e,i+this._metrics.ascender),r&&(c_(t,e,i,this._metrics.width,this._metrics.height),u_(t,i+this._metrics.ascender,e,e+this._metrics.width)),t.restore()}}).prototype.availableOptions={text:{type:l.STRING,default:""},fontIdentifier:{type:l.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:l.OBJECT,default:null},lineHeight:{type:l.NUMBER,default:1},fontSize:{type:l.NUMBER,default:22},textColor:{type:l.STRING,default:"black"},strokeStyle:{type:l.STRING,default:"black"},outlineWidth:{type:l.NUMBER,default:0},textBaseline:{type:l.STRING,default:"alphabetic"},excludeAccents:{type:l.BOOLEAN,default:!1}}})),Ug=b((()=>{_a(),(__=class extends we{}).prototype.availableOptions={text:{type:l.STRING,default:""},frame:{type:l.OBJECT,default:null},font:{type:l.OBJECT,default:null}}})),Gg=b((()=>{_a(),(m_=class extends we{}).prototype.availableOptions={tintColor:{type:l.COLOR,default:Wt.BLACK},textColor:{type:l.COLOR,default:Wt.BLACK},alignment:{type:l.STRING,default:"left",available:["left","center","right"]},lineSpacing:{type:l.NUMBER,default:1},fontIdentifier:{type:l.STRING,default:"imgly_font_open_sans_bold"}}})),jg=b((()=>{_a(),Lg(),Gg(),({Rectangle:g_}=Wn),(p_=class extends we{constructor(t){super(t),this.setSize(new t_(this.getWidth(),0)),this.serverImageSmoothingFix=!1}_getFrame(){const t=this.getSize();return new g_(0,0,t.width,t.height)}_getTextFrame(){return this._getFrame()}_getTextFrameForElement(t){return t.getFrame().clone()}_calculateLayoutElements(){ut.warn("TextDesignRow is an abstract class.")}_getLayoutElements(){return this._options.elements.length<=0&&this.layout(),this.getElements()}_fontSize(t){return ut.warn("TextDesignRow#_fontSize not implemented. @TODO: Is it necessary?"),0}layout(){return this.setElements(this._calculateLayoutElements()),this}textFrame(t,e){return t.getFrame().clone()}willRender(t){}didRender(t){}render(t){t.save(),this._getLayoutElements().forEach((e=>{const{text:i,frame:s,font:r}=e.serializeOptions(),n=this.getAttributes();r.draw(t,s.x,s.y,{textColor:n.getTextColor().toRGBA(),alignment:n.getAlignment()})})),t.restore()}}).prototype.availableOptions={words:{type:l.OBJECT,default:null},width:{type:l.NUMBER,default:100},attributes:{type:l.CONFIGURABLE,default:new m_},shearingAngle:{type:l.NUMBER,default:0},elements:{type:l.ARRAY,default:[]},size:{type:l.OBJECT,default:null}}})),Vg=b((()=>{_a(),Ng(),Ug(),jg(),({Rectangle:f_}=Wn),T(x_=y_=class extends p_{_calculateLayoutElements(){if(this.getWords().size()<=0)return[];const{orientation:t,width:e,size:i,relativeRowOffset:s,attributes:r}=this.serializeOptions(),{fontIdentifier:n}=r,o=this.getWords().joined(3),a=t===y_.Orientations.Left?[o[0],o[1],o[2]]:[o[1],o[2],o[0]],l=st.Array.range(0,2).map((t=>new d_({text:a[t],fontIdentifier:n,fontSize:60}))),h=l.map((t=>t.getSizeValue())),u=h[0].width>h[1].width?0:1,c=(u+1)%2;l[c].fitWidth(h[u].width),h[c]=l[c].getSizeValue();const d=(h[c].height+h[u].height)/(1-s),_=new d_({text:a[2],fontIdentifier:n});_.fitHeight(d);const m=_.getSizeValue().width,g=h[u].width,p=e/(m+g),f=p*m,y=p*g,x=p*d,b=s*x;i.set(e,x);const v=st.Array.range(0,3).map((t=>new d_({text:a[t],fontIdentifier:n})));v[0].fitWidth(y),v[1].fitWidth(y),v[2].fitWidth(f);const w=t===y_.Orientations.Left?0:f,D=[w,w,t===y_.Orientations.Left?y:0],k=[0,v[0].getSizeValue().height+b,0],T=v.map(((t,e)=>new f_(D[e],k[e],t.getSizeValue().width,t.getSizeValue().height)));return v.map(((t,e)=>new __({text:a[e],font:v[e],frame:T[e]})))}},"Orientations",{Right:"RIGHT",Left:"LEFT"}),x_.prototype.availableOptions={...p_.prototype.availableOptions,orientation:{type:l.STRING,default:x_.Orientations.Left,available:[x_.Orientations.Right,x_.Orientations.Left]},relativeRowOffset:{type:l.NUMBER,default:.05}}})),Wg=b((()=>{_a(),({Rectangle:b_}=Wn),v_=class{constructor(t=0,e=0,i=0,s=0){this.top=t,this.left=e,this.bottom=i,this.right=s}multiply(t){this.top*=t,this.left*=t,this.bottom*=t,this.right*=t}toObject(){return{...this}}equals(t,e=0){return Math.abs(t.top-this.top)<=e&&Math.abs(t.left-this.left)<=e&&Math.abs(t.bottom-this.bottom)<=e&&Math.abs(t.right-this.right)<=e}scale(t=1,e){return void 0===e&&(e=t),this.top*=e,this.bottom*=e,this.left*=t,this.right*=t,this}clone(){return new v_(this.top,this.left,this.bottom,this.right)}applyToRectangle(t){return new b_(t.x+this.left,t.y+this.top,t.width-this.left-this.right,t.height-this.top-this.bottom)}static get ZERO(){return new v_(0,0,0,0)}}})),Hg=b((()=>{_a(),Ng(),Wg(),Ug(),jg(),(w_=class extends p_{_calculateLayoutElements(){const{attributes:t,imageInsets:e,size:i,width:s}=this.serializeOptions(),r=this.getWords().joined(1)[0]||"",{fontIdentifier:n}=t,o=new d_({text:r,fontIdentifier:n});o.fitWidth(this._getTextFrame().width);const a=o.getTextMetrics().height+e.top+e.bottom;i.height=a;const l=this._getTextFrame();return[new __({text:r,frame:l,font:o})]}}).prototype.availableOptions={...p_.prototype.availableOptions,imageInsets:{type:l.OBJECT,default:new v_}}})),qg=b((()=>{_a(),({Rectangle:D_,Vector2:k_}=Wn),T_=(t,e,i,s)=>{t.drawImage(e,i.x,i.y,i.width,i.height,s.x,s.y,s.width,s.height)},C_=(t,e,i,s="source-over",r=!1)=>{t.save(),t.fillStyle=i.toRGBA(),t.globalCompositeOperation=s,t.fillRect(e.x,e.y,e.width,e.height),r&&(t.strokeStyle=i.toRGBA(),t.strokeWith=1,t.strokeRect(e.x,e.y,e.width,e.height)),t.restore()},R_=(t,e,i,s,r="source-over",n=!1)=>{t.save(),t.fillStyle=s.toRGBA(),t.globalCompositeOperation=r,i=Math.min(Math.max(i,0),.5*Math.min(e.height,e.width));const o=e.x,a=e.x+e.width,l=e.y,h=e.y+e.height;t.beginPath(),t.moveTo(o+i,l),t.arcTo(a,l,a,h,i),t.arcTo(a,h,o,h,i),t.arcTo(o,h,o,l,i),t.arcTo(o,l,a,l,i),t.closePath(),t.fill(),n&&t.stroke(),t.restore()},I_=(t,e,i,s=4)=>{t.save(),t.strokeStyle=i.toRGBA(),t.lineWidth=s,t.strokeRect(e.x,e.y,e.width,e.height),t.restore()},F_=(t,e,i,s="source-over")=>{t.save();const r=e.height/2,n=e.y+r;let o=e.x+r;const a=e.x+e.width;for(t.fillStyle=i.toRGBA(),t.globalCompositeOperation=s;o<a;)t.beginPath(),t.arc(o,n,r,0,2*Math.PI),t.fill(),o+=4*r;t.restore()},S_=(t,e)=>{const i=e.applyToRectangle(t),{x:s,y:r,width:n,height:o}=t;return{corners:[D_.FromDiagonalPoints(new k_(0,0),new k_(i.x,i.y)),D_.FromDiagonalPoints(new k_(0,i.y+i.height),new k_(i.x,o)),D_.FromDiagonalPoints(new k_(i.x+i.width,i.y+i.height),new k_(n,o)),D_.FromDiagonalPoints(new k_(i.x+i.width,0),new k_(n,i.y))].map((t=>t.translate(s,r))),bars:[D_.FromDiagonalPoints(new k_(i.x,0),new k_(i.x+i.width,i.y)),D_.FromDiagonalPoints(new k_(0,i.y),new k_(i.x,i.y+i.height)),D_.FromDiagonalPoints(new k_(i.x,i.y+i.height),new k_(i.x+i.width,o)),D_.FromDiagonalPoints(new k_(i.x+i.width,i.y),new k_(n,i.y+i.height))].map((t=>t.translate(s,r))),center:i}},E_=(t,e,i,s)=>{const r=e.naturalWidth||e.width,n=e.naturalHeight||e.height,o=S_(new D_(0,0,r,n),s),a=S_(i,s);T_(t,e,o.center,a.center),st.Array.zip(o.corners,a.corners).forEach((([i,s])=>T_(t,e,i,s))),st.Array.zip(o.bars,a.bars).forEach((([i,s])=>T_(t,e,i,s)))},O_=(t,e,i,s,r="source-atop")=>{if(t.save(),s&&(t.globalAlpha=s.a),t.drawImage(e,i.x,i.y,i.width,i.height),s&&(t.globalAlpha=1),s){const e=s.clone();e.a=1,C_(t,i,e,r)}t.restore()}})),Xg=b((()=>{_a(),qg(),Wg(),Hg(),(A_=class extends w_{_getTextColor(){return this.getAutoAdjustTextColor()&&!this.getIsMasked()?this.getBackgroundColor().equals(Wt.WHITE)?Wt.BLACK:Wt.WHITE:this.getAttributes().getTextColor().clone()}_getTextFrame(){return this.getImageInsets().applyToRectangle(this._getFrame())}_getTextFrameForElement(t){const e=super._getTextFrameForElement(t),i=this.getImageInsets();return(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&(e.y-=i.top),e}willRender(t){this.getAttributes().setTextColor(this._getTextColor());const e=this.getImage();if(e){const i=this.getCapInsets(),s=this._getFrame();i&&!i.equals(v_.ZERO)?E_(t,e,s,i):t.drawImage(e,s.x,s.y,s.width,s.height),C_(t,s,this.getBackgroundColor(),"source-atop",!0)}(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&e&&(t.save(),t.globalCompositeOperation="destination-out")}didRender(t){super.didRender(t),(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&t.restore()}}).prototype.availableOptions={...w_.prototype.availableOptions,image:{type:l.IMAGE,default:null},capInsets:{type:l.OBJECT,default:new v_},backgroundColor:{type:l.COLOR,default:Wt.WHITE},autoAdjustTextColor:{type:l.BOOLEAN,default:!0},isMasked:{type:l.BOOLEAN,default:!0},isUsedInInvertedLayout:{type:l.BOOLEAN,default:!1}}})),Yg=b((()=>{_a(),Wg(),(B_=class extends we{insetsForWidth(t){return this.getRelativeInsets().clone().scale(t)}static get Small(){return new B_({imagePath:"text-design/images/imgly_text_design_asset_banderole_small.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new v_(.05,.2,.05,.2)})}static get Rectangle(){return new B_({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new v_(.05,.05,.05,.05),needsImageSmoothingFix:!0})}static get Celebrate1(){return new B_({imagePath:"text-design/images/imgly_text_design_asset_celebrate_01.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new v_(.05,.2,.05,.2)})}static get Celebrate2(){return new B_({imagePath:"text-design/images/imgly_text_design_asset_celebrate_02.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new v_(.05,.2,.05,.2)})}}).prototype.availableOptions={image:{type:l.IMAGE,default:null},imagePath:{type:l.STRING,default:null},relativeInsets:{type:l.OBJECT,default:new v_},fontIdentifier:{type:l.STRING,default:"imgly_font_open_sans_bold"},needsImageSmoothingFix:{type:l.BOOLEAN,default:!1}}})),Jg=b((()=>{_a(),Wg(),Lg(),(M_=class extends we{getSize(){const t=this.getRows(),e=this.getWidth(),i=t.length-1;let s=t.reduce(((t,e)=>t+e.getSize().height),0);s+=(i+1)*this.getRelativeLineSpacing()*e;const r=this.getRelativeInsets().clone().scale(e);return s+=r.top+r.bottom,new t_(e,s)}}).prototype.availableOptions={text:{type:l.STRING,default:""},lines:{type:l.ARRAY,default:[]},relativeInsets:{type:l.OBJECT,default:new v_},relativeLineSpacing:{type:l.NUMBER,default:0},rows:{type:l.OBJECT,default:[]},background:{type:l.OBJECT,default:null},width:{type:l.NUMBER,default:0}}})),Kg=b((()=>{_a(),P_=class{constructor(t){this.words=[],t&&this.splitIntoWords(t)}splitIntoWords(t){return this.words=t.match(/\S+/g)||[],[...this.words]}get(){return[...this.words]}getWord(t){return this.words[t]}set(t){return this.words=[...t],this}slice(t,e){return P_.fromWords(this.words.slice(t,e))}getLowerCase(){return this.words.map((t=>t.toLowerCase()))}getUpperCase(){return this.words.map((t=>t.toUpperCase()))}size(){return this.words.length}countNumberOfCharacters(){return this.words.reduce(((t,e)=>t+e.length),0)}joined(t){const e=this.size(),i=Math.floor(e/t),s=e%t;let r=0,n=0;return st.Array.range(0,t).map((t=>{r=n;const o=i+(t<s?1:0);return n=Math.min(r+o,e),st.Array.range(r,n).reduce(((t,e)=>t+(e===r?"":" ")+this.words[e]),"")}))}static fromWords(t){const e=new P_;return e.words=[...t],e}}})),Zg=b((()=>{_a(),Pg(),Wg(),Hg(),Gg(),Jg(),Kg(),10,4,.4,T(L_=class extends we{constructor(t){super(t),this._relativeInsets=new v_,this._background=null,this._fontRandomizer=new Qd(0),this._lineNumberRandomizer=new Qd(0),this._wordsPerLineRandomizer=new Qd(0),this._seedPool=[this._fontRandomizer,this._lineNumberRandomizer,this._wordsPerLineRandomizer]}seed(t){this._seedPool.forEach((e=>e.seed(t)))}getImagePaths(){return[]}onImagesLoaded(){}getMaximumNumberOfTries(){return 10}getMinLineCountOfRandom(){return 4}getRandomAdditionalLinePercentage(){return.4}_fontForRow(t,e){return this._fontRandomizer.pickNext(this.getFontIdentifiers())}_modifiedText(t){return t.replace("\n"," ").replace("\t"," ")}_minimumNumberOfLines(t){return Math.ceil(Math.sqrt(t.size()))}_maximumNumberOfLines(t){return t.size()}_calculatedNumberOfLines(t){let e=this._minimumNumberOfLines(t);if(t.size()>=this.getMinLineCountOfRandom()){const t=Math.floor(Math.max(1,e*this.getRandomAdditionalLinePercentage()));e+=this._lineNumberRandomizer.nextInRange(0,t)}return Math.min(e,this._maximumNumberOfLines(t))}_randomizedNumberOfWordsPerLine(t,e){if(t>e)return ut.warn("TextDesign#_randomizedNumberOfWordsPerLine: Invalid number of lines"),e;const i=st.Array.repeat(1,t);return st.Array.range(t,e).forEach((e=>{const s=this._wordsPerLineRandomizer.nextInRange(0,t-1);i[s]+=1})),i}_textLines(t){const e=new P_(t),i=this._calculatedNumberOfLines(e);return this._randomizedNumberOfWordsPerLine(i,e.size()).reduce(((t,i)=>({index:t.index+i,lines:[...t.lines,e.slice(t.index,Math.min(t.index+i,e.size()))]})),{index:0,lines:[]}).lines}_validTextLines(t){let e=this._textLines(t),i=0;do{if(i=st.Array.findIndex(e,(t=>t.countNumberOfCharacters()<3)),i>=0){const t=e[i-1],s=e[i+1];(t?t.countNumberOfCharacters():Number.MAX_SAFE_INTEGER)<(s?s.countNumberOfCharacters():Number.MAX_SAFE_INTEGER)&&t?(t.words=[...t.words,...e[i].words],e=[...e.slice(0,i),...e.slice(i+1)]):s&&(s.words=[...e[i].words,...s.words],e=[...e.slice(0,i),...e.slice(i+1)])}}while(i>-1&&e.length>1);return e}_modifiedLines(t){return t}_getBackground(){return this._background}generateLayoutData(t,e){const i=this._modifiedText(t),s=this._modifiedLines(this._validTextLines(i)),r=e*(1-this._relativeInsets.left-this._relativeInsets.right),n=this._layoutRows(s,r);return new M_({text:i,relativeInsets:this._relativeInsets.clone(),relativeLineSpacing:this.getRelativeLineSpacing(),background:this._background||this._getBackground(),lines:s,rows:n,width:e})}_layoutRows(t,e){return t.map(((t,i)=>this._randomLayoutRow(t,i,e,new m_({fontIdentifier:this._fontForRow(i,t)})).layout()))}_randomLayoutRow(t,e,i,s){return new w_({words:t,width:i,attributes:s})}},"defaultFontIdentifiers",[]),T(L_,"identifier","textdesign"),L_.prototype.availableOptions={fontIdentifiers:{type:l.ARRAY,default:[]},relativeLineSpacing:{type:l.NUMBER,default:0}}})),Qg=b((()=>{_a(),Pg(),Vg(),Hg(),Xg(),Gg(),Yg(),zg(),Zg(),z_=class extends L_{constructor(...t){super(...t),T(this,"getImagePaths",(()=>{const t=this.getBanderoles();return t&&t.map((t=>t.getImagePath()))||[]})),T(this,"onImagesLoaded",(()=>{const t=this.getBanderoles();t&&t.forEach((t=>{const e=s_.getImage(t.getImagePath());e?t.setImage(e):ut.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`)}))})),this._rowTypeLessThan3WordsRandomizer=new Qd(0),this._rowTypeMoreThan3WordsRandomizer=new Qd(0),this._banderolesRandomizer=new Qd(0),this._seedPool=[...this._seedPool,this._rowTypeLessThan3WordsRandomizer,this._rowTypeMoreThan3WordsRandomizer,this._banderolesRandomizer]}_modifiedText(t){return super._modifiedText(t).toUpperCase()}generateLayoutData(t,e){return this._options.hasMaskedText=!1,super.generateLayoutData(t,e)}_randomLayoutRow(t,e,i,s){if(t.size()<3){const e=0===this._rowTypeLessThan3WordsRandomizer.nextInRange(0,2);return this._layoutRow(t,i,s,e)}const r=this._rowTypeMoreThan3WordsRandomizer.nextInRange(0,3);switch(r){case 0:return new x_({words:t,width:i,attributes:s,orientation:x_.Orientations.Left});case 1:return new x_({words:t,width:i,attributes:s,orientation:x_.Orientations.Right});case 2:return this._layoutRow(t,i,s,!0);case 3:return new w_({words:t,width:i,attributes:s});default:throw new Error(`TextDesignBlocks#_randomLayoutRow: Invalid randomValue generated: ${r}.`)}}_layoutRow(t,e,i,s){if(this.getHasMaskedText()&&(s=!1),s){this.setHasMaskedText(!0);const i=this._banderolesRandomizer.pickNext(this.getBanderoles()),s=new A_({words:t,width:e,attributes:new m_({alignment:"left",fontIdentifier:i.getFontIdentifier()}),image:i.getImage(),imageInsets:i.insetsForWidth(e),capInsets:null,backgroundColor:Wt.WHITE});return i.getNeedsImageSmoothingFix()&&(s.serverImageSmoothingFix=!0),s}return new w_({words:t,width:e,attributes:i})}},T(z_,"defaultFontIdentifiers",["imgly_font_campton_bold"]),T(z_,"identifier","imgly_text_design_blocks"),T(z_,"defaultBanderoles",[B_.Rectangle,B_.Small]),z_.prototype.availableOptions={...L_.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:z_.defaultFontIdentifiers},relativeLineSpacing:{type:l.NUMBER,default:.025/3},hasMaskedText:{type:l.BOOLEAN,default:!1},banderoles:{type:l.ARRAY,default:z_.defaultBanderoles}}})),$g=b((()=>{_a(),Hg(),Qg(),T(N_=class extends z_{constructor(...t){super(...t),this._exclusiveFont=null}generateLayoutData(t,e){return this._exclusiveFont=this._fontRandomizer.pickNext(this.getFontIdentifiers()),super.generateLayoutData(t,e)}_fontForRow(t,e){return this._exclusiveFont||super._fontForRow(t,e)}_layoutRow(t,e,i,s){return new w_({words:t,width:e,attributes:i})}},"defaultFontIdentifiers",["imgly_font_ostrich_sans_heavy","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_black"]),T(N_,"identifier","imgly_text_design_blocks_condensed"),N_.prototype.availableOptions={...z_.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:N_.defaultFontIdentifiers}}})),tp=b((()=>{_a(),qg(),Lg(),Ug(),jg(),({Rectangle:U_}=Wn),T(j_=G_=class extends p_{constructor(...t){super(...t),this.setSize(new t_(this.getWidth(),this.getHeight()))}_calculateLayoutElements(){return[new __({frame:this._getTextFrame()})]}render(t){const e=this._getFrame(),i=this.getType(),s=this.getAttributes().getTextColor(),r=e.height/3;let n=new U_(e.x,e.y,e.width,r),o=new U_(e.x,e.y+2*r,e.width,r);switch(i){case G_.FormType.Rect:C_(t,e,s);break;case G_.FormType.DoubleRect:C_(t,n,s),C_(t,o,s);break;case G_.FormType.DoubleRectFirstPunctuated:F_(t,n,s),C_(t,o,s);break;case G_.FormType.DoubleRectSecondPunctuated:C_(t,n,s),F_(t,o,s);break;case G_.FormType.LongLine:{const i=e.height/2,r=new U_(e.x,e.y,e.width,i);R_(t,r,.5*r.height,s);break}case G_.FormType.LongAndShortLine:{const i=.2*e.height,r=.75*i;n=new U_(e.x,e.y+i,e.width,i);const a=e.x+.25*e.width,l=e.y+e.height-r;o=new U_(a,l,.5*e.width,r),R_(t,n,.5*n.height,s),R_(t,o,.5*o.height,s);break}}}},"FormType",{Rect:"RECT",DoubleRect:"DOUBLE_RECT",DoubleRectFirstPunctuated:"DOUBLE_RECT_FIRST_PUNCTUATED",DoubleRectSecondPunctuated:"DOUBLE_RECT_SECOND_PUNCTUATED",LongLine:"LONG_LINE",LongAndShortLine:"LONG_AND_SHORT_LINE"}),j_.prototype.availableOptions={...p_.prototype.availableOptions,height:{type:l.NUMBER,default:100},type:{type:l.STRING,default:j_.FormType.Rect,available:st.values(j_.FormType)}}})),ep=b((()=>{_a(),Hg(),tp(),Qg(),T(V_=class extends z_{_layoutRow(t,e,i,s){return new w_({words:t,width:e,attributes:i})}_layoutRows(t,e){const i=super._layoutRows(t,e),s=.08*e;return[new j_({width:e,height:.032*e,type:j_.FormType.LongLine,shearingAngle:0}).layout(),...i,new j_({width:e,height:s,type:j_.FormType.LongAndShortLine,shearingAngle:0}).layout()]}},"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]),T(V_,"identifier","imgly_text_design_blocks_light"),V_.prototype.availableOptions={...z_.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:V_.defaultFontIdentifiers}}})),ip=b((()=>{_a(),Hg(),Gg(),ep(),T(W_=class extends V_{_layoutRows(t,e){return t.map(((t,i)=>this._randomLayoutRow(t,i,e,new m_({fontIdentifier:this._fontForRow(i,t)})).layout()))}_layoutRow(t,e,i,s){return new w_({words:t,width:e,attributes:i})}},"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]),T(W_,"identifier","imgly_text_design_blocks_light-v3_1_0"),W_.prototype.availableOptions={...V_.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:W_.defaultFontIdentifiers}}})),sp=b((()=>{_a(),Ng(),qg(),Lg(),Ug(),Hg(),({Rectangle:H_}=Wn),T(X_=q_=class extends w_{getImageSize(){const t=this.getLeftImage(),e=this.getRightImage(),i=this.getWords(),s=this.getAttributes().getFontIdentifier(),r=t?new t_(t.width,t.height):new t_,n=i.joined(1)[0];if(!n)return r;const o=new d_({text:n,fontIdentifier:s,fontSize:50}).getSizeValue(),a=e?2:1;r.scale(a,1);const l=r.clone().fitInWidthWithOther(this._getFrame().width,o);return l.scale(1/a,1),l}_getTextFrame(){const t=super._getTextFrame().clone(),e=this.getImageSize(),i=this.getRightImage(),s=this.getImagePosition();return i?(t.x+=e.width,t.width-=2*e.width):s===q_.ImagePosition.Left&&(t.x+=e.width),t}_calculateLayoutElements(){const t=super._calculateLayoutElements(),e=this._getFrame(),i=this.getRightImage(),s=this.getImageSize(),r=this.getImagePosition(),n=this._getTextFrame(),o=this.getAttributes().getFontIdentifier(),a=new d_({text:"stickerClock",fontIdentifier:o});a.fitWidth(this._getTextFrame().width);const l=(new H_).set(e.x,e.y,s.width,s.height);if(i||r!==q_.ImagePosition.Right||(l.x+=n.width),t.push(new __({text:"stickerClock",frame:l,font:a})),i){const e=t[0];if(e){const i=l.clone();i.translate(e.getFrame().width+i.width,0),t.push(new __({text:"stickerClock",frame:i,font:a}))}}return t}render(t){const e=this._getLayoutElements(),i=this.getAttributes(),s=i.getTextColor(),r=this.getLeftImage(),n=this.getRightImage(),o=e[0],a=e[1],{font:l}=o.serializeOptions(),h=this._getTextFrameForElement(o);if(l.draw(t,h.x,h.y,{textColor:i.getTextColor().toRGBA(),alignment:i.getAlignment()}),r){const e=a.getFrame();t.drawImage(r,e.x,e.y,e.width,e.height),C_(t,e,s,"source-atop")}if(e.length>2){const i=e[2].getFrame().clone();t.drawImage(n,i.x,i.y,i.width,i.height),C_(t,i,s,"source-atop")}}},"ImagePosition",{Left:"LEFT",right:"RIGHT"}),X_.prototype.availableOptions={...w_.prototype.availableOptions,leftImage:{type:l.IMAGE,default:null},rightImage:{type:l.IMAGE,default:null},imagePosition:{type:l.STRING,default:X_.ImagePosition.Left,available:[X_.ImagePosition.Left,X_.ImagePosition.Right]}}})),rp=b((()=>{_a(),Hg(),sp(),Yg(),Kg(),Qg(),T(J_=Y_=class extends z_{_fontForRow(t,e){const i=this.getFontIdentifiers();return i[t%i.length]}_minimumNumberOfLines(t){return Math.max(Math.floor(.7*super._minimumNumberOfLines(t)),1)}_maximumNumberOfLines(t){return Math.max(Math.floor(t.countNumberOfCharacters()/5),1)}_randomLayoutRow(t,e,i,s){return this._createSingleRow(Y_.RowType.Single,t,i,s)}_createSingleRow(t,e,i,s){const r=s.getFontIdentifier(),n="imgly_font_amberlight"===r||"imgly_font_handycheera_regular"===r?(new P_).set(e.getLowerCase()):e;switch(t){case Y_.RowType.Single:return new w_({words:n,width:i,attributes:s});case Y_.RowType.SingleImage:return new X_({words:n,width:i,attributes:s});default:return ut.warn(`TextDesignCelebrate#_createSingleRow: Invalid row type '${t}'`),null}}},"defaultFontIdentifiers",["imgly_font_handycheera_regular","imgly_font_rasa_regular"]),T(J_,"defaultBanderoles",[B_.Celebrate1,B_.Celebrate2]),T(J_,"identifier","imgly_text_design_celebrate"),T(J_,"RowType",{Single:"SINGLE",SingleImage:"SINGLE_IMAGE"}),J_.prototype.availableOptions={...z_.prototype.availableOptions,relativeLineSpacing:{type:l.NUMBER,default:.01875},fontIdentifiers:{type:l.ARRAY,default:J_.defaultFontIdentifiers},banderoles:{type:l.ARRAY,default:J_.defaultBanderoles}}})),np=b((()=>{_a(),Ng(),Kg(),qg(),Lg(),Gg(),Ug(),jg(),T(K_=class extends p_{constructor(...t){super(...t),this.setSize(new t_(this.getWidth(),this.getHeight()))}_getImageFrame(){const t=this._getTextFrame().clone(),e=this.getImage();if(this.getDrawingModeAspectFit()&&e){const i=Math.min(t.width/e.width,t.height/e.height),s=e.width*i,r=e.height*i;t.x+=(t.width-s)/2,t.y+=(t.height-r)/2,t.width=s,t.height=r}return t}_calculateLayoutElements(){return[new __({text:"",frame:this._getImageFrame(),font:new d_})]}render(t){const e=this.getImage(),i=this._getImageFrame(),s=this.getAttributes().getTextColor();O_(t,e,i,s)}},"RowImages",{decorative1:"text-design/images/imgly_text_design_asset_decorative_01.png",decorative2:"text-design/images/imgly_text_design_asset_decorative_02.png",decorative3:"text-design/images/imgly_text_design_asset_decorative_05.png",decorative4:"text-design/images/imgly_text_design_asset_decorative_06.png",celebrate1:"text-design/images/imgly_text_design_asset_celebrate_03.png",celebrate2:"text-design/images/imgly_text_design_asset_celebrate_04.png",celebrate3:"text-design/images/imgly_text_design_asset_celebrate_05.png"}),K_.prototype.availableOptions={...p_.prototype.availableOptions,words:{type:l.OBJECT,default:new P_},height:{type:l.NUMBER,default:0},image:{type:l.IMAGE,default:null},imagePath:{type:l.STRING,default:K_.RowImages.decorative1},drawingModeAspectFit:{type:l.BOOLEAN,default:!1},attributes:{type:l.CONFIGURABLE,default:new m_}}})),op=b((()=>{_a(),Pg(),Hg(),sp(),np(),Yg(),zg(),Kg(),Qg(),rp(),Z_=class extends J_{constructor(...t){super(...t),T(this,"getImagePaths",(()=>{const t=this.getBanderoles();return[...t&&t.map((t=>t.getImagePath()))||[],...this._celebrateTypes]})),T(this,"onImagesLoaded",(()=>{const t=this.getBanderoles();t&&t.forEach((t=>{const e=s_.getImage(t.getImagePath());e?t.setImage(e):ut.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`)}))})),this._celebrateTypes=[K_.RowImages.celebrate1,K_.RowImages.celebrate2,K_.RowImages.celebrate3],this._exclusiveFont=null,this._typeRandomizer=new Qd(0),this._useMaskedRandomizer=new Qd(0),this._seedPool.push(this._typeRandomizer),this._seedPool.push(this._useMaskedRandomizer)}_fontForRow(t,e){const i=this.getFontIdentifiers();return i[t%(i.length-1)]}_layoutRows(t,e){const i=this._typeRandomizer.pickNext(this._celebrateTypes),s=s_.getImage(i);s||ut.warn(`TextDesignCelebrateSimple#_layoutRows: Image not fount '${i}'`);return[new K_({width:e,height:.5*e,drawingModeAspectFit:!0,image:s}).layout(),...super._layoutRows(t,e)]}_randomLayoutRow(t,e,i,s){const r=t.countNumberOfCharacters();r<4&&s.setFontIdentifier("imgly_font_rasa_regular");const n=this._useMaskedRandomizer.nextBool(2,1);return r<13&&n&&!this.getHasMaskedText()?this._layoutRow(t,i,s,!0):super._randomLayoutRow(t,e,i,s)}},T(Z_,"identifier","imgly_text_design_celebrate_simple"),T(Z_,"defaultFontIdentifiers",["imgly_font_amberlight","imgly_font_rasa_regular","imgly_font_rasa_500"]),Z_.prototype.availableOptions={...J_.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:Z_.defaultFontIdentifiers}}})),ap=b((()=>{_a(),(Q_=class extends we{render(t,e,i,s,r){ut.warn("TextDesignBackground#render: Abstract class")}}).prototype.availableOptions={}})),lp=b((()=>{_a(),zg(),qg(),ap(),({Rectangle:$_}=Wn),(tm=class extends Q_{getImagePaths(){const{topImagePath:t,bottomImagePath:e,leftImagePath:i,rightImagePath:s}=this._options;return[t,e,i,s].filter((t=>""!==t))}render(t,e,i,s,r){const n=i.clone().scale(e.width),o=e.rectangle(0,0),a=s_.getImage(this.getTopImagePath()),l=s_.getImage(this.getLeftImagePath()),h=s_.getImage(this.getRightImagePath()),u=s_.getImage(this.getBottomImagePath());if(a){const e=a.width/a.height,i=n.top*this.getTopImageFillRate(),r=i*e,l=o.width/2,h=new $_(l-r/2,0,r,i);O_(t,a,h,s)}if(u){const e=u.width/u.height,i=n.bottom*this.getBottomImageFillRate(),r=i*e,a=o.width/2,l=new $_(a-r/2,o.height-i,r,i);O_(t,u,l,s)}if(l){const e=l.width/l.height,i=n.left*this.getLeftImageFillRate(),r=i/e,a=o.height/2,h=new $_(0,a-r/2,i,r);O_(t,l,h,s)}if(h){const e=h.width/h.height,i=n.right*this.getRightImageFillRate(),r=i/e,a=o.height/2-r/2,l=new $_(o.width-i,a,i,r);O_(t,h,l,s)}}}).prototype.availableOptions={topImagePath:{type:l.STRING,default:""},leftImagePath:{type:l.STRING,default:""},bottomImagePath:{type:l.STRING,default:""},rightImagePath:{type:l.STRING,default:""},topImageFillRate:{type:l.NUMBER,default:1},leftImageFillRate:{type:l.NUMBER,default:1},bottomImageFillRate:{type:l.NUMBER,default:1},rightImageFillRate:{type:l.NUMBER,default:1}},tm.Backgrounds=[new tm({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_3.png",topImageFillRate:.8,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.8}),new tm({leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_2.png",leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6}),new tm({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_2.png",topImageFillRate:.6,bottomImageFillRate:.6}),new tm({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_2.png",topImageFillRate:.1,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6})]})),hp=b((()=>{_a(),lp(),Pg(),Wg(),Hg(),Kg(),Zg(),T(em=class extends L_{constructor(...t){super(...t),this._relativeInsets=new v_(.1,.1,.1,.1),this._alreadyContainsARowWithScriptFont=!1,this._backgroundsRandomizer=new Qd(0),this._seedPool.push(this._backgroundsRandomizer)}getImagePaths(){return st.Array.flatten(tm.Backgrounds.map((t=>t.getImagePaths())))}_getBackground(){return this._backgroundsRandomizer.pickNext(tm.Backgrounds)}generateLayoutData(t,e){return this._alreadyContainsARowWithScriptFont=!1,this._background=this._getBackground(),super.generateLayoutData(t,e)}_modifiedText(t){return super._modifiedText(t).toUpperCase()}_fontForRow(t,e){let i=super._fontForRow(t,e);return"imgly_font_petit_formal_script"===i&&(this._alreadyContainsARowWithScriptFont&&(i="imgly_font_bungee_inline"),this._alreadyContainsARowWithScriptFont=!0),i}_randomLayoutRow(t,e,i,s){const r="imgly_font_petit_formal_script"===s.getFontIdentifier();return new w_({words:r?(new P_).set(t.getLowerCase()):t,width:i,attributes:s})}},"identifier","imgly_text_design_equal_width"),T(em,"defaultFontIdentifiers",["imgly_font_ultra","imgly_font_bungee_inline","imgly_font_petit_formal_script"]),em.prototype.availableOptions={...L_.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:em.defaultFontIdentifiers},relativeLineSpacing:{type:l.NUMBER,default:.025}}})),up=b((()=>{_a(),Wg(),hp(),T(im=class extends em{constructor(...t){super(...t),this._relativeInsets=new v_}_getBackground(){return null}},"defaultFontIdentifiers",["imgly_font_ultra"]),T(im,"identifier","imgly_text_design_equal_width_fat"),im.prototype.availableOptions={...em.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:im.defaultFontIdentifiers}}})),cp=b((()=>{_a(),Wg(),(sm=class extends we{insetsForWidth(t){return this.getRelativeInsets().clone().scale(t)}}).prototype.availableOptions={imagePath:{type:l.STRING,default:""},minimumHeightRatio:{type:l.NUMBER,default:0},sizeToFitContent:{type:l.BOOLEAN,default:!0},capInsets:{type:l.OBJECT,default:new v_},relativeInsets:{type:l.OBJECT,default:new v_}},sm.Box=new sm({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",relativeInsets:new v_(.1,.1,.1,.1)}),sm.Badge1=new sm({imagePath:"text-design/images/imgly_text_design_asset_badge1.png",relativeInsets:new v_(.3,.18,.2,.18)}),sm.Badge2=new sm({imagePath:"text-design/images/imgly_text_design_asset_badge2.png",relativeInsets:new v_(.3,.18,.2,.18)}),sm.Badge3=new sm({imagePath:"text-design/images/imgly_text_design_asset_badge3.png",relativeInsets:new v_(.3,.18,.2,.18)}),sm.Badge4=new sm({imagePath:"text-design/images/imgly_text_design_asset_badge4.png",relativeInsets:new v_(.3,.18,.2,.18)}),sm.SpeechBubble1=new sm({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small2.png",relativeInsets:new v_(.04,.07,.12,.07),capInsets:new v_(57,171,123,51)}),sm.SpeechBubble2=new sm({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble3.png",relativeInsets:new v_(.04,.07,.12,.07),capInsets:new v_(6,105,87,15)}),sm.SpeechBubble3=new sm({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small.png",relativeInsets:new v_(.165664675,.2,.165664675,.2),minimumHeightRatio:.7}),sm.SpeechBubble4=new sm({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble4.png",relativeInsets:new v_(.124800224,.2,.291200523,.2),minimumHeightRatio:.7}),sm.SpeechBubble5=new sm({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble5.png",relativeInsets:new v_(.114892823,.27,.15984926,.27)}),sm.Watercolor1=new sm({imagePath:"text-design/images/imgly_text_design_asset_watercolor_01.png",minimumHeightRatio:.7,relativeInsets:new v_(.2,.25,.2,.25)}),sm.Watercolor2=new sm({imagePath:"text-design/images/imgly_text_design_asset_watercolor_02.png",minimumHeightRatio:.7,relativeInsets:new v_(.08,.25,.3,.25)}),sm.Watercolor3=new sm({imagePath:"text-design/images/imgly_text_design_asset_watercolor_03.png",minimumHeightRatio:.7,relativeInsets:new v_(.1,.2,.15,.2)})})),dp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.arabic=void 0;var e="[".concat("\u0620-\u064a\u066e-\u066f\u0671-\u06d5\u06ee-\u06ef\u06fa-\u06ff").concat("\u0750-\u077f","]"),i="".concat(e).concat("[\u064b-\u065f\u0670]","*");t.arabic=i})),_p=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bengali=void 0;var e="[\\u{0980}-\\u{09FF}]",i="".concat(e,"(").concat("\\u{09CD}").concat(e,"|").concat("[\\u{0980}-\\u{0983}\\u{09BC}-\\u{09D7}\\u{09E2}\\u{09E3}\\u{09FE}]",")*");t.bengali=i})),mp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.devanagari=void 0;var e="[\\u{0900}-\\u{097F}]",i="".concat(e,"(").concat("\\u{094D}").concat(e,"|").concat("[\\u{0900}-\\u{0903}\\u{093A}-\\u{0957}\\u{0962}\\u{0963}]",")*");t.devanagari=i})),gp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.gujarati=void 0;var e="[\\u{0A80}-\\u{0AFF}]",i="".concat(e,"(").concat("\\u{0ACD}").concat(e,"|").concat("[\\u{0A81}-\\u{0A83}\\u{0ABC}\\u{0ABE}-\\u{0ACD}\\u{0AE2}\\u{0AE3}\\u{0AFA}-\\u{0AFF}]",")*");t.gujarati=i})),pp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hebrew=void 0;var e="".concat("[\u05d0-\u05ea]").concat("[\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7]","*");t.hebrew=e})),fp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.japaneseKana=void 0;var e="((".concat("[\\u{30A0}-\\u{30FF}]","|").concat("[\\u{3041}-\\u{3096}\\u{309D}-\\u{309F}]",")").concat("[\\u{3099}-\\u{309A}]","?|").concat("[\\u{309B}-\\u{309C}]",")");t.japaneseKana=e})),yp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.kannada=void 0;var e="[\\u{0C80}-\\u{0CFF}]",i="".concat(e,"(").concat("\\u{0CCD}").concat(e,"|").concat("[\\u{0C81}-\\u{0C83}\\u{0CBC}\\u{0CBE}-\\u{0CCD}\\u{0CD5}\\u{0CD6}\\u{0CE2}\\u{0CE3}]",")*");t.kannada=i})),xp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.khmer=void 0;var e="[\\u{1780}-\\u{17FF}]",i="".concat(e,"(").concat("\\u{17D2}").concat(e,"|").concat("[\\u{17B6}-\\u{17D1}\\u{17D3}\\u{17DD}]",")*");t.khmer=i})),bp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lao=void 0;var e="".concat("[\\u{0E80}-\\u{0EFF}]").concat("[\\u{0EB1}\\u{0EB4}-\\u{0EBC}\\u{0EC8}-\\u{0ECD}]","*");t.lao=e})),vp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.malayalam=void 0;var e="[\\u{0D00}-\\u{0D7F}]",i="".concat(e,"(").concat("\\u{0D4D}").concat(e,"|").concat("[\\u{0D00}-\\u{0D03}\\u{0D3B}\\u{0D3C}\\u{0D3E}-\\u{0D4D}\\u{0D57}\\u{0D62}-\\u{0D63}]",")*");t.malayalam=i})),wp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.myanmar=void 0;var e="[\\u{1000}-\\u{109F}]",i="[".concat(["\\u{102B}-\\u{1038}","\\u{103A}-\\u{103E}","\\u{1056}-\\u{1059}","\\u{105E}-\\u{1060}","\\u{1062}-\\u{1064}","\\u{1067}-\\u{106D}","\\u{1071}-\\u{1074}","\\u{1082}-\\u{108D}","\\u{108F}","\\u{109A}-\\u{109D}"].join(""),"]"),s="".concat(e,"(").concat("\\u{1039}").concat(e,"|").concat(i,")*");t.myanmar=s})),Dp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tamil=void 0;var e="".concat("[\\u{0B80}-\\u{0BFF}]").concat("[\\u{0B82}-\\u{0B83}\\u{0BBE}-\\u{0BD7}\\u{0962}\\u{0963}]","*");t.tamil=e})),kp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.telugu=void 0;var e="[\\u{0C00}-\\u{0C7F}]",i="".concat(e,"(").concat("\\u{0C4D}").concat(e,"|").concat("[\\u{0C00}-\\u{0C04}\\u{0C3E}-\\u{0C56}\\u{0C62}\\u{0C63}]",")*");t.telugu=i})),Tp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.thai=void 0;var e="".concat("[\\u0E00-\\u0E7F]").concat("[\\u0E31\\u0E33-\\u0E3A\\u0E47-\\u0E4E]","*");t.thai=e})),Cp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tibetan=void 0;var e="".concat("[\\u{0F00}-\\u{0FFF}]").concat("[\\0F18\\0F19\\0F35\\0F37\\0F39\\0F3E\\0F3F\\u{0F71}-\\u{0F87}\\u{0F8D}-\\u{0FBC}\\u{0FC6}]","*");t.tibetan=e})),Rp=v((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emojiVariation=t.keyCap=t.countryFlag=void 0;t.countryFlag="[\\u{1F1E6}-\\u{1F1FF}]{2}";t.keyCap="[0-9#\\*][\\u{FE0F}]?\\u{20E3}";var e="(".concat(["[\\u{2600}-\\u{26FF}]","[\\u{2700}-\\u{27BF}]","[\\u{1F300}-\\u{1F5FF}]","[\\u{1F600}-\\u{1F64F}]","[\\u{1F680}-\\u{1F6FF}]","[\\u{1F700}-\\u{1F77F}]","[\\u{1F900}-\\u{1F9FF}]"].join("|"),")"),i="".concat(e,"(").concat("\\u{200D}").concat(e,"|").concat("[\\u{1F3FB}-\\u{1F3FF}]","|").concat("[\\u{FE0E}\\u{FE0F}]",")*");t.emojiVariation=i})),Ip=v(((t,e)=>{var i=dp(),s=_p(),r=mp(),n=gp(),o=pp(),a=fp(),l=yp(),h=xp(),u=bp(),c=vp(),d=wp(),_=Dp(),m=kp(),g=Tp(),p=Cp(),f=Rp(),y=[f.countryFlag,f.keyCap,f.emojiVariation,i.arabic,s.bengali,r.devanagari,n.gujarati,o.hebrew,a.japaneseKana,l.kannada,h.khmer,u.lao,c.malayalam,d.myanmar,_.tamil,m.telugu,g.thai,p.tibetan,"."],x=new RegExp("(".concat(y.join("|"),")"),"gu");e.exports={splitGraphemes:function(t){return t.match(x)||[]}}})),Fp=b((()=>{rm=D(Ip()),nm=class{constructor(t){this._context=t,this._lastFontStyle={}}getLines(){let t=[],e=[];const i=this._lines.length;for(let s=0;s<i;s++){const i=this._lines[s],r=this._buildWords(i),n=r.length;for(let s=0;s<n;s++){const i=r[s],n=e.concat(i).join("").replace(/\s+$/i,"");if(this._getWidth(n)>this._maxWidth){e.length>0&&(t.push(e.join("")),e=[i]);const s=i.replace(/\s+$/i,"");if(this._getWidth(s)>this._maxWidth){const s=this._splitWord(i);t=t.concat(s.lines),s.rest&&(e=[s.rest])}}else e.push(i)}t.push(e.join("")),e=[]}return t.map((t=>this._trimLine(t,this._context.textAlign)))}_trimLine(t,e){return t}_buildWords(t){const e=[];let i="";const s=t.length;for(let r=0;r<s;r++){const n=t[r];i+=n," "!==n&&"-"!==n&&r!==s-1||(e.push(i),i="")}return e}_splitWord(t){const e={lines:[],rest:null},i=(0,rm.splitGraphemes)(t),s=i.length;let r=[];for(let n=0;n<s;n++){const t=i[n];this._getWidth(r.concat(t).join(""))>this._maxWidth?(r.length>0&&e.lines.push(r.join("")),r=[t]):r.push(t),n===s-1&&r.length>0&&(e.rest=r.join(""))}return e}_fontStyleChanged(){return this._context.font!==this._lastFontStyle&&(this._lastFontStyle=this._context.font,!0)}_getWidth(t){return this._context.measureText(t).width}setText(t){this._text=t,this._lines=t.split("\n")}setMaxWidth(t){this._maxWidth=t}}})),Sp=b((()=>{_a(),Fp(),({Vector2:om}=Wn),am=class{constructor(t,e){this._text=t,this._operation=e,this._textOptions={},this.rotation=0,this._createCanvas(),this._createTexture()}_createCanvas(){this._canvas=st.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new nm(this._context),this._finalCanvas=st.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d")}_createTexture(){this._texture=Jn.Texture.fromCanvas(this._canvas),this._finalTexture=Jn.Texture.fromCanvas(this._finalCanvas)}_applyTextOptions(t,e){e.font=`${this._text.getFontStyle()} ${this._text.getFontWeight()} ${t.fontSize}px "${this._text.getFontFamily()}"`,this._text.getTextMetrics()?e.textBaseline="alphabetic":e.textBaseline="top",e.textAlign=this._text.getAlignment(),e.fillStyle=this._text.getColor().toRGBA(),e.strokeStyle=this._text.getOutlineColor().toRGBA();const i=this._text.getOutlineWidth();i>0&&(e.lineWidth=i)}_buildOutputLines(t){return this._textSplitter.setText(this._text.getText()),this._textSplitter.setMaxWidth(t),this._textSplitter.getLines().map((t=>t.replace(/\s+$/i,"")))}_renderTextLine(t,e,i){const s=this._text.getAlignment(),r=new om(0,e);switch(s){case"left":r.x=i;break;case"center":r.x=this._canvas.width/2;break;case"right":r.x=this._canvas.width-i}this._context.save(),this._context.translate(r.x,r.y),this._context.fillText(t,0,0),this._context.restore();this._text.getOutlineWidth()>0&&(this._context.miterLimit=2,this._context.strokeText(t,r.x,r.y))}update(t,e){const i=this.calculateFontStyles(t,e);if(i){const{dimensions:s,lines:r}=this._calculateText(t,i,e);this._renderText(t,s,r,i,e),this._updateFinalTexture()}}_updateFinalTexture(){const{width:t,height:e}=this._canvas,{rotation:i}=this,s=Math.cos(i),r=Math.sin(i),n=new om(Math.abs(t*s)+Math.abs(e*r),Math.abs(t*r)+Math.abs(e*s));this._finalCanvas.width=n.x,this._finalCanvas.height=n.y,this._finalContext.save(),this._finalContext.translate(this._finalCanvas.width/2,this._finalCanvas.height/2),this._finalContext.rotate(i),this._finalContext.drawImage(this._canvas,-t/2,-e/2),this._finalContext.restore()}_renderText(t,e,i,s,r){this._canvas.width=e.x,this._canvas.height=e.y,this._text.getMaxHeight()&&(this._canvas.height=Math.min(this._text.getMaxHeight()*r.y,this._canvas.height)),this._context=this._canvas.getContext("2d"),this._context.fillStyle=this._text.getBackgroundColor().toRGBA(),this._context.fillRect(0,0,e.x,e.y),this._applyTextOptions(s,this._context);const n=this._padding(r),o=this._text.getTextMetrics(),a=this._text.getFontSize()*r.y,l=1/o.unitsPerEm*a,h=o.ascender*l;for(let u=0;u<i.length;u++){const t=i[u];this._renderTextLine(t,s.topPadding+s.lineHeight*u+n+h,n)}}calculateFontStyles(t,e){const i=this._text.getFontFamily(),s=this._text.getFontSize()*e.y,r=this._text.getAbsoluteTextHeight(e),n=r*this._text.getLineHeight(),o={fontFamily:i,fontSize:s,lineHeight:n,topPadding:r*(this._text.getLineHeight()-1)/2};return this._textOptions.fontFamily===i&&this._textOptions.fontSize===s&&this._textOptions.lineHeight===n||(this._textOptions=o),o}_calculateText(t,e,i){const s=this._text.getMaxWidth()*i.x;this._applyTextOptions(e,this._context);const r=new om;let n=this._text.getText().split("\n");"undefined"!==typeof s&&(r.x=s,n=this._buildOutputLines(s));for(let l=0;l<n.length;l++){const t=n[l];r.x=Math.max(r.x,this._context.measureText(t).width)}const{lineHeight:o}=e;r.y=n.length*o;const a=this._padding(i);return r.y+=2*a,r.x+=2*a,{dimensions:r,lines:n}}_padding(t){return.2*this._text.getAbsoluteTextHeight(t)}getTexture(){return this._texture}getFinalTexture(){return this._finalTexture}getDimensions(t,e){const i=this.calculateFontStyles(t,e),{dimensions:s}=this._calculateText(t,i,e);return s}dispose(){this._measurementElement&&document.body.removeChild(this._measurementElement),this._texture&&(this._texture.dispose(),this._texture=null),this._finalTexture&&(this._finalTexture.dispose(),this._finalTexture=null)}}})),Ep=b((()=>{_a(),Fp(),Lg(),zg(),({Vector2:lm}=Wn),(hm=class extends we{constructor(t){super(t),this._textOptions={},this._createCanvas()}_createCanvas(){this._canvas=st.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new nm(this._context),this._finalCanvas=st.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d"),this.updateFontVariation()}setOption(t,e,i=!0,s=!1){super.setOption(t,e,i,s),"fontIdentifier"!==t||s||this.updateFontVariation()}updateFontVariation(){const t=s_.getVariation(this.getFontIdentifier());return t||ut.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(t),t}_applyTextOptions(t={},e=this._context){const{fontSize:i,fontVariation:s,lineHeight:r,textColor:n,alignment:o}={...this._options,...t},{fontStyle:a,fontWeight:l,fontFamily:h}=s.serializeOptions();e.font=`${a} ${l} ${i}px "${h}"`,e.fillStyle=n,e.textBaseline="top",e.textAlign=o||"left"}_buildOutputLines(t){return this._textSplitter.setText(this.getText()),this._textSplitter.setMaxWidth(t),this._textSplitter.getLines()}_renderTextLine(t,e){const i=this.getAlignment(),s=new lm(0,e);switch(i){case"center":s.x=this._canvas.width/2;break;case"right":s.x=this._canvas.width}this._context.fillText(t,s.x,s.y)}update(){const t=this.calculateFontStyles();if(t){const{dimensions:e,lines:i}=this._calculateText(t);this._dimensions=e,this._renderText(e,i,t)}}draw(t,e=0,i=0){this.update(),t.drawImage(this._canvas,e,i,this._dimensions.x,this._dimensions.y)}_renderText(t,e,i){this._canvas.width=t.x,this._canvas.height=t.y,this._context=this._canvas.getContext("2d"),this._applyTextOptions(i,this._context);for(let s=0;s<e.length;s++){const t=e[s];this._renderTextLine(t,i.topPadding+i.lineHeight*s)}}getFontFamily(){return this.getFontVariation().getFontFamily()}calculateFontStyles(){const t=this.getFontFamily(),e=this.getFontSize(),i=this.getAbsoluteTextHeight(),s={fontFamily:t,fontSize:e,textHeight:i,lineHeight:i*this.getLineHeight(),topPadding:i*(this.getLineHeight()-1)/2};return this._textOptions={...s},s}getTextMetrics(){return this.getFontVariation().getTextMetrics()}getAbsoluteTextHeight(){const t=this.getFontSize(),e=this.getTextMetrics();if(e){const i=1/e.unitsPerEm*t,s=e.ascender*i,r=e.descender*i;return s+Math.abs(r)}return t*this.getLineHeight()*1.1}_calculateText(t){this._applyTextOptions(t,this._context);const e=new lm;let i=this.getText().split("\n");for(let r=0;r<i.length;r++){const t=i[r];e.x=Math.max(e.x,this._context.measureText(t).width)}const{lineHeight:s}=t;return e.y=i.length*s,{dimensions:e,lines:i}}getDimensions(){const t=this.calculateFontStyles(),{dimensions:e}=this._calculateText(t);return e}fitMaxHeight(){this.update();const t=this.getDimensions();this.getText().split("\n"),this.getMaxHeight(),t.y}fitMaxWidth(){const t=this.getDimensions().x,e=this.getMaxWidth()/t;this.setFontSize(this.getFontSize()*e),this._textOptions.fontSize=this.getFontSize()}fitInFrame(t){this.setMaxWidth(t.width),this.setMaxHeight(t.height),this.fitMaxWidth(),this.fitMaxHeight()}getSize(){const t=this.getDimensions();return new t_(t.x,t.y)}}).prototype.availableOptions={text:{type:l.STRING,default:""},fontIdentifier:{type:l.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:l.OBJECT,default:null},lineHeight:{type:l.NUMBER,default:1},fontSize:{type:l.NUMBER,default:22},textColor:{type:l.STRING,default:"black"},strokeStyle:{type:l.STRING,default:"black"},outlineWidth:{type:l.NUMBER,default:0},textBaseline:{type:l.STRING,default:"alphabetic"},excludeAccents:{type:l.BOOLEAN,default:!0},maxWidth:{type:l.NUMBER,default:100},maxHeight:{type:l.NUMBER,default:0},alignment:{type:l.STRING,default:"left",available:["left","center","right"]}}})),Op=b((()=>{_a(),Sp(),Ng(),Ep(),Ug(),Xg(),(um=class extends A_{_calculateLayoutElements(){const t=this.getWords(),e=this._getTextFrame(),i=this.getAttributes().getFontIdentifier(),s=this.getImageInsets(),r=new d_({text:t.getWord(0),fontIdentifier:i});r.fitWidth(e.width);const n=new __({text:t.getWord(0),frame:e,font:r});n.setFrame(this._getTextFrameForElement(n));const o=this.getSize();return(this.getSizeToFitContent()||o.height<=1)&&(o.height=s.top+n.getFrame().height+s.bottom),o.height=Math.max(o.height,this.getMinimumHeight()),[n]}_getTextFrameForElement(t){const e=this.getWords().getWord(0),i=this.getAttributes(),s=i.getFontIdentifier(),r=this.getImageInsets(),n=this.getImageInsets().applyToRectangle(this._getFrame()).scale(this.getTextScaleFactor()),o=new hm({text:e,fontIdentifier:s,alignment:i.getAlignment(),lineHeight:1});o.fitInFrame(n);const a=o.getSize();n.height=a.height;let l=a.height*this.getRowScaleFactor();this.getSizeToFitContent()&&(l+=r.top+r.bottom);const h=this._getFrame(),u=i.getAlignment();if(this.getCenteredVertically())n.y=h.height/2-l/2+r.top;else switch(u){case"left":n.y=h.height-l-r.bottom;break;case"center":n.y=h.height/2-l/2+l*this.getCenterOffset(),n.x=(h.width-n.width)/2;break;case"right":n.x=h.width-n.width-r.right}return n}render(t){t.save(),this._getLayoutElements().forEach((e=>{let{text:i,frame:s}=e.serializeOptions();const r=this.getAttributes(),n=r.getFontIdentifier(),o=new hm({text:i,fontIdentifier:n,alignment:r.getAlignment(),lineHeight:1,textColor:r.getTextColor().toRGBA()});s=this._getTextFrameForElement(e),o.fitInFrame(s),o.draw(t,s.x,s.y)})),t.restore()}}).prototype.availableOptions={...A_.prototype.availableOptions,centerOffset:{type:l.NUMBER,default:0},sizeToFitContent:{type:l.BOOLEAN,default:!1},textScaleFactor:{type:l.NUMBER,default:.95},rowScaleFactor:{type:l.NUMBER,default:1},minimumHeight:{type:l.NUMBER,default:0},centeredVertically:{type:l.BOOLEAN,default:!1}}})),Ap=b((()=>{_a(),cp(),Pg(),Op(),zg(),Kg(),Zg(),T(dm=cm=class extends L_{constructor(...t){super(...t),this._rowType=sm.Box,this._alignmentRandomizer=new Qd(0),this._isMaskedRandomizer=new Qd(0),this._seedPool.push(this._alignmentRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return[sm.Box.getImagePath()]}_modifiedText(t){return super._modifiedText(t).toLowerCase()}_modifiedLines(t){const e=new P_;return e.set([t.reduce(((t,e)=>`${t}${""===t?"":"\n"}${e.joined(1)[0]}`),"")]),[e]}_layoutRows(t,e){const i=super._layoutRows(t,e),s=i[0];if(s&&this.getSquareLayout()){const t=s.getSize();t.height=t.width}return i}getAlignment(){return this._alignmentRandomizer.pickNext(this.constructor.ValidAlignments||cm.ValidAlignments)}_randomLayoutRow(t,e,i,s){const r=this.getAlignment(),n=this._rowType,o=s_.getImage(n.getImagePath());s.setAlignment(r);const a=new um({words:t,width:i,attributes:s,image:o,imageInsets:n.insetsForWidth(i),capInsets:n.getCapInsets(),backgroundColor:Wt.WHITE,centerOffset:0,textScaleFactor:.7,isMasked:this._isMaskedRandomizer.nextBool()});this._rowType===sm.Box&&(a.serverImageSmoothingFix=!0);const l=a.getSize();return this.getSquareLayout()?l.height=l.width:l.height=Math.max(l.height,l.width*n.getMinimumHeightRatio()),a}},"defaultFontIdentifiers",["imgly_font_galano_grotesque_bold"]),T(dm,"Alignment",{Left:"left",Center:"center",Right:"right"}),T(dm,"ValidAlignments",[cm.Alignment.Left,cm.Alignment.Center,cm.Alignment.Right]),T(dm,"identifier","imgly_text_design_masked"),dm.prototype.availableOptions={...L_.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:dm.defaultFontIdentifiers},squareLayout:{type:l.BOOLEAN,default:!0}}})),Bp=b((()=>{_a(),cp(),Pg(),Ap(),T(_m=class extends dm{constructor(...t){super(...t),this._possibleRowTypes=[sm.Badge1,sm.Badge2,sm.Badge3,sm.Badge4],this._rowTypesRandomizer=new Qd(0),this._isMaskedRandomizer=new Qd(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map((t=>t.getImagePath()))}_randomLayoutRow(t,e,i,s){this._rowType=this._rowTypesRandomizer.pickNext(this._possibleRowTypes),s.setLineSpacing(.9);const r=super._randomLayoutRow(t,e,i,s);return r.set({textScaleFactor:.9}),r}},"defaultFontIdentifiers",["imgly_font_campton_bold"]),T(_m,"identifier","imgly_text_design_masked_badge"),T(_m,"ValidAlignments",[dm.Alignment.Center]),_m.prototype.availableOptions={...dm.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:_m.defaultFontIdentifiers}}})),Mp=b((()=>{_a(),cp(),Pg(),Ap(),T(mm=class extends dm{constructor(...t){super(...t),this._possibleRowTypes=[sm.SpeechBubble1,sm.SpeechBubble3],this._rowTypesRandomizer=new Qd(0),this._isMaskedRandomizer=new Qd(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map((t=>t.getImagePath()))}_rowTypes(t){return this._possibleRowTypes}_randomLayoutRow(t,e,i,s){this._rowType=this._rowTypesRandomizer.pickNext(this._rowTypes(t)),s.setLineSpacing(.9);const r=super._randomLayoutRow(t,e,i,s);return r.set({textScaleFactor:1,minimumHeight:i*this._rowType.getMinimumHeightRatio(),sizeToFitContent:this._rowType.getSizeToFitContent(),centeredVertically:!0}),r}},"defaultFontIdentifiers",["imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_roboto_black","imgly_font_roboto_light"]),T(mm,"identifier","imgly_text_design_masked_speech_bubble"),mm.prototype.availableOptions={...dm.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:mm.defaultFontIdentifiers},squareLayout:{type:l.BOOLEAN,default:!1},alignment:{type:l.STRING,default:"left",available:dm.ValidAlignments}}})),Pp=b((()=>{_a(),cp(),Ap(),Mp(),T(gm=class extends mm{constructor(...t){super(...t),this._possibleRowTypes=[sm.SpeechBubble2,sm.SpeechBubble4,sm.SpeechBubble2,sm.SpeechBubble4,sm.SpeechBubble5],this._possibleRowTypesForMin15=this._possibleRowTypes.slice(0,2),this._possibleRowTypesForMax14=this._possibleRowTypes.slice(2)}_rowTypes(t){return t.countNumberOfCharacters()<15?this._possibleRowTypesForMax14:this._possibleRowTypesForMin15}},"defaultFontIdentifiers",["imgly_font_permanent_marker"]),T(gm,"identifier","imgly_text_design_masked_speech_bubble_comic"),gm.prototype.availableOptions={...mm.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:gm.defaultFontIdentifiers}}})),Lp=b((()=>{_a(),Op(),Ap(),T(pm=class extends dm{_modifiedText(t){return super._modifiedText(t).toUpperCase()}_randomLayoutRow(t,e,i,s){const r=this._alignmentRandomizer.pickNext(dm.ValidAlignments);return s.setAlignment(r),new um({words:t,width:i,attributes:s,image:null,backgroundColor:Wt.WHITE,centerOffset:0,sizeToFitContent:!0,isMasked:!1,autoAdjustTextColor:!1})}},"defaultFontIdentifiers",["imgly_font_abril_fatface_regular"]),T(pm,"identifier","imgly_text_design_multiline"),pm.prototype.availableOptions={...dm.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:pm.defaultFontIdentifiers}}})),zp=b((()=>{_a(),({Rectangle:fm}=Wn),(ym=class extends we{getContentFrame(){const t=this.getFrame().clone(),e=.1*t.width;return t.insetBy(e,e)}intersects(t){return this.getFrame().intersects(t.getFrame())}}).prototype.availableOptions={frame:{type:l.OBJECT,default:new fm}}})),Np=b((()=>{_a(),zg(),qg(),ap(),zp(),({Rectangle:xm}=Wn),(bm=class extends Q_{constructor(...t){super(...t),this._MAX_TRIES=1e3,this._PRECISION=1e3}render(t,e,i,s,r){const{imagePaths:n,relativeParticleSize:o}=this._options;if(n.length<=0)return;const a=e.width/e.height,l=new xm(Math.round(i.left*this._PRECISION),Math.round(i.top*this._PRECISION*a),this._PRECISION,this._PRECISION);l.width-=l.x+Math.round(i.right*this._PRECISION),l.height-=l.y+Math.round(i.bottom*this._PRECISION*a);const h=[];let u=0,c=0;for(;u<this.getParticleCount()&&c<this._MAX_TRIES;){const t=o/2,e=Math.round(t*this._PRECISION),i=Math.round(t*this._PRECISION*a),s=Math.floor(this._PRECISION)-e,n=Math.floor(this._PRECISION)-i,d=r.nextInRange(e,s),_=r.nextInRange(i,n),m=new xm(d-e,_-i,2*e,2*i);m.intersects(l)||this.hasCollision(h,m)||(h.push(new ym({frame:m})),u+=1),c+=1}for(let d=0;d<h.length;d++){const i=h[d],o=r.pickNext(n),a=s_.getImage(o),l=r.nextInRange(140,230)/255,u=e.width/this._PRECISION,c=e.height/this._PRECISION,_=i.getContentFrame();_.x*=u,_.y*=c,_.width*=u,_.height*=c;const m=s.clone();m.a=l,O_(t,a,_,m,"source-atop")}}hasCollision(t,e){for(let i=0;i<t.length;i++)if(e.intersects(t[i].getFrame()))return!0;return!1}}).prototype.availableOptions={...Q_.prototype.availableOptions,particleCount:{type:l.NUMBER,default:50},relativeParticleSize:{type:l.NUMBER,default:.08},imagePaths:{type:l.ARRAY,default:[]}}})),Up=b((()=>{_a(),Np(),T(vm=class extends bm{},"Images",["text-design/images/imgly_text_design_particle_brush_01.png","text-design/images/imgly_text_design_particle_brush_02.png","text-design/images/imgly_text_design_particle_brush_03.png","text-design/images/imgly_text_design_particle_brush_04.png","text-design/images/imgly_text_design_particle_brush_05.png","text-design/images/imgly_text_design_particle_brush_06.png","text-design/images/imgly_text_design_particle_brush_07.png","text-design/images/imgly_text_design_particle_brush_08.png","text-design/images/imgly_text_design_particle_brush_09.png","text-design/images/imgly_text_design_particle_brush_10.png"]),vm.prototype.availableOptions={...bm.prototype.availableOptions,imagePaths:{type:l.ARRAY,default:[...vm.Images]},relativeParticleSize:{type:l.NUMBER,default:.12}}})),Gp=b((()=>{_a(),Np(),T(wm=class extends bm{},"Images",["text-design/images/imgly_text_design_particle_circle_01.png","text-design/images/imgly_text_design_particle_circle_02.png","text-design/images/imgly_text_design_particle_circle_03.png","text-design/images/imgly_text_design_particle_circle_04.png","text-design/images/imgly_text_design_particle_circle_05.png","text-design/images/imgly_text_design_particle_circle_06.png","text-design/images/imgly_text_design_particle_circle_07.png","text-design/images/imgly_text_design_particle_circle_08.png","text-design/images/imgly_text_design_particle_circle_09.png","text-design/images/imgly_text_design_particle_circle_10.png"]),wm.prototype.availableOptions={...bm.prototype.availableOptions,imagePaths:{type:l.ARRAY,default:[...wm.Images]},relativeParticleSize:{type:l.NUMBER,default:.12}}})),jp=b((()=>{_a(),Np(),T(Dm=class extends bm{},"Images",["text-design/images/imgly_text_design_particle_triangle_01.png","text-design/images/imgly_text_design_particle_triangle_02.png","text-design/images/imgly_text_design_particle_triangle_03.png","text-design/images/imgly_text_design_particle_triangle_04.png","text-design/images/imgly_text_design_particle_triangle_05.png","text-design/images/imgly_text_design_particle_triangle_06.png","text-design/images/imgly_text_design_particle_triangle_07.png","text-design/images/imgly_text_design_particle_triangle_08.png","text-design/images/imgly_text_design_particle_triangle_09.png","text-design/images/imgly_text_design_particle_triangle_10.png"]),Dm.prototype.availableOptions={...bm.prototype.availableOptions,imagePaths:{type:l.ARRAY,default:[...Dm.Images]}}})),Vp=b((()=>{_a(),Pg(),Wg(),Hg(),sp(),np(),zg(),Kg(),Zg(),T(Tm=km=class extends L_{constructor(...t){super(...t),this._relativeInsets=new v_(0,0,0,0),this._INVALID_FONTS_IF_LESS_THEN_5_CHARS=["imgly_font_montserrat_light"],this._INVALID_FONTS_IF_LESS_THEN_4_CHARS=["imgly_font_montserrat_light","imgly_font_wolesbro"],this._lineCount=0,this._decorativeRowCreated=!1,this._useImageRowRandomizer=new Qd(0),this._rowTypeRandomizer=new Qd(0),this._lineDecorativeTypeRandomizer=new Qd(0),this._seedPool.push(this._useImageRowRandomizer),this._seedPool.push(this._rowTypeRandomizer),this._seedPool.push(this._lineDecorativeTypeRandomizer)}getImagePaths(){return[...km.DecoratorImages,...km.RowImages]}_fontForRow(t,e){const i=e.countNumberOfCharacters();let s=this.getFontIdentifiers();return i<4?s=s.filter((t=>this._INVALID_FONTS_IF_LESS_THEN_4_CHARS.indexOf(t)<0)):i<5&&(s=s.filter((t=>this._INVALID_FONTS_IF_LESS_THEN_5_CHARS.indexOf(t)<0))),s[t%s.length]}_modifiedText(t){return super._modifiedText(t).toUpperCase()}_modifiedLines(t){return this._lineCount=t.length,t}generateLayoutData(t,e){return this._decorativeRowCreated=!1,super.generateLayoutData(t,e)}_randomLayoutRow(t,e,i,s){let r=t;switch(s.getFontIdentifier()){case"imgly_font_wolesbro":r=(new P_).set(t.getLowerCase());break;case"imgly_font_permanent_marker":r=(new P_).set(t.getUpperCase())}const n=this.getDecorativeRowsInTheMiddleOnly()&&(0===e||e===this._lineCount-1);if(this._useImageRowRandomizer.nextBool()||this._decorativeRowCreated||n)return new w_({words:r,width:i,attributes:s});this._decorativeRowCreated=!0;const[o,a]=this._randomDecoratorImages();return new X_({words:t,width:i,attributes:s,leftImage:o,rightImage:a})}_layoutRows(t,e){const i=super._layoutRows(t,e);if(!this.getDecorationsVisible())return i;const s=.0625*e,r=new K_({width:e,height:s,image:s_.getImage(this._rowTypeRandomizer.pickNext(km.RowImages))}).layout(),n=new K_({width:e,height:s,image:s_.getImage(this._rowTypeRandomizer.pickNext(km.RowImages))}).layout();return[r,...i,n]}_randomDecoratorImages(){return this._lineDecorativeTypeRandomizer.nextInRange(0,1)?km.DecoratorImages.slice(0,2).map((t=>s_.getImage(t))):km.DecoratorImages.slice(2).map((t=>s_.getImage(t)))}},"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]),T(Tm,"identifier","imgly_text_design_sunshine"),T(Tm,"RowImages",[K_.RowImages.decorative1,K_.RowImages.decorative2,K_.RowImages.decorative3,K_.RowImages.decorative4]),T(Tm,"DecoratorImages",["text-design/images/imgly_text_design_asset_decorative_03.png","text-design/images/imgly_text_design_asset_decorative_04.png","text-design/images/imgly_text_design_asset_decorative_07.png","text-design/images/imgly_text_design_asset_decorative_08.png"]),Tm.prototype.availableOptions={...L_.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:Tm.defaultFontIdentifiers},relativeLineSpacing:{type:l.NUMBER,default:.025/3*4},decorationsVisible:{type:l.BOOLEAN,default:!0},decorativeRowsInTheMiddleOnly:{type:l.BOOLEAN,default:!1}}})),Wp=b((()=>{_a(),Up(),Gp(),jp(),Pg(),Wg(),zg(),Vp(),T(Rm=Cm=class extends Tm{constructor(...t){super(...t),this._relativeInsets=new v_(.3,.3,.3,.3),this._backgroundRandomizer=new Qd(0),this._decoTypeRandomizer=new Qd(0),this._seedPool.push(this._backgroundRandomizer),this._seedPool.push(this._decoTypeRandomizer)}getImagePaths(){return[...Tm.RowImages,...st.Array.flatten(Cm.Backgrounds.map((t=>t.getImagePaths()))),...Cm.DecoratorImages]}_getBackground(){return this._backgroundRandomizer.pickNext(Cm.Backgrounds)}_randomDecoratorImages(){switch(this._decoTypeRandomizer.nextInRange(0,2)){case 0:return Cm.DecoratorImages.slice(0,2).map((t=>s_.getImage(t)));case 1:case 2:return Cm.DecoratorImages.slice(2).map((t=>s_.getImage(t)));default:return ut.warn("TextDesignParticles#_randomDecoratorImages: Number generated not in valid range."),Cm.DecoratorImages.slice(2).map((t=>s_.getImage(t)))}}},"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]),T(Rm,"identifier","imgly_text_design_particles"),T(Rm,"Backgrounds",[new vm,new wm,new Dm]),T(Rm,"DecoratorImages",["text-design/images/imgly_text_design_particle_holder_01.png","text-design/images/imgly_text_design_particle_holder_02.png","text-design/images/imgly_text_design_particle_holder_03.png","text-design/images/imgly_text_design_particle_holder_04.png"]),Rm.prototype.availableOptions={...Tm.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:Rm.defaultFontIdentifiers},decorationsVisible:{type:l.BOOLEAN,default:!1},decorativeRowsInTheMiddleOnly:{type:l.BOOLEAN,default:!0}}})),Hp=b((()=>{_a(),Pg(),Wg(),tp(),Zg(),T(Im=class extends L_{constructor(...t){super(...t),this._relativeInsets=new v_(.1,0,0,0),this._rowTypeRandomizer=new Qd(0),this._seedPool.push(this._rowTypeRandomizer)}_modifiedText(t){return super._modifiedText(t).toUpperCase()}_randomLayoutRow(t,e,i,s){const r=super._randomLayoutRow(t,e,i,s);return r.setShearingAngle(this.getShearingAngle()),r}_layoutRows(t,e){const i=super._layoutRows(t,e),s=st.values(j_.FormType);return[new j_({width:e,height:30,type:this._rowTypeRandomizer.pickNext(s),shearingAngle:this.getShearingAngle()}).layout(),...i,new j_({width:e,height:30,type:this._rowTypeRandomizer.pickNext(s),shearingAngle:this.getShearingAngle()}).layout()]}},"defaultFontIdentifiers",["imgly_font_campton_bold"]),T(Im,"identifier","imgly_text_design_rotated"),Im.prototype.availableOptions={...L_.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:Im.defaultFontIdentifiers},relativeLineSpacing:{type:l.NUMBER,default:.025/3},shearingAngle:{type:l.NUMBER,default:-.1}}})),qp=b((()=>{Wg(),np(),zg(),Vp(),T(Fm=class extends Tm{constructor(...t){super(...t),this._relativeInsets=new v_(0,.3,0,.3)}_layoutRows(t,e){const i=super._layoutRows(t,e);if(!this.getDecorationsVisible())return i;const s=new K_({width:e,height:25,image:s_.getImage(this._rowTypeRandomizer.pickNext(Tm.RowImages))}).layout(),r=new K_({width:e,height:25,image:s_.getImage(this._rowTypeRandomizer.pickNext(Tm.RowImages))}).layout();return[s,...i,r]}},"identifier","imgly_text_design_sunshine-v3_1_0")})),Xp=b((()=>{_a(),cp(),Ap(),Mp(),T(Sm=class extends mm{constructor(...t){super(...t),this._possibleRowTypes=[sm.Watercolor1,sm.Watercolor2,sm.Watercolor3]}},"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro"]),T(Sm,"identifier","imgly_text_design_watercolor"),Sm.prototype.availableOptions={...mm.prototype.availableOptions,fontIdentifiers:{type:l.ARRAY,default:Sm.defaultFontIdentifiers},alignment:{type:l.STRING,default:dm.Alignment.Center,available:dm.ValidAlignments}}})),Yp=b((()=>{_a(),Pg(),Xg(),Op(),Lg(),qg(),({Rectangle:Em}=Wn),Om=1e3,Am=class{constructor(){this._layoutData=null,this._layout=null,this._text="",this._seed=0,this._debugMode=!1,this.randomizer=new Qd}createLayout(t,e,i){this._layout=t,this._text=e,this._seed=i,t.seed(i),this._layoutData=t.generateLayoutData(e,Om)}calculateAspect(){return this._layoutData?this._layoutData.getSize().aspect():(ut.warn("TextDesignRenderer#calculateAspect: No layout data"),1)}draw(t,e,i,s){const r=this._layoutData;if(this._layoutData){const n=new t_(Om,Om/e.aspect()),o=e.width/Om,a=r.getRelativeInsets().clone().scale(n.width),l=r.getRelativeLineSpacing()*n.width;let h=a.top;t.save(),this.randomizer.seed(this._seed);const u=r.getBackground();u&&u.render(t,e,r.getRelativeInsets(),s?Wt.WHITE:i,this.randomizer),t.scale(o,o),r.getRows().forEach((e=>{t.save();const r=e.getAttributes();if(t.transform(1,e.getShearingAngle(),0,1,a.left,h),r.setTextColor(s?Wt.WHITE:i.clone()),r.setTintColor(s?Wt.WHITE:i.clone()),(e instanceof A_||e instanceof um)&&(e.setBackgroundColor(s?Wt.WHITE:i.clone()),e.setIsUsedInInvertedLayout(s)),this._debugMode&&(e._debugMode=!0),e.willRender(t),e.render(t),e.didRender(t),this._debugMode){const i=e._getFrame(),s=e._getTextFrame();I_(t,i,Wt.GREEN),I_(t,s,Wt.BLUE),e._getLayoutElements().forEach((i=>{const s=i.getFrame(),r=e._getTextFrameForElement(i);I_(t,s,new Wt(1,1,0)),I_(t,r,new Wt(0,1,1))}))}h+=e.getSize().height+l,t.restore()})),this._debugMode&&I_(t,new Em(0,0,n.width,n.height),Wt.RED),t.restore()}}}})),Jp=b((()=>{_a(),Ig(),Qg(),$g(),ep(),ip(),rp(),op(),hp(),up(),Ap(),Bp(),Mp(),Pp(),Lp(),Wp(),Hp(),Vp(),qp(),Xp(),Pg(),Lg(),zg(),Yp(),({Vector2:Bm}=Wn),(Mm=class extends Od{constructor(t,e){super(t,e),this._isDisposed=!1,this._renderer=new Am,this._canvas=st.createCanvas(),this._context=this._canvas.getContext("2d"),this._texture=Jn.Texture.fromCanvas(this._canvas),this._sprite.setTexture(this._texture),this._aspect=1,this._isLayoutDirty=!0,this.getSeed()<0&&this.setSeed(Qd.TimeSeed())}seed(t){this.setSeed(t||Qd.TimeSeed()),this._isLayoutDirty=!0}_updateLayout(){const t=this.getLayout();return t?(this._renderer.createLayout(t,this.getText(),this.getSeed()),this._aspect=this._renderer.calculateAspect(),this._isLayoutDirty=!1,!0):null}applyTransform(t){super.applyTransform(t);const e={};this._options.dimensions&&(e.width=t.applyToRelativeSize(this.getWidth())),this.set(e,!1)}applyFlip(t){super.applyFlip(t);let{rotation:e}=this._options;switch(t){case"horizontal":e+=2*(Math.PI-e),this.setRotation(e);break;case"vertical":e+=2*(Math.PI/2-e),this.setRotation(e)}}update(t,e){const i=this._isLayoutDirty;if(this._isDisposed||i&&!this._updateLayout())return;const s=this.getWidth()*e.min()/t.getTextureScale(),r=s/this._aspect,n=new Bm(s,r),o=new Bm(Math.round(2*s),Math.round(2*r)).clamp(new Bm(1,1),new Bm(1/0,1/0)),a=t.getRenderer(),l=a.getMaxDimensions()||1/0;o.x>l&&(o.x=l,o.y=Math.round(o.x/this._aspect)),o.y>l&&(o.y=l,o.x=Math.round(o.y*this._aspect));const h=st.ensureCanvasDimensions(this._canvas,o);(i||h)&&(this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._renderer.draw(this._context,new t_(o.x,o.y),this.getColor(),this.getInverted()),this.setDimensions(n),this._texture.getBaseTexture().update(),a.isOfType(u.WEBGL)&&a.updateTexture(this._texture.getBaseTexture())),super.update(t,e),this._applyFlip()}_applyFlip(){const t=this._sprite.getScale(),{flipHorizontally:e,flipVertically:i}=this._options;(e&&t.x>0||!e&&t.x<0)&&(t.x*=-1),(i&&t.y>0||!i&&t.y<0)&&(t.y*=-1),this._sprite.setScale(t)}_optionEquals(t,e){if("layout"===t){const{layout:t}=this._options;return!(!t&&e||!e&&t)&&(!(!e.constructor||!t.constructor)&&t.constructor.identifier===e.constructor.identifier)}return super._optionEquals(t,e)}serializeOptions(t,e=!1){if(t&&this.getPadding()<0){const e=t.indexOf("padding");e>-1&&t.splice(e,1)}const i=super.serializeOptions(t,e);return t||(i.type="textdesign"),i}_getTexture(){return this._texture}canBeFlippedHorizontally(){return!1}canBeDuplicated(){return!0}canMaskCanvas(){return!0}canAdjustPadding(){return!0}dispose(){this._isDisposed=!0,this._texture.dispose(),this._sprite.dispose()}}).Layouts={TextDesignBlocks:z_,TextDesignBlocksCondensed:N_,TextDesignBlocksLight:V_,TextDesignCelebrate:J_,TextDesignCelebrateSimple:Z_,TextDesignEqualWidth:em,TextDesignEqualWidthFat:im,TextDesignMasked:dm,TextDesignMaskedBadge:_m,TextDesignMaskedSpeechBubble:mm,TextDesignMaskedSpeechBubbleComic:gm,TextDesignMultiline:pm,TextDesignWatercolor:Sm,TextDesignSunshine:Tm,TextDesignParticles:Rm,TextDesignRotated:Im},Mm.LegacyLayouts={TextDesignBlocksLightV310:W_,TextDesignSunshineV310:Fm},Mm.AssetManager=s_,Mm.prototype.availableOptions={id:{type:l.STRING,default:()=>st.getUUID()},position:{type:l.VECTOR2,default:new Bm(.5,.5)},dimensions:{type:l.VECTOR2,default:Bm.NULL},anchor:{type:l.VECTOR2,default:new Bm(0,0)},pivot:{type:l.VECTOR2,default:new Bm(.5,.5)},rotation:{type:l.NUMBER,default:0},flipHorizontally:{type:l.BOOLEAN,default:!1},flipVertically:{type:l.BOOLEAN,default:!1},layout:{type:l.OBJECT,default:null,setter(t){return this._isLayoutDirty=!0,t}},text:{type:l.STRING,default:"",setter(t){return this._isLayoutDirty=!0,t}},color:{type:l.COLOR,default:Wt.BLACK,setter(t){return this._isLayoutDirty=!0,t}},padding:{type:l.NUMBER,default:.01,minValue:.01},width:{type:l.NUMBER,default:.8},inverted:{type:l.BOOLEAN,default:!1,setter(t){return this._isLayoutDirty=!0,t}},seed:{type:l.NUMBER,default:-1}},Pm=Mm})),Kp=b((()=>{_a(),Ig(),Sp(),({Vector2:Lm}=Wn),(zm=class extends Od{constructor(...t){super(...t),this._textRenderer=new am(this,this._operation),this._textRenderer.rotation=this.getRotation(),this._sprite.setTexture(this._textRenderer.getFinalTexture()),this._hitTestSprite.setTexture(this._textRenderer.getTexture())}serializeOptions(t,e=!1){const i=super.serializeOptions(t,e);return t||(i.type="text"),i}getDOMStyle(t,e){const i=this.getFontSize()*e.y;return{fontWeight:this._options.fontWeight,fontSize:`${i}px`,fontStyle:this._options.fontStyle,fontFamily:this._options.fontFamily,lineHeight:this.getAbsoluteTextHeight(e)*this.getLineHeight()+"px",color:this._options.color.toRGBA(),backgroundColor:this._options.backgroundColor.toRGBA(),textAlign:this._options.alignment}}getAbsoluteTextHeight(t){const e=this.getFontSize()*t.y,i=this.getTextMetrics();if(i){const t=1/i.unitsPerEm*e,s=i.ascender*t,r=i.descender*t;return s+Math.abs(r)}return e*this.getLineHeight()*1.1}getDimensions(t,e){return this._textRenderer.getDimensions(t,e)}applyFlip(t){super.applyFlip(t);let{rotation:e}=this._options;switch(t){case"horizontal":e+=2*(Math.PI-e),this.setRotation(e);break;case"vertical":e+=2*(Math.PI/2-e),this.setRotation(e)}}applyTransform(t){super.applyTransform(t),this.set({fontSize:t.scaleSize(this.getFontSize(),"y"),maxWidth:t.scaleSize(this.getMaxWidth(),"x")},!1)}applyRotation(t){super.applyRotation(t);const e=(t+360)%360,i=this._operation.getInputDimensions();90!==e&&270!==e||(this.setMaxWidth(this.getMaxWidth()/i.x*i.y),this.setFontSize(this.getFontSize()/i.y*i.x))}setOption(t,e){const{flipHorizontally:i,flipVertically:s}=this._options;if("rotation"===t){let t=e;return i&&(t=2*Math.PI-t),s&&(t=2*Math.PI-t),this._options.rotation=t,this._textRenderer&&(this._textRenderer.rotation=t),this._rotation=t,void this.emit("update")}super.setOption(t,e)}getOption(t){return"rotation"===t?this._rotation:super.getOption(t)}getHitTestDisplayObject(){return this._hitTestSprite}update(t,e){if(this._sprite.setVisible(this._options.visible),!this._options.visible)return;this._textRenderer.update(t,e);const i=this._textRenderer.getFinalTexture();i.getBaseTexture().update();const s=t.getRenderer();s.isOfType(u.WEBGL)&&s.updateTexture(i.getBaseTexture()),super.update(t,e),this._sprite.setRotation(0),this._textRenderer.getTexture().getBaseTexture().update(),this._hitTestSprite.setRotation(this._rotation),this._hitTestSprite.updateTransform(),this._applyFlip()}_applyFlip(){const t=this._sprite.getScale(),{flipHorizontally:e,flipVertically:i}=this._options;(e&&t.x>0||!e&&t.x<0)&&(t.x*=-1,this.setRotation(this._rotation)),(i&&t.y>0||!i&&t.y<0)&&(t.y*=-1,this.setRotation(this._rotation)),this._sprite.setScale(t)}_getTexture(){return this._textRenderer.getFinalTexture()}dispose(){super.dispose(),this._textRenderer.dispose(),this._hitTestSprite.dispose(),this._sprite.dispose()}canBeFlippedHorizontally(){return!1}canAdjustPadding(){return!1}}).prototype.availableOptions={id:{type:l.STRING,default:()=>st.getUUID()},fontSize:{type:l.NUMBER,default:.1},characterSpacing:{type:l.NUMBER,default:0},lineHeight:{type:l.NUMBER,default:1.1},fontIdentifier:{type:l.STRING},fontFamily:{type:l.STRING,default:"Times New Roman"},fontWeight:{type:l.ALL,default:"normal"},fontStyle:{type:l.STRING,default:"normal"},textMetrics:{type:l.OBJECT,default:null},outlineWidth:{type:l.NUMBER,default:0},outlineColor:{type:l.COLOR,default:Wt.BLACK},alignment:{type:l.STRING,default:"left",available:["left","center","right"]},verticalAlignment:{type:l.STRING,default:"top",available:["top","center","bottom"]},color:{type:l.COLOR,default:new Wt(1,0,0,1)},backgroundColor:{type:l.COLOR,default:Wt.TRANSPARENT},position:{type:l.VECTOR2,default:new Lm(.5,.5)},anchor:{type:l.VECTOR2,default:new Lm(0,0)},pivot:{type:l.VECTOR2,default:new Lm(.5,.5)},rotation:{type:l.NUMBER,default:0},text:{type:l.STRING,required:!0},maxWidth:{type:l.NUMBER,default:.5},maxHeight:{type:l.NUMBER,default:0},visible:{type:l.BOOLEAN,default:!0},flipHorizontally:{type:l.BOOLEAN,default:!1},flipVertically:{type:l.BOOLEAN,default:!1}},zm.type="text",Nm=zm})),Zp=b((()=>{_a(),Ig(),Ag(),Mg(),Jp(),Kp(),({Vector2:Um}=Wn),(Gm=class extends yo{constructor(...t){super(...t),this.setSmoothDownscaling(this._sdk.getOptions().smoothDownscaling),this._onSpriteUpdate=this._onSpriteUpdate.bind(this),this._maskCanvas=st.createCanvas();this._options.sprites.slice().forEach((t=>{this.removeSprite(t),this.addSprite(t)}))}getSpritesOfType(t){return this._options.sprites.filter((e=>e instanceof t))}rotate(t){this._options.sprites.forEach((e=>{e.applyRotation(t)}))}flip(t){this._options.sprites.forEach((e=>{e.applyFlip(t)}))}_onSpriteUpdate(t,e){this.emit("update",this),this.setDirty(!0)}_applyRotation(t,e){this._options.sprites.forEach((i=>i.applyRotation(t,e)))}transform(t){this._options.sprites.forEach((e=>e.applyTransform(t)))}scale(t){this._options.sprites.forEach((e=>e.applyScale(t)))}serializeOption(t,e=!1){return"sprites"===t?this._options.sprites.map((t=>t.serializeOptions(void 0,e))):super.serializeOption(t,e)}createSticker(t){return new Kd(this,t)}createText(t){return new Nm(this,t)}createBrush(t){return new Vd(this,t)}createTextDesign(t){return new Pm(this,t)}addSprite(t){this._options.sprites.push(t);const e=this.getSmoothDownscaling();t.setSmoothDownscaling&&t.setSmoothDownscaling(e),this._container.addChild(t.getDisplayObject()),this.setDirty(!0),t.on("update",this._onSpriteUpdate),this.emit("update",this,this._options.sprites)}removeSprite(t){const{sprites:e}=this._options,i=e.indexOf(t);return-1!==i&&(t.off("update",this._onSpriteUpdate),this._container.removeChild(t.getDisplayObject()),e.splice(i,1),this.setDirty(!0),!0)}_getOrientatedStageSize(){const t=this._sdk.getSprite().getTexture().getFrame(),e=this._sdk.getOperationsStack().getByIdentifier("orientation");if(e){const i=e?e.getRotation():0;return 270===i||90===i?new Um(t.height,t.width):new Um(t.width,t.height)}const i=this._sdk.getOperationsStack().getByIdentifier("output");return i?i.getOutputResolution():new Um(t.width,t.height)}_render(t){const e=this._container,{sprites:i}=this._options,s=t.getDimensions().clone().floor();let r=new Jn.Container;return r.addChild(this._sprite),Promise.all(i.map((t=>t.validateSettings()))).then((()=>{i.forEach((t=>t.update(this._sdk,s)))})).then((()=>{this._renderTexture.clear(),i.forEach((t=>{t.getInverted&&t.getInverted()?(this._renderTexture.render(r),this._renderTexture.render(this._renderMaskedSprite(t.getDisplayObject(),t.getColor?t.getColor():Wt.WHITE,t.getPadding?t.getPadding():-1)),r=new Jn.Container):r.addChild(t.getDisplayObject())})),this._renderTexture.render(r),e.addChild(this._sprite),i.forEach((t=>e.addChild(t.getDisplayObject())))}))}_renderMaskedSprite(t,e,i){const s=this._maskCanvas,r=t.getWorldTransform(),n=this._getOrientatedStageSize();st.ensureCanvasDimensions(s,n);const o=s.getContext("2d");if(o.clearRect(0,0,s.width,s.height),o.save(),o.fillStyle=e.toRGBA(),i<0)o.fillRect(0,0,n.x,n.y);else{const e=Math.abs(t.getWidth()/t.getScale().x),s=Math.abs(t.getHeight()/t.getScale().y),n=e*i;o.transform(r.a,r.b,r.c,r.d,r.tx,r.ty),o.fillRect(-n,-n,e+2*n,s+2*n)}o.restore(),o.save(),o.globalCompositeOperation="destination-out",t._renderCanvas({getCurrentRenderTarget:()=>({getPixelRatio:()=>1}),beforeDraw:e=>{const i=t.getWidth(),s=t.getHeight(),r=t.getScale(),n=r.x<0,o=r.y<0;e.translate(i,s),e.scale(n?-1:1,o?-1:1),e.translate(-i,-s)},getContext:()=>o}),o.restore();const a=new Jn.Container,l=new Jn.Sprite(Jn.Texture.fromCanvas(s));return a.addChild(l),a}takeSpriteToFront(t){const{sprites:e}=this._options,i=e.indexOf(t);if(-1===i)return;st.moveArrayItem(e,i,e.length-1);const s=t.getDisplayObject();this._container.removeChild(s),this._container.addChild(s),this.setDirty(!0)}getSpritesAtPosition(t,e){const i=[];this._options.sprites.forEach((t=>t.update(this._sdk,e)));const s=this._sdk.getSprite(),r=s.getWorldTransform().applyInverseToVector(t),{width:n,height:o}=s.getTexture().getFrame(),a=s.getAnchor().clone().multiply(-n,-o);r.subtract(a);const l=this._options.sprites.slice(0).reverse();for(let h=0,u=l.length;h<u;h++){const t=l[h];t.getHitTestDisplayObject().isAtPosition(r)&&i.push(t)}return i}setDirtyForRenderer(t,e,i){super.setDirtyForRenderer(t,e,i),this._options.sprites.forEach((s=>{s.setDirtyForRenderer(t,e,i)}))}dispose(){super.dispose(),this._options.sprites.forEach((t=>{t.dispose()}))}}).StickerSprite=Kd,Gm.TextSprite=Nm,Gm.BrushSprite=Vd,Gm.TextDesignSprite=Pm,Gm.identifier="sprite",Gm.prototype.availableOptions={sprites:{type:l.ARRAY,default:[],setter(t,e){if(t=t.map(((t,e)=>{if(t instanceof Od)return t;const i={...t};switch(delete i.type,t.type){case"text":return new Nm(this,i);case"sticker":return new Kd(this,i);case"brush":return new Vd(this,i);case"textdesign":return new Pm(this,i);default:return ut.error(this.constructor.name,`Invalid sprite type: ${t.type}`),null}})),!e){if(this._options.sprites){this._options.sprites.slice().forEach((t=>{t.dispose(),this.removeSprite(t)}))}t.forEach((t=>{this.addSprite(t)}))}return t}},smoothDownscaling:{type:l.BOOLEAN,default:!1}},ia.Operations.SpriteOperation=Gm,jm=Gm})),Qp=b((()=>{_a(),({Vector2:Vm}=Wn),Wm=class{constructor(t,e){this._options=e,this._oldOptions={start:t.getStart().clone(),end:t.getEnd().clone(),rotation:t.getRotation(),textureScale:t.getTextureScale()},this._inputDimensions=t.getInputDimensions(!1),this._rotationDelta=e.rotation-t.getRotation(),this._deltaCos=Math.cos(this._rotationDelta),this._deltaSin=Math.sin(this._rotationDelta),this._oldAbsoluteSize=this._oldOptions.end.clone().subtract(this._oldOptions.start).multiply(this._inputDimensions),this._newAbsoluteSize=e.end.clone().subtract(e.start).multiply(this._inputDimensions),this._absoluteStartDiff=this._oldOptions.start.clone().subtract(e.start).multiply(this._inputDimensions),this._scaleRatio=t.calculateScale(e.rotation)/t.calculateScale(),this._sizeFactor=this._newAbsoluteSize.clone().divide(this._oldAbsoluteSize),this._textureScaleFactor=this._options.textureScale/t.getTextureScale()}applyToRelativePoint(t){const e=this._oldOptions.start,i=this._oldOptions.end,s=e.clone().add(i.clone().subtract(e).divide(2)).multiply(this._inputDimensions),r=t.clone().multiply(this._oldAbsoluteSize).subtract(this._oldAbsoluteSize.clone().divide(2)),n=s.clone().add(r).clone().subtract(this._inputDimensions.clone().divide(2)),o=new Vm(n.x*this._deltaCos-n.y*this._deltaSin,n.x*this._deltaSin+n.y*this._deltaCos),a=this._inputDimensions.clone().divide(2).add(o),l=this._options.start.clone().multiply(this._inputDimensions);return a.clone().subtract(l).divide(this._newAbsoluteSize)}applyToRelativeSize(t){return t*this._oldAbsoluteSize.min()/this._newAbsoluteSize.min()}applyToDimensions(t){return t=t.clone().multiply(this._scaleRatio),this._options.textureScale&&t.multiply(this._textureScaleFactor),t}scaleSize(t,e="y"){return t/this._sizeFactor[e]}applyToRotation(t){return(t+this._rotationDelta)%(2*Math.PI)}invert(){const t=this._options.start.clone(),e=this._options.end.clone(),i=this._inputDimensions,s=-this._rotationDelta,r=Math.cos(s),n=Math.sin(s),o=this._oldAbsoluteSize,a=this._newAbsoluteSize,l=t.clone().subtract(e).multiply(i),h=1/this._scaleRatio,u=new Vm(1/this._sizeFactor.x,1/this._sizeFactor.y),c=1/this._textureScaleFactor,d=this._oldOptions;return this._oldOptions=this._options,this._options=d,this._inputDimensions=i,this._rotationDelta=s,this._deltaCos=r,this._deltaSin=n,this._oldAbsoluteSize=a,this._newAbsoluteSize=o,this._absoluteStartDiff=l,this._scaleRatio=h,this._sizeFactor=u,this._textureScaleFactor=c,this}}})),$p=b((()=>{_a(),Qp(),({Vector2:Hm}=Wn),(qm=class extends yo{_render(t){this._sprite.setRotation(0);const e=t.getDimensions(),{start:i,end:s,rotation:r,textureScale:n}=this._options,o=s.clone().subtract(i).clone().divide(2),a=i.clone().add(o),l=this.calculateScale()*n,h=e.clone().multiply(l).multiply(o);return this._sprite.setAnchor(a),this._sprite.setRotation(r),this._sprite.setScale(l,l),this._sprite.setPosition(h),this._renderTexture.render(this._container),Promise.resolve()}calculateScale(t=this._options.rotation){const e=this.getInputDimensions(!1),i=new Hm(Math.abs(e.x*Math.cos(t))+Math.abs(e.y*Math.sin(t)),Math.abs(e.x*Math.sin(t))+Math.abs(e.y*Math.cos(t))),s=e.clone().subtract(i.clone()).divide(2).abs();let r=1;return r=s.y>s.x?2*s.y/e.y+1:2*s.x/e.x+1,r}getNewDimensions(t){const{start:e,end:i,textureScale:s}=this._options,r=this.calculateScale();return t.clone().multiply(s*r).multiply(i.clone().subtract(e)).round()}flip(t){const{start:e,end:i}=this._options,s=e.clone();"horizontal"===t?(e.set(1-i.x,e.y),i.set(1-s.x,i.y)):"vertical"===t&&(e.set(e.x,1-i.y),i.set(i.x,1-s.y))}rotate(t){const{start:e,end:i}=this._options,s=(t+360)%360,r=Math.floor(s/90);for(let n=0;n<r;n++){const t=e.clone();e.set(1-i.y,t.x),i.set(1-t.y,i.x)}}_onBeforeExport(){this._wasEnabledBeforeExport=this.getEnabled(),this.setEnabled(!0)}_onAfterExport(){this.setEnabled(this._wasEnabledBeforeExport,!0)}}).identifier="transform",qm.prototype.availableOptions={start:{type:l.VECTOR2,default:new Hm(0,0)},end:{type:l.VECTOR2,default:new Hm(1,1)},textureScale:{type:l.NUMBER,default:1},rotation:{type:l.NUMBER,default:0}},qm.TransformChange=Wm,ia.Operations.TransformOperation=qm,Xm=qm})),tf=b((()=>{Qf(),_a(),wo(),(Ym=class extends yo{constructor(...t){super(...t),this._watermarkImage=null,this._watermarkTexture=null,this._loadWatermarkImage=()=>{if(!this._watermarkImage){if(!(this._options.watermarkURI instanceof window.Image)){const t={value:this._options.crossOrigin,cors:!0};return ct.loadImage(this._options.watermarkURI,t).then((t=>{this._watermarkImage=t}))}this._watermarkImage=this._options.watermarkURI}return Promise.resolve()},this._setWatermarkalignment=(t,e)=>{const i=Math.min(e.x,e.y)*st.clamp(this._options.inset,0,1);switch(this._options.alignment){case"center":this._watermarkSprite.setPosition(new Qt(e.x-t.x,e.y-t.y).divide(2));break;case"top-left":this._watermarkSprite.setPosition(new Qt(i,i));break;case"top-right":this._watermarkSprite.setPosition(new Qt(e.x-t.x-i,i));break;case"bottom-left":this._watermarkSprite.setPosition(new Qt(i,e.y-t.y-i));break;case"bottom-right":this._watermarkSprite.setPosition(new Qt(e.x-t.x-i,e.y-t.y-i));break;default:this._watermarkSprite.setPosition(new Qt(0,0))}},this._watermarkSprite=new Jn.Sprite,this._watermarkSprite.setAnchor(0,0),this._container.addChild(this._watermarkSprite)}_render(t){const{alpha:e,size:i}=this._options;return this._loadWatermarkImage().then((()=>{if(this._watermarkImage){this._watermarkTexture||(this._watermarkTexture=Jn.Texture.fromImage(this._watermarkImage),this._watermarkSprite.setTexture(this._watermarkTexture));const s=t.getDimensions(),{width:r,height:n}=this._watermarkImage,o=st.resizeVectorToFit(new Qt(r,n),s.clone().multiply(st.clamp(i,0,1)));this._setWatermarkalignment(o,s),this._watermarkSprite.setWidth(o.x),this._watermarkSprite.setHeight(o.y),this._watermarkSprite.setAlpha(e),this._renderTexture&&this._renderTexture.render(this._container)}return Promise.resolve()}))}dispose(){super.dispose(),this._watermarkSprite.dispose()}}).identifier="watermark",Ym.prototype.availableOptions={watermarkURI:{type:l.STRING,required:!0},alignment:{type:l.STRING,default:"top-right"},inset:{type:l.NUMBER,default:"0.05"},size:{type:l.NUMBER,default:"0.2"},alpha:{type:l.NUMBER,default:1},crossOrigin:{type:l.STRING,default:"anonymous"}},ia.Operations.WatermarkOperation=Ym,Jm=Ym})),ef=b((()=>{_a(),nh(),lh(),ag(),lg(),hg(),_g(),pg(),xg(),bg(),vg(),wg(),Tg(),Bg(),Zp(),$p(),tf(),Km=[Sa,La,Uc,Hc,Kc,sd,ud,_d,bd,Rd,qd,jm,Xm,Jm,pd,jc],ia.AllOperations=Km})),sf=b((()=>{ef(),da(),da()})),rf=b((()=>{Zm=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}}]},{fontFamily:"Archivo",variations:[{identifier:"imgly_font_archivo_black",fontWeight:"normal",filePath:"fonts/imgly_font_archivo_black.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_bungee_inline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_campton_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Carter",variations:[{identifier:"imgly_font_carter_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_carter_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}}]},{fontFamily:"Codystar",variations:[{identifier:"imgly_font_codystar",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_codystar.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}}]},{fontFamily:"Fira Sans",variations:[{identifier:"imgly_font_fira_sans_regular",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_fira_sans_regular.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Krona One",variations:[{identifier:"imgly_font_krona_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_krona_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}}]},{fontFamily:"Kumar One Outline",variations:[{identifier:"imgly_font_kumar_one_outline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_kumar_one_outline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}}]},{fontFamily:"Molle",variations:[{identifier:"imgly_font_molle",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_molle.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}}]},{fontFamily:"Monoton",variations:[{identifier:"imgly_font_monoton",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_monoton.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}}]},{fontFamily:"Nixie One",variations:[{identifier:"imgly_font_nixie_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_nixie_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}}]},{fontFamily:"Notable",variations:[{identifier:"imgly_font_notable",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_notable.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}}]},{fontFamily:"Oswald SemiBold",variations:[{identifier:"imgly_font_oswald_semi_bold",fontWeight:600,fontStyle:"normal",filePath:"fonts/imgly_font_oswald_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}}]},{fontFamily:"Palanquin Dark SemiBold",variations:[{identifier:"imgly_font_palanquin_dark_semi_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_palanquin_dark_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}}]},{fontFamily:"Poppins",variations:[{identifier:"imgly_font_poppins",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_poppins.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_permanent_marker.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sancreek",variations:[{identifier:"imgly_font_sancreek",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sancreek.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}}]},{fontFamily:"Stint Ultra Expanded",variations:[{identifier:"imgly_font_stint_ultra_expanded",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_stint_ultra_expanded.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}}]},{fontFamily:"VT323",variations:[{identifier:"imgly_font_vt323",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_vt323.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Yeseva One",variations:[{identifier:"imgly_font_yeseva_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_yeseva_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}}]}]})),nf=b((()=>{Qm=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Abril Fatface",variations:[{identifier:"imgly_font_abril_fatface_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_abril_fatface_regular.woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}}]},{fontFamily:"Amberlight",variations:[{identifier:"imgly_font_amberlight",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_amberlight.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_bungee_inline.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_campton_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Handycheera",variations:[{identifier:"imgly_font_handycheera_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_handycheera_regular.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}}]},{fontFamily:"Montserrat Light",variations:[{identifier:"imgly_font_montserrat_light",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_montserrat_light.woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_heavy",fontWeight:900,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_heavy.woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_permanent_marker.woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Petit Formal Script",variations:[{identifier:"imgly_font_petit_formal_script",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_petit_formal_script.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}}]},{fontFamily:"Rasa",variations:[{identifier:"imgly_font_rasa_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_regular.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_500",fontWeight:500,fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_500.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_black.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_light.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sue Ellen Francisco",variations:[{identifier:"imgly_font_sue_ellen_francisco",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sue_ellen_francisco.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}}]},{fontFamily:"Ultra",variations:[{identifier:"imgly_font_ultra",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_ultra.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}}]},{fontFamily:"Wolesbro",variations:[{identifier:"imgly_font_wolesbro",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_wolesbro.woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}]}]})),of=b((()=>{$m=[{identifier:"imgly_transforms_common",defaultName:"Common Ratios",ratios:[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:!0},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:4/3},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:16/9}]},{identifier:"imgly_transforms_facebook",defaultName:"Facebook",ratios:[{identifier:"imgly_transform_facebook_profile",defaultName:"Profile Pic",dimensions:{x:300,y:300},forceDimensions:!1,lockDimensions:!0},{identifier:"imgly_transform_facebook_ad",defaultName:"Ad",dimensions:{x:1200,y:627}},{identifier:"imgly_transform_facebook_post",defaultName:"Post",dimensions:{x:940,y:788}},{identifier:"imgly_transform_facebook_cover",defaultName:"Cover",dimensions:{x:851,y:315}}]}]})),af=b((()=>{sf(),rf(),nf(),of(),tg=[],"undefined"!==typeof ia.Operations.SpriteOperation&&tg.push(ia.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush),eg={TRANSFORM_RATIO_CATEGORIES:$m,FONTS:Zm,TEXT_DESIGN_FONTS:Qm,BRUSHES:tg}})),lf=b((()=>{ps(),ig={...Ni,LOAD:"load",SAVE:"save",EDITOR_RESIZE:"editor:resize",ZOOM:"editor:zoom",ZOOM_CHANGED:"editor:zoom_changed",HISTORY_REDO:"history:redo",HISTORY_BEFORE_REDO:"history:before-redo",TEXT_SCALED:"editor:text:scaled",TRANSFORM_RESIZE:"transform:resize",TRANSFORM_AFTER_EDIT:"transform:after-edit",ADDED_STICKER:"sticker:added-sticker",SPRITES_DESELECTED:"editor:sprite:deselected-all",CANVAS_FOCUS:"canvas:focus"},sg=ig})),hf=b((()=>{af(),lf(),rg={EVENTS:sg,DEFAULTS:eg}}));function uf(){const{userAgent:t,appVersion:e}=navigator;return-1!==e.indexOf("MSIE")?e.match(/MSIE\s+?([0-9]+)/i)[1]:-1!==t.indexOf("Trident")&&t.match(/rv:([0-9]+)/i)[1]}var cf,df,_f,mf,gf,pf,ff,yf,xf,bf,vf,wf,Df,kf,Tf,Cf,Rf,If,Ff,Sf,Ef,Of,Af,Bf,Mf,Pf,Lf,zf,Nf,Uf,Gf,jf,Vf,Wf,Hf,qf,Xf,Yf,Jf,Kf=b((()=>{ng={getIEVersion:uf}})),Zf=b((()=>{sf(),Gt(),Ft(),C(),Kf(),cf=ia.Utils,({Vector2:df}=ia.Math),_f={getInnerDimensionsForElement(t){const e=new df(t.offsetWidth,t.offsetHeight),i=window.getComputedStyle(t,null);return e.x-=parseInt(i.getPropertyValue("padding-left"),10),e.x-=parseInt(i.getPropertyValue("padding-right"),10),e.y-=parseInt(i.getPropertyValue("padding-top"),10),e.y-=parseInt(i.getPropertyValue("padding-bottom"),10),e},getEventPosition(t){let e=t.clientX,i=t.clientY;if(-1!==t.type.indexOf("touch")){if(!t.touches.length)return;e=t.touches[0].clientX,i=t.touches[0].clientY}return new df(e,i)},createTransparentPatternCanvas(){const t=document.createElement("canvas"),e=t.getContext("2d");return t.width=10,t.height=10,e.fillStyle="white",e.fillRect(0,0,t.width,t.height),e.fillStyle="#cccccc",e.fillRect(0,0,t.width/2,t.height/2),e.fillRect(t.width/2,t.height/2,t.width,t.height),t},supportsMSBlob(){const t=document.createElement("canvas"),e="undefined"!==typeof t.msToBlob;return s(t),e},translate(t,e,i={}){let s=this.fetch(t,e);if(!s)return ut.info("Utils#translate",`Unable to translate \`${e}\``),null;for(const r in i)s=s.replace(`\${${r}}`,i[r]);return s},fetch(t,e,i){const s=(e=(e=e.replace(/\[(\w+)]/g,".$1")).replace(/^\./,"")).split(".");for(let r=0;r<s.length;r++){if(!(t=t[s[r]]))break}return"undefined"!==typeof t&&t},isMobile(){const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))},select(t,e,i=null){i||(i=t=>t);const s=[];return e.forEach((e=>{t.forEach((t=>{i(t)===e&&s.push(t)}))})),s},getJSONP:t=>new Nt(t).load(),cloneCategories:(t,e)=>t.map((t=>((t=cf.clone(t))[e]=t[e].slice(0),t))),mergeCategories(t,e,i){t=this.cloneCategories(t,i);let s=null;return e.forEach((e=>{t.forEach((t=>{e.identifier===t.identifier&&(s=t)})),s?s[i]=s[i].concat(e[i]):t.push(e)})),t},wrapFiltersInCategories:(t,e)=>t.map((t=>{let i=t;return e in i||(i={identifier:`imgly_filters_wrapped-${t.identifier}`,displayFlat:!0,[e]:[t]}),i})),getStyleObject(t){const e=window.getComputedStyle(t),i={};for(const s in e){const t=e.getPropertyValue(s),r=s.replace(/-([a-z])/g,((t,e)=>e.toUpperCase()));""!==t&&(i[r]=t)}return i},styleElement(t,e){for(const i in e)t.style[i]=e[i]},debounce(t,e,i){let s;return function(...r){const n=i&&!s;clearTimeout(s),s=setTimeout((()=>{s=null,i||t.apply(this,r)}),e),n&&t.apply(this,r)}},getScrollbarWidth(){const t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",t.style.msOverflowStyle="scrollbar",document.body.appendChild(t);const e=t.offsetWidth;t.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",t.appendChild(i);const s=i.offsetWidth;return t.parentNode.removeChild(t),e-s},findIntegerFraction(t,e=100){let i=Number.MAX_VALUE,s=0,r=0,n=1,o=1;for(let a=0;a<e;a++){const e=n/o-t;if(e<0)n++;else{if(!(e>0))return new df(n,o);o++}const a=Math.abs(n/o-t);a<i&&(i=a,s=n,r=o)}return new df(s,r)},toFixed(t,e=2){const i=t.toFixed(e);return parseFloat(i)},capitalize:t=>t.charAt(0).toUpperCase()+t.slice(1),flipObject(t){const e={};for(const i in t)e[t[i]]=i;return e},Browser:ng}})),Qf=b((()=>{sf(),ps(),St(),Ft(),hf(),Zf(),({Base64:mf}=ia),({Color:gf}=ia),({ColorMatrix:pf}=ia.Math),({EventEmitter:ff}=ia),yf=ia.Utils,({RenderType:xf}=ia),({ImageFormat:bf}=ia),vf=ia,({Vector2:wf}=ia.Math),({Rectangle:Df}=ia.Math),({Range:kf}=ia.Math),"undefined"!==typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):ts()})),$f=b((()=>{Qf(),T(Cf=Tf=class{constructor(t,e,i=!1){this._ui=t,this._options=e,this._categoriesById={},this._filtersByIdentifier={identity:vf.Operations.FilterOperation.Filters.IdentityFilter},this._categories=_f.wrapFiltersInCategories(Ui.DEFAULTS.FILTERS.slice(0),Tf.CATEGORY_ITEMS_PROPERTY),this._customAssetsAllowed=i||t.getEditor().getSDK()._l.areCustomAssetsAllowed(),this._customAssetsAllowed&&this._options.categories&&(this._options.categories=_f.wrapFiltersInCategories(this._options.categories,Tf.CATEGORY_ITEMS_PROPERTY)),this._initCategories()}instantiateFilterWithIdentifier(t){const e={value:this._ui._options.crossOrigin,cors:!0},i=this.getFilterByIdentifier(t);if(!i)return Promise.reject(new Error(`Unknown filter with identifier \`${t}\`!`));if(!(i.prototype instanceof vf.Operations.FilterOperation.Filter)){const{lutImage:t,resolution:s,horizontalTileCount:r,verticalTileCount:n}=i;let o,a,{lightColor:l,darkColor:h}=i;return l&&h?(l=gf.fromHex(l),h=gf.fromHex(h),Promise.resolve(new vf.Operations.FilterOperation.Filters.DuoToneFilter({lightColor:l,darkColor:h}))):(this._ui.getPreloader&&(o=this._ui.getPreloader().getAsset(t)),a=o?Promise.resolve(o):ct.loadImage(this._ui.getAssetPath(t),e),a.then((()=>ct.loadImage(this._ui.getAssetPath(t),e).then((t=>new vf.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:t,resolution:s,horizontalTileCount:r,verticalTileCount:n}))))))}return Promise.resolve(new i)}_initCategories(){if(this._customAssetsAllowed&&this._options.categories&&(this._options.replaceCategories?this._categories=_f.wrapFiltersInCategories(this._options.categories,Tf.CATEGORY_ITEMS_PROPERTY):this._categories=_f.mergeCategories(this._categories,this._options.categories,Tf.CATEGORY_ITEMS_PROPERTY)),this._customAssetsAllowed&&this._options.availableFilters){const t=[];this._categories.forEach((e=>{const i=e.filters.filter((t=>-1!==this._options.availableFilters.indexOf(t.identifier)));i.length>0&&t.push({identifier:e.identifier,defaultName:e.defaultName,filters:i})})),this._categories=t}const t={identifier:"all",defaultName:"All",visible:!1,filters:this._categories.length<=0?[]:this._categories.map((t=>t.filters)).reduce(((t,e)=>t.concat(e)))};this._categories.unshift(t),this._categoriesById.all=t,this._categories.forEach((t=>{this._categoriesById[t.identifier]=t})),t.filters.forEach((t=>{this._filtersByIdentifier[t.identifier]=t}))}getFiltersForCategory(t){if(!this._categoriesById[t])throw new Error(`Unknown filter category '${t}'`);return this._categoriesById[t].filters}getItemsByCategory(t){return this.getFiltersForCategory(t)}getFilterByIdentifier(t){return this._filtersByIdentifier[t]}getCategories(){return this._categories}getCategoryByIdentifier(t){return this._categoriesById[t]}},"CATEGORY_ITEMS_PROPERTY","filters")})),ty=b((()=>{sf(),(Rf=class extends we{}).prototype.availableOptions={fontFamily:{type:l.STRING,required:!0},variations:{type:l.ARRAY,required:!0}}})),ey=b((()=>{sf(),If={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"},(Ff=class extends we{getLabel(){let t=If[this._options.fontWeight];if("italic"===this._options.fontStyle)t+=" Italic";return t}}).prototype.availableOptions={identifier:{type:l.STRING,required:!0},fontFamily:{type:l.STRING,required:!0},fontWeight:{type:l.ALL,default:400},fontStyle:{type:l.STRING,default:"normal"},textMetrics:{type:l.OBJECT,default:null},provider:{type:l.STRING,available:["google","file"]},filePath:{type:l.STRING},default:{type:l.BOOLEAN,default:!1},font:{type:l.OBJECT}}})),iy=b((()=>{Qf(),ty(),ey(),Ft(),R(),Sf=class{constructor(t,e){this._ui=t,this._options=e,this._fonts=[],this._variationsByIdentifier={},this._fontsByFontFamily={},this._initFonts()}_initFonts(){const{fonts:t,replaceFonts:e,availableVariations:i,isTextDesign:s}=this._options;let o=!0;o=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed(),t&&o&&t.forEach((({variations:e},i)=>{e&&e.forEach(((e,s)=>{if(r[e.identifier]){const r=n(e.identifier,!0);t[i].variations[s].identifier=r;const{fontFamily:o}=rg.DEFAULTS.FONTS.find((t=>t.variations.some((t=>t.identifier===r))));t[i].fontFamily=o}}))}));let a,l=s?rg.DEFAULTS.TEXT_DESIGN_FONTS:rg.DEFAULTS.FONTS;o&&(l=e?t:l.concat(t||[])),l=l.map((t=>{const{fontFamily:e}=t;let{variations:s}=t;if(o&&i&&(s=s.filter((t=>-1!==i.indexOf(t.identifier)))),0===s.length)return null;const r=new Rf({fontFamily:e});return s=s.map((t=>{const i=new Ff(t);return i.setFontFamily(e),i.setFont(r),t.default&&!a&&(a=i),null==i.getTextMetrics()&&ut.warn(`Missing font metrics for ${i.getIdentifier()}. The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.`),this._variationsByIdentifier[i.getIdentifier()]=i,i})),r.setVariations(s),this._fontsByFontFamily[e]=r,r})).filter((t=>t)),a||([a]=l[0].getVariations()),this._defaultVariation=a,this._fonts=l}getFonts(){return this._fonts}getFontByFontFamily(t){return this._fontsByFontFamily[t]}getVariationByIdentifier(t){return this._variationsByIdentifier[n(t)]}getVariationsByIdentifier(){return{...this._variationsByIdentifier}}getDefaultVariation(){return this._defaultVariation}}})),sy=b((()=>{Qf(),Ef=class{constructor(t,e={}){this._ui=t,this._options=e,this._defaultLayouts=vf.Operations.SpriteOperation.TextDesignSprite.Layouts,this._legacyLayouts=vf.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts,this._layouts=[],this._init()}_init(){const{availableLayouts:t}=this._options,e={...this._defaultLayouts,...this._legacyLayouts};this._layouts=Object.keys(e).map((t=>({identifier:e[t].identifier,layout:e[t]}))),t&&(t.push(...Object.values(this._legacyLayouts).map((t=>t.identifier))),this._layouts=this._layouts.filter((e=>t.indexOf(e.identifier)>=0)))}getLayoutByIdentifier(t){const e=yf.Array.find(this._layouts,(e=>e.identifier===t));return e&&e.layout}getLayouts(){return[...this._layouts]}getDefaultLayout(){return this.getLayouts()[0]}}})),ry=b((()=>{ey(),30,"abcdefghijklmnopqrstuvwxzy",Of=class{constructor(t){this._fontVariation=t||new Ff({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"}),this._createRuler()}_createRuler(){this._ruler=document.createElement("div"),this._ruler.innerText="abcdefghijklmnopqrstuvwxzy",document.body.appendChild(this._ruler),this._setRulerStyle()}_setRulerStyle(){this._ruler.style.cssText=`\n      position: absolute;\n      top: -9999px;\n      left: -9999px;\n      opacity: 0;\n      display: inline-block;\n      font: ${this._fontVariation.getFontStyle()} ${this._fontVariation.getFontWeight()} 30px ${this._fontVariation.getFontFamily()};\n    `}setFontVariation(t){this._fontVariation=t,this._setRulerStyle()}getWidth(){return this._ruler?this._ruler.offsetWidth:-1}dispose(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null)}}})),ny=b((()=>{ry(),Af="undefined"!==typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):ts(),50,5e3,Bf=class{constructor(t){this._fontVariation=t,this._defaultFontRuler=new Of,this._customFontRuler=new Of(this._fontVariation)}observe(){const t=Af();return new Promise(((e,i)=>{const s=window.setInterval((()=>{if(this._defaultFontRuler.getWidth()!==this._customFontRuler.getWidth())return window.clearInterval(s),e();if(Af()-t>=5e3){const t=new Error(`Failed to load font ${this._fontVariation.getFontFamily()}.`);return t.font=this._fontVariation,i(t)}}),50)}))}dispose(){this._defaultFontRuler.dispose(),this._customFontRuler.dispose()}}})),oy=b((()=>{sf(),ny(),Mf=class{constructor(t){this._ui=t,this._fonts=[],this._observers=[]}add(t){this._fonts.push(t)}load(){return 0===this._fonts.length?Promise.resolve():(this._observers=[],this._fonts.forEach((t=>{this._observers.push(new Bf(t))})),st.executePromises(this._observers.map((t=>t.observe()))))}dispose(){this._observers.forEach((t=>t.dispose()))}}})),ay=b((()=>{oy(),Pf=class extends Mf{load(){return Promise.resolve()}}})),ly=b((()=>{oy(),Lf={italic:"i"},zf=class extends Mf{load(){return this._fonts.length&&this._addStylesheetTag(),super.load()}_addStylesheetTag(){const t=this._getFamiliesString(),e=document.createElement("link");e.rel="stylesheet",e.href=`https://fonts.googleapis.com/css?family=${t}`;document.getElementsByTagName("head")[0].appendChild(e)}_getFamiliesString(){const t={};this._fonts.forEach((e=>{const i=e.getFontFamily(),s=e.getFontStyle(),r=e.getFontWeight();t[i]=t[i]||[],"undefined"!==typeof r?t[i].push(`${r}${Lf[s]||""}`):t[i].push(400)}));const e=[];for(const i in t){const s=t[i],r=s.length?`:${s.join(",")}`:"",n=i.replace(" ","+")+r;e.push(n)}return e.join("|")}}})),hy=b((()=>{ay(),ly(),Nf=class{constructor(t,e){this._ui=t,this._fonts=e,this._loadedFonts=[]}setFonts(t){this._fonts=t}needsToLoad(){for(let t=0;t<this._fonts.length;t++){let e;if(this._fonts[t].getVariations().forEach((t=>{e=e||t.getProvider()})),e)return!0}}fontLoaded(t){const e=t.getFontFamily();return-1!==this._loadedFonts.indexOf(e)}setFontLoaded(t){if(!this.fontLoaded(t)){const e=t.getFontFamily();this._loadedFonts.push(e)}}load(){const t=this._fonts,e={google:new zf(this._ui),file:new Pf(this._ui)},i=()=>{for(const t in e){e[t].dispose()}};t.filter((t=>!this.fontLoaded(t))).forEach((t=>{t.getVariations().forEach((t=>{const i=t.getProvider();if(!i)return;e[i].add(t)}))}));const s=[];for(const r in e)s.push(e[r].load());return Promise.all(s).then((()=>{i(),t.forEach((t=>{this.setFontLoaded(t)}))})).catch((t=>{throw i(),t}))}}})),uy=b((()=>{Qf(),Uf=class{constructor(t,e){this._ui=t,this._options=e,this._brushes=[],this._brushesById={},this._addBrushes(rg.DEFAULTS.BRUSHES);const{brushes:i,replaceBrushes:s,availableBrushes:r}=this._options;this._options.brushes&&this._addBrushes(i,s),r&&(this._brushes=this._brushes.filter((t=>-1!==r.indexOf(t.identifier))))}_addBrushes(t,e){e&&(this._brushes=[],this._brushesById={}),t.forEach((t=>{this._brushes.push(t),this._brushesById[t.identifier]=t}))}getBrushByIdentifier(t){return this._brushesById[t]}getBrushes(){return this._brushes}getFirstBrush(){return this._brushes[0]}}})),cy=b((()=>{Gf=class{constructor(){this._assetsByGroupId={}}addAsset(t,e,i=!1){this._assetsByGroupId[t]?i?this._assetsByGroupId[t].unshift(e):this._assetsByGroupId[t].push(e):this._assetsByGroupId[t]=[e]}setAssets(t,e){this._assetsByGroupId[t]=e}getAssets(t){return this._assetsByGroupId[t]=this._assetsByGroupId[t]||[],this._assetsByGroupId[t]}}})),dy=b((()=>{Qf(),sf(),cy(),ps(),Gt(),jf="imgly_sticker_custom",Vf=class{constructor(t,e,i){this._ui=t,this._options=e,this._dynamicAssetsLibrary=i||this._ui.getEditor().getDynamicAssetsLibrary()||new Gf,this._categoriesById={},this._categories=[],this._stickersById={},this._customStickerCanvas=st.createCanvas(),this.reload()}reload(){this._categoriesById={},this._categories=[],this._stickersById={};const t=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();this._addCategories(Ui.DEFAULTS.STICKER_CATEGORIES);const{categories:e,replaceCategories:i}=this._options;if(t&&this._options.categories?this._addCategories(e,i):(this._updateCategoriesMap(),this._updateAllCategory()),t){const t=this._dynamicAssetsLibrary.getAssets("sticker");if(t.length>0){const e=this._createCustomStickerCategory(t);this._addCategories([e],!1,!0)}}}loadExternal(t){return new Nt(t).load().then((t=>{this._addCategories(t.categories,this._options.replaceCategories)}))}_addCategories(t,e=!1,i=!1){this._categories=e?t.slice(0):i?this._mergeCategories(t,this._categories):this._mergeCategories(this._categories,t),this._updateCategoriesMap(),this._updateAllCategory()}_mergeCategories(t,e){t=_f.cloneCategories(t,"stickers");for(const i of e){let e=!1;for(const s of t)if(i.identifier===s.identifier){for(const t of i.stickers){let e=!1;for(const i of s.stickers)if(t.identifier===i.identifier){Object.assign(i,t),e=!0;break}e||s.stickers.push(t)}e=!0;break}e||t.push(i)}return t}_updateCategoriesMap(){this._categoriesById={},this._categories.forEach((t=>{this._categoriesById[t.identifier]=t})),this._categories.forEach((t=>{t.stickers.forEach((t=>{this._stickersById[t.identifier]=t}))})),"undefined"!==typeof this._options.availableStickers&&null!==this._options.availableStickers&&(this._categories.forEach((t=>{t.identifier!==jf&&(t.stickers=t.stickers.filter((t=>-1!==this._options.availableStickers.indexOf(t.identifier))))})),this._categories=this._categories.filter((t=>t.stickers.length>0))),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map((t=>t.stickers)).reduce(((t,e)=>t.concat(e)),[])},this._categoriesById.all=this._allCategory}renderStickerThumbnailFromImage(t){const e=this._customStickerCanvas,i=e.getContext("2d");i.save();const s=62/t.width,r=s*t.height;e.width=62,e.height=62,i.clearRect(0,0,t.width,t.height),i.translate(0,.5*(e.height-r)),i.scale(s,s),i.drawImage(t,0,0);const n=e.toDataURL("image/png");return i.restore(),{data:n,width:62,height:r}}addCustomStickerFromImage(t,e,i="none"){const s="data:image/svg"===t.src.substring(0,14);t=this._ui.getEditor().getSDK().correctExifOrientation(t);const r=((t,e)=>{const i=t.x/t.y;return i>1?new wf(e,e/i):new wf(e*i,e)})(new wf(t.width,t.height),2048),n=s?r:(t=>{const e=this._ui.getEditor().getSDK().getRenderer(),i=new wf(t.width,t.height),s=1e6*this._ui.getEditor().getMaxMegapixels();let r=e.getMaxDimensions();const n=i.x*i.y>s,o=null!==r&&(i.x>r||i.y>r);if(n){const e=t.width/t.height,i=t.height/t.width;r=new wf(Math.sqrt(s*e),Math.sqrt(s*i)).floor().max()}const a=i.clone();return(n||o)&&(i.x/i.y>1?(a.x=r,a.y=r/i.x*i.y):(a.x=r/i.y*i.x,a.y=r)),a})(t),o=this._customStickerCanvas,a=o.getContext("2d");a.save();const l=this.renderStickerThumbnailFromImage(t);s?(t.width>t.height?(o.width=2048,o.height=2048/t.width*t.height):(o.height=2048,o.width=2048/t.height*t.width),t.width=o.width,t.height=o.height):(o.width=n.x,o.height=n.y,a.scale(n.x/t.width,n.y/t.height)),a.drawImage(t,0,0,t.width,t.height);const h=o.toDataURL();a.restore();const u={identifier:st.generateUUID(),defaultName:e||"",tintMode:i,images:{mediaThumb:{uris:[l.data],rawData:!0,width:l.width,height:l.height},mediaBase:{uris:s?[h,t.src]:[h],rawData:!0,isSVG:s,width:n.x,height:n.y}}},c=this._dynamicAssetsLibrary;c.addAsset("sticker",u,!0);const d=c.getAssets("sticker");if(1===d.length){const t=this._createCustomStickerCategory(d);this._addCategories([t],!1,!0)}else this.getCategory(jf).stickers=d,this._updateAllCategory();this._updateCategoriesMap()}_createCustomStickerCategory(t){return{identifier:jf,defaultName:"Custom",metaData:{backgroundImage:t[t.length-1].images.mediaBase.uris[0],rawData:!0},stickers:t}}getStickersForCategory(t){if(!this._categoriesById[t])throw new Error(`Unknown sticker category '${t}'`);return this._categoriesById[t].stickers}getStickerByIdentifier(t){return this._stickersById[t]}getCategories(t=!1){return t?[this._allCategory].concat(this._categories):this._categories}getCategory(t){return this._categoriesById[t]}static getURLForSticker(t,e="base"){const{images:i}=t,s="base"===e&&i.mediaBase||i.mediaThumb,r=s.uris||[s.uri];if(!_f.Browser.getIEVersion()){const t=r.filter((t=>/\.svg$/i.test(t)));return t.length?t[0]:r[0]}const n=r.filter((t=>!/\.svg$/i.test(t)));return n.length?n[0]:r[0]}}})),_y=b((()=>{Qf(),hy(),uy(),$f(),iy(),dy(),Wf=D(A()),"undefined"!==typeof vf.Operations.SpriteOperation&&(Hf=vf.Operations.SpriteOperation.BrushSprite),(qf=class{constructor(t,e){this._editor=t,this._ui=this._editor.getUI(),this._data=e,this._filterManager=new Cf(this._ui,this._getOptions("filter")),this._stickerManager=new Vf(this._ui,this._getOptions("sticker")),this._brushManager=new Uf(this._ui,this._getOptions("brush")),this._fontManager=new Sf(this._ui,this._getOptions("text"))}_getOptions(t){const{controls:e}=this._editor;let i={};e&&e.get(t)&&(i=e.get(t).defaultOptions);const s=this._editor.getOptions();return yf.deepDefaults({},s.editor.controlsOptions[t]||{},i)}deserialize(){return this._validateVersion().then((()=>this._deserializeInputImage())).then((()=>this._deserializeOperations()))}_validateVersion(){return this._data.version!==this.constructor.version?Promise.reject(new Error(`Invalid version ${this._data.version}, expected ${this.constructor.version}`)):Promise.resolve()}_deserializeInputImage(){return new Promise(((t,e)=>{const{data:i,type:s}=this._data.inputImage;if(i&&s){const e=new window.Image;e.addEventListener("load",(()=>{this._editor.setImage(e),t()})),e.src=`data:${s};base64,${i}`}else t()}))}async _deserializeOperations(){const{operations:t}=this._data;return(0,Wf.default)(t,(async t=>this._deserializeOperation(t)))}_deserializeOperation(t){switch(t.type){case"crop":return this._deserializeCropOperation(t);case"orientation":return this._deserializeOrientationOperation(t);case"filter":return this._deserializeFilterOperation(t);case"adjustments":return this._deserializeAdjustmentsOperation(t);case"sprite":return this._deserializeSpriteOperation(t);case"focus":return this._deserializeFocusOperation(t)}}_deserializeCropOperation(t){const{options:e}=t;let{rotation:i}=e;const s=wf.fromObject(e.start),r=wf.fromObject(e.end);i>Math.PI&&(i-=2*Math.PI);const n={start:s,end:r};"undefined"!==typeof i&&(n.rotation=i);const o=this._editor.operations.getOrCreate("transform");return this._editor.broadcastTransform(o,n),o.set(n),Promise.resolve(o)}_deserializeOrientationOperation(t){const{options:e}=t,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(e),Promise.resolve(i)):Promise.resolve()}_deserializeFilterOperation(t){const{options:e}=t;return this._filterManager.getFilterByIdentifier(e.name)?this._filterManager.instantiateFilterWithIdentifier(e.name).then((t=>{const i=this._editor.operations.getOrCreate("filter");return i.set({identifier:e.name,filter:t,intensity:e.intensity}),i})):(ut.warn("Deserializer",`Unknown filter \`${e.name}\``),Promise.resolve())}_deserializeAdjustmentsOperation(t){const{AdjustmentsOperation:e}=vf.Operations,{options:i}=t,s={};return["brightness","saturation","contrast","exposure","shadows","highlights","clarity"].forEach((t=>{if("undefined"===typeof i[t])return;const{minValue:r,midValue:n,maxValue:o}=e.prototype.availableOptions[t];let a=i[t];a=a<0?n+(n-r)*a:n+(o-n)*a,s[t]=a})),Promise.resolve(this._editor.operations.getOrCreate("adjustments",s))}_deserializeSpriteOperation(t){const{options:e}=t,i=this._editor.operations.getOrCreate("sprite");if(!i)return Promise.resolve();const s=e.sprites.map((t=>this._deserializeSprite(i,t))).filter((t=>t));return Promise.all(s).then((t=>(i.setSprites(t.filter((t=>t))),i)))}_deserializeSprite(t,e){switch(e.type){case"sticker":return this._deserializeSticker(t,e);case"text":return this._deserializeText(t,e);case"brush":return this._deserializeBrush(t,e);case"textdesign":return this._deserializeTextDesign&&this._deserializeTextDesign(t,e)}}_deserializeSticker(t,e){const{SpriteOperation:i}=vf.Operations,{options:s}=e,r=this._stickerManager.getStickerByIdentifier(s.name),n=this._stickerManager.getURLForSticker(r);return r?new Promise(((e,r)=>{const o=new window.Image;o.addEventListener("load",(()=>{const r=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:n,flipHorizontally:a,flipVertically:l}=s,h={identifier:s.name,image:o,position:wf.fromObject(s.position),dimensions:wf.fromObject(s.dimensions),rotation:n,flipHorizontally:a,flipVertically:l,adjustments:{}};"undefined"!==typeof s.adjustments&&["brightness","contrast","saturation"].forEach((t=>{"undefined"!==typeof s.adjustments[t]&&(h.adjustments[t]=s.adjustments[t]+r[t].default)})),e(t.createSticker(h))})),o.crossOrigin=this._editor.getCrossOrigin(),o.src=this._editor.getUI().getAssetPath(n)})):(ut.warn("Deserializer",`Unknown sticker '${s.name}'. Skipping sprite.`),Promise.resolve())}_deserializeText(t,e){const{options:i}=e,{fontSize:s,lineHeight:r,fontFamily:n,fontWeight:o,alignment:a,rotation:l,maxWidth:h,color:u,backgroundColor:c}=i,d=new Nf(this._ui);let _=this._fontManager.getFontByFontFamily(n);return _||(_=this._fontManager.getDefaultFont()),d.setFonts([_]),d.load().then((()=>{const e=t.createText({fontSize:s,lineHeight:r,fontFamily:n,fontWeight:o,alignment:a,rotation:l,maxWidth:h,text:i.text,color:gf.fromArray(u),backgroundColor:gf.fromArray(c),position:wf.fromObject(i.position)});return e._edited=!0,e}))}_deserializeBrush(t,e){const{options:i}=e,{paths:s}=i,r=t.createBrush();return s.forEach((t=>{this._deserializeBrushPath(r,t)})),Promise.resolve(r)}_deserializeBrushPath(t,e){const{points:i}=e,s=this._createBrushForPath(e),r=t.createPath(s);r.setClosed(!0),i.forEach((t=>{r.addControlPoint(wf.fromObject(t))}))}_createBrushForPath(t){const{color:e,size:i}=t,s={color:gf.fromArray(e),size:i},r=this._brushManager.getFirstBrush();if(r.prototype&&r.prototype instanceof Hf){return new r(s)}const n={...r};delete n.image;class o extends Hf{}return o.identifier=r.identifier,new o({...n,...s})}_deserializeFocusOperation(t){const{options:e}=t.options;switch(t.options.type){case"radial":{const{position:t,radius:i,gradientRadius:s,blurRadius:r}=e;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:wf.fromObject(t),radius:i,gradientRadius:s,blurRadius:r}))}case"linear":{const{start:t,end:i,size:s,gradientSize:r,blurRadius:n}=e;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:wf.fromObject(t),end:wf.fromObject(i),size:s,gradientSize:r,blurRadius:n}))}}}_getInputDimensionsForOperation(t){let e=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach((s=>{s===t&&(e=!0),e||(i=s.getNewDimensions(i))})),i}}).version="1.0.0"})),my=b((()=>{Qf(),Xf=2*Math.PI,(Yf=class{constructor(t){this._editor=t,this._serializeOperations=this._serializeOperations.bind(this)}serialize(t={}){this._options={...t,image:!0};const e={version:this.constructor.version};return this._serializeInputImage(e).then(this._serializeOperations)}_serializeInputImage(t){const e=this._editor.getImage(),{width:i,height:s}=e;if(!this._options.image)return t.inputImage={width:i,height:s},Promise.resolve(t);const r=yf.createCanvas();r.width=e.width,r.height=e.height;r.getContext("2d").drawImage(e,0,0);const n=r.toDataURL(bf.PNG);return t.inputImage={type:bf.PNG,data:n.replace(/^data:image\/(.*?);base64,/,""),width:i,height:s},Promise.resolve(t)}_serializeOperations(t){const e=[];return this._editor.operations.getStack().forEach((t=>{const i=this._serializeOperation(t,e);i&&e.push(i)})),t.operations=e.filter((t=>t)),Promise.resolve(t)}_serializeOperation(t,e){switch(t.constructor.identifier){case"transform":return this._serializeTransformOperation(t);case"orientation":return this._serializeOrientationOperation(t);case"filter":return this._serializeFilterOperation(t);case"adjustments":return this._serializeAdjustmentsOperation(t);case"sprite":return this._serializeSpriteOperation(t,e);case"radial-focus":return this._serializeRadialFocusOperation(t);case"mirrored-focus":return this._serializeLinearFocusOperation(t);default:ut.warn(`Unable to serialize operation of type ${t.constructor.identifier}`)}}_serializeTransformOperation(t){const e=t.serializeOptions(["start","end","rotation"],!0);return e.rotation=(e.rotation+Xf)%Xf,{type:"crop",options:e}}_serializeOrientationOperation(t){return{type:"orientation",options:t.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeFilterOperation(t){return"identity"===t.getIdentifier()?null:{type:"filter",options:{intensity:t.getIntensity(),name:t.getIdentifier()}}}_serializeAdjustmentsOperation(t){const{availableOptions:e}=t,i={};return["brightness","saturation","contrast","exposure","shadows","highlights","clarity"].forEach((s=>{const r=e[s],n=t.getOption(s),{minValue:o,midValue:a,maxValue:l}=r;i[s]=n<=a?(n-o)/(a-o)-1:(n-a)/(l-a)})),{type:"adjustments",options:i}}_serializeSpriteOperation(t,e){const i=e.filter((t=>"sprite"===t.type));let s,r=!0;if(i.length?(s=i.pop(),r=!1):s={type:"sprite",options:{sprites:[]}},t.getSprites().forEach((e=>{let i=null;e instanceof t.constructor.StickerSprite?i=this._serializeSticker(t,e):e instanceof t.constructor.TextSprite?i=this._serializeText(t,e):e instanceof t.constructor.BrushSprite?i=this._serializeBrush(t,e):e instanceof t.constructor.TextDesignSprite&&(i=this._serializeTextDesign&&this._serializeTextDesign(t,e)),i&&s.options.sprites.push(i)})),r)return s}_serializeSticker(t,e){const i=e.getAdjustments(),s=e.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],!0);s.name=s.identifier,delete s.identifier,s.rotation=(s.rotation+Xf)%Xf;const r=i.availableOptions;return s.adjustments={brightness:i.getBrightness()-r.brightness.default,saturation:i.getSaturation()-r.saturation.default,contrast:i.getContrast()-r.contrast.default},{type:"sticker",options:s}}_serializeText(t,e){const i=e.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],!0);return i.rotation=(i.rotation+Xf)%Xf,{type:"text",options:i}}_serializeBrush(t,e){return{type:"brush",options:{paths:e.getPaths().map((t=>this._serializePath(t)))}}}_serializePath(t){const e=t.getBrush().serializeOptions(["color","size"],!0);return e.points=t.getControlPoints().map((t=>t.getPosition().toObject())),e}_serializeRadialFocusOperation(t){return{type:"focus",options:{type:"radial",options:t.serializeOptions(["position","radius","gradientRadius","blurRadius"],!0)}}}_serializeLinearFocusOperation(t){return{type:"focus",options:{type:"linear",options:t.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_getInputDimensionsForOperation(t){let e=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach((s=>{s===t&&(e=!0),e||(i=s.getNewDimensions(i))})),i}}).version="1.0.0"})),gy={};w(gy,{default:()=>Jf});var py,fy,yy,xy,by=b((()=>{_y(),my(),(Jf=class{constructor(t){this._editor=t}serialize(...t){return new Yf(this._editor).serialize(...t)}deserialize(t){return new qf(this._editor,t).deserialize()}}).version="1.0.0"})),vy=b((()=>{Qf(),_y(),(py=class extends qf{_deserializeOperation(t){return"selective-blur"===t.type?this._deserializeSelectiveBlurOperation(t):super._deserializeOperation(t)}_deserializeCropOperation(t){const{options:e}=t;let{rotation:i}=e;const s=wf.fromObject(e.start),r=wf.fromObject(e.end),n=e.dimensions?wf.fromObject(e.dimensions):null;if(r.x-s.x<=0||r.y-s.y<=0)throw new Error(`A crop should not result in negative or zero dimensions - start: ${s} - end: ${r}`);i>Math.PI&&(i-=2*Math.PI);const o={start:s,end:r};"undefined"!==typeof i&&(o.rotation=i);const a=this._editor.operations.getOrCreate("transform");if(!a)return Promise.resolve();if(this._editor.broadcastTransform(a,o),a.set(o),n){const t=r.clone().subtract(s),e=a.getInputDimensions(!1).multiply(t);a.setTextureScale(n.x/e.x)}return Promise.resolve(a)}}).version="1.0.1"})),wy=b((()=>{my(),fy=2*Math.PI,(yy=class extends Yf{_serializeTransformOperation(t){const e=t.serializeOptions(["start","end","rotation","textureScale"],!0);return e.rotation=(e.rotation+fy)%fy,1!==e.textureScale&&(e.dimensions=t.getNewDimensions(t.getInputDimensions(!1))),delete e.textureScale,{type:"crop",options:e}}}).version="1.0.1"})),Dy={};w(Dy,{default:()=>xy});var ky,Ty,Cy,Ry,Iy,Fy,Sy,Ey,Oy,Ay,By=b((()=>{vy(),wy(),(xy=class{constructor(t){this._editor=t}serialize(...t){return new yy(this._editor).serialize(...t)}deserialize(t){return new py(this._editor,t).deserialize()}}).version="1.0.1"})),My=b((()=>{St(),Qf(),({OptionType:ky}=vf),(Ty=class extends vf.Configurable{constructor(t,e={}){super(e),this._loaded=!1,this._loading=!1,this._ui=t,this._frame=vf.Utils.deepClone(this._options)}load(){if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=!0;const{imageGroups:t}=this._frame,e=[];return["top","left","right","bottom"].forEach((i=>{if(!(i in t))return;const s=t[i];["start","mid","end"].forEach((t=>{t in s&&e.push(this._loadPart(i,t))}))})),Promise.all(e).then((()=>{this._loaded=!0,this._loading=!1})).catch((t=>{this._loaded=!1,this._loading=!1}))}_loadPart(t,e){const{imageGroups:i}=this._frame,s=i[t][e];let r=s;return"string"!==typeof s&&"image"in s&&(r=s.image),ct.load(this._ui.getAssetPath(r)).then((i=>("string"!==typeof s?this._frame.imageGroups[t][e].image=i:this._frame.imageGroups[t][e]=i,i)))}getFrame(){return this._frame}}).prototype.availableOptions={identifier:{type:ky.STRING,required:!0},defaultName:{type:ky.STRING},thumbnail:{type:ky.STRING},tintable:{type:ky.BOOLEAN,default:!1},layoutMode:{type:ky.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:ky.OBJECT,required:!0}}})),Py=b((()=>{Qf(),Cy=class{constructor(t,e){this._ui=t,this._options=e,this._categoriesById={},this._categories=[],this._framesById={},this._addCategories(Ui.DEFAULTS.FRAME_CATEGORIES),this._customAssetsAllowed=t.getEditor().getSDK()._l.areCustomAssetsAllowed();const{categories:i,replaceCategories:s}=this._options;this._customAssetsAllowed&&this._options.categories?this._addCategories(i,s):this._updateAllCategory()}_addCategories(t,e=!1){this._categories=e?t.slice(0):_f.mergeCategories(this._categories,t,"frames"),this._categoriesById={},this._categories.forEach((t=>{this._categoriesById[t.identifier]=t}));const{availableFrames:i}=this._options;this._customAssetsAllowed&&i&&this._categories.forEach((t=>{t.frames=t.frames.filter((t=>-1!==i.indexOf(t.identifier)))})),this._categories.forEach((t=>{t.frames.forEach((t=>{this._framesById[t.identifier]=t}))})),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map((t=>t.frames)).reduce(((t,e)=>t.concat(e)),[])},this._categoriesById.all=this._allCategory}getFramesForCategory(t){if(!this._categoriesById[t])throw new Error(`Unknown frame category '${t}'`);return this._categoriesById[t].frames}getFrameByIdentifier(t){return this._framesById[t]}getCategories(){return this._categories}getCategory(t){return this._categoriesById[t]}}})),Ly=b((()=>{Qf(),Ry=class{constructor(t,e){this._ui=t,this._options=e,this._overlays=Ui.DEFAULTS.OVERLAYS.slice(0),this._overlaysByIdentifier={};const i=t.getEditor().getSDK()._l.areCustomAssetsAllowed();i&&e.overlays&&(e.replaceOverlays?this._overlays=e.overlays:this._overlays=this._overlays.concat(e.overlays)),i&&e.availableOverlays&&(this._overlays=this._overlays.filter((t=>-1!==e.availableOverlays.indexOf(t.identifier)))),this._overlays.forEach((t=>{this._overlaysByIdentifier[t.identifier]=t}))}getOverlays(){return this._overlays}getOverlayByIdentifier(t){return this._overlaysByIdentifier[t]}}})),zy=b((()=>{Qf(),({OverlayFilter:Iy}=vf.Engine.Filters),Fy={[Iy.BLEND_MODES.NORMAL]:"normal",[Iy.BLEND_MODES.OVERLAY]:"overlay",[Iy.BLEND_MODES.HARD_LIGHT]:"hard light",[Iy.BLEND_MODES.SOFT_LIGHT]:"soft light",[Iy.BLEND_MODES.MULTIPLY]:"multiply",[Iy.BLEND_MODES.DARKEN]:"darken",[Iy.BLEND_MODES.LIGHTEN]:"lighten",[Iy.BLEND_MODES.SCREEN]:"screen",[Iy.BLEND_MODES.COLOR_BURN]:"color burn"}})),Ny=b((()=>{Qf(),hy(),My(),St(),Py(),Ly(),dy(),vy(),zy(),Sy=yf.flipObject(Fy),(Ey=class extends py{constructor(...t){super(...t),this._frameManager=new Cy(this._ui,this._getOptions("frame"));const e=this._getOptions("overlay");e&&(this._overlayManager=new Ry(this._ui,e))}_deserializeSprite(t,e){return"frame"===e.type?this._deserializeFrame(t,e):"overlay"===e.type?this._deserializeOverlay(t,e):super._deserializeSprite(t,e)}_deserializeOperation(t){return"transform"===t.type?this._deserializeTransformOperation(t):super._deserializeOperation(t)}_deserializeOrientationOperation(t){if(this._data.meta&&"html5"!==this._data.meta.platform)return super._deserializeOrientationOperation(t);const{rotation:e,flipHorizontally:i,flipVertically:s}=t.options;let r=90===e&&!i&&!s;return r|=90===e&&i&&s,r|=270===e&&!i&&!s,r|=270===e&&i&&s,r&&(t.options.flipHorizontally=!t.options.flipHorizontally,t.options.flipVertically=!t.options.flipVertically),super._deserializeOrientationOperation(t)}_deserializeTransformOperation(t){return super._deserializeCropOperation(t).then((t=>{if(!t)return;const e=yf.Array.find(this._data.operations,(t=>"orientation"===t.type));if(e){const{options:i}=e;let{rotation:s,flipHorizontally:r,flipVertically:n}=i;90!==s&&270!==s||(!r&&n||r&&!n)&&(r=!r,n=!n),t.rotate(i.rotation),r&&(t.flip("horizontal"),t.setRotation(-1*t.getRotation())),n&&(t.flip("vertical"),t.setRotation(-1*t.getRotation()))}return t}))}_deserializeFrame(t,e){const{identifier:i}=e.options,s=this._frameManager.getFrameByIdentifier(i);if(!s)return ut.warn("Deserializer",`Unknown frame \`${i}\`. Skipping frame.`),Promise.resolve();const r=new Ty(this._ui,s);return r.load().then((()=>{this._editor.operations.getOrCreate("frame",{frame:r.getFrame()})}))}_deserializeOverlay(t,e){const{blendMode:i,intensity:s,identifier:r}=e.options,n=this._overlayManager.getOverlayByIdentifier(r);if(!n)return ut.warn("Deserializer",`Unknown overlay \`${r}\`. Skipping overlay.`),Promise.resolve();const o=this._editor.getUI().getAssetPath(n.image);return ct.load(o).then((t=>{this._editor.operations.getOrCreate("overlay",{alpha:s,identifier:r,blendMode:parseInt(Sy[i||n.blendMode],10),image:t})}))}_createBrushForPath(t){const e=super._createBrushForPath(t);return"undefined"!==typeof t.hardness&&e.hasOption("hardness")&&e.setHardness(t.hardness),e}_deserializeSticker(t,e){const{SpriteOperation:i}=vf.Operations,{options:s}=e,r=this._stickerManager.getStickerByIdentifier(s.identifier),n=Vf.getURLForSticker(r,"base");if(!r)return ut.warn("Deserializer",`Unknown sticker \`${s.identifier}\`. Skipping sprite.`),Promise.resolve();const o=t.getInputDimensions(!1);return new Promise(((e,a)=>{const l=new window.Image;l.addEventListener("load",(()=>{const n=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:a,flipHorizontally:h,flipVertically:u}=s,c={identifier:s.identifier,image:l,position:wf.fromObject(s.position),dimensions:wf.fromObject(s.dimensions).multiply(o.min()),rotation:a,flipHorizontally:h,flipVertically:u,adjustments:{}};"undefined"!==typeof s.adjustments&&["brightness","contrast","saturation"].forEach((t=>{"undefined"!==typeof s.adjustments[t]&&(c.adjustments[t]=s.adjustments[t]+n[t].default)})),"undefined"!==typeof s.tintColor&&"undefined"!==typeof r.tintMode&&(c.tintColor=gf.fromArray(s.tintColor),c.tintMode=r.tintMode),e(t.createSticker(c))})),l.crossOrigin=this._editor.getCrossOrigin(),l.src=this._editor.getUI().getAssetPath(n)}))}_deserializeFilterOperation(t){const{options:e}=t;return this._filterManager.getFilterByIdentifier(e.identifier)?this._filterManager.instantiateFilterWithIdentifier(e.identifier).then((t=>{const i=this._editor.operations.getOrCreate("filter");if(i)return i.set({identifier:e.identifier,filter:t,intensity:e.intensity}),i})):(ut.warn("Deserializer",`Unknown filter \`${e.identifier}\``),Promise.resolve())}_deserializeFocusOperation(t){const{options:e,type:i}=t.options;if("radial"!==i)return super._deserializeFocusOperation(t);const s=this._editor.getImage(),r=s.width/s.height,{start:n,end:o,gradientRadius:a,blurRadius:l}=e,h=wf.fromObject(o).subtract(wf.fromObject(n)).multiply(r,1).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:wf.fromObject(n),radius:h,gradientRadius:a,blurRadius:l}))}_deserializeText(t,e){const{options:i}=e,{fontSize:s,lineHeight:r,fontIdentifier:n,alignment:o,rotation:a,maxWidth:l,color:h,backgroundColor:u}=i,c=new Nf(this._ui);let d=this._fontManager.getVariationByIdentifier(n);return d?c.setFonts([d.getFont()]):d=this._fontManager.getDefaultFont(),c.load().then((()=>{const e=t.getInputDimensions(!1),n=l*e.min()/e.x,c=t.createText({fontSize:s,lineHeight:r,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),alignment:o,rotation:a,maxWidth:n,text:i.text,color:gf.fromArray(h),backgroundColor:gf.fromArray(u),position:wf.fromObject(i.position)});return c._edited=!0,c}))}}).version="2.0.0"})),Uy=b((()=>{wy(),zy(),(Oy=class extends yy{_serializeSticker(t,e){const i=t.getInputDimensions(!1),s=super._serializeSticker(t,e);return"none"!==e.getTintMode()&&(s.options.tintColor=e.serializeOption("tintColor",!0)),s.options.dimensions=e.getDimensions().clone().divide(i.min()).toObject(),s.options.identifier=s.options.name,delete s.options.name,s}_serializePath(t){const e=super._serializePath(t),i=t.getBrush();return i.hasOption("hardness")&&(e.hardness=i.getOption("hardness")),e}_serializeOperation(t,e){return"frame"===t.constructor.identifier?(this._serializeFrameOperation(t,e),null):"overlay"===t.constructor.identifier?(this._serializeOverlayOperation(t,e),null):super._serializeOperation(t,e)}_serializeFrameOperation(t,e){const i=e.filter((t=>"sprite"===t.type));let s;i.length?s=i.pop():(s={type:"sprite",options:{sprites:[]}},e.push(s)),s.options.sprites.push({type:"frame",options:this._getFrameOptions(t)})}_serializeOverlayOperation(t,e){if(!t.getIdentifier())return;const i=e.filter((t=>"sprite"===t.type));let s;i.length?s=i.pop():(s={type:"sprite",options:{sprites:[]}},e.push(s)),s.options.sprites.push({type:"overlay",options:{identifier:t.getIdentifier(),intensity:t.getAlpha(),blendMode:Fy[t.getBlendMode()]}})}_getFrameOptions(t){return{identifier:t.getFrame().identifier}}_serializeOrientationOperation(t){const e=super._serializeOrientationOperation(t);return 90!==e.options.rotation&&270!==e.options.rotation||(e.options.flipHorizontally=!e.options.flipHorizontally,e.options.flipVertically=!e.options.flipVertically),e}_serializeTransformOperation(t){const{operations:e}=this._editor;if(e.exists("orientation")){t=t.clone();const i=e.get("orientation");t.rotate(-i.getRotation()),i.getFlipVertically()&&(t.flip("vertical"),t.setRotation(-1*t.getRotation())),i.getFlipHorizontally()&&(t.flip("horizontal"),t.setRotation(-1*t.getRotation()))}const i=super._serializeTransformOperation(t);return i.type="transform",i}_serializeText(t,e){const i=super._serializeText(t,e),s=t.getInputDimensions(!1);return i.options.fontIdentifier=e.getFontIdentifier(),i.options.maxWidth=i.options.maxWidth*s.x/s.min(),delete i.options.fontFamily,i}_serializeFilterOperation(t){const e=super._serializeFilterOperation(t);return e?(e.options.identifier=e.options.name,delete e.options.name,e):null}_serializeRadialFocusOperation(t){const e=super._serializeRadialFocusOperation(t),i=e.options.options;return i.start=i.position,delete i.position,i.end={x:i.start.x+i.radius,y:i.start.y},delete i.radius,e}}).version="2.0.0"})),Gy={};w(Gy,{default:()=>Ay});var jy,Vy,Wy,Hy,qy,Xy=b((()=>{Ny(),Uy(),(Ay=class{constructor(t){this._editor=t}serialize(...t){return new Oy(this._editor).serialize(...t)}deserialize(t){return new Ey(this._editor,t).deserialize()}}).version="2.0.0"})),Yy=b((()=>{Qf(),St(),iy(),dy(),sy(),Ny(),"undefined"!==typeof vf.Operations.SpriteOperation&&(jy=vf.Operations.SpriteOperation.BrushSprite.Brush),(Vy=class extends Ey{_deserializeSticker(t,e){const{SpriteOperation:i}=vf.Operations,{options:s}=e,r=this._stickerManager.getStickerByIdentifier(s.identifier);if(!r)return ut.warn("Deserializer",`Unknown sticker \`${s.identifier}\`. Skipping sprite.`),Promise.resolve();const{mediaBase:n}=r.images,o=Vf.getURLForSticker(r,"base"),a=n.rawData?n.uris[0]:this._editor.getUI().getAssetPath(o),l=t.getInputDimensions(!1);return ct.load(a).then((e=>{const n=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:o,flipHorizontally:a,flipVertically:h}=s,u={identifier:s.identifier,image:e,position:wf.fromObject(s.position),dimensions:wf.fromObject(s.dimensions).multiply(l.min()),rotation:o||0,flipHorizontally:a,flipVertically:h,resizeMode:r.resizeMode||"keepAspect",adjustments:{}};return"undefined"!==typeof s.adjustments&&["brightness","contrast","saturation"].forEach((t=>{"undefined"!==typeof s.adjustments[t]&&(u.adjustments[t]=s.adjustments[t]+n[t].default)})),"undefined"!==typeof s.tintMode&&"undefined"!==typeof s.tintColor?(u.tintColor=gf.fromArray(s.tintColor.rgba),u.tintMode=s.tintMode):"undefined"!==typeof s.tintColor&&"undefined"!==typeof r.tintMode&&(u.tintColor=gf.fromArray(s.tintColor.rgba),u.tintMode=r.tintMode),"undefined"!==typeof s.alpha&&(u.alpha=s.alpha),t.createSticker(u)}))}_deserializeTransformOperation(t){return super._deserializeTransformOperation(t).then((t=>{if(t)return t._ratio=null,t}))}_deserializeInputImage(){let{data:t,type:e,uri:i}=this._data.image;return t&&e&&(i=`data:${e};base64,${t}`),i?ct.load(i).then((t=>{this._editor.setImage(t)})):Promise.resolve()}_deserializeAdjustmentsOperation(t){const{AdjustmentsOperation:e}=vf.Operations;return super._deserializeAdjustmentsOperation(t).then((i=>{if(!i)return null;const{options:s}=t,r={};return["gamma","whites","blacks","temperature"].forEach((t=>{if("undefined"===typeof s[t])return;const{minValue:i,midValue:n,maxValue:o}=e.prototype.availableOptions[t];let a=s[t];a=a<0?n+(n-i)*a:n+(o-n)*a,r[t]=a})),i.set(r),i}))}_deserializeFocusOperation(t){const{options:e}=t.options;switch(t.options.type){case"radial":return super._deserializeFocusOperation(t);case"linear":{const{start:t,end:i,blurRadius:s}=e;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:wf.fromObject(t),controlPoint2:wf.fromObject(i),blurRadius:s}))}case"mirrored":{const{start:t,end:i,size:s,gradientSize:r,blurRadius:n}=e;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:wf.fromObject(t),end:wf.fromObject(i),size:s,gradientSize:r,blurRadius:n}))}case"gaussian":{const{blurRadius:t}=e;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:t}))}}}_deserializeText(t,e){const{options:i}=e,{fontSize:s,lineHeight:r,fontIdentifier:n,alignment:o,rotation:a,maxWidth:l,color:h,backgroundColor:u}=i,c=this._ui.getFontLoader();let d=this._fontManager.getVariationByIdentifier(n);return d?c.setFonts([d.getFont()]):d=this._fontManager.getDefaultVariation(),c.load().then((()=>{const e=t.getInputDimensions(!1),n=l*e.min()/e.x,c=t.createText({fontSize:s,lineHeight:r,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),textMetrics:d.getTextMetrics(),alignment:o,rotation:a,maxWidth:n,text:i.text,color:gf.fromArray(h.rgba),backgroundColor:gf.fromArray(u.rgba),position:wf.fromObject(i.position)});return c._edited=!0,c}))}_createBrushForPath(t){const{identifier:e,color:i,size:s,hardness:r}=t.brush,n={color:gf.fromArray(i.rgba),size:s};"undefined"!==typeof r&&(n.hardness=r);let o=this._brushManager.getBrushByIdentifier(e);if(o||(o=this._brushManager.getFirstBrush()),o.prototype&&o.prototype instanceof jy){return new o(n)}const a={...o};delete a.image;class l extends jy{}return l.identifier=o.identifier,new l({...a,...n})}_deserializeFrame(t,e){return super._deserializeFrame(t,e).then((()=>{const t=this._editor.operations.get("frame"),{size:i,alpha:s,tintColor:r}=e.options,n={};"undefined"!==typeof i&&(n.scale=i),"undefined"!==typeof s&&(n.alpha=s),"undefined"!==typeof r&&(n.tintColor=gf.fromArray(r.rgba)),t.set(n)}))}_deserializeTextDesign(t,e){const{options:i}=e,{position:s,rotation:r,flipHorizontally:n,flipVertically:o,text:a,color:l,width:h,seed:u,inverted:c}=i;let{identifier:d}=i;d===vf.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?d=vf.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:d===vf.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(d=vf.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);const _=new Ef(this._ui,this._getOptions("textdesign")),m=new Sf(this._ui,{fonts:rg.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:g}=t.constructor.TextDesignSprite,p=this._ui.getFontLoader(),f=new(_.getLayoutByIdentifier(d));return p.setFonts(m.getFonts()),g.setFonts({...g.getFonts(),...m.getVariationsByIdentifier()}),p.load().then((()=>{const e=f.getImagePaths().map((t=>({path:t,fullPath:this._ui.getAssetPath(t),image:null})));return g.loadImages(e).then((()=>(f.onImagesLoaded(),t.createTextDesign({position:s,rotation:r,flipHorizontally:n,flipVertically:o,text:a,color:gf.fromArray(l.rgba),width:h,seed:u,inverted:c,layout:f}))))}))}}).version="3.0.0"})),Jy=b((()=>{sf(),(Wy=class extends we{}).prototype.availableOptions={identifier:{type:l.STRING,required:!0},defaultName:{type:l.STRING,required:!0},ratio:{type:l.ALL,required:!1,default:null},selected:{type:l.BOOLEAN,required:!1},dimensions:{type:l.VECTOR2,required:!1},lockDimensions:{type:l.BOOLEAN,required:!1,default:null},forceDimensions:{type:l.BOOLEAN,required:!1,default:null}}})),Ky=b((()=>{Qf(),Jy(),Uy(),(Hy=class extends Oy{serialize(t={}){return super.serialize(t).then((t=>(t.meta={platform:"html5",version:this._editor.getSDK().version,createdAt:yf.ISODateString(new Date)},t.image=t.inputImage,delete t.inputImage,t)))}_serializeSticker(t,e){const i=super._serializeSticker(t,e);return i.options.alpha=e.getAlpha(),i.options.tintColor&&(i.options.tintColor={rgba:i.options.tintColor}),i}_serializeText(t,e){const i=super._serializeText(t,e);return i.options.color={rgba:i.options.color},i.options.backgroundColor={rgba:i.options.backgroundColor},i.options.flipHorizontally=!1,i.options.flipVertically=!1,delete i.options.fontWeight,i}_serializePath(t){const e=super._serializePath(t);delete e.hardness,delete e.size,delete e.color;const i=t.getBrush();e.brush=i.serializeOptions(["identifier","size","color"],!0),"undefined"===typeof e.brush.identifier&&delete e.brush.identifier,e.brush.color={rgba:e.brush.color};const s=i.getOption("hardness");return"undefined"!==s&&(e.brush.hardness=s),e}_serializeFrameOperation(t,e){super._serializeFrameOperation(t,e);const i=e.filter((t=>"sprite"===t.type));let s;if(i.length){s=i.pop();const e=s.options.sprites.filter((t=>"frame"===t.type))[0];t.getTintColor().equals(new gf(1,1,1,0))||(e.options.tintColor={rgba:t.serializeOption("tintColor",!0)});const r=t.serializeOptions(["scale","alpha"],!0);e.options={...e.options,...r},e.options.size=e.options.scale,delete e.options.scale}}_serializeTransformOperation(t){const e=super._serializeTransformOperation(t);if(t._ratio){let i;i=t._ratio instanceof Wy?t._ratio.getIdentifier():t._ratio.identifier,e.options.meta={identifier:i}}return delete e.options.scale,e}_serializeAdjustmentsOperation(t){const e=super._serializeAdjustmentsOperation(t),{availableOptions:i}=t,s={};return["gamma","whites","blacks","temperature"].forEach((e=>{const r=i[e],n=t.getOption(e),{minValue:o,midValue:a,maxValue:l}=r;s[e]=n<=a?(n-o)/(a-o)-1:(n-a)/(l-a)})),e.options={...e.options,...s},e}_serializeOperation(t,e){switch(t.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(t);case"linear-focus":return this._serializeLinearFocusOperation(t);case"blur":return this._serializeBlurOperation(t);default:return super._serializeOperation(t,e)}}_serializeMirroredFocusOperation(t){return{type:"focus",options:{type:"mirrored",options:t.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_serializeLinearFocusOperation(t){const e=t.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],!0);return e.start=e.controlPoint1,delete e.controlPoint1,e.end=e.controlPoint2,delete e.controlPoint2,{type:"focus",options:{type:"linear",options:e}}}_serializeBlurOperation(t){return{type:"focus",options:{type:"gaussian",options:t.serializeOptions(["blurRadius"],!0)}}}}).version="3.0.0"})),Zy={};w(Zy,{default:()=>qy});var Qy,$y,tx,ex=b((()=>{Yy(),Ky(),(qy=class{constructor(t){this._editor=t}serialize(...t){return new Hy(this._editor).serialize(...t)}deserialize(t){return new Vy(this._editor,t).deserialize()}}).version="3.0.0"})),ix=b((()=>{Qf(),iy(),sy(),Yy(),(Qy=class extends Vy{_deserializeTextDesign(t,e){const{options:i}=e,{position:s,rotation:r,flipHorizontally:n,flipVertically:o,text:a,color:l,width:h,seed:u,inverted:c}=i;let{identifier:d}=i;d===vf.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?d=vf.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:d===vf.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(d=vf.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);const _=new Ef(this._ui,this._getOptions("textdesign")),m=new Sf(this._ui,{fonts:rg.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:g}=t.constructor.TextDesignSprite,p=this._ui.getFontLoader(),f=new(_.getLayoutByIdentifier(d));return p.setFonts(m.getFonts()),g.setFonts({...g.getFonts(),...m.getVariationsByIdentifier()}),p.load().then((()=>{const e=f.getImagePaths().map((t=>({path:t,fullPath:this._ui.getAssetPath(t),image:null})));return g.loadImages(e).then((()=>(f.onImagesLoaded(),t.createTextDesign({position:s,rotation:r,flipHorizontally:n,flipVertically:o,text:a,color:gf.fromArray(l.rgba),width:h,seed:u,inverted:c,layout:f}))))}))}}).version="3.1.0"})),sx=b((()=>{Qf(),Ky(),($y=class extends Hy{_serializeTextDesign(t,e){const i=e.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted"],!0);i.color={rgba:i.color};const s=e.getLayout();return s&&(i.identifier=s.constructor.identifier),{type:"textdesign",options:i}}}).version="3.1.0"})),rx={};w(rx,{default:()=>tx});var nx,ox,ax,lx=b((()=>{ix(),sx(),(tx=class{constructor(t){this._editor=t}serialize(...t){return new $y(this._editor).serialize(...t)}deserialize(t){return new Qy(this._editor,t).deserialize()}}).version="3.1.0"})),hx=b((()=>{Qf(),iy(),sy(),ix(),(nx=class extends Qy{_deserializeTextDesign(t,e){const{options:i}=e,{position:s,rotation:r,flipHorizontally:n,flipVertically:o,text:a,color:l,width:h,seed:u,inverted:c}=i;let{identifier:d}=i;d===vf.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?d=vf.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:d===vf.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(d=vf.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);const _="padding"in i?i.padding/h:-1,m=new Ef(this._ui,this._getOptions("textdesign")),g=new Sf(this._ui,{fonts:rg.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:p}=t.constructor.TextDesignSprite,f=this._ui.getFontLoader(),y=new(m.getLayoutByIdentifier(d));return f.setFonts(g.getFonts()),p.setFonts({...p.getFonts(),...g.getVariationsByIdentifier()}),f.load().then((()=>{const e=y.getImagePaths().map((t=>({path:t,fullPath:this._ui.getAssetPath(t),image:null})));return p.loadImages(e).then((()=>(y.onImagesLoaded(),t.createTextDesign({position:s,rotation:r,flipHorizontally:n,flipVertically:o,text:a,color:gf.fromArray(l.rgba),width:h,seed:u,inverted:c,layout:y,padding:_}))))}))}}).version="3.2.0"})),ux=b((()=>{sx(),(ox=class extends $y{_serializeTextDesign(t,e){const i=e.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted","padding"],!0);i.color={rgba:i.color};const s=e.getLayout();return s&&(i.identifier=s.constructor.identifier),i.padding*=i.width,{type:"textdesign",options:i}}}).version="3.2.0"})),cx={};w(cx,{default:()=>ax});var dx,_x,mx,gx=b((()=>{hx(),ux(),(ax=class{constructor(t){this._editor=t}serialize(...t){return new ox(this._editor).serialize(...t)}deserialize(t){return new nx(this._editor,t).deserialize()}}).version="3.2.0"})),px=b((()=>{hx(),(dx=class extends nx{_deserializeOperation(t){return super._deserializeOperation(t)}_deserializeOrientationOperation(t){const{options:e}=t,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(e),Promise.resolve(i)):Promise.resolve()}}).version="3.4.0"})),fx=b((()=>{zy(),ux(),(_x=class extends ox{_serializeOperation(t,e){return"artfilter"===t.constructor.identifier?this._serializeStyle(t):super._serializeOperation(t,e)}_serializeOrientationOperation(t){return{type:"orientation",options:t.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeStyle(t){const{identifier:e,intensity:i,blendMode:s}=t.getOptions(),{tileEdgeLength:r,overlappingFactor:n}=t.getStyleTransferModel().getOptions();return{type:"artFilter",options:{identifier:e,intensity:i,blendMode:Fy[s],tileEdgeLength:r,overlappingFactor:n}}}}).version="3.4.0"})),yx={};w(yx,{default:()=>mx});var xx,bx,vx,wx=b((()=>{px(),fx(),(mx=class{constructor(t){this._editor=t}serialize(...t){return new _x(this._editor).serialize(...t)}deserialize(t){return new dx(this._editor,t).deserialize()}}).version="3.4.0"})),Dx=b((()=>{Qf(),iy(),sy(),px(),(xx=class extends dx{_deserializeTextDesign(t,e){const{options:i}=e,{position:s,rotation:r,flipHorizontally:n,flipVertically:o,text:a,color:l,width:h,seed:u,inverted:c,identifier:d}=i,_="padding"in i?i.padding/h:-1,m=new Ef(this._ui,this._getOptions("textdesign")),g=new Sf(this._ui,{fonts:rg.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:p}=t.constructor.TextDesignSprite,f=this._ui.getFontLoader(),y=new(m.getLayoutByIdentifier(d));return f.setFonts(g.getFonts()),p.setFonts({...p.getFonts(),...g.getVariationsByIdentifier()}),f.load().then((()=>{const e=y.getImagePaths().map((t=>({path:t,fullPath:this._ui.getAssetPath(t),image:null})));return p.loadImages(e).then((()=>(y.onImagesLoaded(),t.createTextDesign({position:s,rotation:r,flipHorizontally:n,flipVertically:o,text:a,color:gf.fromArray(l.rgba),width:h,seed:u,inverted:c,layout:y,padding:_}))))}))}}).version="3.5.0"})),kx=b((()=>{fx(),(bx=class extends _x{}).version="3.5.0"})),Tx={};w(Tx,{default:()=>vx});var Cx,Rx,Ix,Fx=b((()=>{Dx(),kx(),(vx=class{constructor(t){this._editor=t}serialize(...t){return new bx(this._editor).serialize(...t)}deserialize(t){return new xx(this._editor,t).deserialize()}}).version="3.5.0"})),Sx=b((()=>{Qf(),Dx(),(Cx=class extends xx{_deserializeAdjustmentsOperation(t){const{AdjustmentsOperation:e}=vf.Operations;return super._deserializeAdjustmentsOperation(t).then((i=>{if(!i)return null;const{options:s}=t,r="sharpness",n={};if("undefined"===typeof s[r])return;const{minValue:o,midValue:a,maxValue:l}=e.prototype.availableOptions[r];let h=s[r];return h=h<0?a+(a-o)*h:a+(l-a)*h,n[r]=h,i.set(n),i}))}}).version="3.6.0"})),Ex=b((()=>{kx(),(Rx=class extends bx{_serializeAdjustmentsOperation(t){const e=super._serializeAdjustmentsOperation(t),i="sharpness",{availableOptions:s}=t,r={},n=s[i],o=t.getOption(i),{minValue:a,midValue:l,maxValue:h}=n;return r[i]=o<=l?(o-a)/(l-a)-1:(o-l)/(h-l),e.options={...e.options,...r},e}}).version="3.6.0"})),Ox={};w(Ox,{default:()=>Ix});var Ax,Bx,Mx,Px=b((()=>{Sx(),Ex(),(Ix=class{constructor(t){this._editor=t}serialize(...t){return new Rx(this._editor).serialize(...t)}deserialize(t){return new Cx(this._editor,t).deserialize()}}).version="3.6.0"})),Lx=b((()=>{sf(),Sx(),(Ax=class extends Cx{deserialize(){return this._validateVersion().then((()=>this._deserializeAssetLibrary())).then((()=>this._deserializeInputImage())).then((()=>this._deserializeOperations()))}_deserializeAssetLibrary(){return new Promise(((t,e)=>{const i=this._data;if(!i.assetLibrary)return void t();const{assets:s}=i.assetLibrary,r=[];for(const n in s)r.push(this._deserializeCustomAssets(n,s[n]));return Promise.all(r).then((()=>{t()})).catch((t=>{console.error(t),e(t)}))}))}_deserializeCustomAssets(t,e){return"stickers"===t?this._deserializeCustomStickerAssets(e):Promise.reject(new Error(`Unknown asset type: ${t}`))}_deserializeCustomStickerAssets(t){let e="none";const i=this._editor.getOptions().editor;i&&i.controlsOptions&&i.controlsOptions.sticker&&(e=i.controlsOptions.sticker.customStickerTintMode||"none");const s=t.map((t=>new Promise(((i,s)=>{const{identifier:r,raster:n}=t,o=void 0!==t.svg;let a=`data:${n.type};base64,${n.data}`,l=new co;l.onload=()=>{const s=this._editor.getSDK();l=s.correctExifOrientation(l),l.toDataURL&&(a=l.toDataURL());let n={data:"",width:1,height:1};n=this._stickerManager.renderStickerThumbnailFromImage(l);const h={identifier:r,defaultName:t.name||"",tintMode:e,images:{mediaBase:{uris:[a],rawData:!0,isSVG:o,width:l.width,height:l.height},mediaThumb:{uris:[n.data],rawData:!0,width:n.width,height:n.height}}};if(o){const e=`data:image/svg+xml;base64,${t.svg.data}`;h.images.mediaBase.uris.push(e)}i(h)},l.onerror=()=>{s(new Error(`Invalid base64 data: ${a}`))},l.src=a}))));return Promise.all(s).then((t=>{this._editor.getDynamicAssetsLibrary().setAssets("sticker",t),this._stickerManager.reload()}))}}).version="3.7.0"})),zx=b((()=>{Ex(),(Bx=class extends Rx{serialize(t={}){return super.serialize(t).then((t=>this._serializeAssetLibrary(t).then((t=>t))))}_serializeAssetLibrary(t){if(!this._editor.getDynamicAssetsLibrary)return Promise.resolve(t);const e=this._editor.getDynamicAssetsLibrary(),i=this._serializeCustomStickerAssets(t,e);return 0===i.length||(t.assetLibrary={assets:{stickers:i}}),Promise.resolve(t)}_serializeCustomStickerAssets(t,e){const i=e.getAssets("sticker");if(0===i.length)return[];const s=t.operations.filter((t=>"sprite"===t.type)).flatMap((t=>t.options.sprites)).filter((t=>"sticker"===t.type)).map((t=>t.options.identifier)),r={};s.forEach((t=>{r[t]=!0}));return i.filter((t=>r[t.identifier])).map((t=>{const{identifier:e,defaultName:i,images:s}=t,r=s.mediaBase.uris[0],{isSVG:n}=s.mediaBase,o=/^data:(image\/(jpeg|png));base64,(.*)$/g.exec(r),a={identifier:e,name:i,raster:{type:o[1],data:o[3]}};return i&&(a.name=i),n&&(a.svg={data:s.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}),a}))}}).version="3.7.0"})),Nx={};w(Nx,{default:()=>Mx});var Ux,Gx,jx,Vx=b((()=>{Lx(),zx(),(Mx=class{constructor(t){this._editor=t}serialize(...t){return new Bx(this._editor).serialize(...t)}deserialize(t){return new Ax(this._editor,t).deserialize()}}).version="3.7.0"})),Wx=b((()=>{Lx(),(Ux=class extends Ax{}).version="3.8.0"})),Hx=b((()=>{zx(),(Gx=class extends Bx{_serializeSticker(t,e){const i=super._serializeSticker(t,e);return i.options.tintMode=e.getTintMode(),i}}).version="3.8.0"})),qx={};w(qx,{default:()=>jx});var Xx,Yx,Jx,Kx,Zx=b((()=>{Wx(),Hx(),(jx=class{constructor(t){this._editor=t}serialize(...t){return new Gx(this._editor).serialize(...t)}deserialize(t){return new Ux(this._editor,t).deserialize()}}).version="3.8.0"})),Qx=b((()=>{Qf(),Wx(),(Xx=class extends Ux{_deserializeTransformOperation(t){return super._deserializeCropOperation(t).then((t=>{if(!t)return;const e=yf.Array.find(this._data.operations,(t=>"orientation"===t.type));if(e){const{options:i}=e;t.rotate(i.rotation),i.flipHorizontally&&(t.flip("horizontal"),t.setRotation(-1*t.getRotation())),i.flipVertically&&(t.flip("vertical"),t.setRotation(-1*t.getRotation()))}return t._ratio=null,t}))}_deserializeText(t,e){const{options:i}=e,{fontSize:s,lineHeight:r,fontIdentifier:n,alignment:o,rotation:a,maxWidth:l,color:h,backgroundColor:u}=i,c=this._ui.getFontLoader();let d=this._fontManager.getVariationByIdentifier(n);return d?c.setFonts([d.getFont()]):d=this._fontManager.getDefaultVariation(),c.load().then((()=>{const e=t.getInputDimensions(!1),n=e.min(),c=e.x,_=e.y,m=l*n/c,g=s*n/_,p=t.createText({fontSize:g,lineHeight:r,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),textMetrics:d.getTextMetrics(),alignment:o,rotation:a,maxWidth:m,text:i.text,color:gf.fromArray(h.rgba),backgroundColor:gf.fromArray(u.rgba),position:wf.fromObject(i.position)});return p._edited=!0,p}))}}).version="3.9.0"})),$x=b((()=>{Jy(),Hx(),Yx=2*Math.PI,(Jx=class extends Gx{_serializeTransformOperation(t){const{operations:e}=this._editor;if(e.exists("orientation")){t=t.clone();const i=e.get("orientation");i.getFlipVertically()&&(t.flip("vertical"),t.setRotation(-1*t.getRotation())),i.getFlipHorizontally()&&(t.flip("horizontal"),t.setRotation(-1*t.getRotation())),t.rotate(-i.getRotation())}const i=t.serializeOptions(["start","end","rotation","textureScale"],!0);i.rotation=(i.rotation+Yx)%Yx,1!==i.textureScale&&(i.dimensions=t.getNewDimensions(t.getInputDimensions(!1))),delete i.textureScale;const s={type:"transform",options:i};if(t._ratio){let e;e=t._ratio instanceof Wy?t._ratio.getIdentifier():t._ratio.identifier,s.options.meta={identifier:e}}return delete s.options.scale,s}_serializeText(t,e){const i=t.getInputDimensions(!1),s=super._serializeText(t,e);return s.options.fontSize=s.options.fontSize*i.y/i.min(),s}}).version="3.9.0"})),tb={};w(tb,{default:()=>Kx});var eb,ib,sb,rb=b((()=>{Qx(),$x(),(Kx=class{constructor(t){this._editor=t}serialize(...t){return new Jx(this._editor).serialize(...t)}deserialize(t){return new Xx(this._editor,t).deserialize()}}).version="3.9.0"})),nb=b((()=>{Qx(),(eb=class extends Xx{}).version="3.12.0"})),ob=b((()=>{$x(),(ib=class extends Jx{_serializeCustomStickerAssets(t,e){const i=e.getAssets("sticker");if(0===i.length)return[];const s=t.operations.filter((t=>"sprite"===t.type)).flatMap((t=>t.options.sprites)).filter((t=>"sticker"===t.type)).map((t=>t.options.identifier)),r={};s.forEach((t=>{r[t]=!0}));return i.filter((t=>r[t.identifier])).map((t=>{const{identifier:e,defaultName:i,images:s}=t,r=s.mediaBase.uris[0],{isSVG:n}=s.mediaBase,o=/^data:(image\/(jpeg|png|gif));base64,(.*)$/g.exec(r),a={identifier:e,name:i,raster:{type:o[1],data:o[3]}};return i&&(a.name=i),n&&(a.svg={data:s.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}),a}))}}).version="3.12.0"})),ab={};w(ab,{default:()=>sb});var lb=b((()=>{nb(),ob(),(sb=class{constructor(t){this._editor=t}serialize(...t){return new ib(this._editor).serialize(...t)}deserialize(t){return new eb(this._editor,t).deserialize()}}).version="3.12.0"})),hb=[];Object.freeze(hb);var ub={};Object.freeze(ub);var cb={};function db(){return"undefined"!==typeof window?window:"undefined"!==typeof i.g?i.g:"undefined"!==typeof self?self:cb}function _b(){return++jv.mobxGuid}function mb(t){throw gb(!1,t),"X"}function gb(t,e){if(!t)throw new Error("[mobx] "+(e||"An invariant failed, however the error is obfuscated because this is an production build."))}function pb(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}var fb=function(){};function yb(t){return null!==t&&"object"===typeof t}function xb(t){if(null===t||"object"!==typeof t)return!1;var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}function bb(t,e,i){Object.defineProperty(t,e,{enumerable:!1,writable:!0,configurable:!0,value:i})}function vb(t,e,i){Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!0,value:i})}function wb(t,e){var i="isMobX"+t;return e.prototype[i]=!0,function(t){return yb(t)&&!0===t[i]}}function Db(t){return void 0!==db().Map&&t instanceof db().Map}function kb(t){return t instanceof Set}function Tb(t){for(var e=[];;){var i=t.next();if(i.done)break;e.push(i.value)}return e}function Cb(){return"function"===typeof Symbol&&Symbol.toPrimitive||"@@toPrimitive"}function Rb(t){return null===t?null:"object"===typeof t?""+t:t}function Ib(t,e){for(var i=t.next();!i.done;)e(i.value),i=t.next()}function Fb(){return"function"===typeof Symbol&&Symbol.iterator||"@@iterator"}function Sb(t,e){vb(t,Fb(),e)}function Eb(t){return t[Fb()]=Ab,t}function Ob(){return"function"===typeof Symbol&&Symbol.toStringTag||"@@toStringTag"}function Ab(){return this}var Bb=function(){function t(t){void 0===t&&(t="Atom@"+_b()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=hv.NOT_TRACKING}return t.prototype.onBecomeUnobserved=function(){},t.prototype.onBecomeObserved=function(){},t.prototype.reportObserved=function(){return Yv(this)},t.prototype.reportChanged=function(){qv(),function(t){if(t.lowestObserverState===hv.STALE)return;t.lowestObserverState=hv.STALE;var e=t.observers,i=e.length;for(;i--;){var s=e[i];s.dependenciesState===hv.UP_TO_DATE&&(s.isTracing!==cv.NONE&&Jv(s,t),s.onBecomeStale()),s.dependenciesState=hv.STALE}}(this),Xv()},t.prototype.toString=function(){return this.name},t}(),Mb=wb("Atom",Bb);function Pb(t,e,i){void 0===e&&(e=fb),void 0===i&&(i=fb);var s=new Bb(t);return function(t,e,i){pw("onBecomeObserved",t,e,i)}(s,e),gw(s,i),s}function Lb(t,e){return t===e}var zb={identity:Lb,structural:function(t,e){return hD(t,e)},default:function(t,e){return function(t,e){return"number"===typeof t&&"number"===typeof e&&isNaN(t)&&isNaN(e)}(t,e)||Lb(t,e)},shallow:function(t,e){return hD(t,e,1)}},Nb=function(t,e){return(Nb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function Ub(t,e){function i(){this.constructor=t}Nb(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Gb=function(){return Gb=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Gb.apply(this,arguments)};function jb(t,e){var i="function"===typeof Symbol&&t[Symbol.iterator];if(!i)return t;var s,r,n=i.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(s=n.next()).done;)o.push(s.value)}catch(jD){r={error:jD}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}return o}function Vb(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(jb(arguments[e]));return t}var Wb={},Hb={};function qb(t,e){var i=e?Wb:Hb;return i[t]||(i[t]={configurable:!0,enumerable:e,get:function(){return Xb(this),this[t]},set:function(e){Xb(this),this[t]=e}})}function Xb(t){if(!0!==t.__mobxDidRunLazyInitializers){var e=t.__mobxDecorators;if(e)for(var i in bb(t,"__mobxDidRunLazyInitializers",!0),e){var s=e[i];s.propertyCreator(t,s.prop,s.descriptor,s.decoratorTarget,s.decoratorArguments)}}}function Yb(t,e){return function(){var i,s=function(s,r,n,o){if(!0===o)return e(s,r,n,s,i),null;if(!Object.prototype.hasOwnProperty.call(s,"__mobxDecorators")){var a=s.__mobxDecorators;bb(s,"__mobxDecorators",Gb({},a))}return s.__mobxDecorators[r]={prop:r,propertyCreator:e,descriptor:n,decoratorTarget:s,decoratorArguments:i},qb(r,t)};return Jb(arguments)?(i=hb,s.apply(null,arguments)):(i=Array.prototype.slice.call(arguments),s)}}function Jb(t){return(2===t.length||3===t.length)&&"string"===typeof t[1]||4===t.length&&!0===t[3]}function Kb(t,e,i){return ww(t)?t:Array.isArray(t)?av.array(t,{name:i}):xb(t)?av.object(t,void 0,{name:i}):Db(t)?av.map(t,{name:i}):kb(t)?av.set(t,{name:i}):t}function Zb(t){return t}function Qb(t){gb(t);var e=Yb(!0,(function(e,i,s,r,n){(function(t,e,i,s){var r=tD(t);if(Fw(r)){var n=Ew(r,{object:t,name:e,type:"add",newValue:i});if(!n)return;i=n.newValue}var o=r.values[e]=new Mv(i,s,r.name+"."+e,!1);i=o.value,Object.defineProperty(t,e,function(t){return eD[t]||(eD[t]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.read(this,t)},set:function(e){this.$mobx.write(this,t,e)}})}(e)),r.keys&&r.keys.push(e);!function(t,e,i,s){var r=Ow(t),n=iw(),o=r||n?{type:"add",object:e,name:i,newValue:s}:null;n&&rw(Gb(Gb({},o),{name:t.name,key:i}));r&&Bw(t,o);n&&ow()}(r,t,e,i)})(e,i,s?s.initializer?s.initializer.call(e):s.value:void 0,t)})),i=("undefined"!==typeof d&&d.env,e);return i.enhancer=t,i}var $b={deep:!0,name:void 0,defaultDecorator:void 0};function tv(t){return null===t||void 0===t?$b:"string"===typeof t?{name:t,deep:!0}:t}function ev(t){return t.defaultDecorator?t.defaultDecorator.enhancer:!1===t.deep?Zb:Kb}Object.freeze($b),Object.freeze({deep:!1,name:void 0,defaultDecorator:void 0});var iv=Qb(Kb),sv=Qb((function(t,e,i){return void 0===t||null===t||nD(t)||Hw(t)||Jw(t)||Qw(t)?t:Array.isArray(t)?av.array(t,{name:i,deep:!1}):xb(t)?av.object(t,void 0,{name:i,deep:!1}):Db(t)?av.map(t,{name:i,deep:!1}):kb(t)?av.set(t,{name:i,deep:!1}):mb(!1)})),rv=Qb(Zb),nv=Qb((function(t,e,i){return hD(t,e)?e:t}));var ov={box:function(t,e){arguments.length>2&&lv("box");var i=tv(e);return new Mv(t,ev(i),i.name,!0,i.equals)},shallowBox:function(t,e){return arguments.length>2&&lv("shallowBox"),av.box(t,{name:e,deep:!1})},array:function(t,e){arguments.length>2&&lv("array");var i=tv(e);return new Nw(t,ev(i),i.name)},shallowArray:function(t,e){return arguments.length>2&&lv("shallowArray"),av.array(t,{name:e,deep:!1})},map:function(t,e){arguments.length>2&&lv("map");var i=tv(e);return new Xw(t,ev(i),i.name)},shallowMap:function(t,e){return arguments.length>2&&lv("shallowMap"),av.map(t,{name:e,deep:!1})},set:function(t,e){arguments.length>2&&lv("set");var i=tv(e);return new Zw(t,ev(i),i.name)},object:function(t,e,i){"string"===typeof arguments[1]&&lv("object");var s=tv(i);return yw({},t,e,s)},shallowObject:function(t,e){return"string"===typeof arguments[1]&&lv("shallowObject"),av.object(t,{},{name:e,deep:!1})},ref:rv,shallow:sv,deep:iv,struct:nv},av=function(t,e,i){if("string"===typeof arguments[1])return iv.apply(null,arguments);if(ww(t))return t;var s=xb(t)?av.object(t,e,i):Array.isArray(t)?av.array(t,e):Db(t)?av.map(t,e):kb(t)?av.set(t,e):t;if(s!==t)return s;mb(!1)};function lv(t){mb("Expected one or two arguments to observable."+t+". Did you accidentally try to use observable."+t+" as decorator?")}Object.keys(ov).forEach((function(t){return av[t]=ov[t]}));var hv,uv,cv,dv=Yb(!1,(function(t,e,i,s,r){var n=i.get,o=i.set,a=r[0]||{};!function(t,e,i){var s=tD(t);i.name=s.name+"."+e,i.context=t,s.values[e]=new Lv(i),Object.defineProperty(t,e,function(t){return iD[t]||(iD[t]={configurable:jv.computedConfigurable,enumerable:!1,get:function(){return sD(this).read(this,t)},set:function(e){sD(this).write(this,t,e)}})}(e))}(t,e,Gb({get:n,set:o},a))})),_v=dv({equals:zb.structural}),mv=function(t,e,i){if("string"===typeof e)return dv.apply(null,arguments);if(null!==t&&"object"===typeof t&&1===arguments.length)return dv.apply(null,arguments);var s="object"===typeof e?e:{};return s.get=t,s.set="function"===typeof e?e:s.set,s.name=s.name||t.name||"",new Lv(s)};mv.struct=_v,(uv=hv||(hv={}))[uv.NOT_TRACKING=-1]="NOT_TRACKING",uv[uv.UP_TO_DATE=0]="UP_TO_DATE",uv[uv.POSSIBLY_STALE=1]="POSSIBLY_STALE",uv[uv.STALE=2]="STALE",function(t){t[t.NONE=0]="NONE",t[t.LOG=1]="LOG",t[t.BREAK=2]="BREAK"}(cv||(cv={}));var gv=function(t){this.cause=t};function pv(t){return t instanceof gv}function fv(t){switch(t.dependenciesState){case hv.UP_TO_DATE:return!1;case hv.NOT_TRACKING:case hv.STALE:return!0;case hv.POSSIBLY_STALE:for(var e=kv(!0),i=wv(),s=t.observing,r=s.length,n=0;n<r;n++){var o=s[n];if(zv(o)){if(jv.disableErrorBoundaries)o.get();else try{o.get()}catch(jD){return Dv(i),Tv(e),!0}if(t.dependenciesState===hv.STALE)return Dv(i),Tv(e),!0}}return Cv(t),Dv(i),Tv(e),!1}}function yv(t){var e=t.observers.length>0;jv.computationDepth>0&&e&&mb(!1),jv.allowStateChanges||!e&&"strict"!==jv.enforceActions||mb(!1)}function xv(t,e,i){var s=kv(!0);Cv(t),t.newObserving=new Array(t.observing.length+100),t.unboundDepsCount=0,t.runId=++jv.runId;var r,n=jv.trackingDerivation;if(jv.trackingDerivation=t,!0===jv.disableErrorBoundaries)r=e.call(i);else try{r=e.call(i)}catch(rk){r=new gv(rk)}return jv.trackingDerivation=n,function(t){for(var e=t.observing,i=t.observing=t.newObserving,s=hv.UP_TO_DATE,r=0,n=t.unboundDepsCount,o=0;o<n;o++){0===(a=i[o]).diffValue&&(a.diffValue=1,r!==o&&(i[r]=a),r++),a.dependenciesState>s&&(s=a.dependenciesState)}i.length=r,t.newObserving=null,n=e.length;for(;n--;){0===(a=e[n]).diffValue&&Wv(a,t),a.diffValue=0}for(;r--;){var a;1===(a=i[r]).diffValue&&(a.diffValue=0,Vv(a,t))}s!==hv.UP_TO_DATE&&(t.dependenciesState=s,t.onBecomeStale())}(t),t.observing.length,Tv(s),r}function bv(t){var e=t.observing;t.observing=[];for(var i=e.length;i--;)Wv(e[i],t);t.dependenciesState=hv.NOT_TRACKING}function vv(t){var e=wv(),i=t();return Dv(e),i}function wv(){var t=jv.trackingDerivation;return jv.trackingDerivation=null,t}function Dv(t){jv.trackingDerivation=t}function kv(t){var e=jv.allowStateReads;return jv.allowStateReads=t,e}function Tv(t){jv.allowStateReads=t}function Cv(t){if(t.dependenciesState!==hv.UP_TO_DATE){t.dependenciesState=hv.UP_TO_DATE;for(var e=t.observing,i=e.length;i--;)e[i].lowestObserverState=hv.UP_TO_DATE}}var Rv=0,Iv=1,Fv=Object.getOwnPropertyDescriptor((function(){}),"name");Fv&&Fv.configurable;function Sv(t,e){var i=function(){return Ev(t,e,this,arguments)};return i.isMobxAction=!0,i}function Ev(t,e,i,s){var r=function(t,e,i){var s=iw()&&!!t,r=0;if(s){r=Date.now();var n=i&&i.length||0,o=new Array(n);if(n>0)for(var a=0;a<n;a++)o[a]=i[a];rw({type:"action",name:t,object:e,arguments:o})}var l=wv();qv();var h=Av(!0),u=kv(!0),c={prevDerivation:l,prevAllowStateChanges:h,prevAllowStateReads:u,notifySpy:s,startTime:r,actionId:Iv++,parentActionId:Rv};return Rv=c.actionId,c}(t,i,s);try{return e.apply(i,s)}catch(TD){throw r.error=TD,TD}finally{!function(t){Rv!==t.actionId&&mb("invalid action stack. did you forget to finish an action?");Rv=t.parentActionId,void 0!==t.error&&(jv.suppressReactionErrors=!0);Bv(t.prevAllowStateChanges),Tv(t.prevAllowStateReads),Xv(),Dv(t.prevDerivation),t.notifySpy&&ow({time:Date.now()-t.startTime});jv.suppressReactionErrors=!1}(r)}}function Ov(t,e){var i,s=Av(t);try{i=e()}finally{Bv(s)}return i}function Av(t){var e=jv.allowStateChanges;return jv.allowStateChanges=t,e}function Bv(t){jv.allowStateChanges=t}var Mv=function(t){function e(e,i,s,r,n){void 0===s&&(s="ObservableValue@"+_b()),void 0===r&&(r=!0),void 0===n&&(n=zb.default);var o=t.call(this,s)||this;return o.enhancer=i,o.name=s,o.equals=n,o.hasUnreportedChange=!1,o.value=i(e,void 0,s),r&&iw()&&sw({type:"create",name:o.name,newValue:""+o.value}),o}return Ub(e,t),e.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},e.prototype.set=function(t){var e=this.value;if((t=this.prepareNewValue(t))!==jv.UNCHANGED){var i=iw();i&&rw({type:"update",name:this.name,newValue:t,oldValue:e}),this.setNewValue(t),i&&ow()}},e.prototype.prepareNewValue=function(t){if(yv(this),Fw(this)){var e=Ew(this,{object:this,type:"update",newValue:t});if(!e)return jv.UNCHANGED;t=e.newValue}return t=this.enhancer(t,this.value,this.name),this.equals(this.value,t)?jv.UNCHANGED:t},e.prototype.setNewValue=function(t){var e=this.value;this.value=t,this.reportChanged(),Ow(this)&&Bw(this,{type:"update",object:this,newValue:t,oldValue:e})},e.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},e.prototype.intercept=function(t){return Sw(this,t)},e.prototype.observe=function(t,e){return e&&t({object:this,type:"update",newValue:this.value,oldValue:void 0}),Aw(this,t)},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.value+"]"},e.prototype.valueOf=function(){return Rb(this.get())},e}(Bb);Mv.prototype[Cb()]=Mv.prototype.valueOf;var Pv=wb("ObservableValue",Mv),Lv=function(){function t(t){this.dependenciesState=hv.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=hv.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+_b(),this.value=new gv(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=cv.NONE,gb(t.get,"missing option for computed: get"),this.derivation=t.get,this.name=t.name||"ComputedValue@"+_b(),t.set&&(this.setter=Sv(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?zb.structural:zb.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return t.prototype.onBecomeStale=function(){!function(t){if(t.lowestObserverState!==hv.UP_TO_DATE)return;t.lowestObserverState=hv.POSSIBLY_STALE;var e=t.observers,i=e.length;for(;i--;){var s=e[i];s.dependenciesState===hv.UP_TO_DATE&&(s.dependenciesState=hv.POSSIBLY_STALE,s.isTracing!==cv.NONE&&Jv(s,t),s.onBecomeStale())}}(this)},t.prototype.onBecomeUnobserved=function(){},t.prototype.onBecomeObserved=function(){},t.prototype.get=function(){this.isComputing&&mb("Cycle detected in computation "+this.name+": "+this.derivation),0!==jv.inBatch||0!==this.observers.length||this.keepAlive?(Yv(this),fv(this)&&this.trackAndCompute()&&function(t){if(t.lowestObserverState===hv.STALE)return;t.lowestObserverState=hv.STALE;var e=t.observers,i=e.length;for(;i--;){var s=e[i];s.dependenciesState===hv.POSSIBLY_STALE?s.dependenciesState=hv.STALE:s.dependenciesState===hv.UP_TO_DATE&&(t.lowestObserverState=hv.UP_TO_DATE)}}(this)):fv(this)&&(this.warnAboutUntrackedRead(),qv(),this.value=this.computeValue(!1),Xv());var t=this.value;if(pv(t))throw t.cause;return t},t.prototype.peek=function(){var t=this.computeValue(!1);if(pv(t))throw t.cause;return t},t.prototype.set=function(t){if(this.setter){gb(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else gb(!1,!1)},t.prototype.trackAndCompute=function(){iw()&&sw({object:this.scope,type:"compute",name:this.name});var t=this.value,e=this.dependenciesState===hv.NOT_TRACKING,i=this.computeValue(!0),s=e||pv(t)||pv(i)||!this.equals(t,i);return s&&(this.value=i),s},t.prototype.computeValue=function(t){var e;if(this.isComputing=!0,jv.computationDepth++,t)e=xv(this,this.derivation,this.scope);else if(!0===jv.disableErrorBoundaries)e=this.derivation.call(this.scope);else try{e=this.derivation.call(this.scope)}catch(bD){e=new gv(bD)}return jv.computationDepth--,this.isComputing=!1,e},t.prototype.suspend=function(){this.keepAlive||(bv(this),this.value=void 0)},t.prototype.observe=function(t,e){var i=this,s=!0,r=void 0;return function(t,e){void 0===e&&(e=ub);0;var i,s=e&&e.name||t.name||"Autorun@"+_b();if(e.scheduler||e.delay){var r=function(t){return t.scheduler?t.scheduler:t.delay?function(e){return setTimeout(e,t.delay)}:mw}(e),n=!1;i=new Zv(s,(function(){n||(n=!0,r((function(){n=!1,i.isDisposed||i.track(o)})))}),e.onError,e.requiresObservable)}else i=new Zv(s,(function(){this.track(o)}),e.onError,e.requiresObservable);function o(){t(i)}return i.schedule(),i.getDisposer()}((function(){var n=i.get();if(!s||e){var o=wv();t({type:"update",object:i,newValue:n,oldValue:r}),Dv(o)}s=!1,r=n}))},t.prototype.warnAboutUntrackedRead=function(){},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},t.prototype.valueOf=function(){return Rb(this.get())},t}();Lv.prototype[Cb()]=Lv.prototype.valueOf;var zv=wb("ComputedValue",Lv),Nv=function(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1},Uv=!0,Gv=!1,jv=function(){var t=db();return t.__mobxInstanceCount>0&&!t.__mobxGlobals&&(Uv=!1),t.__mobxGlobals&&t.__mobxGlobals.version!==(new Nv).version&&(Uv=!1),Uv?t.__mobxGlobals?(t.__mobxInstanceCount+=1,t.__mobxGlobals.UNCHANGED||(t.__mobxGlobals.UNCHANGED={}),t.__mobxGlobals):(t.__mobxInstanceCount=1,t.__mobxGlobals=new Nv):(setTimeout((function(){Gv||mb("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")}),1),new Nv)}();function Vv(t,e){var i=t.observers.length;i&&(t.observersIndexes[e.__mapid]=i),t.observers[i]=e,t.lowestObserverState>e.dependenciesState&&(t.lowestObserverState=e.dependenciesState)}function Wv(t,e){if(1===t.observers.length)t.observers.length=0,Hv(t);else{var i=t.observers,s=t.observersIndexes,r=i.pop();if(r!==e){var n=s[e.__mapid]||0;n?s[r.__mapid]=n:delete s[r.__mapid],i[n]=r}delete s[e.__mapid]}}function Hv(t){!1===t.isPendingUnobservation&&(t.isPendingUnobservation=!0,jv.pendingUnobservations.push(t))}function qv(){jv.inBatch++}function Xv(){if(0===--jv.inBatch){$v();for(var t=jv.pendingUnobservations,e=0;e<t.length;e++){var i=t[e];i.isPendingUnobservation=!1,0===i.observers.length&&(i.isBeingObserved&&(i.isBeingObserved=!1,i.onBecomeUnobserved()),i instanceof Lv&&i.suspend())}jv.pendingUnobservations=[]}}function Yv(t){var e=jv.trackingDerivation;return null!==e?(e.runId!==t.lastAccessedBy&&(t.lastAccessedBy=e.runId,e.newObserving[e.unboundDepsCount++]=t,t.isBeingObserved||(t.isBeingObserved=!0,t.onBecomeObserved())),!0):(0===t.observers.length&&jv.inBatch>0&&Hv(t),!1)}function Jv(t,e){if(console.log("[mobx.trace] '"+t.name+"' is invalidated due to a change in: '"+e.name+"'"),t.isTracing===cv.BREAK){var i=[];Kv(xw(t),i,1),new Function("debugger;\n/*\nTracing '"+t.name+"'\n\nYou are entering this break point because derivation '"+t.name+"' is being traced and '"+e.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(t instanceof Lv?t.derivation.toString().replace(/[*]\//g,"/"):"")+"\n\nThe dependencies for this derivation are:\n\n"+i.join("\n")+"\n*/\n    ")()}}function Kv(t,e,i){e.length>=1e3?e.push("(and many more)"):(e.push(""+new Array(i).join("\t")+t.name),t.dependencies&&t.dependencies.forEach((function(t){return Kv(t,e,i+1)})))}var Zv=function(){function t(t,e,i,s){void 0===t&&(t="Reaction@"+_b()),void 0===s&&(s=!1),this.name=t,this.onInvalidate=e,this.errorHandler=i,this.requiresObservable=s,this.observing=[],this.newObserving=[],this.dependenciesState=hv.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+_b(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=cv.NONE}return t.prototype.onBecomeStale=function(){this.schedule()},t.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,jv.pendingReactions.push(this),$v())},t.prototype.isScheduled=function(){return this._isScheduled},t.prototype.runReaction=function(){if(!this.isDisposed){if(qv(),this._isScheduled=!1,fv(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&iw()&&sw({name:this.name,type:"scheduled-reaction"})}catch(t){this.reportExceptionInDerivation(t)}}Xv()}},t.prototype.track=function(t){qv();var e,i=iw();i&&(e=Date.now(),rw({name:this.name,type:"reaction"})),this._isRunning=!0;var s=xv(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&bv(this),pv(s)&&this.reportExceptionInDerivation(s.cause),i&&ow({time:Date.now()-e}),Xv()},t.prototype.reportExceptionInDerivation=function(t){var e=this;if(this.errorHandler)this.errorHandler(t,this);else{if(jv.disableErrorBoundaries)throw t;var i="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";jv.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(i,t),iw()&&sw({type:"error",name:this.name,message:i,error:""+t}),jv.globalReactionErrorHandlers.forEach((function(i){return i(t,e)}))}},t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(qv(),bv(this),Xv()))},t.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t.$mobx=this,t},t.prototype.toString=function(){return"Reaction["+this.name+"]"},t.prototype.trace=function(t){void 0===t&&(t=!1),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=!1;"boolean"===typeof t[t.length-1]&&(i=t.pop());var s=Rw(t);if(!s)return mb(!1);s.isTracing===cv.NONE&&console.log("[mobx.trace] '"+s.name+"' tracing enabled");s.isTracing=i?cv.BREAK:cv.LOG}(this,t)},t}(),Qv=function(t){return t()};function $v(){jv.inBatch>0||jv.isRunningReactions||Qv(tw)}function tw(){jv.isRunningReactions=!0;for(var t=jv.pendingReactions,e=0;t.length>0;){100===++e&&(console.error("Reaction doesn't converge to a stable state after 100 iterations. Probably there is a cycle in the reactive function: "+t[0]),t.splice(0));for(var i=t.splice(0),s=0,r=i.length;s<r;s++)i[s].runReaction()}jv.isRunningReactions=!1}var ew=wb("Reaction",Zv);function iw(){return!!jv.spyListeners.length}function sw(t){if(jv.spyListeners.length)for(var e=jv.spyListeners,i=0,s=e.length;i<s;i++)e[i](t)}function rw(t){sw(Gb(Gb({},t),{spyReportStart:!0}))}var nw={spyReportEnd:!0};function ow(t){sw(t?Gb(Gb({},t),{spyReportEnd:!0}):nw)}function aw(t){return jv.spyListeners.push(t),pb((function(){jv.spyListeners=jv.spyListeners.filter((function(e){return e!==t}))}))}function lw(){mb(!1)}function hw(t){return function(e,i,s){if(s){if(s.value)return{value:Sv(t,s.value),enumerable:!1,configurable:!0,writable:!0};var r=s.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return Sv(t,r.call(this))}}}return uw(t).apply(this,arguments)}}function uw(t){return function(e,i,s){Object.defineProperty(e,i,{configurable:!0,enumerable:!1,get:function(){},set:function(e){bb(this,i,cw(t,e))}})}}var cw=function(t,e,i,s){return 1===arguments.length&&"function"===typeof t?Sv(t.name||"<unnamed action>",t):2===arguments.length&&"function"===typeof e?Sv(t,e):1===arguments.length&&"string"===typeof t?hw(t):!0!==s?hw(e).apply(null,arguments):void(t[e]=Sv(t.name||e,i.value))};function dw(t,e){return Ev("string"===typeof t?t:t.name||"<unnamed action>","function"===typeof t?t:e,this,void 0)}function _w(t,e,i){bb(t,e,Sv(e,i.bind(t)))}cw.bound=function(t,e,i,s){return!0===s?(_w(t,e,i.value),null):i?{configurable:!0,enumerable:!1,get:function(){return _w(this,e,i.value||i.initializer.call(this)),this[e]},set:lw}:{enumerable:!1,configurable:!0,set:function(t){_w(this,e,t)},get:function(){}}};var mw=function(t){return t()};function gw(t,e,i){return pw("onBecomeUnobserved",t,e,i)}function pw(t,e,i,s){var r="function"===typeof s?oD(e,i):oD(e),n="function"===typeof s?s:i,o=r[t];return"function"!==typeof o?mb(!1):(r[t]=function(){o.call(this),n.call(this)},function(){r[t]=o})}function fw(t){var e=t.enforceActions,i=t.computedRequiresReaction,s=t.computedConfigurable,r=t.disableErrorBoundaries,n=t.arrayBuffer,o=t.reactionScheduler,a=t.reactionRequiresObservable,l=t.observableRequiresReaction;if(!0===t.isolateGlobalState&&((jv.pendingReactions.length||jv.inBatch||jv.isRunningReactions)&&mb("isolateGlobalState should be called before MobX is running any reactions"),Gv=!0,Uv&&(0===--db().__mobxInstanceCount&&(db().__mobxGlobals=void 0),jv=new Nv)),void 0!==e){var h=void 0;switch(e){case!0:case"observed":h=!0;break;case!1:case"never":h=!1;break;case"strict":case"always":h="strict";break;default:mb("Invalid value for 'enforceActions': '"+e+"', expected 'never', 'always' or 'observed'")}jv.enforceActions=h,jv.allowStateChanges=!0!==h&&"strict"!==h}void 0!==i&&(jv.computedRequiresReaction=!!i),void 0!==a&&(jv.reactionRequiresObservable=!!a),void 0!==l&&(jv.observableRequiresReaction=!!l,jv.allowStateReads=!jv.observableRequiresReaction),void 0!==s&&(jv.computedConfigurable=!!s),void 0!==r&&(!0===r&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on."),jv.disableErrorBoundaries=!!r),"number"===typeof n&&Vw(n),o&&function(t){var e=Qv;Qv=function(i){return t((function(){return e(i)}))}}(o)}function yw(t,e,i,s){var r=(s=tv(s)).defaultDecorator||(!1===s.deep?rv:iv);Xb(t),tD(t,s.name,r.enhancer),qv();try{for(var n=Object.getOwnPropertyNames(e),o=0,a=n.length;o<a;o++){var l=n[o],h=Object.getOwnPropertyDescriptor(e,l);0;var u=(i&&l in i?i[l]:h.get?dv:r)(t,l,h,!0);u&&Object.defineProperty(t,l,u)}}finally{Xv()}return t}function xw(t,e){return bw(oD(t,e))}function bw(t){var e={name:t.name};return t.observing&&t.observing.length>0&&(e.dependencies=function(t){var e=[];return t.forEach((function(t){-1===e.indexOf(t)&&e.push(t)})),e}(t.observing).map(bw)),e}function vw(t,e){if(null===t||void 0===t)return!1;if(void 0!==e){if(nD(t)){var i=t.$mobx;return i.values&&!!i.values[e]}return!1}return nD(t)||!!t.$mobx||Mb(t)||ew(t)||zv(t)}function ww(t){return 1!==arguments.length&&mb(!1),vw(t)}Object.create(Error.prototype);var Dw={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function kw(t,e,i,s){return s.detectCycles&&t.set(e,i),i}function Tw(t,e,i){if(!e.recurseEverything&&!ww(t))return t;if("object"!==typeof t)return t;if(null===t)return null;if(t instanceof Date)return t;if(Pv(t))return Tw(t.get(),e,i);if(ww(t)&&function(t){nD(t)?t.$mobx.getKeys():Jw(t)||Qw(t)?Tb(t.keys()):Hw(t)?t.map((function(t,e){return e})):mb(!1)}(t),!0===e.detectCycles&&null!==t&&i.has(t))return i.get(t);if(Hw(t)||Array.isArray(t)){var s=kw(i,t,[],e),r=t.map((function(t){return Tw(t,e,i)}));s.length=r.length;for(var n=0,o=r.length;n<o;n++)s[n]=r[n];return s}if(Qw(t)||Object.getPrototypeOf(t)===Set.prototype){if(!1===e.exportMapsAsObjects){var a=kw(i,t,new Set,e);return t.forEach((function(t){a.add(Tw(t,e,i))})),a}var l=kw(i,t,[],e);return t.forEach((function(t){l.push(Tw(t,e,i))})),l}if(Jw(t)||Object.getPrototypeOf(t)===Map.prototype){if(!1===e.exportMapsAsObjects){var h=kw(i,t,new Map,e);return t.forEach((function(t,s){h.set(s,Tw(t,e,i))})),h}var u=kw(i,t,{},e);return t.forEach((function(t,s){u[s]=Tw(t,e,i)})),u}var c=kw(i,t,{},e);for(var d in t)c[d]=Tw(t[d],e,i);return c}function Cw(t,e){var i;return"boolean"===typeof e&&(e={detectCycles:e}),e||(e=Dw),e.detectCycles=void 0===e.detectCycles?!0===e.recurseEverything:!0===e.detectCycles,e.detectCycles&&(i=new Map),Tw(t,e,i)}function Rw(t){switch(t.length){case 0:return jv.trackingDerivation;case 1:return oD(t[0]);case 2:return oD(t[0],t[1])}}function Iw(t,e){void 0===e&&(e=void 0),qv();try{return t.apply(e)}finally{Xv()}}function Fw(t){return void 0!==t.interceptors&&t.interceptors.length>0}function Sw(t,e){var i=t.interceptors||(t.interceptors=[]);return i.push(e),pb((function(){var t=i.indexOf(e);-1!==t&&i.splice(t,1)}))}function Ew(t,e){var i=wv();try{var s=t.interceptors;if(s)for(var r=0,n=s.length;r<n&&(gb(!(e=s[r](e))||e.type,"Intercept handlers should return nothing or a change object"),e);r++);return e}finally{Dv(i)}}function Ow(t){return void 0!==t.changeListeners&&t.changeListeners.length>0}function Aw(t,e){var i=t.changeListeners||(t.changeListeners=[]);return i.push(e),pb((function(){var t=i.indexOf(e);-1!==t&&i.splice(t,1)}))}function Bw(t,e){var i=wv(),s=t.changeListeners;if(s){for(var r=0,n=(s=s.slice()).length;r<n;r++)s[r](e);Dv(i)}}var Mw=function(){var t=!1,e={};return Object.defineProperty(e,"0",{set:function(){t=!0}}),Object.create(e)[0]=1,!1===t}(),Pw=0,Lw=function(){};!function(t,e){"undefined"!==typeof Object.setPrototypeOf?Object.setPrototypeOf(t.prototype,e):"undefined"!==typeof t.prototype.__proto__?t.prototype.__proto__=e:t.prototype=e}(Lw,Array.prototype),Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach((function(t){Object.defineProperty(Lw.prototype,t,{configurable:!0,writable:!0,value:Array.prototype[t]})}));var zw=function(){function t(t,e,i,s){this.array=i,this.owned=s,this.values=[],this.lastKnownLength=0,this.atom=new Bb(t||"ObservableArray@"+_b()),this.enhancer=function(i,s){return e(i,s,t+"[..]")}}return t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.dehanceValues=function(t){return void 0!==this.dehancer&&t.length>0?t.map(this.dehancer):t},t.prototype.intercept=function(t){return Sw(this,t)},t.prototype.observe=function(t,e){return void 0===e&&(e=!1),e&&t({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),Aw(this,t)},t.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},t.prototype.setArrayLength=function(t){if("number"!==typeof t||t<0)throw new Error("[mobx.array] Out of range: "+t);var e=this.values.length;if(t!==e)if(t>e){for(var i=new Array(t-e),s=0;s<t-e;s++)i[s]=void 0;this.spliceWithArray(e,0,i)}else this.spliceWithArray(t,e-t)},t.prototype.updateArrayLength=function(t,e){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=e,e>0&&t+e+1>Pw&&Vw(t+e+1)},t.prototype.spliceWithArray=function(t,e,i){var s=this;yv(this.atom);var r=this.values.length;if(void 0===t?t=0:t>r?t=r:t<0&&(t=Math.max(0,r+t)),e=1===arguments.length?r-t:void 0===e||null===e?0:Math.max(0,Math.min(e,r-t)),void 0===i&&(i=hb),Fw(this)){var n=Ew(this,{object:this.array,type:"splice",index:t,removedCount:e,added:i});if(!n)return hb;e=n.removedCount,i=n.added}var o=(i=0===i.length?i:i.map((function(t){return s.enhancer(t,void 0)}))).length-e;this.updateArrayLength(r,o);var a=this.spliceItemsIntoValues(t,e,i);return 0===e&&0===i.length||this.notifyArraySplice(t,i,a),this.dehanceValues(a)},t.prototype.spliceItemsIntoValues=function(t,e,i){var s;if(i.length<1e4)return(s=this.values).splice.apply(s,Vb([t,e],i));var r=this.values.slice(t,t+e);return this.values=this.values.slice(0,t).concat(i,this.values.slice(t+e)),r},t.prototype.notifyArrayChildUpdate=function(t,e,i){var s=!this.owned&&iw(),r=Ow(this),n=r||s?{object:this.array,type:"update",index:t,newValue:e,oldValue:i}:null;s&&rw(Gb(Gb({},n),{name:this.atom.name})),this.atom.reportChanged(),r&&Bw(this,n),s&&ow()},t.prototype.notifyArraySplice=function(t,e,i){var s=!this.owned&&iw(),r=Ow(this),n=r||s?{object:this.array,type:"splice",index:t,removed:i,added:e,removedCount:i.length,addedCount:e.length}:null;s&&rw(Gb(Gb({},n),{name:this.atom.name})),this.atom.reportChanged(),r&&Bw(this,n),s&&ow()},t}(),Nw=function(t){function e(e,i,s,r){void 0===s&&(s="ObservableArray@"+_b()),void 0===r&&(r=!1);var n=t.call(this)||this,o=new zw(s,i,n,r);if(vb(n,"$mobx",o),e&&e.length){var a=Av(!0);n.spliceWithArray(0,0,e),Bv(a)}return Mw&&Object.defineProperty(o.array,"0",Uw),n}return Ub(e,t),e.prototype.intercept=function(t){return this.$mobx.intercept(t)},e.prototype.observe=function(t,e){return void 0===e&&(e=!1),this.$mobx.observe(t,e)},e.prototype.clear=function(){return this.splice(0)},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),t.map((function(t){return Hw(t)?t.peek():t})))},e.prototype.replace=function(t){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,t)},e.prototype.toJS=function(){return this.slice()},e.prototype.toJSON=function(){return this.toJS()},e.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},e.prototype.find=function(t,e,i){void 0===i&&(i=0);var s=this.findIndex.apply(this,arguments);return-1===s?void 0:this.get(s)},e.prototype.findIndex=function(t,e,i){void 0===i&&(i=0);for(var s=this.peek(),r=s.length,n=i;n<r;n++)if(t.call(e,s[n],n,this))return n;return-1},e.prototype.splice=function(t,e){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(t);case 2:return this.$mobx.spliceWithArray(t,e)}return this.$mobx.spliceWithArray(t,e,i)},e.prototype.spliceWithArray=function(t,e,i){return this.$mobx.spliceWithArray(t,e,i)},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.$mobx;return i.spliceWithArray(i.values.length,0,t),i.values.length},e.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},e.prototype.shift=function(){return this.splice(0,1)[0]},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.$mobx;return i.spliceWithArray(0,0,t),i.values.length},e.prototype.reverse=function(){var t=this.slice();return t.reverse.apply(t,arguments)},e.prototype.sort=function(t){var e=this.slice();return e.sort.apply(e,arguments)},e.prototype.remove=function(t){var e=this.$mobx.dehanceValues(this.$mobx.values).indexOf(t);return e>-1&&(this.splice(e,1),!0)},e.prototype.move=function(t,e){function i(t){if(t<0)throw new Error("[mobx.array] Index out of bounds: "+t+" is negative");var e=this.$mobx.values.length;if(t>=e)throw new Error("[mobx.array] Index out of bounds: "+t+" is not smaller than "+e)}if(i.call(this,t),i.call(this,e),t!==e){var s,r=this.$mobx.values;s=t<e?Vb(r.slice(0,t),r.slice(t+1,e+1),[r[t]],r.slice(e+1)):Vb(r.slice(0,e),[r[t]],r.slice(e,t),r.slice(t+1)),this.replace(s)}},e.prototype.get=function(t){var e=this.$mobx;if(e){if(t<e.values.length)return e.atom.reportObserved(),e.dehanceValue(e.values[t]);console.warn("[mobx.array] Attempt to read an array index ("+t+") that is out of bounds ("+e.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},e.prototype.set=function(t,e){var i=this.$mobx,s=i.values;if(t<s.length){yv(i.atom);var r=s[t];if(Fw(i)){var n=Ew(i,{type:"update",object:this,index:t,newValue:e});if(!n)return;e=n.newValue}(e=i.enhancer(e,r))!==r&&(s[t]=e,i.notifyArrayChildUpdate(t,e,r))}else{if(t!==s.length)throw new Error("[mobx.array] Index out of bounds, "+t+" is larger than "+s.length);i.spliceWithArray(t,0,[e])}},e}(Lw);Sb(Nw.prototype,(function(){this.$mobx.atom.reportObserved();var t=this,e=0;return Eb({next:function(){return e<t.length?{value:t[e++],done:!1}:{done:!0,value:void 0}}})})),Object.defineProperty(Nw.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(t){this.$mobx.setArrayLength(t)}}),bb(Nw.prototype,Ob(),"Array"),["indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach((function(t){var e=Array.prototype[t];gb("function"===typeof e,"Base function not defined on Array prototype: '"+t+"'"),bb(Nw.prototype,t,(function(){return e.apply(this.peek(),arguments)}))})),["every","filter","forEach","map","some"].forEach((function(t){gb("function"===typeof Array.prototype[t],"Base function not defined on Array prototype: '"+t+"'"),bb(Nw.prototype,t,(function(e,i){var s=this,r=this.$mobx;return r.atom.reportObserved(),r.dehanceValues(r.values)[t]((function(t,r){return e.call(i,t,r,s)}),i)}))})),["reduce","reduceRight"].forEach((function(t){bb(Nw.prototype,t,(function(){var e=this,i=this.$mobx;i.atom.reportObserved();var s=arguments[0];return arguments[0]=function(t,r,n){return r=i.dehanceValue(r),s(t,r,n,e)},i.values[t].apply(i.values,arguments)}))})),function(t,e){for(var i=0;i<e.length;i++)bb(t,e[i],t[e[i]])}(Nw.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var Uw=Gw(0);function Gw(t){return{enumerable:!1,configurable:!1,get:function(){return this.get(t)},set:function(e){this.set(t,e)}}}function jw(t){Object.defineProperty(Nw.prototype,""+t,Gw(t))}function Vw(t){for(var e=Pw;e<t;e++)jw(e);Pw=t}Vw(1e3);var Ww=wb("ObservableArrayAdministration",zw);function Hw(t){return yb(t)&&Ww(t.$mobx)}var qw={},Xw=function(){function t(t,e,i){if(void 0===e&&(e=Kb),void 0===i&&(i="ObservableMap@"+_b()),this.enhancer=e,this.name=i,this.$mobx=qw,this._keysAtom=Pb(this.name+".keys()"),"function"!==typeof Map)throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return t.prototype._has=function(t){return this._data.has(t)},t.prototype.has=function(t){var e=this;if(!jv.trackingDerivation)return this._has(t);var i=this._hasMap.get(t);if(!i){var s=i=new Mv(this._has(t),Zb,this.name+"."+Yw(t)+"?",!1);this._hasMap.set(t,s),gw(s,(function(){return e._hasMap.delete(t)}))}return i.get()},t.prototype.set=function(t,e){var i=this._has(t);if(Fw(this)){var s=Ew(this,{type:i?"update":"add",object:this,newValue:e,name:t});if(!s)return this;e=s.newValue}return i?this._updateValue(t,e):this._addValue(t,e),this},t.prototype.delete=function(t){var e=this;if((yv(this._keysAtom),Fw(this))&&!(r=Ew(this,{type:"delete",object:this,name:t})))return!1;if(this._has(t)){var i=iw(),s=Ow(this),r=s||i?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return i&&rw(Gb(Gb({},r),{name:this.name,key:t})),Iw((function(){e._keysAtom.reportChanged(),e._updateHasMapEntry(t,!1),e._data.get(t).setNewValue(void 0),e._data.delete(t)})),s&&Bw(this,r),i&&ow(),!0}return!1},t.prototype._updateHasMapEntry=function(t,e){var i=this._hasMap.get(t);i&&i.setNewValue(e)},t.prototype._updateValue=function(t,e){var i=this._data.get(t);if((e=i.prepareNewValue(e))!==jv.UNCHANGED){var s=iw(),r=Ow(this),n=r||s?{type:"update",object:this,oldValue:i.value,name:t,newValue:e}:null;s&&rw(Gb(Gb({},n),{name:this.name,key:t})),i.setNewValue(e),r&&Bw(this,n),s&&ow()}},t.prototype._addValue=function(t,e){var i=this;yv(this._keysAtom),Iw((function(){var s=new Mv(e,i.enhancer,i.name+"."+Yw(t),!1);i._data.set(t,s),e=s.value,i._updateHasMapEntry(t,!0),i._keysAtom.reportChanged()}));var s=iw(),r=Ow(this),n=r||s?{type:"add",object:this,name:t,newValue:e}:null;s&&rw(Gb(Gb({},n),{name:this.name,key:t})),r&&Bw(this,n),s&&ow()},t.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},t.prototype.values=function(){var t=this,e=this.keys();return Eb({next:function(){var i=e.next(),s=i.done,r=i.value;return{done:s,value:s?void 0:t.get(r)}}})},t.prototype.entries=function(){var t=this,e=this.keys();return Eb({next:function(){var i=e.next(),s=i.done,r=i.value;return{done:s,value:s?void 0:[r,t.get(r)]}}})},t.prototype.forEach=function(t,e){var i=this;this._keysAtom.reportObserved(),this._data.forEach((function(s,r){return t.call(e,i.get(r),r,i)}))},t.prototype.merge=function(t){var e=this;return Jw(t)&&(t=t.toJS()),Iw((function(){var i=Av(!0);try{xb(t)?Object.keys(t).forEach((function(i){return e.set(i,t[i])})):Array.isArray(t)?t.forEach((function(t){var i=jb(t,2),s=i[0],r=i[1];return e.set(s,r)})):Db(t)?t.constructor!==Map?mb("Cannot initialize from classes that inherit from Map: "+t.constructor.name):t.forEach((function(t,i){return e.set(i,t)})):null!==t&&void 0!==t&&mb("Cannot initialize map from "+t)}finally{Bv(i)}})),this},t.prototype.clear=function(){var t=this;Iw((function(){vv((function(){t._data.forEach((function(e,i){return t.delete(i)}))}))}))},t.prototype.replace=function(t){var e=this;return Iw((function(){var i=function(t){if(Db(t)||Jw(t))return t;if(Array.isArray(t))return new Map(t);if(xb(t)){var e=new Map;for(var i in t)e.set(i,t[i]);return e}return mb("Cannot convert to map from '"+t+"'")}(t),s=new Map,r=!1;if(Ib(e._data.keys(),(function(t){if(!i.has(t))if(e.delete(t))r=!0;else{var n=e._data.get(t);s.set(t,n)}})),Ib(i.entries(),(function(t){var i=jb(t,2),n=i[0],o=i[1],a=e._data.has(n);if(e.set(n,o),e._data.has(n)){var l=e._data.get(n);s.set(n,l),a||(r=!0)}})),!r)if(e._data.size!==s.size)e._keysAtom.reportChanged();else for(var n=e._data.keys(),o=s.keys(),a=n.next(),l=o.next();!a.done;){if(a.value!==l.value){e._keysAtom.reportChanged();break}a=n.next(),l=o.next()}e._data=s})),this},Object.defineProperty(t.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),t.prototype.toPOJO=function(){var t=this,e={};return this.forEach((function(i,s){return e["symbol"===typeof s?s:Yw(s)]=t.get(s)})),e},t.prototype.toJS=function(){return new Map(this)},t.prototype.toJSON=function(){return this.toPOJO()},t.prototype.toString=function(){var t=this;return this.name+"[{ "+Tb(this.keys()).map((function(e){return Yw(e)+": "+t.get(e)})).join(", ")+" }]"},t.prototype.observe=function(t,e){return Aw(this,t)},t.prototype.intercept=function(t){return Sw(this,t)},t}();function Yw(t){return t&&t.toString?t.toString():new String(t).toString()}Sb(Xw.prototype,(function(){return this.entries()})),vb(Xw.prototype,Ob(),"Map");var Jw=wb("ObservableMap",Xw),Kw={},Zw=function(){function t(t,e,i){if(void 0===e&&(e=Kb),void 0===i&&(i="ObservableSet@"+_b()),this.name=i,this.$mobx=Kw,this._data=new Set,this._atom=Pb(this.name),"function"!==typeof Set)throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(t,s){return e(t,s,i)},t&&this.replace(t)}return t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.clear=function(){var t=this;Iw((function(){vv((function(){t._data.forEach((function(e){t.delete(e)}))}))}))},t.prototype.forEach=function(t,e){var i=this;this._atom.reportObserved(),this._data.forEach((function(s){t.call(e,s,s,i)}))},Object.defineProperty(t.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),t.prototype.add=function(t){var e=this;if((yv(this._atom),Fw(this))&&!(r=Ew(this,{type:"add",object:this,newValue:t})))return this;if(!this.has(t)){Iw((function(){e._data.add(e.enhancer(t,void 0)),e._atom.reportChanged()}));var i=iw(),s=Ow(this),r=s||i?{type:"add",object:this,newValue:t}:null;0,s&&Bw(this,r)}return this},t.prototype.delete=function(t){var e=this;if(Fw(this)&&!(r=Ew(this,{type:"delete",object:this,oldValue:t})))return!1;if(this.has(t)){var i=iw(),s=Ow(this),r=s||i?{type:"delete",object:this,oldValue:t}:null;return Iw((function(){e._atom.reportChanged(),e._data.delete(t)})),s&&Bw(this,r),!0}return!1},t.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},t.prototype.entries=function(){var t=0,e=Tb(this.keys()),i=Tb(this.values());return Eb({next:function(){var s=t;return t+=1,s<i.length?{value:[e[s],i[s]],done:!1}:{done:!0}}})},t.prototype.keys=function(){return this.values()},t.prototype.values=function(){this._atom.reportObserved();var t,e=this,i=0;return void 0!==this._data.values?t=Tb(this._data.values()):(t=[],this._data.forEach((function(e){return t.push(e)}))),Eb({next:function(){return i<t.length?{value:e.dehanceValue(t[i++]),done:!1}:{done:!0}}})},t.prototype.replace=function(t){var e=this;return Qw(t)&&(t=t.toJS()),Iw((function(){var i=Av(!0);try{Array.isArray(t)||kb(t)?(e.clear(),t.forEach((function(t){return e.add(t)}))):null!==t&&void 0!==t&&mb("Cannot initialize set from "+t)}finally{Bv(i)}})),this},t.prototype.observe=function(t,e){return Aw(this,t)},t.prototype.intercept=function(t){return Sw(this,t)},t.prototype.toJS=function(){return new Set(this)},t.prototype.toString=function(){return this.name+"[ "+Tb(this.keys()).join(", ")+" ]"},t}();Sb(Zw.prototype,(function(){return this.values()})),vb(Zw.prototype,Ob(),"Set");var Qw=wb("ObservableSet",Zw),$w=function(){function t(t,e,i){this.target=t,this.name=e,this.defaultEnhancer=i,this.values={}}return t.prototype.read=function(t,e){if(this.target===t||(this.illegalAccess(t,e),this.values[e]))return this.values[e].get()},t.prototype.write=function(t,e,i){var s=this.target;s!==t&&this.illegalAccess(t,e);var r=this.values[e];if(r instanceof Lv)r.set(i);else{if(Fw(this)){if(!(a=Ew(this,{type:"update",object:s,name:e,newValue:i})))return;i=a.newValue}if((i=r.prepareNewValue(i))!==jv.UNCHANGED){var n=Ow(this),o=iw(),a=n||o?{type:"update",object:s,oldValue:r.value,name:e,newValue:i}:null;o&&rw(Gb(Gb({},a),{name:this.name,key:e})),r.setNewValue(i),n&&Bw(this,a),o&&ow()}}},t.prototype.remove=function(t){if(this.values[t]){var e=this.target;if(Fw(this))if(!(n=Ew(this,{object:e,name:t,type:"remove"})))return;try{qv();var i=Ow(this),s=iw(),r=this.values[t].get();this.keys&&this.keys.remove(t),delete this.values[t],delete this.target[t];var n=i||s?{type:"remove",object:e,oldValue:r,name:t}:null;s&&rw(Gb(Gb({},n),{name:this.name,key:t})),i&&Bw(this,n),s&&ow()}finally{Xv()}}},t.prototype.illegalAccess=function(t,e){console.warn("Property '"+e+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},t.prototype.observe=function(t,e){return Aw(this,t)},t.prototype.intercept=function(t){return Sw(this,t)},t.prototype.getKeys=function(){var t=this;return void 0===this.keys&&(this.keys=new Nw(Object.keys(this.values).filter((function(e){return t.values[e]instanceof Mv})),Zb,"keys("+this.name+")",!0)),this.keys.slice()},t}();function tD(t,e,i){void 0===e&&(e=""),void 0===i&&(i=Kb);var s=t.$mobx;return s||(xb(t)||(e=(t.constructor.name||"ObservableObject")+"@"+_b()),e||(e="ObservableObject@"+_b()),vb(t,"$mobx",s=new $w(t,e,i)),s)}var eD=Object.create(null),iD=Object.create(null);function sD(t){var e=t.$mobx;return e||(Xb(t),t.$mobx)}var rD=wb("ObservableObjectAdministration",$w);function nD(t){return!!yb(t)&&(Xb(t),rD(t.$mobx))}function oD(t,e){if("object"===typeof t&&null!==t){if(Hw(t))return void 0!==e&&mb(!1),t.$mobx.atom;if(Qw(t))return t.$mobx;if(Jw(t)){var i=t;return void 0===e?i._keysAtom:((s=i._data.get(e)||i._hasMap.get(e))||mb(!1),s)}var s;if(Xb(t),e&&!t.$mobx&&t[e],nD(t))return e?((s=t.$mobx.values[e])||mb(!1),s):mb(!1);if(Mb(t)||zv(t)||ew(t))return t}else if("function"===typeof t&&ew(t.$mobx))return t.$mobx;return mb(!1)}function aD(t,e){return t||mb("Expecting some object"),void 0!==e?aD(oD(t,e)):Mb(t)||zv(t)||ew(t)||Jw(t)||Qw(t)?t:(Xb(t),t.$mobx?t.$mobx:void mb(!1))}var lD=Object.prototype.toString;function hD(t,e,i){return void 0===i&&(i=-1),uD(t,e,i)}function uD(t,e,i,s,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return!1;if(t!==t)return e!==e;var n=typeof t;if("function"!==n&&"object"!==n&&"object"!=typeof e)return!1;t=cD(t),e=cD(e);var o=lD.call(t);if(o!==lD.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t===""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e;case"[object Symbol]":return"undefined"!==typeof Symbol&&Symbol.valueOf.call(t)===Symbol.valueOf.call(e)}var a="[object Array]"===o;if(!a){if("object"!=typeof t||"object"!=typeof e)return!1;var l=t.constructor,h=e.constructor;if(l!==h&&!("function"===typeof l&&l instanceof l&&"function"===typeof h&&h instanceof h)&&"constructor"in t&&"constructor"in e)return!1}if(0===i)return!1;i<0&&(i=-1),r=r||[];for(var u=(s=s||[]).length;u--;)if(s[u]===t)return r[u]===e;if(s.push(t),r.push(e),a){if((u=t.length)!==e.length)return!1;for(;u--;)if(!uD(t[u],e[u],i-1,s,r))return!1}else{var c=Object.keys(t),d=void 0;if(u=c.length,Object.keys(e).length!==u)return!1;for(;u--;)if(!dD(e,d=c[u])||!uD(t[d],e[d],i-1,s,r))return!1}return s.pop(),r.pop(),!0}function cD(t){return Hw(t)?t.peek():Db(t)||Jw(t)||kb(t)||Qw(t)?Tb(t.entries()):t}function dD(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var _D,mD,gD,pD,fD,yD,xD,bD,vD,wD,DD="$mobx";"object"===typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:aw,extras:{getDebugName:function(t,e){return(void 0!==e?oD(t,e):nD(t)||Jw(t)||Qw(t)?aD(t):oD(t)).name}},$mobx:DD}),(mD=_D||(_D={})).UNDO="undo",mD.REDO="redo",mD.DELETE="delete",mD.BRING_TO_FRONT="bringtofront",mD.EDIT="edit",mD.DUPLICATE="duplicate",mD.ADD="add",mD.FLIP="flip",mD.INVERT="invert",mD.CLOSE="close",mD.EXPORT="export",(pD=gD||(gD={})).LIBRARY="library",pD.TRANSFORM="transform",pD.FILTER="filter",pD.ADJUSTMENT="adjustment",pD.FOCUS="focus",pD.STICKER="sticker",pD.TEXT="text",pD.TEXT_DESIGN="textdesign",pD.OVERLAY="overlay",pD.FRAME="frame",pD.BRUSH="brush",pD.CUSTOM="customTool",(yD=fD||(fD={})).TEXT="text",yD.CARD="card",(bD=xD||(xD={})).LARGE="large",bD.MEDIUM="medium",bD.SMALL="small",(wD=vD||(vD={})).ERROR="error",wD.WARNING="warning",wD.INFO="info",wD.TEXT_EDIT="textEdit";var kD,TD,CD=class{constructor(){this.position=new class{constructor(){this.enabled=!0,this.threshold=20,this.snapToHorizontalCenter=!0,this.snapToVerticalCenter=!0,this.snapToLeft=.1,this.snapToRight=.1,this.snapToTop=.1,this.snapToBottom=.1}},this.rotation=new class{constructor(){this.enabled=!0,this.threshold=20,this.angles=[0,45,90,135,180,225,270,315]}}}};(TD=kD||(kD={})).CENTER="center",TD.TOP_LEFT="top-left",TD.TOP_RIGHT="top-right",TD.BOTTOM_LEFT="bottom-left",TD.BOTTOM_RIGHT="bottom-right";var RD,ID=class{constructor(){this.watermarkURI="",this.alignment=kD.TOP_RIGHT,this.inset=.05,this.size=.2}};(RD||(RD={})).OBJECT="object";var FD,SD,ED,OD;!function(t){t.IMAGE="image",t.DATA_URL="data-url",t.BLOB="blob",t.MSBLOB="ms-blob"}(FD||(FD={})),function(t){t.PNG="image/png",t.JPEG="image/jpeg"}(SD||(SD={})),(OD=ED||(ED={})).BMP="image/bmp",OD.GIF="image/gif",OD.ICO="image/x-icon",OD.JPEG="image/jpeg",OD.PNG="image/png",OD.SVG="image/svg+xml",OD.TIFF="image/tiff",OD.WEBP="image/webp";var AD;gD.FILTER,gD.FOCUS,gD.ADJUSTMENT,gD.LIBRARY,gD.OVERLAY,gD.STICKER,gD.TEXT,gD.TEXT_DESIGN,gD.FRAME,gD.BRUSH,gD.TRANSFORM,gD.CUSTOM,function(t){t.BRIGHTNESS="brightness",t.CONTRAST="contrast",t.SATURATION="saturation",t.CLARITY="clarity",t.SHADOWS="shadows",t.HIGHLIGHTS="highlights",t.EXPOSURE="exposure",t.GAMMA="gamma",t.BLACKS="blacks",t.WHITES="whites",t.TEMPERATURE="temperature",t.SHARPNESS="sharpness"}(AD||(AD={}));var BD,MD=Object.values(AD).reduce(((t,e)=>(t[e]=!0,t)),{});!function(t){t.RemoveAdjustmentButton="removeAdjustmentButton",t.Expandable="expandable",t.Separator="separator",t.Items="items"}(BD||(BD={}));var PD,LD,zD=class{constructor(){this.categories=[],this.flattenCategories=!1,this.advancedUIToolControlBarOrder=[{type:BD.Expandable,children:[BD.RemoveAdjustmentButton,BD.Separator]},BD.Items]}};!function(t){t.RemoveFilterButton="removeFilterButton",t.FilterIntensitySlider="filterIntensitySlider",t.Expandable="expandable",t.Separator="separator",t.Items="items"}(PD||(PD={})),function(t){t.FilterIntensity="filterIntensity"}(LD||(LD={}));var ND,UD,GD,jD,VD,WD,HD=class{constructor(){this.categories=[],this.flattenCategories=!1,this.categoryHeaderType=fD.CARD,this.enablePreviewThumbnails=!1,this.advancedUIToolControlBarOrder=[{type:PD.Expandable,children:[PD.RemoveFilterButton,PD.FilterIntensitySlider,PD.Separator]},PD.Items],this.basicUIToolControlBarTabsOrder=[LD.FilterIntensity]}};function qD(t){return void 0!==t.lightColor}(UD=ND||(ND={})).Desert="imgly_duotone_desert",UD.Peach="imgly_duotone_peach",UD.Clash="imgly_duotone_clash",UD.Plum="imgly_duotone_plum",UD.Breezy="imgly_duotone_breezy",UD.DeepBlue="imgly_duotone_deepblue",UD.Frog="imgly_duotone_frog",UD.Sunset="imgly_duotone_sunset",UD.AD1920="imgly_lut_ad1920",UD.Greyed="imgly_lut_bw",UD.Dusty="imgly_lut_x400",UD.Litho="imgly_lut_litho",UD.Sepia="imgly_lut_sepiahigh",UD.Weathered="imgly_lut_plate",UD.HardStuff="imgly_lut_sin",UD.Polaroid="imgly_lut_blues",UD.Sunny70s="imgly_lut_front",UD.Oldtimer="imgly_lut_texas",UD.Inferno="imgly_lut_celsius",UD.Snappy="imgly_lut_cool",UD.Chestnut="imgly_lut_chest",UD.Softy="imgly_lut_winter",UD.Pebble="imgly_lut_kdynamic",UD.Moss="imgly_lut_fall",UD.Lemon="imgly_lut_lenin",UD.GreenGap="imgly_lut_pola669",UD.Colla="imgly_lut_elder",UD.Solanus="imgly_lut_orchid",UD.Kalmen="imgly_lut_bleached",UD.Joran="imgly_lut_bleachedblue",UD.Levante="imgly_lut_breeze",UD.Zephyr="imgly_lut_blueshadows",UD.Golden="imgly_lut_sunset",UD.LowFire="imgly_lut_eighties",UD.Sunrise="imgly_lut_evening",UD.FlatBlack="imgly_lut_k2",UD.Pumpkin="imgly_lut_nogreen",UD.Ancient="imgly_lut_ancient",UD.Candy="imgly_lut_cottoncandy",UD.Classic="imgly_lut_classic",UD.Colorful="imgly_lut_colorful",UD.Creamy="imgly_lut_creamy",UD.Fixie="imgly_lut_fixie",UD.Food="imgly_lut_food",UD.Fridge="imgly_lut_fridge",UD.Glam="imgly_lut_glam",UD.Gobblin="imgly_lut_gobblin",UD.Hicon="imgly_lut_highcontrast",UD.HighCarb="imgly_lut_highcarb",UD.K1="imgly_lut_k1",UD.K6="imgly_lut_k6",UD.Keen="imgly_lut_keen",UD.Lomo="imgly_lut_lomo",UD.Lomo100="imgly_lut_lomo100",UD.Lucid="imgly_lut_lucid",UD.Mellow="imgly_lut_mellow",UD.Neat="imgly_lut_neat",UD.Pale="imgly_lut_pale",UD.Pitched="imgly_lut_pitched",UD.PolaSX="imgly_lut_polasx",UD.Pro400="imgly_lut_pro400",UD.Quozi="imgly_lut_quozi",UD.Settled="imgly_lut_settled",UD.Seventies="imgly_lut_seventies",UD.Soft="imgly_lut_soft",UD.Steel="imgly_lut_steel",UD.Summer="imgly_lut_summer",UD.Tender="imgly_lut_tender",UD.Twilight="imgly_lut_twilight",(jD=GD||(GD={})).DuoTone="imgly_filter_category_duotone",jD.BW="imgly_filter_category_bw",jD.Vintage="imgly_filter_category_vintage",jD.Smooth="imgly_filter_category_smooth",jD.Cold="imgly_filter_category_cold",jD.Warm="imgly_filter_category_warm",jD.Legacy="imgly_filter_category_legacy",function(t){t.RemoveFocusButton="removeFocusButton",t.FocusIntensitySlider="focusIntensitySlider",t.Expandable="expandable",t.Separator="separator",t.Items="items"}(VD||(VD={})),function(t){t.FocusIntensity="focusIntensity"}(WD||(WD={}));var XD,YD,JD,KD=class{constructor(){this.items=[],this.advancedUIToolControlBarOrder=[{type:VD.Expandable,children:[VD.RemoveFocusButton,VD.FocusIntensitySlider,VD.Separator]},VD.Items],this.basicUIToolControlBarTabsOrder=[WD.FocusIntensity]}};!function(t){t.RADIAL="radial",t.LINEAR="linear",t.MIRRORED="mirrored",t.GAUSSIAN="gaussian"}(XD||(XD={})),function(t){t.RemoveFrameButton="removeFrameButton",t.FrameOpacitySlider="frameOpacitySlider",t.FrameSizeSlider="frameSizeSlider",t.FrameColorList="frameColorList",t.Separator="separator",t.Items="items",t.Expandable="expandable"}(YD||(YD={})),function(t){t.FrameSize="frameSize",t.FrameOpacity="frameOpacity",t.FrameColor="frameColor"}(JD||(JD={}));var ZD,QD=class{constructor(){this.items=[],this.advancedUIToolControlBarOrder=[{type:YD.Expandable,children:[YD.RemoveFrameButton,YD.FrameOpacitySlider,YD.FrameSizeSlider,YD.FrameColorList,YD.Separator]},YD.Items],this.basicUIToolControlBarTabsOrder=[JD.FrameOpacity,JD.FrameSize,JD.FrameColor]}},$D=class{constructor(t){this.name=t.name,this.coverImageUrl=t.coverImageUrl}loadCoverImage(t="anonymous"){return new Promise(((e,i)=>{const s=new Image;s.addEventListener("load",(()=>{e(s)})),s.addEventListener("error",(()=>{i(new Error(`Failed to load image at ${this.coverImage}`))})),s.crossOrigin=t,s.src=this.coverImageUrl,this.coverImage=s}))}},tk=class{constructor(t){this.title=t.title,this.category=t.category||t.title,this.thumbUrl=t.thumbUrl,this.rawUrl=t.rawUrl,this.authorName=t.authorName,this.authorAvatar=t.authorAvatar}loadThumbImage(t="anonymous"){return new Promise(((e,i)=>{const s=new Image;s.addEventListener("load",(()=>{e(s)})),s.addEventListener("error",(()=>{i(new Error(`Failed to load image at ${this.thumbUrl}`))})),s.crossOrigin=t,s.src=this.thumbUrl,this.thumbImage=s}))}getThumbImage(){return this.thumbUrl}},ek=class{loadJSON(t){const e=new class{getData(t){return new Promise(((e,i)=>{const s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="json",s.onload=()=>{const{status:t}=s;200===t?e(s.response):i(new Error(`HTTP Status ${t}`))},s.send()}))}};return e.getData(t)}getCategories(){return Promise.resolve([])}searchImages(t){return Promise.resolve([])}},ik=class extends ek{loadData(){return this.data?Promise.resolve(this.data):this.loadJSON("https://img.ly/static/libraries/unsplash/metadata.json").then((t=>("string"===typeof t&&(t=JSON.parse(t)),this.data=t,t)))}getCategories(){return this.loadData().then((t=>t.categories.map((t=>new $D({name:t.name,coverImageUrl:t.coverImage})))))}searchImages(t){return this.loadData().then((e=>e.images.filter((e=>{const i=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").split(/\s+/);for(let t=0;t<i.length;t+=1){const s=i[t];if(!new RegExp(s,"i").test(e.title))return!1}return!0})).map((t=>new tk(t)))))}};!function(t){t.UploadImageButton="uploadImageButton",t.OpenWebcamButton="openWebcamButton",t.SearchFieldInput="searchFieldInput",t.Separator="separator",t.Items="items"}(ZD||(ZD={}));var sk,rk,nk,ok=class{constructor(){this.enableWebcam=!1,this.enableUpload=!1,this.provider=ik,this.flattenCategories=!1,this.categoryHeaderType=fD.CARD,this.advancedUIToolControlBarOrder=[ZD.SearchFieldInput,ZD.UploadImageButton,ZD.OpenWebcamButton,ZD.Separator,ZD.Items]}};(rk=sk||(sk={})).RemoveOverlayButton="removeOverlayButton",rk.OverlayOpacitySlider="overlayOpacitySlider",rk.OverlayBlendModeCarousel="overlayBlendModeCarousel",rk.Expandable="expandable",rk.Separator="separator",rk.Items="items",function(t){t.OverlayOpacity="overlayOpacity",t.OverlayBlendMode="overlayBlendMode"}(nk||(nk={}));var ak,lk,hk,uk,ck,dk,_k=class{constructor(){this.items=[],this.advancedUIToolControlBarOrder=[{type:sk.Expandable,children:[sk.RemoveOverlayButton,sk.OverlayBlendModeCarousel,sk.OverlayOpacitySlider,sk.Separator]},sk.Items],this.basicUIToolControlBarTabsOrder=[nk.OverlayBlendMode,nk.OverlayOpacity]}};(lk=ak||(ak={})).NORMAL="normal",lk.OVERLAY="overlay",lk.SOFT_LIGHT="softLight",lk.HARD_LIGHT="hardLight",lk.MULTIPLY="multiply",lk.DARKEN="darken",lk.COLOR_BURN="colorBurn",lk.SCREEN="screen",lk.LIGHTEN="lighten",(uk=hk||(hk={})).Bokeh="imgly_overlay_bokeh",uk.Chop="imgly_overlay_chop",uk.Clouds="imgly_overlay_clouds",uk.Golden="imgly_overlay_golden",uk.Grain="imgly_overlay_grain",uk.Hearts="imgly_overlay_hearts",uk.LightLeak1="imgly_overlay_lightleak1",uk.LightLeak2="imgly_overlay_lightleak2",uk.Metal="imgly_overlay_metal",uk.Mosaic="imgly_overlay_mosaic",uk.Painting="imgly_overlay_painting",uk.Paper="imgly_overlay_paper",uk.Rain="imgly_overlay_rain",uk.Vintage="imgly_overlay_vintage",uk.Wall1="imgly_overlay_wall1",uk.Wall2="imgly_overlay_wall2",uk.Wood="imgly_overlay_wood",function(t){t.UploadStickerButton="uploadStickerButton",t.StickerOpacitySlider="stickerOpacitySlider",t.StickerColorList="stickerColorList",t.Separator="separator",t.Items="items"}(ck||(ck={})),function(t){t.StickerColor="stickerColor",t.StickerOpacity="stickerOpacity"}(dk||(dk={}));var mk,gk,pk=class{constructor(){this.categories=[],this.canvasActions=[_D.BRING_TO_FRONT,_D.FLIP,_D.DUPLICATE,_D.DELETE],this.flattenCategories=!1,this.categoryHeaderType=fD.CARD,this.enableCustomUpload=!0,this.customStickerResizeMode="keepAspect",this.customStickerTintMode="none",this.advancedUIToolControlBarOrder=[ck.UploadStickerButton,ck.StickerOpacitySlider,ck.StickerColorList,ck.Separator,ck.Items],this.basicUIToolControlBarTabsOrder=[dk.StickerColor,dk.StickerOpacity]}};!function(t){t.NewTextButton="newTextButton",t.FontFamilyDropdown="fontFamilyDropdown",t.FontSizeInput="fontSizeInput",t.TextAligmentList="textAlignmentList",t.Separator="separator",t.Inline="inline",t.TextColorList="textColorList",t.BackgroundColorList="backgroundColorList",t.LineSpacingSlider="lineSpacingSlider"}(mk||(mk={})),function(t){t.FontSize="fontSize",t.TextAligment="textAlignment",t.TextColor="textColor",t.BackgroundColor="backgroundColor",t.LineSpacing="lineSpacing"}(gk||(gk={}));var fk,yk,xk=class{constructor(){this.fonts=[],this.canvasActions=[_D.EDIT,_D.BRING_TO_FRONT,_D.DUPLICATE,_D.DELETE],this.allowEmojis=!1,this.disableAutoScaling=!1,this.addDefaultTextOnEnter=!0,this.advancedUIToolControlBarOrder=[mk.NewTextButton,mk.FontFamilyDropdown,{type:mk.Inline,children:[mk.FontSizeInput,mk.TextAligmentList]},mk.Separator,mk.TextColorList,mk.BackgroundColorList,mk.Separator,mk.LineSpacingSlider],this.basicUIToolControlBarTabsOrder=[gk.FontSize,gk.TextAligment,gk.TextColor,gk.BackgroundColor,gk.LineSpacing]}};function bk(t){return void 0===t.provider||"file"===t.provider}function vk(t){return"google"===t.provider}!function(t){t.RemoveBrushButton="removeBrushButton",t.BrushColorList="brushColorList",t.BrushSizeSlider="brushSizeSlider",t.BrushHardnessSlider="brushHardnessSlider",t.Expandable="expandable",t.Separator="separator"}(fk||(fk={})),function(t){t.BrushSize="brushSize",t.BrushHardness="brushHardness",t.BrushColor="brushColor"}(yk||(yk={}));var wk,Dk=class{constructor(){this.defaultSize=.05,this.defaultHardness=.5,this.advancedUIToolControlBarOrder=[{type:fk.Expandable,children:[fk.RemoveBrushButton,fk.Separator]},fk.BrushHardnessSlider,fk.BrushSizeSlider,fk.BrushColorList],this.basicUIToolControlBarTabsOrder=[yk.BrushColor,yk.BrushSize,yk.BrushHardness]}};!function(t){t.NewTextDesignButton="newTextDesignButton",t.ShuffleLayoutButton="shuffleLayoutButton",t.TextDesignColorList="textDesignColorList",t.Separator="separator",t.Items="items"}(wk||(wk={}));var kk,Tk,Ck=class{constructor(){this.items=[],this.canvasActions=[_D.EDIT,_D.BRING_TO_FRONT,_D.INVERT,_D.DUPLICATE,_D.DELETE],this.allowEmojis=!1,this.addDefaultTextOnEnter=!0,this.advancedUIToolControlBarOrder=[wk.NewTextDesignButton,wk.ShuffleLayoutButton,wk.TextDesignColorList,wk.Separator,wk.Items]}};!function(t){t.ResetTransformButton="resetTransformButton",t.KeepResolutionCheckbox="keepResolutionCheckbox",t.CropSizeInput="cropSizeInput",t.Separator="separator",t.Items="items"}(kk||(kk={})),function(t){t.CropSize="cropSize",t.FlipRotate="flipRotate",t.Resolution="resolution"}(Tk||(Tk={}));var Rk,Ik,Fk,Sk=class{constructor(){this.categories=[],this.enableRotation=!0,this.enableFlip=!0,this.flattenCategories=!1,this.categoryHeaderType=fD.TEXT,this.advancedUIToolControlBarOrder=[kk.ResetTransformButton,kk.KeepResolutionCheckbox,kk.CropSizeInput,kk.Separator,kk.Items],this.basicUIToolControlBarTabsOrder=[Tk.CropSize,Tk.FlipRotate,Tk.Resolution]}};(Ik=Rk||(Rk={})).CommonCategory="imgly_transforms_common",Ik.FacebookCategory="imgly_transforms_facebook",Ik.TwitterCategory="imgly_transforms_twitter",Ik.InstagramCategory="imgly_transforms_instagram",Ik.Custom="imgly_transform_common_custom",Ik.Square="imgly_transform_common_square",Ik.ThreeByFour="imgly_transform_common_3",Ik.FourByThree="imgly_transform_common_4",Ik.NineBySixteen="imgly_transform_common_9",Ik.SixteenByNine="imgly_transform_common_16",Ik.FacebookPost="imgly_transform_facebook_post",Ik.FacebookProfile="imgly_transform_facebook_profile",Ik.FacebookTitle="imgly_transform_facebook_title",Ik.InstagramLandscape="imgly_transform_instagram_landscape",Ik.InstagramPortrait="imgly_transform_instagram_portrait",Ik.InstagramSquare="imgly_transform_instagram_square",Ik.InstagramStory="imgly_transform_instagram_story",Ik.TwitterPost="imgly_transform_twitter_post",Ik.TwitterProfile="imgly_transform_twitter_profile",Ik.TwitterTitle="imgly_transform_twitter_title",function(t){t.EXPORT="export",t.CLOSE="close",t.HISTORY_UNDO="historyUndo",t.HISTORY_REDO="historyRedo",t.HISTORY_CHANGE="historyChange",t.EDITOR_READY="editorReady",t.ERROR_IMAGE_LOADING="errorImageLoading",t.IMAGE_LOAD="imageLoad",t.TOOL_ENTER="toolEnter",t.STICKER_UPLOAD_ADD="stickerUploadAdd",t.ERROR_WEBGL_CONTEXT_LOST="errorWebGLContextLost",t.CROP_DIMENSIONS_CHANGE="cropDimensionsChange"}(Fk||(Fk={}));var Ek=class{constructor(){this.events={}}addListener(t,e){return(this.events[t]||(this.events[t]=[])).push(e),this}removeListener(t,e){const i=this.events[t];if(!i)return this;const s=i.lastIndexOf(e);return-1===s||i.splice(s,1),this}removeAllListeners(t){return this.events[t]=void 0,this}on(t,e){return this.addListener(t,e)}off(t,e){return this.removeListener(t,e)}emit(t,...e){const i=this.events[t];return!(!i||!i.length)&&(i.slice(0).forEach((t=>t.apply(null,e))),!0)}};C();var Ok=()=>"undefined"!==typeof window&&window.navigator&&window.navigator.userAgent||"",Ak=(t=Ok())=>-1!==t.indexOf("Edge"),Bk=(t=Ok())=>!!t.match(/msie|trident/i),Mk=(t=Ok())=>!!t.match(/windows/i),Pk=(t=Ok())=>-1!==t.indexOf("Safari")&&-1===t.indexOf("Chrome"),Lk=(t=Ok())=>!!t.match(/iP(hone|od|ad)|AppleWebKit/),zk=()=>{if("undefined"===typeof document)return!1;const t=document.createElement("canvas"),e=t.getContext("webgl")||t.getContext("experimental-webgl"),i=e&&e instanceof WebGLRenderingContext;return s(t),i};function Nk(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}var Uk,Gk,jk=class{static fromSize(t){return new jk(t.width,t.height)}static distance(t,e){const i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)}static dot(t,e){return t.x*e.x+t.y*e.y}static lerp(t,e,i){const s=Math.min(Math.max(i,0),1);return new jk(t.x*s+e.x*(1-s),t.y*s+e.y*(1-s))}static lerpUnclamped(t,e,i){return new jk(t.x*i+e.x*(1-i),t.y*i+e.y*(1-i))}static proportionalFit(t,e){return t.x/t.y>e.x/e.y?e.multiply(t.y/e.y):e.multiply(t.x/e.x)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}get normalized(){const t=this.magnitude;return new jk(this.x/t,this.y/t)}get floored(){return new jk(Math.floor(this.x),Math.floor(this.y))}get rounded(){return new jk(Math.round(this.x),Math.round(this.y))}get min(){return Math.min(this.x,this.y)}get max(){return Math.max(this.x,this.y)}get abs(){return new jk(Math.abs(this.x),Math.abs(this.y))}get swapped(){return new jk(this.y,this.x)}constructor(t,e){"number"===typeof t?(this.x=t,this.y=e):(this.x=t.x,this.y=t.y)}clone(){return new jk(this.x,this.y)}add(t,e){return"number"===typeof t?new jk(this.x+t,this.y+e):new jk(this.x+t.x,this.y+t.y)}subtract(t,e){return"number"===typeof t?new jk(this.x-t,this.y-e):new jk(this.x-t.x,this.y-t.y)}multiply(t,e){return"number"===typeof t?new jk(this.x*t,this.y*(void 0===e?t:e)):new jk(this.x*t.x,this.y*t.y)}divide(t,e){return"number"===typeof t?new jk(this.x/t,this.y/(void 0===e?t:e)):new jk(this.x/t.x,this.y/t.y)}equals(t){return this.x===t.x&&this.y===t.y}clamp(t,e){const i=Math.max(t.x,Math.min(e.x,this.x)),s=Math.max(t.y,Math.min(e.y,this.y));return new jk(i,s)}},Vk=jk;Vk.ZERO=new jk(0,0),Vk.ONE=new jk(1,1),Vk.UP=new jk(0,1),Vk.DOWN=new jk(0,-1),Vk.RIGHT=new jk(1,0),Vk.LEFT=new jk(-1,0),(Gk=Uk||(Uk={}))[Gk.EditorContainer=0]="EditorContainer",Gk[Gk.ToolControlBar=1]="ToolControlBar",Gk[Gk.ToolControlBarExpandableControls=2]="ToolControlBarExpandableControls",Gk[Gk.CanvasContainer=3]="CanvasContainer",Gk[Gk.Canvas=4]="Canvas",Gk[Gk.MainBarButtonClose=5]="MainBarButtonClose",Gk[Gk.MainBarButtonExport=6]="MainBarButtonExport",Gk[Gk.MainBarButtonUndo=7]="MainBarButtonUndo",Gk[Gk.MainBarButtonRedo=8]="MainBarButtonRedo",Gk[Gk.MainBarButtonZoom=9]="MainBarButtonZoom",Gk[Gk.Tooltip=10]="Tooltip",Gk[Gk.Cursor=11]="Cursor",Gk[Gk.CursorContainer=12]="CursorContainer",Gk[Gk.NummericInput=13]="NummericInput",Gk[Gk.BrushSize=14]="BrushSize",Gk[Gk.BrushHardness=15]="BrushHardness",Gk[Gk.Dialog=16]="Dialog",Gk[Gk.DialogBody=17]="DialogBody",Gk[Gk.CardContainer=18]="CardContainer",Gk[Gk.CategoryItemsContainer=19]="CategoryItemsContainer",Gk[Gk.ToolbarItem=20]="ToolbarItem",Gk[Gk.ColorList=21]="ColorList",Gk[Gk.NoResult=22]="NoResult",Gk[Gk.CardLabel=23]="CardLabel",Gk[Gk.CardAvatar=24]="CardAvatar",Gk[Gk.Dropdown=25]="Dropdown",Gk[Gk.DropdownList=26]="DropdownList",Gk[Gk.TextAlignment=27]="TextAlignment",Gk[Gk.Sprite=28]="Sprite",Gk[Gk.SpriteTopLeft=29]="SpriteTopLeft",Gk[Gk.SpriteTopRight=30]="SpriteTopRight",Gk[Gk.SpriteBottomLeft=31]="SpriteBottomLeft",Gk[Gk.SpriteBottomRight=32]="SpriteBottomRight",Gk[Gk.Knob=33]="Knob",Gk[Gk.TextWidth=34]="TextWidth",Gk[Gk.ToolbarWrapper=35]="ToolbarWrapper",Gk[Gk.MainCanvasActionBar=36]="MainCanvasActionBar",Gk[Gk.SpriteActions=37]="SpriteActions",Gk[Gk.CarouselSlider=38]="CarouselSlider",Gk[Gk.CropMask=39]="CropMask",Gk[Gk.FlipRotateControls=40]="FlipRotateControls",Gk[Gk.RotateSlider=41]="RotateSlider",Gk[Gk.CropTopRight=42]="CropTopRight",Gk[Gk.CropTopLeft=43]="CropTopLeft",Gk[Gk.CropBottomRight=44]="CropBottomRight",Gk[Gk.CropBottomLeft=45]="CropBottomLeft",Gk[Gk.Watermark=46]="Watermark",Gk[Gk.Toolbar=47]="Toolbar",Gk[Gk.CanvasBar=48]="CanvasBar",Gk[Gk.Checkbox=49]="Checkbox",Gk[Gk.Focus=50]="Focus",Gk[Gk.SnappingLine=51]="SnappingLine",Gk[Gk.LibraryUploadButton=52]="LibraryUploadButton",Gk[Gk.LibraryWebcamButton=53]="LibraryWebcamButton",Gk[Gk.ZoomLevel=54]="ZoomLevel",Gk[Gk.BasicToolControlBar=55]="BasicToolControlBar";var Wk={};for(const $C in Uk){const t=Uk[$C];"string"===typeof t&&(Wk[t]=t)}var Hk,qk=Wk;Boolean("undefined"!==typeof window&&(null==(Hk=window.Cypress)?void 0:Hk.env("pesdk")));R();var Xk={};function Yk(){if("undefined"===typeof navigator)return!1;const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}w(Xk,{isMobile:()=>Yk});var Jk,Kk=t=>{t.preventDefault(),t.stopPropagation()},Zk=("undefined"!==typeof window&&window.performance.now.bind(window.performance),class{constructor(t){this.text=t,this.lastOffsetWidth=-1;const e="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.element=document.createElement("div"),this.element.setAttribute("aria-hidden","true"),this.element.appendChild(document.createTextNode(t)),this.collapsible=document.createElement("span"),this.expandable=document.createElement("span"),this.collapsibleInner=document.createElement("span"),this.expandableInner=document.createElement("span"),this.collapsible.style.cssText=e,this.expandable.style.cssText=e,this.expandableInner.style.cssText=e,this.collapsibleInner.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.collapsible.appendChild(this.collapsibleInner),this.expandable.appendChild(this.expandableInner),this.element.appendChild(this.collapsible),this.element.appendChild(this.expandable)}getElement(){return this.element}setFont(t){this.element.style.cssText=`max-width:none;\n      min-width:20px;\n      min-height:20px;\n      display:inline-block;\n      overflow:hidden;\n      position:absolute;\n      width:auto;\n      margin:0;\n      padding:0;\n      top:-999px;\n      white-space:nowrap;\n      font-synthesis:none;\n      font:${t};`}getWidth(){return this.element.offsetWidth}setWidth(t){this.element.style.width=`${t}px`}onResize(t){const e=()=>{this.onScroll(t)};this.collapsible.addEventListener("scroll",e),this.expandable.addEventListener("scroll",e),this.reset()}reset(){const t=this.getWidth(),e=t+100;return this.expandableInner.style.width=`${e}px`,this.expandable.scrollLeft=e,this.collapsible.scrollLeft=this.collapsible.scrollWidth+100,this.lastOffsetWidth!==t&&(this.lastOffsetWidth=t,!0)}onScroll(t){this.reset()&&null!==this.element.parentNode&&t(this.lastOffsetWidth)}}),Qk=class{static getUserAgent(){return window.navigator.userAgent}static getNavigatorVendor(){return window.navigator.vendor}static hasWebKitFallbackBug(){if(null===Qk.HAS_WEBKIT_FALLBACK_BUG){const t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(Qk.getUserAgent());Qk.HAS_WEBKIT_FALLBACK_BUG=!!t&&(parseInt(t[1],10)<536||536===parseInt(t[1],10)&&parseInt(t[2],10)<=11)}return Qk.HAS_WEBKIT_FALLBACK_BUG}static hasSafari10Bug(){if(null===Qk.HAS_SAFARI_10_BUG)if(Qk.supportsNativeFontLoading()&&/Apple/.test(Qk.getNavigatorVendor())){const t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(Qk.getUserAgent());Qk.HAS_SAFARI_10_BUG=!!t&&parseInt(t[1],10)<603}else Qk.HAS_SAFARI_10_BUG=!1;return Qk.HAS_SAFARI_10_BUG}static supportsNativeFontLoading(){return null===Qk.SUPPORTS_NATIVE_FONT_LOADING&&(Qk.SUPPORTS_NATIVE_FONT_LOADING=!!document.fonts),Qk.SUPPORTS_NATIVE_FONT_LOADING}static supportsStretch(){if(null===Qk.SUPPORTS_STRETCH){const t=document.createElement("div");try{t.style.font="condensend 100px sans-serif"}catch(yD){Qk.SUPPORTS_STRETCH=!1}Qk.SUPPORTS_STRETCH=""!==t.style.font}return Qk.SUPPORTS_STRETCH}constructor(t){this.font={fontFamily:"normal",fontStyle:"normal",fontWeight:"normal",fontStretch:"normal",...t}}load(t,e){const i="BESbswy";let s=null;const r=e||Qk.DEFAULT_TIMEOUT,n=this.getTime();return new Promise(((t,e)=>{if(Qk.supportsNativeFontLoading()&&!Qk.hasSafari10Bug()){const o=new Promise(((t,s)=>{const o=()=>{this.getTime()-n>=r?s(new Error(r+"ms timeout exceeded")):document.fonts.load(this.getStyle(`"${this.font.fontFamily}"`),i).then((e=>{e.length>=1?t():setTimeout(o,25)}),e)};o()})),a=new Promise(((t,e)=>{s=setTimeout((()=>{e(new Error(`${r} ms timeout exceeded`))}),r)}));Promise.race([a,o]).then((()=>{clearTimeout(s),t(this)}),e)}else{const o=new Zk(i),a=new Zk(i),l=new Zk(i);let h=-1,u=-1,c=-1,d=-1,_=-1,m=-1;const g=document.createElement("div"),p=()=>{null!==g.parentNode&&g.parentNode.removeChild(g)},f=()=>{if((-1!==h&&-1!==u||-1!==h&&-1!==c||-1!==u&&-1!==c)&&(h===u||h===c||u===c)){if(Qk.hasWebKitFallbackBug()&&(h===d&&u===d&&c===d||h===_&&u===_&&c===_||h===m&&u===m&&c===m))return;p(),clearTimeout(s),t(this)}};g.dir="ltr",o.setFont(this.getStyle("sans-serif")),a.setFont(this.getStyle("serif")),l.setFont(this.getStyle("monospace")),g.appendChild(o.getElement()),g.appendChild(a.getElement()),g.appendChild(l.getElement()),document.body.appendChild(g),d=o.getWidth(),_=a.getWidth(),m=l.getWidth();const y=()=>{if(this.getTime()-n>=r)p(),e(new Error(`${r} ms timeout exceeded`));else{const t=document.hidden;!0!==t&&void 0!==t||(h=o.getWidth(),u=a.getWidth(),c=l.getWidth(),f()),s=setTimeout(y,50)}};y(),o.onResize((t=>{h=t,f()})),o.setFont(this.getStyle(`"${this.font.fontFamily}",sans-serif`)),a.onResize((t=>{u=t,f()})),a.setFont(this.getStyle(`"${this.font.fontFamily}",serif`)),l.onResize((t=>{c=t,f()})),l.setFont(this.getStyle(`"${this.font.fontFamily}",monospace`))}}))}getStyle(t){return[this.font.fontStyle,this.font.fontWeight,Qk.supportsStretch()?this.font.fontStretch:"","100px",t].join(" ")}getTime(){return(new Date).getTime()}},$k=Qk;$k.HAS_WEBKIT_FALLBACK_BUG=null,$k.HAS_SAFARI_10_BUG=null,$k.SUPPORTS_STRETCH=null,$k.SUPPORTS_NATIVE_FONT_LOADING=null,$k.DEFAULT_TIMEOUT=6e4,function(t){t.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",t.IMAGE_DOWNSCALED="imageDownscaled"}(Jk||(Jk={}));var tT=class extends Ek{constructor(t,e){super(),this.image=t,this.options=e}needsResize(){const t=this.resizedDimensions();return t.x<this.image.width||t.y<this.image.height}resizedDimensions(){const{options:t}=this,e={width:this.image.width,height:this.image.height};let i=Vk.fromSize(e),s=Vk.fromSize(e);const{maxMegaPixels:r}=t;if(r){const t=1e6*(Yk()?r.mobile:r.desktop),s=e.width/e.height,n=e.height/e.width,o=new Vk(Math.floor(Math.sqrt(t*s)),Math.floor(Math.sqrt(t*n)));o.x<=e.width&&o.y<=e.height&&(i=o)}const n=t.maxDimensions;n&&(n.height<e.height||n.width<e.width)&&(s=new Vk(n.width,n.height));const o=new Vk(Math.min(i.x,s.x),Math.min(i.y,s.y));return Vk.proportionalFit(o,Vk.fromSize(e)).floored}downscaleIfNecessary(){const t=this.resizedDimensions();if(!(t.x<this.image.width||t.y<this.image.height))return this.image;this.emit(Jk.BEGAN_IMAGE_DOWNSCALING,this.image);const e=document.createElement("canvas");e.width=t.x,e.height=t.y;const i=e.getContext("2d"),{image:s}=this;return i.imageSmoothingQuality="high",i.drawImage(s,0,0,s.width,s.height,0,0,t.x,t.y),this.emit(Jk.IMAGE_DOWNSCALED,{width:t.x,height:t.y}),e}downscaleImageIfNecessary(){const t=this.image,e=this.resizedDimensions();if(!(e.x<this.image.width||e.y<this.image.height))return t;this.emit(Jk.BEGAN_IMAGE_DOWNSCALING,t);const i=new Image;return i.width=e.x,i.height=e.y,i.src=t.src,this.emit(Jk.IMAGE_DOWNSCALED,{width:e.x,height:e.y}),i}},eT=t=>e=>{(t=>"Enter"===t.key)(e)&&t(e)},iT=t=>e=>{(t=>"Escape"===t.key)(e)&&t(e)};var sT=(...t)=>function(t){const e=function(t){return"/"===t.charAt(0)}(t),i="/"===t.substr(-1);return t=function(t,e){let i=0;for(let s=t.length-1;s>=0;s--){const e=t[s];"."===e?t.splice(s,1):".."===e?(t.splice(s,1),i++):i&&(t.splice(s,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}(t.split("/").filter(Boolean),!e).join("/"),t||e||(t="."),t&&i&&(t+="/"),(e?"/":"")+t}(t.join("/")),rT=D(I()),nT=(t,e,[i,s],r=0)=>{const n=t[e];if(n){if(n<i)return console.error(`${e} must be greater than or equal to ${i}`),i;if(n>s)return console.error(`${e} must be less than or equal to ${s}`),s}return n||r},oT=(t,e,i=[1,1,1,1])=>{const s=t[e];let r=!0;return s&&s.forEach((t=>{t<0&&(console.error(`${t} in ${e} must be greater than or equal to 0`),r=!1),t>1&&(console.error(`${t} in ${e} must be less than or equal to 1`),r=!1)})),r&&s||i},aT=t=>.08*t,lT=t=>.03*t,hT={},uT=({src:t,crossOrigin:e,key:i,resolve:s,reject:r})=>{hT[i]=t;const n=new Image;n.onload=()=>{hT[i]===t&&(s(n),delete hT[i])},n.onerror=e=>{hT[i]===t&&(r(e),delete hT[i])},n.crossOrigin=e,n.src=t},cT=class extends Error{constructor(t){super(t),this.name="AssetNotFoundError"}},dT=()=>Math.max(window.devicePixelRatio||1,1),_T=new RegExp(/\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83D\uDC68\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83D\uDC68\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83D\uDC68\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83D\uDC68\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC69(?:\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFC-\uDFFF]))|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68\u200D(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D(?:\uD83D[\uDC68\uDC69])|\uD83E\uDDD1\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC68(?:\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|(?:\uD83D[\uDC67-\uDC69])\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]\uFE0F)|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83C\uDFF3\uFE0F\u200D\u26A7|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF]))\u200D[\u2695\u2696\u2708]\uFE0F|\uD83D\uDC69\u200D(?:\uD83D[\uDC67\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D\uDC3B\u200D\u2744|\uD83C\uDFF4\u200D\u2620|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDF])\u200D[\u2640\u2642])\uFE0F|\uD83E\uDDD1\u200D[\u2695\u2696\u2708]\uFE0F|(?:\uD83D[\uDC68\uDC69])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D[\u2695\u2696\u2708]\uFE0F)|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC08\u200D\u2B1B|\uD83E\uDDD1\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDC66\uDC67\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|(?:[\u270A\u270B]|\uD83C[\uDF85\uDFC3\uDFC7]|\uD83D[\uDC43\uDC4A-\uDC4C\uDC4F\uDC50\uDC66-\uDC69\uDC6B-\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD7A\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270C\u270D]|\uD83C[\uDFC2\uDFC4\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC46-\uDC49\uDC4D\uDC4E\uDD74\uDD75\uDD90])(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9\u23EA\u23ED-\u23EF\u23F1-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7\u26F8\u26FA\u26FD\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2753\u2757\u2763\u2764\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE1A\uDE2F\uDE37\uDF0D-\uDF0F\uDF15\uDF1C\uDF21\uDF24-\uDF2C\uDF36\uDF78\uDF7D\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFA7\uDFAC-\uDFAE\uDFC6\uDFCD\uDFCE\uDFD4-\uDFE0\uDFED\uDFF3\uDFF5\uDFF7]|\uD83D[\uDC08\uDC15\uDC1F\uDC26\uDC3F\uDC41\uDC53\uDC6A\uDC7D\uDCA3\uDCB0\uDCB3\uDCBB\uDCBF\uDCCB\uDCDA\uDCDF\uDCE4-\uDCE6\uDCEA-\uDCED\uDCF7\uDCF9-\uDCFB\uDCFD\uDD08\uDD0D\uDD12\uDD13\uDD49\uDD4A\uDD50-\uDD67\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDE10\uDE87\uDE8D\uDE91\uDE94\uDE98\uDEAD\uDEB2\uDEB9\uDEBA\uDEBC\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])\uFE0F|[\u23E9-\u23F3\u23F8-\u23FA\u25FB-\u25FE\u2614\u2615\u267F\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6]/g),mT=t=>t.replace(_T,""),gT=t=>{try{return new URL(t),!0}catch(e){return!1}},pT=t=>t instanceof HTMLImageElement,fT=[{identifier:"basics",name:"Basics",items:[{identifier:AD.BRIGHTNESS},{identifier:AD.CONTRAST},{identifier:AD.SATURATION},{identifier:AD.GAMMA}]},{identifier:"refinements",name:"Refinements",items:[{identifier:AD.CLARITY},{identifier:AD.SHADOWS},{identifier:AD.HIGHLIGHTS},{identifier:AD.EXPOSURE},{identifier:AD.BLACKS},{identifier:AD.WHITES},{identifier:AD.TEMPERATURE},{identifier:AD.SHARPNESS}]}],yT=[{identifier:GD.DuoTone,name:"DuoTone",thumbnailURI:"./categories/duotone.jpg",items:[{identifier:ND.Desert,name:"Desert",thumbnailURI:"./items/imgly_duotone_desert.jpg",lightColor:"#e1de9a",darkColor:"#cb2129",defaultIntensity:.5},{identifier:ND.Peach,name:"Peach",thumbnailURI:"./items/imgly_duotone_peach.jpg",lightColor:"#e9abb8",darkColor:"#0040ff",defaultIntensity:.5},{identifier:ND.Clash,name:"Clash",thumbnailURI:"./items/imgly_duotone_clash.jpg",lightColor:"#f41a0f",darkColor:"#23007c",defaultIntensity:.5},{identifier:ND.Plum,name:"Plum",thumbnailURI:"./items/imgly_duotone_plum.jpg",lightColor:"#74d7ff",darkColor:"#23007c",defaultIntensity:.5},{identifier:ND.Breezy,name:"Breezy",thumbnailURI:"./items/imgly_duotone_breezy.jpg",lightColor:"#68fdff",darkColor:"#c20000",defaultIntensity:.5},{identifier:ND.DeepBlue,name:"Deep Blue",thumbnailURI:"./items/imgly_duotone_deepblue.jpg",lightColor:"#2de9eb",darkColor:"#58007c",defaultIntensity:.5},{identifier:ND.Frog,name:"Frog",thumbnailURI:"./items/imgly_duotone_frog.jpg",lightColor:"#5bff60",darkColor:"#7f23a9",defaultIntensity:.5},{identifier:ND.Sunset,name:"Sunset",thumbnailURI:"./items/imgly_duotone_sunset.jpg",lightColor:"#f8ea46",darkColor:"#c400be",defaultIntensity:.5}]},{identifier:GD.BW,name:"B & W",thumbnailURI:"./categories/b&w.jpg",items:[{identifier:ND.AD1920,name:"1920 A.D.",thumbnailURI:"./items/imgly_lut_ad1920.jpg",lutURI:"./items/imgly_lut_ad1920_5_5_128.png",defaultIntensity:1},{identifier:ND.Greyed,name:"Greyed",thumbnailURI:"./items/imgly_lut_bw.jpg",lutURI:"./items/imgly_lut_bw_5_5_128.png",defaultIntensity:1},{identifier:ND.Dusty,name:"Dusty",thumbnailURI:"./items/imgly_lut_x400.jpg",lutURI:"./items/imgly_lut_dusty_5_5_128.png",defaultIntensity:1},{identifier:ND.Litho,name:"Litho",thumbnailURI:"./items/imgly_lut_litho.jpg",lutURI:"./items/imgly_lut_litho_5_5_128.png",defaultIntensity:1},{identifier:ND.Sepia,name:"Sepia",thumbnailURI:"./items/imgly_lut_sepiahigh.jpg",lutURI:"./items/imgly_lut_sepia_5_5_128.png",defaultIntensity:1},{identifier:ND.Weathered,name:"Weathered",thumbnailURI:"./items/imgly_lut_plate.jpg",lutURI:"./items/imgly_lut_weathered_5_5_128.png",defaultIntensity:1},{identifier:ND.HardStuff,name:"Hard Stuff",thumbnailURI:"./items/imgly_lut_sin.jpg",lutURI:"./items/imgly_lut_hard_stuff_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8}]},{identifier:GD.Vintage,name:"Vintage",thumbnailURI:"./categories/vintage.jpg",items:[{identifier:ND.Polaroid,name:"Polaroid",thumbnailURI:"./items/imgly_lut_blues.jpg",lutURI:"./items/imgly_lut_polaroid_5_5_128.png",defaultIntensity:1},{identifier:ND.Sunny70s,name:"Sunny 70s",thumbnailURI:"./items/imgly_lut_front.jpg",lutURI:"./items/imgly_lut_sunny_70s_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:ND.Oldtimer,name:"Oldtimer",thumbnailURI:"./items/imgly_lut_texas.jpg",lutURI:"./items/imgly_lut_oldtimer_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:ND.Inferno,name:"Inferno",thumbnailURI:"./items/imgly_lut_celsius.jpg",lutURI:"./items/imgly_lut_inferno_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:ND.Snappy,name:"Snappy",thumbnailURI:"./items/imgly_lut_cool.jpg",lutURI:"./items/imgly_lut_snappy_5_5_128.png",defaultIntensity:1}]},{identifier:GD.Smooth,name:"Smooth",thumbnailURI:"./categories/smooth.jpg",items:[{identifier:ND.Chestnut,name:"Chestnut",thumbnailURI:"./items/imgly_lut_chest.jpg",lutURI:"./items/imgly_lut_chestnut_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:ND.Softy,name:"Softy",thumbnailURI:"./items/imgly_lut_winter.jpg",lutURI:"./items/imgly_lut_softly_5_5_128.png",defaultIntensity:1},{identifier:ND.Pebble,name:"Pebble",thumbnailURI:"./items/imgly_lut_kdynamic.jpg",lutURI:"./items/imgly_lut_pebble_5_5_128.png",defaultIntensity:1},{identifier:ND.Moss,name:"Moss",thumbnailURI:"./items/imgly_lut_fall.jpg",lutURI:"./items/imgly_lut_moss_5_5_128.png",defaultIntensity:1},{identifier:ND.Lemon,name:"Lemon",thumbnailURI:"./items/imgly_lut_lenin.jpg",lutURI:"./items/imgly_lut_lemon_5_5_128.png",defaultIntensity:1},{identifier:ND.GreenGap,name:"Green Gap",thumbnailURI:"./items/imgly_lut_pola669.jpg",lutURI:"./items/imgly_lut_green_gap_5_5_128.png",defaultIntensity:1}]},{identifier:GD.Cold,name:"Cold",thumbnailURI:"./categories/cold.jpg",items:[{identifier:ND.Colla,name:"Colla",thumbnailURI:"./items/imgly_lut_elder.jpg",lutURI:"./items/imgly_lut_colla_5_5_128.png",defaultIntensity:1},{identifier:ND.Solanus,name:"Solanus",thumbnailURI:"./items/imgly_lut_orchid.jpg",lutURI:"./items/imgly_lut_solanus_5_5_128.png",defaultIntensity:1},{identifier:ND.Kalmen,name:"Kalmen",thumbnailURI:"./items/imgly_lut_bleached.jpg",lutURI:"./items/imgly_lut_kalmen_5_5_128.png",defaultIntensity:1},{identifier:ND.Joran,name:"Joran",thumbnailURI:"./items/imgly_lut_bleachedblue.jpg",lutURI:"./items/imgly_lut_joran_5_5_128.png",defaultIntensity:1},{identifier:ND.Levante,name:"Levante",thumbnailURI:"./items/imgly_lut_breeze.jpg",lutURI:"./items/imgly_lut_levante_5_5_128.png",defaultIntensity:1},{identifier:ND.Zephyr,name:"Zephyr",thumbnailURI:"./items/imgly_lut_blueshadows.jpg",lutURI:"./items/imgly_lut_zephyr_5_5_128.png",defaultIntensity:1}]},{identifier:GD.Warm,name:"Warm",thumbnailURI:"./categories/warm.jpg",items:[{identifier:ND.Golden,name:"Golden",thumbnailURI:"./items/imgly_lut_sunset.jpg",lutURI:"./items/imgly_lut_golden_5_5_128.png",defaultIntensity:1},{identifier:ND.LowFire,name:"Low Fire",thumbnailURI:"./items/imgly_lut_eighties.jpg",lutURI:"./items/imgly_lut_low_fire_5_5_128.png",defaultIntensity:1},{identifier:ND.Sunrise,name:"Sunrise",thumbnailURI:"./items/imgly_lut_evening.jpg",lutURI:"./items/imgly_lut_sunrise_5_5_128.png",defaultIntensity:1},{identifier:ND.FlatBlack,name:"Flat Black",thumbnailURI:"./items/imgly_lut_k2.jpg",lutURI:"./items/imgly_lut_flat_black_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:ND.Pumpkin,name:"Pumpkin",thumbnailURI:"./items/imgly_lut_nogreen.jpg",lutURI:"./items/imgly_lut_pumpkin_5_5_128.png",defaultIntensity:1}]},{identifier:GD.Legacy,name:"Legacy",thumbnailURI:"./categories/legacy.jpg",items:[{identifier:ND.Ancient,name:"Ancient",thumbnailURI:"./items/imgly_lut_ancient.jpg",lutURI:"./items/imgly_lut_ancient_5_5_128.png",defaultIntensity:1},{identifier:ND.Candy,name:"Candy",thumbnailURI:"./items/imgly_lut_cottoncandy.jpg",lutURI:"./items/imgly_lut_cottoncandy_5_5_128.png",defaultIntensity:1},{identifier:ND.Classic,name:"Classic",thumbnailURI:"./items/imgly_lut_classic.jpg",lutURI:"./items/imgly_lut_classic_5_5_128.png",defaultIntensity:1},{identifier:ND.Colorful,name:"Colorful",thumbnailURI:"./items/imgly_lut_colorful.jpg",lutURI:"./items/imgly_lut_colorful_5_5_128.png",defaultIntensity:1},{identifier:ND.Creamy,name:"Creamy",thumbnailURI:"./items/imgly_lut_creamy.jpg",lutURI:"./items/imgly_lut_creamy_5_5_128.png",defaultIntensity:1},{identifier:ND.Fixie,name:"Fixie",thumbnailURI:"./items/imgly_lut_fixie.jpg",lutURI:"./items/imgly_lut_fixie_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:ND.Food,name:"Food",thumbnailURI:"./items/imgly_lut_food.jpg",lutURI:"./items/imgly_lut_food_5_5_128.png",defaultIntensity:1},{identifier:ND.Fridge,name:"Fridge",thumbnailURI:"./items/imgly_lut_fridge.jpg",lutURI:"./items/imgly_lut_fridge_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:ND.Glam,name:"Glam",thumbnailURI:"./items/imgly_lut_glam.jpg",lutURI:"./items/imgly_lut_glam_5_5_128.png",defaultIntensity:1},{identifier:ND.Gobblin,name:"Gobblin",thumbnailURI:"./items/imgly_lut_gobblin.jpg",lutURI:"./items/imgly_lut_gobblin_5_5_128.png",defaultIntensity:1},{identifier:ND.Hicon,name:"Hicon",thumbnailURI:"./items/imgly_lut_highcontrast.jpg",lutURI:"./items/imgly_lut_highcontrast_5_5_128.png",defaultIntensity:1},{identifier:ND.HighCarb,name:"High Carb",thumbnailURI:"./items/imgly_lut_highcarb.jpg",lutURI:"./items/imgly_lut_highcarb_5_5_128.png",defaultIntensity:1},{identifier:ND.K1,name:"K1",thumbnailURI:"./items/imgly_lut_k1.jpg",lutURI:"./items/imgly_lut_k1_5_5_128.png",defaultIntensity:1},{identifier:ND.K6,name:"K6",thumbnailURI:"./items/imgly_lut_k6.jpg",lutURI:"./items/imgly_lut_k6_5_5_128.png",defaultIntensity:1},{identifier:ND.Keen,name:"Keen",thumbnailURI:"./items/imgly_lut_keen.jpg",lutURI:"./items/imgly_lut_keen_5_5_128.png",defaultIntensity:1},{identifier:ND.Lomo,name:"Lomo",thumbnailURI:"./items/imgly_lut_lomo.jpg",lutURI:"./items/imgly_lut_lomo_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:ND.Lomo100,name:"Lomo 100",thumbnailURI:"./items/imgly_lut_lomo100.jpg",lutURI:"./items/imgly_lut_lomo100_5_5_128.png",defaultIntensity:1},{identifier:ND.Lucid,name:"Lucid",thumbnailURI:"./items/imgly_lut_lucid.jpg",lutURI:"./items/imgly_lut_lucid_5_5_128.png",defaultIntensity:1},{identifier:ND.Mellow,name:"Mellow",thumbnailURI:"./items/imgly_lut_mellow.jpg",lutURI:"./items/imgly_lut_mellow_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:ND.Neat,name:"Neat",thumbnailURI:"./items/imgly_lut_neat.jpg",lutURI:"./items/imgly_lut_neat_5_5_128.png",defaultIntensity:1},{identifier:ND.Pale,name:"Pale",thumbnailURI:"./items/imgly_lut_pale.jpg",lutURI:"./items/imgly_lut_pale_5_5_128.png",defaultIntensity:1},{identifier:ND.Pitched,name:"Pitched",thumbnailURI:"./items/imgly_lut_pitched.jpg",lutURI:"./items/imgly_lut_pitched_5_5_128.png",defaultIntensity:1},{identifier:ND.PolaSX,name:"Pola SX",thumbnailURI:"./items/imgly_lut_polasx.jpg",lutURI:"./items/imgly_lut_polasx_5_5_128.png",defaultIntensity:1},{identifier:ND.Pro400,name:"Pro 400",thumbnailURI:"./items/imgly_lut_pro400.jpg",lutURI:"./items/imgly_lut_pro400_5_5_128.png",defaultIntensity:1},{identifier:ND.Quozi,name:"Quozi",thumbnailURI:"./items/imgly_lut_quozi.jpg",lutURI:"./items/imgly_lut_quozi_5_5_128.png",defaultIntensity:1},{identifier:ND.Settled,name:"Settled",thumbnailURI:"./items/imgly_lut_settled.jpg",lutURI:"./items/imgly_lut_settled_5_5_128.png",defaultIntensity:1},{identifier:ND.Seventies,name:"Seventies",thumbnailURI:"./items/imgly_lut_seventies.jpg",lutURI:"./items/imgly_lut_seventies_5_5_128.png",defaultIntensity:1},{identifier:ND.Soft,name:"Soft",thumbnailURI:"./items/imgly_lut_soft.jpg",lutURI:"./items/imgly_lut_soft_5_5_128.png",defaultIntensity:1},{identifier:ND.Steel,name:"Steel",thumbnailURI:"./items/imgly_lut_steel.jpg",lutURI:"./items/imgly_lut_steel_5_5_128.png",defaultIntensity:1},{identifier:ND.Summer,name:"Summer",thumbnailURI:"./items/imgly_lut_summer.jpg",lutURI:"./items/imgly_lut_summer_5_5_128.png",defaultIntensity:1},{identifier:ND.Tender,name:"Tender",thumbnailURI:"./items/imgly_lut_tender.jpg",lutURI:"./items/imgly_lut_tender_5_5_128.png",defaultIntensity:1},{identifier:ND.Twilight,name:"Twilight",thumbnailURI:"./items/imgly_lut_twilight.jpg",lutURI:"./items/imgly_lut_twilight_5_5_128.png",defaultIntensity:1}]}],xT=[{identifier:XD.RADIAL,thumbnailURI:"./items/radial.png"},{identifier:XD.MIRRORED,thumbnailURI:"./items/mirrored.png"},{identifier:XD.LINEAR,thumbnailURI:"./items/linear.png"},{identifier:XD.GAUSSIAN,thumbnailURI:"./items/gaussian.png"}],bT=[{identifier:"imgly_font_open_sans_bold",fontFamily:"Open Sans",fontWeight:"bold",fontURI:"./fonts/imgly_font_open_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}},{identifier:"imgly_font_aleo_bold",fontFamily:"Aleo",fontWeight:"bold",fontURI:"./fonts/imgly_font_aleo_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}},{identifier:"imgly_font_amaticsc",fontFamily:"Amatic SC",fontWeight:"normal",fontURI:"./fonts/imgly_font_amaticsc.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}},{identifier:"imgly_font_archivo_black",fontFamily:"Archivo",fontWeight:"normal",fontURI:"./fonts/imgly_font_archivo_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}},{identifier:"imgly_font_bungee_inline",fontFamily:"Bungee Inline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_bungee_inline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}},{identifier:"imgly_font_fira_sans_regular",fontFamily:"Fira Sans",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_fira_sans_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}},{identifier:"imgly_font_campton_bold",fontFamily:"Campton Book",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_campton_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}},{identifier:"imgly_font_carter_one",fontFamily:"Carter One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_carter_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}},{identifier:"imgly_font_codystar",fontFamily:"Codystar",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_codystar.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}},{identifier:"imgly_font_galano_grotesque_bold",fontFamily:"Galano Grotesque",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_galano_grotesque_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_krona_one",fontFamily:"Krona One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_krona_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}},{identifier:"imgly_font_kumar_one_outline",fontFamily:"Kumar One Outline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_kumar_one_outline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}},{identifier:"imgly_font_lobster",fontFamily:"Lobster",fontWeight:"normal",fontURI:"./fonts/imgly_font_lobster.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}},{identifier:"imgly_font_molle",fontFamily:"Molle",fontWeight:"normal",fontStyle:"italic",fontURI:"./fonts/imgly_font_molle.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}},{identifier:"imgly_font_monoton",fontFamily:"Monoton",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_monoton.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}},{identifier:"imgly_font_nixie_one",fontFamily:"Nixie One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_nixie_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}},{identifier:"imgly_font_notable",fontFamily:"Notable",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_notable.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}},{identifier:"imgly_font_ostrich_sans_black",fontFamily:"Ostrich",fontWeight:800,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontFamily:"Ostrich",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_oswald_semi_bold",fontFamily:"Oswald SemiBold",googleFamily:"Oswald",fontWeight:600,fontStyle:"normal",fontURI:"./fonts/imgly_font_oswald_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}},{identifier:"imgly_font_palanquin_dark_semi_bold",fontFamily:"Palanquin Dark SemiBold",googleFamily:"Palanquin Dark",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_palanquin_dark_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}},{identifier:"imgly_font_poppins",fontFamily:"Poppins",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_poppins.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}},{identifier:"imgly_font_permanent_marker",fontFamily:"Permanent Marker",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_permanent_marker.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}},{identifier:"imgly_font_roboto_black_italic",fontFamily:"Roboto Black",fontWeight:"bold",fontStyle:"italic",googleFamily:"Roboto",fontURI:"./fonts/imgly_font_roboto_black_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontFamily:"Roboto Light",googleFamily:"Roboto",fontWeight:300,fontStyle:"italic",fontURI:"./fonts/imgly_font_roboto_light_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sancreek",fontFamily:"Sancreek",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sancreek.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}},{identifier:"imgly_font_stint_ultra_expanded",fontFamily:"Stint Ultra Expanded",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_stint_ultra_expanded.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}},{identifier:"imgly_font_trash_hand",fontFamily:"Trash Hand",fontWeight:"normal",fontURI:"./fonts/imgly_font_trash_hand.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}},{identifier:"imgly_font_vt323",fontFamily:"VT323",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_vt323.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_yeseva_one",fontFamily:"Yeseva One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_yeseva_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}},{identifier:"imgly_font_abril_fatface_regular",fontFamily:"Abril Fatface",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_abril_fatface_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}},{identifier:"imgly_font_amberlight",fontFamily:"Amberlight",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_amberlight.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}},{identifier:"imgly_font_montserrat_light",fontFamily:"Montserrat Light",googleFamily:"Montserrat",fontWeight:300,fontStyle:"normal",fontURI:"./fonts/imgly_font_montserrat_light.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}},{identifier:"imgly_font_handycheera_regular",fontFamily:"Handycheera",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_handycheera_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}},{identifier:"imgly_font_ostrich_sans_heavy",fontFamily:"Ostrich",fontWeight:900,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_heavy.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}},{identifier:"imgly_font_petit_formal_script",fontFamily:"Petit Formal Script",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_petit_formal_script.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}},{identifier:"imgly_font_rasa_500",fontFamily:"Rasa",fontWeight:500,fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_500.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_regular",fontFamily:"Rasa",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_regular.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_roboto_black",fontFamily:"Roboto Black",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_black.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light",fontFamily:"Roboto Light",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_light.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sue_ellen_francisco",fontFamily:"Sue Ellen Francisco",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sue_ellen_francisco.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}},{identifier:"imgly_font_ultra",fontFamily:"Ultra",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_ultra.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}},{identifier:"imgly_font_wolesbro",fontFamily:"Wolesbro",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_wolesbro.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}],vT=["imgly_font_open_sans_bold","imgly_font_aleo_bold","imgly_font_amaticsc","imgly_font_archivo_black","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_carter_one","imgly_font_codystar","imgly_font_fira_sans_regular","imgly_font_galano_grotesque_bold","imgly_font_krona_one","imgly_font_kumar_one_outline","imgly_font_lobster","imgly_font_molle","imgly_font_monoton","imgly_font_nixie_one","imgly_font_notable","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_oswald_semi_bold","imgly_font_palanquin_dark_semi_bold","imgly_font_poppins","imgly_font_permanent_marker","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sancreek","imgly_font_stint_ultra_expanded","imgly_font_trash_hand","imgly_font_vt323","imgly_font_yeseva_one"],wT=["imgly_font_abril_fatface_regular","imgly_font_amberlight","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_galano_grotesque_bold","imgly_font_handycheera_regular","imgly_font_montserrat_light","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_heavy","imgly_font_permanent_marker","imgly_font_petit_formal_script","imgly_font_rasa_500","imgly_font_rasa_regular","imgly_font_roboto_black","imgly_font_roboto_light","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sue_ellen_francisco","imgly_font_ultra","imgly_font_wolesbro"],DT=[{identifier:"imgly_frame_dia",name:"Dia",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_left.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_right.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",name:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",name:"Black Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",name:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",name:"Low Poly",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}}],kT=[{identifier:hk.Golden,name:"Golden",defaultBlendMode:ak.LIGHTEN,overlayURI:"./items/imgly_overlay_golden.jpg",thumbnailURI:"./items/imgly_overlay_golden_thumb.jpg"},{identifier:hk.LightLeak1,name:"Lightleak",defaultBlendMode:ak.SCREEN,overlayURI:"./items/imgly_overlay_lightleak1.jpg",thumbnailURI:"./items/imgly_overlay_lightleak1_thumb.jpg"},{identifier:hk.Rain,name:"Rain",defaultBlendMode:ak.OVERLAY,overlayURI:"./items/imgly_overlay_rain.jpg",thumbnailURI:"./items/imgly_overlay_rain_thumb.jpg"},{identifier:hk.Mosaic,name:"Mosaic",defaultBlendMode:ak.MULTIPLY,overlayURI:"./items/imgly_overlay_mosaic.jpg",thumbnailURI:"./items/imgly_overlay_mosaic_thumb.jpg"},{identifier:hk.Vintage,name:"Vintage",defaultBlendMode:ak.OVERLAY,overlayURI:"./items/imgly_overlay_vintage.jpg",thumbnailURI:"./items/imgly_overlay_vintage_thumb.jpg"},{identifier:hk.Paper,name:"Paper",defaultBlendMode:ak.MULTIPLY,overlayURI:"./items/imgly_overlay_paper.jpg",thumbnailURI:"./items/imgly_overlay_paper_thumb.jpg"},{identifier:hk.Bokeh,name:"Bokeh",defaultBlendMode:ak.LIGHTEN,overlayURI:"./items/imgly_overlay_bokeh.jpg",thumbnailURI:"./items/imgly_overlay_bokeh_thumb.jpg"},{identifier:hk.Hearts,name:"Hearts",defaultBlendMode:ak.SCREEN,overlayURI:"./items/imgly_overlay_hearts.jpg",thumbnailURI:"./items/imgly_overlay_hearts_thumb.jpg"},{identifier:hk.LightLeak2,name:"Lightleak 2",defaultBlendMode:ak.LIGHTEN,overlayURI:"./items/imgly_overlay_lightleak2.jpg",thumbnailURI:"./items/imgly_overlay_lightleak2_thumb.jpg"},{identifier:hk.Wood,name:"Wood",defaultBlendMode:ak.MULTIPLY,overlayURI:"./items/imgly_overlay_wood.jpg",thumbnailURI:"./items/imgly_overlay_wood_thumb.jpg"},{identifier:hk.Chop,name:"Chop",defaultBlendMode:ak.MULTIPLY,overlayURI:"./items/imgly_overlay_chop.jpg",thumbnailURI:"./items/imgly_overlay_chop_thumb.jpg"},{identifier:hk.Metal,name:"Metal",defaultBlendMode:ak.OVERLAY,overlayURI:"./items/imgly_overlay_metal.jpg",thumbnailURI:"./items/imgly_overlay_metal_thumb.jpg"},{identifier:hk.Painting,name:"Painting",defaultBlendMode:ak.OVERLAY,overlayURI:"./items/imgly_overlay_painting.jpg",thumbnailURI:"./items/imgly_overlay_painting_thumb.jpg"},{identifier:hk.Grain,name:"Grain",defaultBlendMode:ak.OVERLAY,overlayURI:"./items/imgly_overlay_grain.jpg",thumbnailURI:"./items/imgly_overlay_grain_thumb.jpg"},{identifier:hk.Clouds,name:"Clouds",defaultBlendMode:ak.SOFT_LIGHT,overlayURI:"./items/imgly_overlay_clouds.jpg",thumbnailURI:"./items/imgly_overlay_clouds_thumb.jpg"},{identifier:hk.Wall1,name:"Wall",defaultBlendMode:ak.LIGHTEN,overlayURI:"./items/imgly_overlay_wall1.jpg",thumbnailURI:"./items/imgly_overlay_wall1_thumb.jpg"},{identifier:hk.Wall2,name:"Wall 2",defaultBlendMode:ak.OVERLAY,overlayURI:"./items/imgly_overlay_wall2.jpg",thumbnailURI:"./items/imgly_overlay_wall2_thumb.jpg"}],TT=[{identifier:"imgly_sticker_emoticons",name:"Emoticons",thumbnailURI:"./categories/emoticons.png",items:[{identifier:"imgly_sticker_emoticons_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_grin.svg",tintMode:"none",name:"Grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_laugh",stickerURI:"./emoticons/imgly_sticker_emoticons_laugh.svg",tintMode:"none",name:"Laugh",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smile",stickerURI:"./emoticons/imgly_sticker_emoticons_smile.svg",tintMode:"none",name:"Smile",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_wink.svg",tintMode:"none",name:"Wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tongue_out_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_tongue_out_wink.svg",tintMode:"none",name:"Tongue out wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angel",stickerURI:"./emoticons/imgly_sticker_emoticons_angel.svg",tintMode:"none",name:"Angel",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kisses",stickerURI:"./emoticons/imgly_sticker_emoticons_kisses.svg",tintMode:"none",name:"Kisses",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loving",stickerURI:"./emoticons/imgly_sticker_emoticons_loving.svg",tintMode:"none",name:"Loving",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kiss",stickerURI:"./emoticons/imgly_sticker_emoticons_kiss.svg",tintMode:"none",name:"Kiss",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wave",stickerURI:"./emoticons/imgly_sticker_emoticons_wave.svg",tintMode:"none",name:"Wave",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_nerd",stickerURI:"./emoticons/imgly_sticker_emoticons_nerd.svg",tintMode:"none",name:"Nerd",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cool",stickerURI:"./emoticons/imgly_sticker_emoticons_cool.svg",tintMode:"none",name:"Cool",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_blush",stickerURI:"./emoticons/imgly_sticker_emoticons_blush.svg",tintMode:"none",name:"Blush",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_duckface",stickerURI:"./emoticons/imgly_sticker_emoticons_duckface.svg",tintMode:"none",name:"Duckface",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_furious.svg",tintMode:"none",name:"Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angry",stickerURI:"./emoticons/imgly_sticker_emoticons_angry.svg",tintMode:"none",name:"Angry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_steaming_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_steaming_furious.svg",tintMode:"none",name:"Steaming Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sad",stickerURI:"./emoticons/imgly_sticker_emoticons_sad.svg",tintMode:"none",name:"Sad",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_anxious",stickerURI:"./emoticons/imgly_sticker_emoticons_anxious.svg",tintMode:"none",name:"Anxious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_cry.svg",tintMode:"none",name:"Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sobbing",stickerURI:"./emoticons/imgly_sticker_emoticons_sobbing.svg",tintMode:"none",name:"Sobbing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loud_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_loud_cry.svg",tintMode:"none",name:"Loud Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wide_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_wide_grin.svg",tintMode:"none",name:"Wide grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_impatient",stickerURI:"./emoticons/imgly_sticker_emoticons_impatient.svg",tintMode:"none",name:"Impatient",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tired",stickerURI:"./emoticons/imgly_sticker_emoticons_tired.svg",tintMode:"none",name:"Tired",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_asleep",stickerURI:"./emoticons/imgly_sticker_emoticons_asleep.svg",tintMode:"none",name:"Asleep",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sleepy",stickerURI:"./emoticons/imgly_sticker_emoticons_sleepy.svg",tintMode:"none",name:"Sleepy",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_deceased",stickerURI:"./emoticons/imgly_sticker_emoticons_deceased.svg",tintMode:"none",name:"Deceased",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_attention",stickerURI:"./emoticons/imgly_sticker_emoticons_attention.svg",tintMode:"none",name:"Attention",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_question",stickerURI:"./emoticons/imgly_sticker_emoticons_question.svg",tintMode:"none",name:"Question",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",stickerURI:"./emoticons/imgly_sticker_emoticons_not_speaking_to_you.svg",tintMode:"none",name:"Not speaking to you",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sick",stickerURI:"./emoticons/imgly_sticker_emoticons_sick.svg",tintMode:"none",name:"Sick",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pumpkin",stickerURI:"./emoticons/imgly_sticker_emoticons_pumpkin.svg",tintMode:"none",name:"Pumpkin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_boxer",stickerURI:"./emoticons/imgly_sticker_emoticons_boxer.svg",tintMode:"none",name:"Boxer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_idea",stickerURI:"./emoticons/imgly_sticker_emoticons_idea.svg",tintMode:"none",name:"Idea",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smoking",stickerURI:"./emoticons/imgly_sticker_emoticons_smoking.svg",tintMode:"none",name:"Smoking",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_beer",stickerURI:"./emoticons/imgly_sticker_emoticons_beer.svg",tintMode:"none",name:"Beer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skateboard",stickerURI:"./emoticons/imgly_sticker_emoticons_skateboard.svg",tintMode:"none",name:"Skateboard",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_guitar",stickerURI:"./emoticons/imgly_sticker_emoticons_guitar.svg",tintMode:"none",name:"Guitar",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_music",stickerURI:"./emoticons/imgly_sticker_emoticons_music.svg",tintMode:"none",name:"Music",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sunbathing",stickerURI:"./emoticons/imgly_sticker_emoticons_sunbathing.svg",tintMode:"none",name:"Sunbathing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hippie",stickerURI:"./emoticons/imgly_sticker_emoticons_hippie.svg",tintMode:"none",name:"Hippie",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_humourous",stickerURI:"./emoticons/imgly_sticker_emoticons_humourous.svg",tintMode:"none",name:"Humourous",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hitman",stickerURI:"./emoticons/imgly_sticker_emoticons_hitman.svg",tintMode:"none",name:"Hitman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_harry_potter",stickerURI:"./emoticons/imgly_sticker_emoticons_harry_potter.svg",tintMode:"none",name:"Harry Potter",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_business",stickerURI:"./emoticons/imgly_sticker_emoticons_business.svg",tintMode:"none",name:"Business",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_batman",stickerURI:"./emoticons/imgly_sticker_emoticons_batman.svg",tintMode:"none",name:"Batman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skull",stickerURI:"./emoticons/imgly_sticker_emoticons_skull.svg",tintMode:"none",name:"Skull",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_ninja",stickerURI:"./emoticons/imgly_sticker_emoticons_ninja.svg",tintMode:"none",name:"Ninja",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_masked",stickerURI:"./emoticons/imgly_sticker_emoticons_masked.svg",tintMode:"none",name:"Masked",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_alien",stickerURI:"./emoticons/imgly_sticker_emoticons_alien.svg",tintMode:"none",name:"Alien",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wrestler",stickerURI:"./emoticons/imgly_sticker_emoticons_wrestler.svg",tintMode:"none",name:"Wrestler",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_devil",stickerURI:"./emoticons/imgly_sticker_emoticons_devil.svg",tintMode:"none",name:"Devil",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_star",stickerURI:"./emoticons/imgly_sticker_emoticons_star.svg",tintMode:"none",name:"Star",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_baby_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_baby_chicken.svg",tintMode:"none",name:"Baby Chicken",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_rabbit",stickerURI:"./emoticons/imgly_sticker_emoticons_rabbit.svg",tintMode:"none",name:"Rabbit",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pig",stickerURI:"./emoticons/imgly_sticker_emoticons_pig.svg",tintMode:"none",name:"Pig",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_chicken.svg",tintMode:"none",name:"Chicken",resizeMode:"keepAspect"}]},{identifier:"imgly_sticker_shapes",name:"Shapes",thumbnailURI:"./categories/shapes.png",items:[{identifier:"imgly_sticker_shapes_badge_01",stickerURI:"./shapes/imgly_sticker_shapes_badge_01.svg",tintMode:"solid",name:"Shape Badge 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_04",stickerURI:"./shapes/imgly_sticker_shapes_badge_04.svg",tintMode:"solid",name:"Shape Badge 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_12",stickerURI:"./shapes/imgly_sticker_shapes_badge_12.svg",tintMode:"solid",name:"Shape Badge 12",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_06",stickerURI:"./shapes/imgly_sticker_shapes_badge_06.svg",tintMode:"solid",name:"Shape Badge 06",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_13",stickerURI:"./shapes/imgly_sticker_shapes_badge_13.svg",tintMode:"solid",name:"Shape Badge 13",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_36",stickerURI:"./shapes/imgly_sticker_shapes_badge_36.svg",tintMode:"solid",name:"Shape Badge 36",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_08",stickerURI:"./shapes/imgly_sticker_shapes_badge_08.svg",tintMode:"solid",name:"Shape Badge 08",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_11",stickerURI:"./shapes/imgly_sticker_shapes_badge_11.svg",tintMode:"solid",name:"Shape Badge 11",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_35",stickerURI:"./shapes/imgly_sticker_shapes_badge_35.svg",tintMode:"solid",name:"Shape Badge 35",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_28",stickerURI:"./shapes/imgly_sticker_shapes_badge_28.svg",tintMode:"solid",name:"Shape Badge 28",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_32",stickerURI:"./shapes/imgly_sticker_shapes_badge_32.svg",tintMode:"solid",name:"Shape Badge 32",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_15",stickerURI:"./shapes/imgly_sticker_shapes_badge_15.svg",tintMode:"solid",name:"Shape Badge 15",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_20",stickerURI:"./shapes/imgly_sticker_shapes_badge_20.svg",tintMode:"solid",name:"Shape Badge 20",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_18",stickerURI:"./shapes/imgly_sticker_shapes_badge_18.svg",tintMode:"solid",name:"Shape Badge 18",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_19",stickerURI:"./shapes/imgly_sticker_shapes_badge_19.svg",tintMode:"solid",name:"Shape Badge 19",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_02",stickerURI:"./shapes/imgly_sticker_shapes_arrow_02.svg",tintMode:"solid",name:"Shape Arrow 02",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_03",stickerURI:"./shapes/imgly_sticker_shapes_arrow_03.svg",tintMode:"solid",name:"Shape Arrow 03",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_01",stickerURI:"./shapes/imgly_sticker_shapes_spray_01.svg",tintMode:"solid",name:"Shape Spray 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_04",stickerURI:"./shapes/imgly_sticker_shapes_spray_04.svg",tintMode:"solid",name:"Shape Spray 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_03",stickerURI:"./shapes/imgly_sticker_shapes_spray_03.svg",tintMode:"solid",name:"Shape Spray 03",resizeMode:"keepAspect"}]}],CT=[{thumbnailURI:"./items/dark/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/dark/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/dark/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/dark/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/dark/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/dark/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/dark/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/dark/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/dark/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/dark/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/dark/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/dark/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/dark/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/dark/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}],RT=[{thumbnailURI:"./items/light/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/light/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/light/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/light/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/light/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/light/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/light/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/light/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/light/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/light/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/light/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/light/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/light/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/light/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}],IT=[{identifier:"imgly_transforms_common",name:"Common",items:[{identifier:"imgly_transform_common_custom",name:"Custom",thumbnailURI:"",ratio:"*"},{identifier:"imgly_transform_common_square",name:"Square",thumbnailURI:"",ratio:1},{identifier:"imgly_transform_common_4",name:"4:3",thumbnailURI:"",ratio:4/3},{identifier:"imgly_transform_common_16",name:"16:9",thumbnailURI:"",ratio:16/9},{identifier:"imgly_transform_common_3",name:"3:4",thumbnailURI:"",ratio:3/4},{identifier:"imgly_transform_common_9",name:"9:16",thumbnailURI:"",ratio:9/16}]},{identifier:"imgly_transforms_facebook",name:"Facebook",items:[{identifier:"imgly_transform_facebook_profile",name:"Profile",thumbnailURI:"",dimensions:{x:300,y:300},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_title",name:"Title",thumbnailURI:"",dimensions:{x:1200,y:627},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_post",name:"Post",thumbnailURI:"",dimensions:{x:940,y:788},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_instagram",name:"Instagram",items:[{identifier:"imgly_transform_instagram_landscape",name:"Landscape",thumbnailURI:"",dimensions:{x:1080,y:566},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_portrait",name:"Portrait",thumbnailURI:"",dimensions:{x:1080,y:1350},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_square",name:"Square",thumbnailURI:"",dimensions:{x:1080,y:1080},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_story",name:"Story",thumbnailURI:"",dimensions:{x:1080,y:1920},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_twitter",name:"Twitter",items:[{identifier:"imgly_transform_twitter_post",name:"Post",thumbnailURI:"",dimensions:{x:1024,y:512},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_profile",name:"Profile",thumbnailURI:"",dimensions:{x:400,y:400},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_title",name:"Title",thumbnailURI:"",dimensions:{x:1500,y:500},forceDimensions:!0,lockDimensions:!0}]}],FT=D(A()),ST={italic:"i"},ET=class{constructor(t){this.assetManager=t,this.injectedFonts={},this.loadedFonts={},this.isFontLoaded=t=>void 0!==this.loadedFonts[t],this.getGoogleFamiliesString=t=>{const e=t.reduce(((t,e)=>{const{fontFamily:i,fontStyle:s,fontWeight:r=400}=e;return t[i]=(t[i]||[]).concat(`${r}${ST[s]||""}`),t}),{});return Object.keys(e).map((t=>{const i=e[t].length?`:${e[t].join(",")}`:"";return t.replace(" ","+")+i})).join("|")}}static createFontFacesCSS(t,e){return t.map((t=>{const i=e(t.fontURI);return`@font-face {\n        font-family: "${t.fontFamily}";\n        src: url('${i}') format('${t.format||"woff"}');\n        font-weight: ${t.fontWeight||"normal"};\n        font-style: ${t.fontStyle||"normal"};\n      }`}))}getFontWithId(t){const e=this.assetManager.getFontAsset(t);if(!e)throw new Error("The requested font does not exist as an asset.");return e}injectAllFonts(){const t=this.assetManager.getFontAssets();this.injectFonts(t)}async loadAllFonts(){const t=this.assetManager.getFontAssets();return this.loadFonts(t)}async loadFontsWithIdentifiers(t){const e=t.map((t=>this.getFontWithId(t)));return this.loadFonts(e)}async loadFonts(t){return this.injectFonts(t),(0,FT.default)(t,(t=>this.loadFont(t,!1)),{stopOnError:!1}).then((()=>{}))}async loadFont(t,e=!0){return new Promise(((i,s)=>{this.isFontLoaded(t.identifier)&&i(),e&&this.injectFonts([t]);new $k(t).load().then((()=>{this.loadedFonts[t.identifier]=t,i()})).catch((e=>{s(t.identifier)}))}))}async loadFontWithIdentifier(t,e=!0){const i=this.assetManager.getFontAsset(t);if(!i)throw new Error(`The requested font asset with identifier ${t} does not exist!`);return this.loadFont(i,e)}injectFonts(t,e=this.assetManager.getPathForCategory("font")){const i=t.filter(vk),s=t.filter(bk);i.length>0&&this.addGoogleFontLinks(i),s.length>0&&this.addWebFontCSS(s,e)}addGoogleFontLinks(t){const e=t.filter((t=>!this.injectedFonts[t.identifier]));if(0===e.length)return;const i=this.getGoogleFamiliesString(e),s=document.createElement("link");s.rel="stylesheet",s.href=`https://fonts.googleapis.com/css?family=${i}`;document.getElementsByTagName("head")[0].appendChild(s),t.forEach((t=>{this.injectedFonts[t.identifier]=t}))}addWebFontCSS(t,e){const i=t.filter((t=>!this.injectedFonts[t.identifier]));if(0===i.length)return;const s=`\n      /* Injected by PhotoEditorSDK */\n      ${ET.createFontFacesCSS(i,e).join("\n")}\n    `,r=document.createElement("style");r.innerHTML=s,document.head.appendChild(r),t.forEach((t=>{this.injectedFonts[t.identifier]=t}))}},OT=class{constructor(t,e=!1,i){var s,o;this.assetResolver=i,this.basePath="assets/",this.areCustomAssetsAllowed=!1,this.getAssets=t=>{switch(t){case"overlay":return this.overlayAssets;case"filter":return this.filterCategories;case"font":return this.fontAssets;case"focus":return this.focusAssets;case"adjustment":return this.adjustmentCategories;case"sticker":return this.stickerCategories;case"textdesign":return this.textDesignAssets;case"frame":return this.frameAssets;case"transform":return this.transformCategories;default:return[]}return[]},this.getPath=(t,e)=>{const{assetResolver:i={}}=this,s=e&&i.item?i.item(e,t):e;if(null==s?void 0:s.match(/data:image/g))return s;if((null==s?void 0:s.match(/(ftp|http|https):\/\//))&&gT(s))return s;if(!s&&gT(t))return t;const r=s?sT(t,s):sT(t);let n;if(this.basePath.match(/(ftp|http|https):\/\//)){const{length:t}=this.basePath;"/"!==this.basePath[t-1]&&(this.basePath=`${this.basePath}/`),n=this.basePath+r}else n=sT(this.basePath,r);return i.path?i.path(n,t,s):n},this.getPathForCategory=t=>(...e)=>this.getPath(t,...e),this.addCustomStickerAsset=(t,e,i)=>{t.forEach((t=>{const{thumbnailURI:s,name:r,stickerURI:n,identifier:o,tintMode:a,resizeMode:l}=t,h=this.stickerCategories.find((t=>t.identifier===e)),u={identifier:o,name:r,thumbnailURI:s,stickerURI:n,tintMode:a,resizeMode:l};if(h)h.items.push(u),h.thumbnailURI=s;else{const t={identifier:e,name:i,thumbnailURI:s,items:[u]};this.stickerCategories=[t,...this.stickerCategories]}})),this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[])},this.getItemPath=(t,e,i)=>{const s=t.find((t=>t.identifier===e));return s&&(s[i]||s.path)||""},this.isNonExistingFont=t=>!bT.find((e=>e.identifier===t.identifier))&&!r[t.identifier],this.replaceDeprecatedFont=t=>r[t.identifier]?bT.find((e=>e.identifier===n(t.identifier,!0))):t,(null==t?void 0:t.basePath)&&(this.basePath=t.basePath),this.areCustomAssetsAllowed=e;const a=yT.reduce(this.allOptions,[]);t&&t.filter?this.filterCategories=this.configuredCategory(yT,t.filter,a):this.filterCategories=yT,this.lutFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter((t=>function(t){return void 0!==t.lutURI}(t))),this.duoToneFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter((t=>qD(t)));const l=fT.reduce(this.allOptions,[]);t&&t.adjustment?this.adjustmentCategories=this.configuredCategory(fT,t.adjustment,l):this.adjustmentCategories=fT,this.fontAssets=bT.reduce(this.allOptions,[]);let h=vT.map((t=>this.getFontAsset(t)));if((null==(o=null==(s=null==t?void 0:t.text)?void 0:s.fonts)?void 0:o.length)>0){h=t.text.fonts.map((t=>{if(this.isNonExistingFont(t))return t;const e=this.replaceDeprecatedFont(t);return this.getFontAsset(e.identifier)}));const e=t.text.fonts.filter(this.isNonExistingFont);this.fontAssets=t.text.fonts?[...this.fontAssets,...e]:this.fontAssets}this.textToolFontAssets=h;const u=t&&t.focus&&t.focus.items&&t.focus.items.length?t.focus.items.map((t=>xT.find((e=>e.identifier===t.identifier)))):xT;this.focusAssets=u,t&&t.overlay&&t.overlay.items?this.overlayAssets=this.configuredItem(t.overlay.items,kT,kT):this.overlayAssets=kT,t&&t.frame&&t.frame.items?this.frameAssets=this.configuredItem(t.frame.items,DT,DT):this.frameAssets=DT;const c=TT.reduce(this.allOptions,[]);t&&t.sticker?this.stickerCategories=this.configuredCategory(TT,t.sticker,c):this.stickerCategories=TT,this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[]);let d=CT;t&&"light"===t.theme&&(d=RT),this.textDesignAssets=t&&t.textdesign&&t.textdesign.items&&t.textdesign.items.length?t.textdesign.items.map((t=>d.find((e=>e.identifier===t.identifier)))):d,this.textDesignToolFontAssets=wT.map((t=>this.getFontAsset(t)));const _=IT.reduce(this.allOptions,[]);t&&t.transform?this.transformCategories=this.configuredCategory(IT,t.transform,_,gD.TRANSFORM):this.transformCategories=IT,this.transformAssets=this.transformCategories.reduce(this.allOptions,[]),this.fontManager=new ET(this)}getFontManager(){return this.fontManager}getAssetSource(t,e){switch(t){case"filter":if(this.getLUTFilterAsset(e))return this.getPath(t,this.getItemPath(this.lutFilterAssets,e,"lutURI"));break;case"overlay":return this.getPath(t,this.getItemPath(this.overlayAssets,e,"overlayURI"));case"font":return this.getPath(t,this.getItemPath(this.fontAssets,e,"fontURI"));case"sticker":const i=this.stickerAssets.find((t=>t.identifier===e));if(i){if("data:image"===i.stickerURI.substr(0,10))return i.stickerURI;if(e.includes("imgly_sticker")&&i.stickerURI.includes(".svg")&&Bk()){const i=this.getPath(t,this.getItemPath(this.stickerAssets,e,"stickerURI")).split("/");return i.splice(i.length-1,0,"base"),i[i.length-1]=i[i.length-1].replace(".svg",".png"),i.join("/")}return this.getPath(t,this.getItemPath(this.stickerAssets,e,"stickerURI"))}throw new Error("Cannot resolve this type of sticker asset yet");case"textdesign":return this.getPath(sT(t,"engine"),e);case"frame":return this.getPath(t,e)}throw new Error("Cannot resolve this type of asset yet")}getDuotoneFilterAsset(t){return this.duoToneFilterAssets.filter((e=>e.identifier===t))[0]}getLUTFilterAsset(t){return this.lutFilterAssets.filter((e=>e.identifier===t))[0]}getOverlayAsset(t){return this.overlayAssets.filter((e=>e.identifier===t))[0]}getStickerAsset(t){return this.stickerAssets.filter((e=>e.identifier===t))[0]}getFontAsset(t){return this.fontAssets.filter((e=>e.identifier===t))[0]}getTextDesignAssets(t){return this.textDesignAssets.filter((e=>e.identifier===t))[0]}getFrameAsset(t){return this.frameAssets.filter((e=>e.identifier===t))[0]}getFontAssets(){return this.fontAssets}getFontAssetsForText(){return this.textToolFontAssets}getFontAssetsForTextDesign(){return this.textDesignToolFontAssets}getFrameAssets(){return this.frameAssets}allOptions(t,e){return Object.prototype.hasOwnProperty.call(e,"items")?[...t,...e.items]:[...t,e]}configuredCategory(t,e,i,s){return e.categories&&e.categories.length?e.categories.reduce(((e,r)=>{const n=t.find((t=>t.identifier===r.identifier));return n?e.push({...n,...r,items:this.configuredItem(r.items,i,n.items,s).filter(Boolean)}):(this.areCustomAssetsAllowed||s===gD.TRANSFORM)&&e.push({...r,items:this.configuredItem(r.items,i,r.items,s).filter(Boolean)}),e}),[]):t}configuredItem(t,e,i,s){return t&&t.length?t.reduce(((t,i)=>{const r=e.find((t=>t.identifier===i.identifier));return r?t.push({...r,...i}):(this.areCustomAssetsAllowed||s===gD.TRANSFORM)&&t.push(i),t}),[]).filter(Boolean):i}},AT=class{static contains(t,e){return e.x>=t.minX&&e.x<=t.maxX&&e.y>=t.minY&&e.y<=t.maxY}constructor(t,e,i,s){if("number"===typeof t){if("number"!==typeof e||void 0===i||void 0===s)throw new Error("Invalid arguments passed to Rect. Expected (number, number, number, number)");this.origin={x:t,y:e},this.size={width:i||0,height:s||0}}else{if(this.origin=t,"number"===typeof e)throw new Error("Invalid arguments passed to Rect. Expected (Float2, Size)");this.size=e}}get minX(){return this.origin.x}get minY(){return this.origin.y}get midX(){return this.origin.x+.5*this.size.width}get midY(){return this.origin.y+.5*this.size.height}get maxX(){return this.origin.x+this.size.width}get maxY(){return this.origin.y+this.size.height}get width(){return this.size.width}get height(){return this.size.height}},BT=AT;BT.ZERO=new AT({x:0,y:0},{width:0,height:0});var MT=class{constructor(t,e,i,s,r,n){this.a=t,this.b=e,this.c=i,this.d=s,this.tx=r,this.ty=n}static fromScale(t,e){return new MT(t,0,0,e,0,0)}static fromRotation(t){const e=Math.cos(t),i=Math.sin(t);return new MT(e,-i,i,e,0,0)}static fromRotationDeg(t){const e=Math.PI*t/180;return this.fromRotation(e)}static fromTranslation(t,e){return new MT(1,0,0,1,t,e)}static fromTRS(t,e,i,s,r){const n=Math.cos(i),o=Math.sin(i);return new MT(s*n,-r*o,s*o,r*n,t,e)}static multiply(t,e){const i=t.a*e.a+t.b*e.c,s=t.a*e.b+t.b*e.d,r=t.c*e.a+t.d*e.c,n=t.c*e.b+t.d*e.d,o=t.a*e.tx+t.b*e.ty+t.tx,a=t.c*e.tx+t.d*e.ty+t.ty;return new MT(i,s,r,n,o,a)}static transformPoint(t,e){return{x:t.a*e.x+t.b*e.y+t.tx,y:t.c*e.x+t.d*e.y+t.ty}}static getInverted(t){const e=t.a*t.d-t.b*t.c;if(0===e)return t;const i=1/e,s=i*t.d,r=-i*t.b,n=-i*t.c,o=i*t.a,a=i*(t.b*t.ty-t.d*t.tx),l=i*(t.c*t.tx-t.a*t.ty);return new MT(s,r,n,o,a,l)}},PT=MT;function LT(t){return"number"===typeof t}PT.IDENTITY=MT.fromScale(1,1);var zT,NT=t=>t<0,UT=t=>NT(t)?-t:t,GT=t=>t*(Math.PI/180),jT=t=>t*(180/Math.PI);!function(t){t[t.Top=0]="Top",t[t.Right=90]="Right",t[t.Bottom=180]="Bottom",t[t.Left=270]="Left"}(zT||(zT={}));var VT={0:GT(0),90:GT(90),180:GT(180),270:GT(270)},WT=Object.values(VT),HT=t=>{let e=Math.round(jT(UT(t)));return NT(t)&&(270===e?e=90:90===e&&(e=270)),VT[e%360]},qT=t=>0===t?t:360-UT(t),XT=t=>((t,e)=>{const i=t.indexOf(e);if(-1!==i&&t.length)return i===t.length-1?t[0]:t[i+1]})(WT,HT(t)),YT=t=>((t,e)=>{const i=t.indexOf(e);if(-1!==i&&t.length)return 0===i?t[t.length-1]:t[i-1]})(WT,HT(t)),JT=t=>{const e=HT(t);return e===VT[270]||e===VT[90]},KT=class{static get IDENTITY(){return new KT({x:0,y:0})}constructor(t,e={x:1,y:1},i=0){this.position=t,this.scale=e,this.rotation=i}};C();var ZT,QT={};function $T(t){return void 0!==t.x}function tC(t){return PT.fromTRS(t.position.x,t.position.y,t.rotation,t.scale.x,t.scale.y)}function eC(t){const e=t.getParent(),i=function(t){return t.getBaseLocalToParentMatrix?t.getBaseLocalToParentMatrix():tC(t.getTransform())}(t);if(void 0===e)return i;const s=eC(e);return PT.multiply(s,i)}function iC(t){return t.getLocalToParentMatrix?t.getLocalToParentMatrix():tC(t.getTransform())}function sC(t){const e=t.getParent(),i=iC(t);if(void 0===e)return i;const s=sC(e);return PT.multiply(s,i)}function rC(t,e,i,s=!1){const r="output"===e.type&&s?eC(e):sC(e),n="output"===i.type&&s?eC(i):sC(i),o=PT.getInverted(n);return PT.transformPoint(o,PT.transformPoint(r,t))}function nC(t,e,i){const s=new Vk(t,0),r=new Vk(rC(s,e,i)),n=new Vk(rC(Vk.ZERO,e,i));return Vk.distance(n,r)}function oC(t,e,i){const s=$T(t)?t.x:t.width,r=$T(t)?t.y:t.height;return{width:nC(s,e,i),height:nC(r,e,i)}}function aC(t,e){const i=sC(e);return PT.transformPoint(i,t)}function lC(t,e){const i=new Vk(t,0),s=new Vk(aC(i,e)),r=new Vk(aC(Vk.ZERO,e));return Vk.distance(s,r)}function hC(t){const e=sC(t),i=t.getBounds(),s={x:i.width,y:0},r={x:0,y:i.height},n=new Vk(PT.transformPoint(e,Vk.ZERO)),o=new Vk(PT.transformPoint(e,s)),a=new Vk(PT.transformPoint(e,r));return{width:Vk.distance(n,o),height:Vk.distance(n,a)}}function uC(t,e){const i=hC(t),s=e.getTransform().scale,r=1/s.x,n=1/s.y;return{width:i.width*r,height:i.height*n}}function cC(t,e){const i=e.getBounds();return{width:t.width*i.width,height:t.height*i.height}}function dC(t,e){const i=e.getBounds();return{width:t.width/i.width,height:t.height/i.height}}function _C(t,e,i=!0){const s=e.getBounds();return{x:t.x*s.width+(i?0:s.minX),y:t.y*s.height+(i?0:s.minY)}}function mC(t,e,i=!0){const s=e.getBounds();return{x:(t.x-(i?0:s.minX))/s.width,y:(t.y-(i?0:s.minY))/s.height}}function gC(t,e){const i=rC({x:1,y:0},t,e,!0),s=rC(Vk.ZERO,t,e,!0);return Math.atan2(i.y-s.y,i.x-s.x)}function pC(t){return"string"!==typeof t&&!Array.isArray(t)&&void 0===t.a}function fC(t){return"string"!==typeof t&&Array.isArray(t)&&3===t.length}function yC(t){return"string"!==typeof t&&!Array.isArray(t)&&void 0!==t.a}function xC(t){return"string"!==typeof t&&Array.isArray(t)&&4===t.length}w(QT,{absoluteToRelativePoint:()=>mC,absoluteToRelativeSize:()=>dC,getBaseLocalToWorldMatrix:()=>eC,getLocalToParentMatrix:()=>iC,getLocalToWorldMatrix:()=>sC,getPointInWorldSpace:()=>aC,getRotationBetweenCoordinateSpaces:()=>gC,getScalarInWorldSpace:()=>lC,getSizeInOutputSpace:()=>uC,getSizeInWorldSpace:()=>hC,pointFromSpaceToSpace:()=>rC,rectTransformToAffineTransform:()=>tC,relativeToAbsolutePoint:()=>_C,relativeToAbsoluteSize:()=>cC,scalarFromSpaceToSpace:()=>nC,sizeFromSpaceToSpace:()=>oC}),function(t){t.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",t.IMAGE_DOWNSCALED="imageDownscaled",t.WEBGL_CONTEXT_LOST="context-lost"}(ZT||(ZT={}));function bC(t){return void 0!==t.getTransform}var vC=t=>2*Math.PI-t,wC=({rotation:t,outputRotation:e=0,flipHorizontally:i,flipVertically:s})=>{let r=t;return i&&(r=vC(r)),s&&(r=(t=>-t)(r)),r+e};Qf(),Gt(),$f(),iy(),sy(),Qf();var DC=class{static downloadDataURL(t,e="photoeditorsdk-export"){const i=this.createBlobURLFromDataURL(t),s=this.getExtensionFromDataURL(t),r=document.createElement("a");r.download=`${e}.${s}`,r.href=i,document.body.appendChild(r),r.click(),document.body.removeChild(r)}static downloadMSBlob(t,e="photoeditorsdk-export"){navigator.msSaveBlob&&navigator.msSaveBlob(t,`${e}.png`)}static getExtensionFromDataURL(t){return t.split(",")[0].split(":")[1].split(";")[0].split("/").pop()}static createBlobURLFromDataURL(t){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array)return t;const e=mf.decode(t.split(",")[1]),i=t.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(e.length),r=new Uint8Array(s);for(let o=0;o<e.length;o++)r[o]=e[o];const n=new window.Blob([s],{type:i});return window.URL.createObjectURL(n)}};Qf();iy(),C(),Qf(),Qf();Qf();var kC=class extends ff{constructor(t,e,i,s=!1){super(),this._ui=t,this._options=e,this._mediator=i,this._shallow=s,s||(this._initSDK(),this.operations=new class{constructor(t,e,i){this._editor=t,this._sdk=e,this._mediator=i,this._available=this._sdk.getOperations(),this._map={},this._stack=this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._fixStack()}exists(t){return!!this._map[t]}add(t){const{identifier:e}=t.constructor;t.on("update",(()=>{this._mediator.emit(rg.EVENTS.OPERATION_UPDATED,t)}));const i=this._preferredOrder.indexOf(e);if(-1===i)throw new Error(`EditorOperations#add: \`${e}\` does not appear in \`operationsOrder\``);this._stack.set(i,t),this._map[e]=t,this._mediator.emit(rg.EVENTS.OPERATION_CREATED,t)}remove(t,e=!0){const i="object"===typeof t?t.constructor.identifier:t,s=this._stack.getStack();t=this.get(i),delete this._map[i];const r=s.map((t=>t.constructor.identifier)).indexOf(i);if(-1!==r){this._stack.removeAt(r);for(let t=r+1;t<s.length;t++){const e=s[t];e&&e.setDirty(!0)}e&&this._mediator.emit(rg.EVENTS.OPERATION_REMOVED,t)}}get(t){return this._map[t]}getOrCreate(t,e={}){if(this._map[t]){const i=this._map[t];return i.set(e,!1),i}const i=new(0,this._available[t])(this._sdk,e);return this.add(i),i}getStack(){return this._stack}reset(){this._map={}}_fixStack(){const t=this._stack.getStack().slice();this._stack.clear(),t.forEach((t=>{this.add(t)}))}}(this,this._sdk,this._mediator))}_initFonts(){const t=yf.defaults(this._options.editor.controlsOptions.text,{additionalFonts:[],replaceFonts:!1,availableVariations:null});this._fontManager=new Sf(this._ui,t);const e=this._fontManager.getFonts(),i=this._ui.getFontLoader();i.setFonts(e),i.load()}setImage(t=this._options.editor.image,e=!0){e&&this.reset();let i=null;i=this._sdk.parseExif(t),this._setImage(t,i)}_initSDK(){const{logLevel:t,displayWelcomeMessage:e,debug:i,license:s,crossOrigin:r,watermark:n}=this._options,{smoothDownscaling:o,smoothUpscaling:a,preferredRenderer:l,pixelRatio:h,transparent:u,clearColor:c}=this._options.editor;let d;Array.isArray(c)?d=gf.fromArray(c):"string"===typeof c?d=gf.fromHex(c):c instanceof gf&&(d=c.clone());const _={logLevel:t,debug:i,displayWelcomeMessage:e,pixelRatio:h,smoothDownscaling:o,smoothUpscaling:a,transparent:u,crossOrigin:r,clearColor:d,license:s,watermark:n};this._sdk=new vf(l,_)}getMaxMegapixels(){const{maxMegaPixels:t}=this._options.editor;return t}getCrossOrigin(){return yf.getCrossOriginValue(this._options.crossOrigin||"anonymous")}getOutputDimensions(t=!1){return this._sdk.getOutputDimensions(t)}getOutputTextureDimensions(t=!1){return this._sdk.getOutputTextureDimensions(t)}getFinalDimensions(t=!1){return this._sdk.getFinalDimensions(t)}_setImage(t=this._options.editor.image,e=null){this._sdk.setAllOperationsToDirty(),this._options.editor.image=t,this._sdk.setImage(t,e)}_ensureImageIsResized(){const t=this._sdk.getImage(),e=this._sdk.getRenderer(),i=this.getMaxMegapixels(),s=i?1e6*i:null,r=e.getMaxDimensions(),n=new class{constructor(t,e,i){this._image=t,this._maxPixels=e,this._maxDimensions=i}needsResize(){const t=new wf(this._image.width,this._image.height),e=t.x*t.y>this._maxPixels,i=null!==this._maxDimensions&&(t.x>this._maxDimensions||t.y>this._maxDimensions);return e||i}resize(){let t=null,e=null;const i=this._maxDimensions;return new Promise(((s,r)=>{window.setTimeout((()=>{const r=new wf(this._image.width,this._image.height).clone();if(r.x*r.y>this._maxPixels&&(r.copy(this._getDimensionsByMaxPixels()),t="maxMegaPixels"),null!==i&&(r.x>i||r.y>i)){const e=Math.min(i/r.x,i/r.y);r.multiply(e),t="maxDimensions"}r.floor(),e=this._createResizedImageCanvas(r),s({canvas:e,dimensions:r,reason:t})}),1e3)}))}_createResizedImageCanvas(t,e=t){const i=this._image,s=document.createElement("canvas");s.width=t.x,s.height=t.y;const r=t.clone().subtract(e).divide(2);return s.getContext("2d").drawImage(i,0,0,i.width,i.height,r.x,r.y,e.x,e.y),s}_getDimensionsByMaxPixels(){const t=this._image,e=this._maxPixels,i=t.width/t.height,s=t.height/t.width;return new wf(Math.sqrt(e*i),Math.sqrt(e*s)).floor()}}(t,s,r);return!this._resizedImage&&n.needsResize()?n.resize().then((({canvas:t,dimensions:e,reason:i})=>(this._resizedImage=t,this._sdk.setImage(t),t))):Promise.resolve(t)}export(t=!1){return this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty(),this._ensureImageIsResized().then((e=>{const i=this._options.editor.export,s=new class{constructor(t,e,i){this._sdk=t,this._options=e,this._download=i}export(){const t=this._getRenderType();return this._sdk.export(t,this._options.format,this._options.quality).then((e=>(this._download&&this._downloadData(t,e),e)))}_downloadData(t,e){switch(t){case xf.DATAURL:DC.downloadDataURL(e,this._options.fileBasename);break;case xf.MSBLOB:DC.downloadMSBlob(e,this._options.fileBasename)}}_getRenderType(){const t=this._options;return t.type===xf.IMAGE&&this._download?_f.supportsMSBlob()?xf.MSBLOB:xf.DATAURL:t.type}}(this._sdk,i,t);return s.export().then((t=>(this.emit("export",t),this._mediator.emit(rg.EVENTS.EXPORT,t,this),this._watermarkOperation&&(this._watermarkOperation.setEnabled(!0),this._sdk.render()),this._sdk.setAllOperationsToDirty(),t)))}))}broadcastTransform(t,e){const i=new vf.Operations.TransformOperation.TransformChange(t,e);["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"].forEach((t=>{const e=this.operations.get(t);e&&e.transform(i)}))}broadcastFlip(t){["mirrored-focus","radial-focus","linear-focus","sprite","selective-blur"].forEach((e=>{const i=this.operations.get(e);i&&i.flip(t)}))}broadcastRotate(t){["transform","mirrored-focus","linear-focus","radial-focus","sprite","selective-blur"].forEach((e=>{const i=this.operations.get(e);i&&i.rotate(t)}))}_initSerializers(){this._serializers={"1.0.0":(by(),gy).default,"1.0.1":(By(),Dy).default,"2.0.0":(Xy(),Gy).default,"3.0.0":(ex(),Zy).default,"3.1.0":(lx(),rx).default,"3.2.0":(gx(),cx).default,"3.4.0":(wx(),yx).default,"3.5.0":(Fx(),Tx).default,"3.6.0":(Px(),Ox).default,"3.7.0":(Vx(),Nx).default,"3.8.0":(Zx(),qx).default,"3.9.0":(rb(),tb).default,"3.12.0":(lb(),ab).default}}serialize(t={},e="3.12.0"){const i=this._serializers[e];if(!i)return Promise.reject(new Error(`No serializer for version ${e} found.`));return new i(this).serialize(t)}deserialize(t){const e=this._serializers[t.version];if(!e)return Promise.reject(new Error(`No serializer for version ${t.version} found.`));return new e(this).deserialize(t)}save(t=!1,e=!1){const i=this._options.editor.save;return this.serialize({image:e}).then((e=>{const s=JSON.stringify(e,null,2);if(t){const t=`data:text/json;charset=utf-8;base64,${window.encodeURI(window.btoa(s))}`;DC.downloadDataURL(t,i.fileBasename)}return s}))}reset(){this._sdk.reset(),this.operations.reset()}dispose(){this.stop(),this._resizedImage&&s(this._resizedImage),this._sdk.dispose()}getRenderer(){return this._sdk.getRenderer()}getSDK(){return this._sdk}getInputDimensions(){return this._sdk.getInputDimensions()}getImage(){return this._sdk.getImage()}getOptions(){return this._options}getUI(){return this._ui}getMediator(){return this._mediator}};hy();var TC=class extends ff{constructor(t={}){super(),this._mediator=new ff,this._fontLoader=new Nf(this),this._options=t,this._initOptions(),this._initEvents(),this._disposed=!1,this._isReady=!1,this._editor=new kC(this,this._options,this._mediator),this._options.editor.image&&this._editor.setImage(this._options.editor.image),this._mediator.once(rg.EVENTS.EDITOR_READY,(()=>{this._isReady=!0})),ut.setLevel(this._options.logLevel)}export(...t){return this._editor.export(...t)}serialize(...t){return this._editor.serialize(...t)}deserialize(t){return this._editor.deserialize(t)}getEditor(){return this._editor}isReady(){return this._isReady}onReady(t){this._isReady?t():this._mediator.once(rg.EVENTS.EDITOR_READY,t)}createFilter(t){return new Cf(this,this._getOptions("filter")).instantiateFilterWithIdentifier(t)}getTextDesignLayoutByID(t){return new(new Ef(this,this._getOptions("textDesign")).getLayoutByIdentifier(t))}getTextDesignAssetManager(){return vf.Operations.SpriteOperation.TextDesignSprite.AssetManager}getTextDesignFontManager(){return new Sf(this,{fonts:rg.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0,isTextDesign:!0})}_getOptions(t){const e=this.getEditor(),{controls:i}=e;let s={};i&&i.get(t)&&(s=i.get(t).defaultOptions);const r=e.getOptions();return yf.deepDefaults({},r.editor.controlsOptions[t]||{},s)}_initOptions(){if(this._options=yf.defaults(this._options,{language:"en",logLevel:"warn",crossOrigin:"anonymous",editor:{},assets:{},responsive:!1,preloader:!0,autoRun:!0}),this._options.editor=yf.defaults(this._options.editor||{},{enableZoom:!0,enableDrag:!0,enableExport:!0,enableKeyboardControls:!0,enablePositionSnapping:!0,enableRotationSnapping:!0,enableSave:!1,enableLoad:!1,pixelRatio:Math.max("undefined"!==typeof window&&window.devicePixelRatio||1,1),preferredRenderer:"webgl",transparent:!0,clearColor:[0,0,0,0],displayResizeMessage:!0,maxMegaPixels:{},displayCloseButton:!1,undoMode:"global",defaultControl:"filter",forceCrop:!1,snappingOptions:{},tools:["transform","filter","adjustments","focus","text","textdesign","sticker","brush","frame","overlay","library","artfilter"],controlsOrder:[["library"],["artfilter","transform","filter","adjustments","focus"],["text","textdesign","sticker","brush","frame","overlay"]],operationsOrder:["exif-orientation","artfilter","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","linear-focus","blur","selective-blur","overlay","sprite","frame"],controlsOptions:{focus:{highQualityCanvasBlur:!1}}}),this._options.editor.snappingOptions=yf.defaults(this._options.editor.snappingOptions,{position:{},rotation:{}}),this._options.editor.snappingOptions.position=yf.defaults(this._options.editor.snappingOptions.position,{padding:{},threshold:20}),this._options.editor.snappingOptions.position.padding=yf.defaults(this._options.editor.snappingOptions.position.padding,{left:.1,right:.1,top:.1,bottom:.1}),this._options.editor.snappingOptions.rotation=yf.defaults(this._options.editor.snappingOptions.rotation,{angles:[0,45,90,135,180,225,270,315],threshold:20}),this._options.editor.controlsOptions.focus=yf.defaults(this._options.editor.controlsOptions.focus,{highQualityCanvasBlur:!1}),this._options.editor.maxMegaPixels=yf.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor.export=yf.defaults(this._options.editor.export||{},{format:"image/png",type:xf.IMAGE,download:!0,fileBasename:"photoeditorsdk-export",quality:.8}),this._options.editor.save=yf.defaults(this._options.editor.save||{},{format:"text/json",download:!0,fileBasename:"photoeditorsdk-save"}),this._options.extensions=yf.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=yf.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null}),!(this._options.editor.image instanceof window.Image)){const t=new window.Image;this._options.editor.image&&(t.src=this._options.editor.image,this._options.editor.image=t)}}_initEvents(){this._mediator.pipeEvents(this)}_disposeEvents(){this._mediator.unpipeEvents(this)}setImage(t){this._editor.setImage(t)}getAssetPath(t,e=!1,i=!1){let{baseUrl:s,resolver:r}=this._options.assets,n=`${s}/${t}`;r=r||(t=>t),t.match(/(ftp|http|https):\/\//)&&(n=t);const o=t.replace(/assets\//,"").split("/");let a={};switch(o[0]){case"art-filters":return a={identifier:o[1],type:o[2].split(".")[0]},r("art-filter",a);case"filters":return a={identifier:o[1].replace(/\.png$/g,"")},r("filter",a);case"fonts":return a={identifier:o[1].replace(/\.(woff|otf|ttf)$/g,"")},r("font",a);case"frames":return a={identifier:o[1],filename:o[2]},r("frame",a);case"overlays":return a={identifier:o[1].replace(/\.(png|jpg|jpeg)$/g,"")},r("overlay",a);case"stickers":{const t=o[3].endsWith(".svg"),e="thumbs"===o[3];return a={category:o[1],identifier:(t?o[3]:o[4]).replace(/\.(png|svg)$/g,""),variant:t?"svg":e?"thumb":"base"},r("sticker",a)}case"text-design":return a={type:"fonts"===o[1]?"font":"image",identifier:o[2].replace(/\.(png|otf|ttf|woff2?)$/g,"")},r("text-design",a)}return"undefined"!==typeof r&&null!==r&&(n=r(n)),n}getFontLoader(){return this._fontLoader}dispose(){if(this._disposed)throw new Error("This instance of PhotoEditorSDK is already disposed.");this._disposed=!0,this._disposeEvents()}render(t){return this.deserialize(t).then((()=>this.export()))}};TC.prototype.identifier="engine-wrapper",TC.Constants=rg,TC.Events=rg.EVENTS,TC.Utils=_f,TC.JSONLoader=Nt,TC.SDK=vf;var CC=class extends Ek{constructor(t){super(),this.config=t}getOutputDimensions(){const t=this.getOutputContainer();return t?t.getResolution():{width:0,height:0}}getSmallerOutputSide(){const t=this.getOutputContainer();if(!t)return 0;const e=t.getResolution();return Math.min(e.width,e.height)}convertPointFromPreviewIntoOutputSpace(t,e){const i=PT.getInverted(QT.rectTransformToAffineTransform(e));return PT.transformPoint(i,t)}convertPointFromPreviewIntoWorldSpace(t,e,i){const s=PT.getInverted(QT.rectTransformToAffineTransform(e)),r=i?this.getOutputContainer().getBaseLocalToParentMatrix():this.getOutputContainer().getLocalToParentMatrix(),n=PT.multiply(r,s);return PT.transformPoint(n,t)}convertPointFromPreviewIntoFlippedPreviewSpace(t){const e=this.getOutputContainer().getFlipTransformMatrix();return PT.transformPoint(e,t)}convertPointFromWorldIntoPreviewSpace(t,e){const i=QT.rectTransformToAffineTransform(e),s=PT.getInverted(this.getOutputContainer().getLocalToParentMatrix()),r=PT.multiply(i,s);return PT.transformPoint(r,t)}convertPointFromOutputIntoPreviewSpace(t,e){const i=QT.rectTransformToAffineTransform(e);return PT.transformPoint(i,t)}getContainersAtPreviewPoint(t,e){const i=new Array,s=this.convertPointFromPreviewIntoWorldSpace(t,e),r=this.getRootContainers();for(const n of r)this.accumulateContainersAtWorldPointInHierarchy(s,n,i);return i}isPreviewPointInContainer(t,e,i){const s=this.convertPointFromPreviewIntoWorldSpace(t,i);return this.isWorldPointInContainer(s,e)}isWorldPointInContainer(t,e){const i=QT.getLocalToWorldMatrix(e),s=PT.getInverted(i),r=PT.transformPoint(s,t);return BT.contains(e.getBounds(),r)}accumulateContainersAtWorldPointInHierarchy(t,e,i){this.isWorldPointInContainer(t,e)&&i.push(e);const s=e.getChildren();for(const r of s)bC(r)&&this.accumulateContainersAtWorldPointInHierarchy(t,r,i)}},RC=class{constructor(t){this.engine=t,this.id=Nk()}getID(){return this.id}getContainer(){return this.engine.getRootContainers()[0]}getIndexInParent(){const{rootOperations:t}=this.engine;for(let e=0;e<t.length;e+=1)if(t[e].getID()===this.id)return e;return-1}setIndexInParent(t){this.engine.moveIndex(this,t)}isValid(){return-1!==this.getIndexInParent()}},IC=class extends RC{constructor(t,e,i){super(e),this.operation=i,this.type="adjustments",this.setProperties(t)}getProperties(){const t=this.operation.getOptions(),e=t.gamma-1;return{brightness:t.brightness||0,saturation:t.saturation||0,contrast:t.contrast||0,gamma:(e<0?2*e:e)||0,clarity:t.clarity||0,exposure:t.exposure||0,shadows:.5*t.shadows||0,highlights:t.highlights||0,whites:t.whites||0,blacks:t.blacks||0,temperature:t.temperature||0,sharpness:t.sharpness||0}}setProperties(t){void 0!==t.gamma&&(t.gamma=1+(t.gamma<0?.5*t.gamma:t.gamma)),t.shadows&&(t.shadows=2*t.shadows),this.operation.set(t)}getOperation(){return this.operation}getTypeIdentifier(){return"adjustments"}},FC=t=>{if(yC(t))return new vf.Color(t.r,t.g,t.b,t.a);if(xC(t))return new vf.Color(t[0],t[1],t[2],t[3]);if(pC(t))return new vf.Color(t.r,t.g,t.b,1);if(fC(t))return new vf.Color(t[0],t[1],t[2],1);if(function(t){return"string"===typeof t}(t)){const[e,i,s]=t.match(/[0-9A-fa-f]{1,2}/g);return new vf.Color(parseInt(e,16)/255,parseInt(i,16)/255,parseInt(s,16)/255,1)}throw new Error("Invalid color type")},SC=class{get x(){return this._x}get y(){return this._y}constructor(t=0,e=0){this._x=t,this._y=e}set(t,e){return this._x=t,this._y=e,this}clone(){return new SC(this._x,this._y)}copy(t){return this._x=t.x,this._y=t.y,this}clamped(t=this,e=this){let i="number"===typeof t?{x:t,y:t}:t,s="number"===typeof e?{x:e,y:e}:e;return this._x=Math.max(i.x,this._x),this._y=Math.max(i.y,this._y),this._x=Math.min(s.x,this._x),this._y=Math.min(s.y,this._y),this}divide(t,e){return"number"===typeof t||null===t?(this._x/=t,this._y/="undefined"===typeof e?t:e):(this._x/=t.x,this._y/=t.y),this}subtract(t,e){return"number"===typeof t||null===t?(this._x-=t,this._y-="undefined"===typeof e?t:e):(this._x-=t.x,this._y-=t.y),this}multiply(t,e){return"number"===typeof t||null===t?(this._x*=t,this._y*="undefined"===typeof e?t:e):(this._x*=t.x,this._y*=t.y),this}add(t,e){return"number"===typeof t||null===t?(this._x+=t,this._y+="undefined"===typeof e?t:e):(this._x+=t.x,this._y+=t.y),this}dot(t,e){return"number"===typeof t||null===t?this._x*t+this._y*("undefined"===typeof e?t:e):this._x*t.x+this._y*t.y}equals(t,e){return"number"===typeof t||null===t?t===this._x&&e===this._y:t.x===this._x&&t.y===this._y}flip(){let t=this._x;return this._x=this._y,this._y=t,this}round(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this}ceil(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this}floor(){return this._x=0|this._x,this._y=0|this._y,this}abs(){return this._x=Math.abs(this._x),this._y=Math.abs(this._y),this}len(){return Math.sqrt(this._x*this._x+this._y*this._y)}min(){return Math.min(this._x,this._y)}max(){return Math.max(this._x,this._y)}toObject(){return{x:this._x,y:this._y}}toString(){return`Vector2({ x: ${this._x}, y: ${this._y} })`}roundDecimal(t){return this._x=parseFloat(this._x.toFixed(t)),this._y=parseFloat(this._y.toFixed(t)),this}asArray(t=!1){return t?[this._y,this._x]:[this._x,this._y]}static fromObject(t){return new SC(t.x,t.y)}static fromSize(t){return new SC(t.width,t.height)}static get NULL(){return new SC(0,0)}},EC=class{constructor(t){this.engine=t,this.id=Nk(),this.transform=KT.IDENTITY,this.bounds=BT.ZERO}getID(){return this.id}getParent(){const t=this.engine.getRootContainers();if(0!==t.length&&this.id!==t[0].id)return t[0]}getIndexInParent(){const{rootOperations:t}=this.engine;for(let e=0;e<t.length;e+=1)if(t[e].getID()===this.id)return e;return-1}setIndexInParent(t){this.engine.moveIndex(this,t)}getChildren(){const t=this.engine.getRootContainers();return t.length>0&&(this.id===t[0].id||this.id===this.engine.getOutputContainer().id)?this.engine.rootOperations:[]}getBounds(){return this.bounds}setPivotOnSelfAndSprite(t,e,i){"number"===typeof e?(this.setPivotInternal(e,i),t.setPivot(new SC(e,i))):(this.setPivotInternal(e),t.setPivot(SC.fromObject(e)))}setPivot(t,e){this.setPivotInternal(t,e)}getPivot(){const t=this.getBounds();return{x:-t.minX/t.width,y:-t.minY/t.height}}getTransform(){return this.transform}setTransform(t){this.transform=t}updateTransform(){this.setTransform(this.transform)}getPosition(){return this.transform.position}setPosition(t,e){let i;i="number"===typeof t?{x:t,y:void 0===e?t:e}:t;const{scale:s}=this.transform,{rotation:r}=this.transform;this.setTransform(new KT(i,s,r))}getScale(){return this.transform.scale}setScale(t,e){let i;i="number"!==typeof t?t:{x:t,y:void 0===e?t:e};const{position:s,rotation:r}=this.transform;this.setTransform(new KT(s,i,r))}getRotation(){return this.transform.rotation}setRotation(t){const{position:e,scale:i}=this.transform;this.setTransform(new KT(e,i,t))}getSizeInWorldSpace(){return QT.getSizeInWorldSpace(this)}getSizeInOutputSpace(){return QT.getSizeInOutputSpace(this,this.engine.getOutputContainer())}setSizeInWorldSpace(t){const e=this.getBounds();this.setScale(t.width/e.width,t.height/e.height)}setSizeInOutputSpace(t){const e=this.engine.getOutputContainer().getScale();this.setSizeInWorldSpace({width:t.width/e.x,height:t.height/e.y})}isValid(){return-1!==this.getIndexInParent()}setPivotInternal(t,e){const i=this.getBounds();"number"===typeof t?this.setBoundsFromSize(i.width,i.height,{x:t,y:e}):this.setBoundsFromSize(i.width,i.height,t)}setBoundsFromSize(t,e,i=this.getPivot()){this.bounds=new BT(-i.x*t,-i.y*e,t,e)}},OC=class extends EC{constructor(t,e){super(e),this.type="drawing",this.drawing=t,this.operation=e.createSpriteOperation(),this.sprite=this.operation.createBrush({}),this.operation.addSprite(this.sprite),this.radialBrush=this.sprite._createRadialBrush();const i=e.getRootContainers()[0].getBounds();this.bounds=new BT(0,0,i.width,i.height),this.setTransform(KT.IDENTITY),this.operation.setDirty(!0),this.setData(t)}beginStroke(t){if(this.currentStroke)throw new Error("A brush stroke has already been started but not finished.");if("imgly_brush_radial"!==t.id)throw new Error("This adapter does not support any brush faces other than the radial img.ly brush.");this.currentBrush=t,this.currentStroke={brush:t,path:{controlPoints:[]}},this.radialBrush.setColor(FC(t.color)),this.radialBrush.setHardness(t.hardness),this.radialBrush.setSize(t.size),this.currentPath=this.sprite.createPath(this.radialBrush.clone())}addPointToCurrentStroke(t,e=!0){if(!this.currentStroke||!this.currentBrush||!this.currentPath)throw new Error('A brush stroke has to first be started with a call to "beginStroke(brush:Brush)"');if(this.currentStroke.path.controlPoints.length){const e=this.currentStroke.path.controlPoints,i=e[e.length-1],s=this.currentBrush.size/10;if(Math.sqrt(t.x-i.x**2+(t.y-i.y**2))<s)return}const i=this.engine.getOutputContainer(),s=this.engine.getRootContainers()[0],r=QT.pointFromSpaceToSpace(t,s,i,!0),n=QT.absoluteToRelativePoint(r,i,!1),o=i.getBounds();this.currentPath.addControlPoint(SC.fromObject(n)),this.currentStroke.path.controlPoints.push(t),e&&this.sprite.render(SC.fromObject({x:o.width,y:o.height}))}endStroke(){if(!this.currentStroke||!this.currentPath||!this.currentBrush)return;this.currentStroke.path.controlPoints.length&&this.drawing.strokes.push(this.currentStroke),this.currentStroke=void 0,this.currentBrush=void 0,this.currentPath.setClosed(!0);const t=this.engine.getOutputContainer().getBounds();this.sprite.render(SC.fromObject({x:t.width,y:t.height})),this.currentPath=void 0}setData(t){this.drawing={...this.drawing,...t},this.drawing.strokes&&(this.drawing.strokes=[]),this.sprite.clearPersistCanvas(),this.sprite.clearCanvas(),this.sprite.setPaths([]),this.drawStrokes(t.strokes)}getData(){return this.drawing}updateData(){this.setData(this.getData())}getOperation(){return this.operation}drawStrokes(t){t.forEach((t=>{this.beginStroke(t.brush),t.path.controlPoints.forEach((t=>{this.addPointToCurrentStroke(t,!0)})),this.endStroke()}))}},AC=class extends RC{constructor(t,e,i,s){super(s),this.filterOperation=e,this.type="duotone-filter",e.set({intensity:i.colorIntensity}),e.set({filter:t}),s.pesdk.setAllOperationsToDirty()}getProperties(){return{colorIntensity:this.filterOperation.getOptions().intensity}}setProperties(t){let e=this.filterOperation.getOptions().intensity;void 0!==t.colorIntensity&&(e=Math.min(Math.max(t.colorIntensity,0),1)),this.filterOperation.set({intensity:e})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}},BC=class extends RC{constructor(t,e,i){super(i),this.frameOperation=t,this.type="frame",this.setProperties(e),i.pesdk.setAllOperationsToDirty()}setProperties(t){if(this.props={...this.props,...t},"number"===typeof t.opacity&&this.frameOperation.set({alpha:t.opacity}),t.tintColor&&this.frameOperation.set({tintColor:FC(t.tintColor)}),t.width){const e=this.engine.getOutputContainer().getBounds(),i=Math.min(e.width,e.height),s=t.width/i;this.frameOperation.set({scale:s})}this.frameOperation.setDirty(!0)}getProperties(){return this.props}getOperation(){return this.frameOperation}getTypeIdentifier(){return"frame"}},MC=class extends RC{constructor(t,e,i){super(e),this.blurOperation=i,this.type="gaussian-blur",this.setProperties(t)}getProperties(){const t=this.engine.getOutputContainer(),e=t.getBounds(),i=Math.min(e.size.width,e.size.height);return{blurRadius:QT.scalarFromSpaceToSpace(this.blurOperation.getOptions().blurRadius*i,t,this.getContainer())}}setProperties(t){if(void 0!==t.blurRadius){const e=this.engine.pesdk.getOutputDimensions(),i=Math.min(e.x,e.y),s=this.getContainer(),r=this.engine.getOutputContainer(),n=QT.scalarFromSpaceToSpace(t.blurRadius,s,r)/i;this.blurOperation.set({blurRadius:n})}}getOperation(){return this.blurOperation}getTypeIdentifier(){return"blur"}},PC=class extends EC{constructor(t,e){super(e),this.data=t,this.type="image",this.dispose=()=>{var t;(null==(t=this.data)?void 0:t.image)instanceof HTMLCanvasElement&&s(this.data.image)};const i=e.configuration.downscaleOptions;if(i){const{maxDimensions:t}=i;this.downscaleOptions={maxMegaPixels:i.maxMegaPixels,maxDimensions:{width:Math.min(e.maxTextureDimension,t?t.width:Number.MAX_VALUE),height:Math.min(e.maxTextureDimension,t?t.height:Number.MAX_VALUE)}}}else this.downscaleOptions={maxDimensions:{width:e.maxTextureDimension,height:e.maxTextureDimension}};this.setData(t);const{image:r}=this.data;this.bounds=new BT(Vk.ZERO,{width:r.width,height:r.height})}setData(t){if(this.data={...this.data,...t},t.image){let e,{image:i}=t;if(i instanceof HTMLImageElement&&(e=this.engine.pesdk.parseExif(i),e)){const t=e.getTags();if(t&&t.Orientation){const s=1!==t.Orientation&&2!==t.Orientation,r=-1!==[2,4,5,7].indexOf(t.Orientation);if(s||r){if(Bk()||Ak()||!CSS.supports("image-orientation","from-image")){const e=this.engine.pesdk.createOperation("exif-orientation",{},!1);e.setTags(t),i=e.applyTo(i)}e.setOrientation(1),t.Orientation=1}}}const s=new tT(i,this.downscaleOptions);s.on(Jk.IMAGE_DOWNSCALED,(({width:t,height:e})=>{this.engine.emit(ZT.IMAGE_DOWNSCALED,{width:t,height:e})})),s.on(Jk.BEGAN_IMAGE_DOWNSCALING,(()=>{this.engine.emit(ZT.BEGAN_IMAGE_DOWNSCALING)})),i=s.downscaleIfNecessary(),this.data.image=i,this.engine.pesdk.setImage(i,e),this.setBoundsFromSize(i.width,i.height)}}getData(){return this.data}setPivot(t,e){throw new Error("This container does not support modifying the pivot")}getOperation(){throw new Error("This container has no associated operation")}},LC=class extends RC{constructor(t,e,i){super(e),this.props=t,this.blurOperation=i,this.type="linear-blur",this.setProperties(t)}getProperties(){return this.props}setProperties(t){this.props={...this.props,...t};const e=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),s=i.getBounds(),r=this.getContainer(),n=i.getBaseLocalToParentMatrix(),o=QT.getBaseLocalToWorldMatrix(r),a=PT.multiply(PT.getInverted(n),o),l=Math.min(s.size.width,s.size.height);if(void 0!==t.blurRadius){const s=QT.scalarFromSpaceToSpace(t.blurRadius,r,i);e.blurRadius=s/l}if(void 0!==t.start){const s=PT.transformPoint(a,t.start),r=QT.absoluteToRelativePoint(s,i,!1);e.controlPoint1=r}if(void 0!==t.end){const s=PT.transformPoint(a,t.end),r=QT.absoluteToRelativePoint(s,i,!1);e.controlPoint2=r}this.blurOperation.set(e)}updateProperties(){const t=this.getProperties();this.setProperties(t)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"linear-focus"}},zC=class extends RC{constructor(t,e,i,s){super(s),this.filter=t,this.filterOperation=e,this.props=i,this.type="lut-filter",e.set({intensity:i.intensity}),e.set({filter:t}),s.pesdk.setAllOperationsToDirty()}getProperties(){return{intensity:this.filterOperation.getOptions().intensity,lutImage:this.props.lutImage,horizontalTileCount:this.props.horizontalTileCount,verticalTileCount:this.props.verticalTileCount}}setProperties(t){const e=this.filterOperation.getOptions(),i="number"===typeof t.intensity?t.intensity:e.intensity;this.filterOperation.set({intensity:i})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}},NC=class extends RC{constructor(t,e,i){super(e),this.props=t,this.blurOperation=i,this.type="mirrored-blur",this.setProperties(t)}getProperties(){return this.props}setProperties(t){this.props={...this.props,...t};const e=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),s=i.getBounds(),r=this.getContainer(),n=i.getBaseLocalToParentMatrix(),o=QT.getBaseLocalToWorldMatrix(r),a=PT.multiply(PT.getInverted(n),o),l=Math.min(s.size.width,s.size.height);if(void 0!==t.blurRadius){const s=QT.scalarFromSpaceToSpace(t.blurRadius,r,i);e.blurRadius=s/l}if(void 0!==t.gradientSize){const s=QT.scalarFromSpaceToSpace(t.gradientSize,r,i)/l;e.gradientSize=s}if(void 0!==t.clearAreaWidth){const s=QT.scalarFromSpaceToSpace(t.clearAreaWidth,r,i)/l;e.size=.5*s}if(void 0!==t.mirrorAxisOrigin){const s=PT.transformPoint(a,t.mirrorAxisOrigin),r=QT.absoluteToRelativePoint(s,i,!1);e.start=r}if(void 0!==t.mirrorAxisDirection){const s=PT.transformPoint(a,t.mirrorAxisDirection),r=QT.absoluteToRelativePoint(s,i,!1);e.end=r}this.blurOperation.set(e)}updateProperties(){const t=this.getProperties();this.setProperties(t)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"mirrored-focus"}},UC=class extends EC{constructor(t,e,i,s){super(s),this.settings=t,this.operation=e,this.flipOperation=i,this.type="output",this.flipTransform=PT.IDENTITY,this.blockTransformUpdate=!1,this.transformUpdateWhileBlock=!1,this.bounds=new BT({x:0,y:0},this.settings.resolution),this.setData(t)}pauseChildrenUpdates(){this.transformUpdateWhileBlock=!1,this.blockTransformUpdate=!0}resumeChildrenUpdates(){this.blockTransformUpdate=!1,this.transformUpdateWhileBlock&&this.updateChildrenContainers()}setData(t){if(this.settings={...this.settings,...t},t.resolution&&(this.setBoundsFromSize(t.resolution.width,t.resolution.height),this.setTransform(this.transform),this.operation.set({outputResolution:new SC(t.resolution.width,t.resolution.height)})),void 0!==t.flipHorizontally){const e=t.flipHorizontally;this.updateFlipTransform(),this.flipOperation.set({flipHorizontally:e})}if(void 0!==t.flipVertically){const e=t.flipVertically;this.updateFlipTransform(),this.flipOperation.set({flipVertically:e})}this.operation.setDirty(!0),this.flipOperation.setDirty(!0)}getData(){return this.settings}setResolution(t){this.setData({resolution:t})}getResolution(){return this.getData().resolution}setTransform(t){if(this.transform.rotation!==t.rotation||this.transform.position!==t.position||this.transform.scale!==t.scale){this.transform=t;const e=this.flipTransform;this.flipTransform=PT.IDENTITY;const i=this.engine.getRootContainers()[0],s=QT.pointFromSpaceToSpace({x:0,y:0},i,this),r=-t.rotation,n=SC.fromObject(s).clone().subtract(SC.fromObject(this.getBounds().origin));this.operation.set({pivot:new SC(0,0),position:n,scale:new SC(1/t.scale.x,1/t.scale.y),rotation:r}),this.flipTransform=e,this.operation.setDirty(!0),this.updateChildrenContainers()}}rotate(t,e){const i=this.getPivot(),s=this.getBounds(),r={x:s.midX,y:s.midY},n=QT.getPointInWorldSpace(r,this);this.setPivot(.5,.5),this.setPosition(n),this.setRotation(t),this.setResolution(e);const o={x:-e.width*(.5-i.x),y:-e.height*(.5-i.y)},a=QT.getPointInWorldSpace(o,this);this.setPivot(i),this.setPosition(a),this.updateChildrenContainers()}setPivot(t,e){super.setPivotInternal(t,e),this.setTransform(this.transform)}getTransform(){return this.transform}getBaseLocalToParentMatrix(){return QT.rectTransformToAffineTransform(this.getTransform())}getLocalToParentMatrix(){const t=QT.rectTransformToAffineTransform(this.getTransform());return PT.multiply(t,this.flipTransform)}getFlipTransformMatrix(){return this.flipTransform}isValid(){return!0}getOperation(){return this.operation}updateFlipTransform(){const{flipHorizontally:t,flipVertically:e}=this.settings;if(t||e){const i=this.getPivot(),s=this.getBounds(),r=t?-1:1,n=t?-2*(i.x-.5)*s.width:0,o=e?-1:1,a=e?-2*(i.y-.5)*s.height:0;this.flipTransform=new PT(r,0,0,o,n,a)}else this.flipTransform=PT.IDENTITY}updateChildrenContainers(){this.blockTransformUpdate?this.transformUpdateWhileBlock=!0:this.engine.rootOperations.forEach((t=>{bC(t)?(t.updateTransform(),"updateData"in t&&t.updateData()):"updateProperties"in t&&t.updateProperties()}))}},GC=class extends RC{constructor(t,e,i){super(i),this.overlayOperation=t,this.type="overlay";const s=e.blendMode||i.mapBlendMode(t.getBlendMode());t.set({blendMode:i.reverseMapBlendMode(s)}),t.set({image:e.image}),i.pesdk.setAllOperationsToDirty()}getProperties(){const t=this.overlayOperation.getOptions();return{image:t.image,blendMode:this.engine.mapBlendMode(t.blendMode),opacity:t.alpha}}setProperties(t){const e=this.overlayOperation.getOptions();"number"===typeof t.opacity&&(e.alpha=t.opacity),void 0!==t.blendMode&&(e.blendMode=this.engine.reverseMapBlendMode(t.blendMode)),this.overlayOperation.set(e),this.overlayOperation.setDirty(!0)}getOperation(){return this.overlayOperation}getTypeIdentifier(){return"overlay"}setFlipHorizontally(t){this.overlayOperation.setFlipHorizontally(t)}setFlipVertically(t){this.overlayOperation.setFlipVertically(t)}getFlipHorizontally(){return this.overlayOperation.getFlipHorizontally()}getFlipVertically(){return this.overlayOperation.getFlipVertically()}},jC=class extends RC{constructor(t,e,i){super(e),this.props=t,this.blurOperation=i,this.type="radial-blur",this.setProperties(t)}getProperties(){return this.props}setProperties(t){this.props={...this.props,...t};const e=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),s=i.getBounds(),r=this.getContainer(),n=i.getBaseLocalToParentMatrix(),o=QT.getBaseLocalToWorldMatrix(r),a=PT.multiply(PT.getInverted(n),o),l=Math.min(s.size.width,s.size.height);if(void 0!==t.blurRadius){const s=QT.scalarFromSpaceToSpace(t.blurRadius,r,i);e.blurRadius=s/l}if(void 0!==t.center){const s=PT.transformPoint(a,t.center),r=QT.absoluteToRelativePoint(s,i,!1);e.position=r}if(void 0!==t.radius){const s=QT.scalarFromSpaceToSpace(t.radius,r,i)/l;e.radius=s}if(void 0!==t.gradientSize){const s=QT.scalarFromSpaceToSpace(t.gradientSize,r,i)/l;e.gradientRadius=s}this.blurOperation.set(e)}updateProperties(){const t=this.getProperties();this.setProperties(t)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"radial-focus"}},VC=class extends EC{constructor(t,e){super(e),this.data=t,this.type="sticker";let i=t.image;const s=this.engine.pesdk.parseExif(t.image);if(s){const e=s.getTags();if(e&&e.Orientation){const r=1!==e.Orientation&&2!==e.Orientation,n=-1!==[2,4,5,7].indexOf(e.Orientation);if(r||n){const r=this.engine.pesdk.createOperation("exif-orientation",{},!1);r.setTags(e),i=r.applyTo(t.image),s.setOrientation(1),e.Orientation=1}}}i=new tT(i,{maxMegaPixels:{desktop:10,mobile:5}}).downscaleImageIfNecessary(),this.operation=e.createSpriteOperation(),this.sprite=this.operation.createSticker({identifier:"",image:i,position:new SC(0,0),dimensions:new SC(1,1),rotation:0,smoothDownscaling:!1}),this.operation.addSprite(this.sprite),this.bounds=new BT({x:0,y:0},{width:i.width,height:i.height}),this.setTransform(KT.IDENTITY),this.sprite.setPivot(new SC(0,0)),this.operation.setDirty(!0),this.setData(t)}setData(t){this.data={...this.data,...t},t.id&&(this.id=t.id),LT(t.opacity)&&t.opacity>=0&&this.sprite.setAlpha(t.opacity),t.tintColor&&this.sprite.setTintColor(FC(t.tintColor)),t.tintMode&&this.sprite.setTintMode(t.tintMode),this.operation.setDirty(!0)}getData(){return this.data}updateData(){this.setData(this.getData())}setTransform(t){super.setTransform(t);const e=this.engine.getOutputContainer(),i=this.getParent(),s={width:this.bounds.width*t.scale.x,height:this.bounds.height*t.scale.y},r=QT.sizeFromSpaceToSpace(s,i,e);this.sprite.setDimensions(SC.fromSize(r));const n=QT.pointFromSpaceToSpace(t.position,i,e,!0),o=QT.absoluteToRelativePoint(n,e,!1);this.sprite.setPosition(new SC(o.x,o.y));const a=QT.getRotationBetweenCoordinateSpaces(i,e),l=t.rotation+a;this.sprite.setRotation(l),this.operation.setDirty(!0)}setPivot(t,e){this.setPivotOnSelfAndSprite(this.sprite,t,e)}getOperation(){return this.operation}setFlipHorizontally(t){this.sprite.setFlipHorizontally(t)}setFlipVertically(t){this.sprite.setFlipVertically(t)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}};var WC=class{constructor(t){this.context=t,this.sourceLines=[],this.maxWidth=100}static buildWords(t){const e=[];let i="";const s=t.length;for(let r=0;r<s;r+=1){const n=t[r];i+=n," "!==n&&"-"!==n&&r!==s-1||(e.push(i),i="")}return e}getLines(){let t=[],e=[];const i=this.sourceLines.length;for(let s=0;s<i;s+=1){const i=this.sourceLines[s],r=WC.buildWords(i),n=r.length;for(let s=0;s<n;s+=1){const i=r[s],n=e.concat(i).join("").replace(/\s+$/i,"");if(this.getWidth(n)>this.maxWidth){e.length>0&&(t.push(e.join("")),e=[i]);const s=i.replace(/\s+$/i,"");if(this.getWidth(s)>this.maxWidth){const s=this.splitWord(i);t=t.concat(s.lines),s.rest&&(e=[s.rest])}}else e.push(i)}t.push(e.join("")),e=[]}return t}splitWord(t){const e={lines:[],rest:null},i=t.length;let s=[];for(let r=0;r<i;r+=1){const n=t[r];this.getWidth(s.concat(n).join(""))>this.maxWidth?(s.length>0&&e.lines.push(s.join("")),s=[n]):s.push(n),r===i-1&&s.length>0&&(e.rest=s.join(""))}return e}getWidth(t){return this.context.measureText(t).width}setText(t){this.sourceLines=t.split("\n")}setMaxWidth(t){this.maxWidth=t}};function HC(t,e,i,s,r,n,o){t.font=`${i.fontStyle||"normal"} ${i.fontWeight||"normal"} ${s}px "${i.fontFamily}"`;const a=new WC(t);a.setText(e),a.setMaxWidth(n);const l=a.getLines().map((t=>t.replace(/\s+$/i,""))),h=function(t,e){if(e){const i=1/e.unitsPerEm*t,s=e.ascender*i,r=e.descender*i;return s+Math.abs(r)}return 1.1*t}(s,o),u=h*r,c=h/5;return{width:n+2*c,height:l.length*u+2*c}}var qC=class extends EC{constructor(t,e){if(super(e),this.text=t,this.type="text",!qC.measureContext){const t=document.createElement("canvas");qC.measureContext=t.getContext("2d")}this.operation=e.createSpriteOperation();const i=this.engine.getOutputContainer(),s=this.getParent(),r=i.getBounds();this.sprite=this.operation.createText({text:t.text,position:new SC(0,0),rotation:0,fontSize:QT.scalarFromSpaceToSpace(t.fontSize/r.height,s,i),lineHeight:t.lineHeight,fontIdentifier:t.fontIdentifier,alignment:t.alignment,color:FC(t.textColor),backgroundColor:FC(t.backgroundColor),maxWidth:QT.scalarFromSpaceToSpace(t.width/r.width,s,i)});const n=e.assetProvider.getFontManager().getFontWithId(t.fontIdentifier);this.sprite.setFontFamily(n.fontFamily),this.sprite.setFontWeight(n.fontWeight||"normal"),this.sprite.setFontStyle(n.fontStyle||"normal"),this.sprite.setFontIdentifier(n.identifier),this.sprite.setTextMetrics(n.textMetrics),this.sprite.setPivot(new SC(0,0)),this.operation.addSprite(this.sprite);const o=HC(qC.measureContext,t.text,n,t.fontSize,t.lineHeight,t.width,n.textMetrics);this.bounds=new BT(0,0,o.width,o.height),this.setTransform(KT.IDENTITY),this.operation.setDirty(!0)}setData(t){this.text={...this.text,...t};const e=this.engine.assetProvider.getFontManager().getFontWithId(t.fontIdentifier||this.text.fontIdentifier);if(t.fontIdentifier&&(this.sprite.setFontFamily(e.fontFamily),this.sprite.setFontWeight(e.fontWeight||"normal"),this.sprite.setFontStyle(e.fontStyle||"normal"),this.sprite.setFontIdentifier(e.identifier),this.sprite.setTextMetrics(e.textMetrics)),t.id&&(this.id=t.id),t.text&&this.sprite.setText(t.text),t.fontSize){const e=this.engine.getOutputContainer(),i=this.getParent(),s=QT.scalarFromSpaceToSpace(t.fontSize,i,e),r=e.getBounds();this.sprite.setFontSize(s/r.height)}if(t.alignment&&this.sprite.setAlignment(t.alignment),t.lineHeight&&this.sprite.setLineHeight(t.lineHeight),t.textColor&&this.sprite.setColor(FC(t.textColor)),t.backgroundColor&&this.sprite.setBackgroundColor(FC(t.backgroundColor)),t.width){const e=this.engine.getOutputContainer(),i=this.getParent(),s=QT.scalarFromSpaceToSpace(t.width,i,e),r=e.getBounds();this.sprite.setMaxWidth(s/r.width)}const i=HC(qC.measureContext,this.text.text,e,this.text.fontSize,this.text.lineHeight,this.text.width,e.textMetrics);this.setBoundsFromSize(i.width,i.height),this.operation.setDirty(!0)}getData(){return this.text}updateData(){this.setData(this.getData())}setTransform(t){super.setTransform(t);const e=this.engine.getOutputContainer(),i=this.getParent(),s=QT.pointFromSpaceToSpace(t.position,i,e,!0),r=QT.absoluteToRelativePoint(s,e,!1);this.sprite.setPosition(new SC(r.x,r.y));const n=QT.getRotationBetweenCoordinateSpaces(i,e);this.sprite.setRotation(t.rotation+n),this.operation.setDirty(!0)}setPivot(t,e){this.setPivotOnSelfAndSprite(this.sprite,t,e)}getOperation(){return this.operation}setFlipHorizontally(t){this.sprite.setRotation(this.getFlippedRotation({flipHorizontally:t})),this.sprite.setFlipHorizontally(t)}setFlipVertically(t){this.sprite.setRotation(this.getFlippedRotation({flipVertically:t})),this.sprite.setFlipVertically(t)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}getFlippedRotation({flipVertically:t,flipHorizontally:e}){const i=t||this.getFlipVertically(),s=e||this.getFlipHorizontally();let r=this.getRotation();return(i||s)&&(r=vC(r)),r}},XC=1e3,YC=class extends EC{constructor(t,e,i){super(i),this.textDesign=t,this.layout=e,this.type="text-design",this.currentLayoutSize=void 0,this.layoutID=e.identifier,this.operation=i.createSpriteOperation();const s=this.engine.getOutputContainer(),r=this.getParent(),n=s.getBounds(),o=Math.min(n.width,n.height);e.seed(t.seed),this.bounds=this.calculateBounds(this.textDesign,this.layout);const a=t.width;this.sprite=this.operation.createTextDesign({text:t.text,layout:e,inverted:t.inverted,color:FC(t.color),width:QT.scalarFromSpaceToSpace(t.width/o,r,s),padding:t.padding/a,seed:t.seed}),this.updatePivot(),this.operation.addSprite(this.sprite),this.setTransform(KT.IDENTITY),this.operation.setDirty(!0)}static stringify(t){return JSON.stringify(t,YC.serializer())}static serializer(){const t=[],e=[],i=(i,s)=>t[0]===s?"[Circular ~]":`[Circular ~.${e.slice(0,t.indexOf(s)).join(".")}]`;return function(s,r){const n=this;if(t.length>0){const o=t.indexOf(n);~o?(t.splice(o+1),e.splice(o,1/0,s)):(t.push(n),e.push(s)),~t.indexOf(r)&&(r=i.call(n,s,r))}else t.push(r);return r}}calculateBounds(t,e,i=!0){const s=t.inverted&&i?Math.max(0,2*t.padding):0,r=t.width/XC;if(void 0===this.currentLayoutSize){e.seed(t.seed);const i=e.generateLayoutData(t.text,XC);this.currentLayoutData=i,this.currentLayoutSize=i.getSize()}return new BT(0,0,this.currentLayoutSize.width*r+s,this.currentLayoutSize.height*r+s)}findNextUniqueSeed(t,e,i){let s=i;const r=this.currentLayoutData?YC.stringify(this.currentLayoutData.getRows()):"";let n;for(let o=0;o<20&&(e.seed(s),n=e.generateLayoutData(t.text,XC),r===YC.stringify(n.getRows()));o+=1)s+=1;return e.seed(s),this.currentLayoutData=n,s}setData(t){if(this.textDesign={...this.textDesign,...t},t.id&&(this.id=t.id),void 0!==t.padding){const e=this.textDesign.width;this.sprite.setPadding(t.padding/e)}else t.width&&(this.textDesign.padding=this.sprite.getPadding()*this.textDesign.width);if(void 0!==t.seed&&(t.seed<0&&(t.seed=this.findNextUniqueSeed(this.textDesign,this.layout,Date.now()),this.textDesign.seed=t.seed),this.currentLayoutSize=void 0,this.layout.seed(t.seed),this.sprite.setSeed(t.seed),this.sprite.setLayout(this.layout)),t.color&&this.sprite.setColor(FC(t.color)),void 0!==t.inverted&&this.sprite.setInverted(t.inverted),t.text&&(this.currentLayoutSize=void 0,this.sprite.setText(t.text)),t.width){const e=this.engine.getOutputContainer(),i=this.getParent(),s=e.getBounds(),r=Math.min(s.width,s.height),n=QT.scalarFromSpaceToSpace(t.width/r,i,e);this.sprite.setWidth(n)}if(void 0!==t.padding||void 0!==t.seed||void 0!==t.inverted||t.text||t.width){const t=this.calculateBounds(this.textDesign,this.layout);this.setBoundsFromSize(t.width,t.height),this.updatePivot()}this.operation.setDirty(!0)}getData(){return this.textDesign}updateData(){this.setData(this.getData())}setTransform(t){super.setTransform(t);const e=this.engine.getOutputContainer(),i=this.getParent();if(1!==t.scale.x||1!==t.scale.y)throw new Error("This engine doesn't support scaling TextDesign containers! You can change the bounds using the width property of the TextDesign data.");const s=QT.pointFromSpaceToSpace(t.position,i,e,!0),r=QT.absoluteToRelativePoint(s,e,!1);this.sprite.setPosition(new SC(r.x,r.y));const n=QT.getRotationBetweenCoordinateSpaces(i,e);this.sprite.setRotation(t.rotation+n),this.operation.setDirty(!0)}setPivot(t,e){"number"===typeof t?super.setPivot(t,e):super.setPivot(t),this.updatePivot()}getOperation(){return this.operation}getLayoutID(){return this.layoutID}setFlipHorizontally(t){this.sprite.setFlipHorizontally(t)}setFlipVertically(t){this.sprite.setFlipVertically(t)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}updatePivot(){const t=this.textDesign.inverted?Math.max(0,this.textDesign.padding):0,e=new Vk(this.bounds.width-2*t,this.bounds.height-2*t),i=this.getPivot(),s=new Vk(i.x*this.bounds.width,i.y*this.bounds.height),r=new Vk(t,t),n=s.subtract(r).divide(e);this.sprite.setPivot(new SC(n.x,n.y))}},{BLEND_MODES:JC}=vf.Operations.OverlayOperation,KC="imgly_font_open_sans_bold",ZC=class extends CC{constructor(t){var e,i;let r;if(super(t),this.previews=Array(),this.rootOperationStack=[],this.deferredRenderQueue=[],this.operationStackOffset=1,this.enforceOperationOrder=()=>{this.refreshFlipIndex(),this.refreshFrameIndex()},this.isSpriteTop=t=>{const e=this.rootOperationStack.findIndex((({id:e})=>t===e));let i=1;return this.rootOperationStack.find((t=>"frame"===t.type))&&(i+=1),e+i===this.rootOperationStack.length},this.setWatermarkOpacity=t=>{const e=this.sdk.getOperationsStack().getByIdentifier("watermark");e&&e.set({alpha:t})},this.assetProvider=t.assetProvider||new OT,(null==(e=null==t?void 0:t.watermark)?void 0:e.watermarkURI)&&"string"===typeof t.watermark.watermarkURI&&"data:"===t.watermark.watermarkURI.slice(0,5)?r=t.watermark.watermarkURI:(null==(i=null==t?void 0:t.watermark)?void 0:i.watermarkURI)&&"string"===typeof t.watermark.watermarkURI&&t.watermark.watermarkURI.trim()&&(r=gT(t.watermark.watermarkURI)?t.watermark.watermarkURI:this.assetProvider.getPath(t.watermark.watermarkURI)),this.wrapper=new TC({license:t.license,crossOrigin:t.crossOrigin,assets:{resolver:(t,e)=>this.resolveAssetForSDK(t,e)},editor:{preferredRenderer:t.preferredRenderer,pixelRatio:1,clearColor:Cw(t.backgroundColor)},watermark:{...Cw(t.watermark),watermarkURI:r}}),this.editor=this.wrapper.getEditor(),this.sdk=this.editor.getSDK(),this.sdk.setRenderMode("adapter"),this.tempCanvas=document.createElement("canvas"),this.sdk.setCanvas(this.tempCanvas),"webgl"===t.preferredRenderer){const t=document.createElement("canvas"),e=t.getContext("webgl")||t.getContext("experimental-webgl");this.maxTextureDimension=e.getParameter(e.MAX_TEXTURE_SIZE),s(t)}else this.maxTextureDimension=1/0}get configuration(){return this.config}get pesdk(){return this.sdk}get rootOperations(){return this.rootOperationStack}dispose(){s(this.tempCanvas),this.rootContainer.dispose(),this.pesdk.dispose(),this.wrapper.dispose()}render(t){return new Promise((e=>{const i=()=>new Promise((i=>{const{canvas:s}=t,r=t.getTransform(),n=this.outputContainer.getPivot(),o=t.getCanvasBounds(),a=t.quality,{tempCanvas:l}=this;this.sdk.setTextureQuality(a);const h=this.sdk.getOutputDimensions();return l.width=h.x,l.height=h.y,this.sdk.getRenderer().resizeTo(new SC(l.width,l.height)),this.sdk.render(!0).then((()=>{const a=s.getContext("2d");a.clearRect(0,0,s.width,s.height),a.save(),a.translate(-o.minX,-o.minY),a.translate(r.position.x,r.position.y),a.rotate(r.rotation),a.scale(r.scale.x,r.scale.y),a.translate(-n.x*l.width,-n.y*l.height),a.scale(1/t.quality,1/t.quality),a.drawImage(l,0,0),a.restore(),e(),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?(this.sdk.setAllOperationsToDirty(),Promise.resolve(this.deferredRenderQueue[0]().then(i))):i()}))}));this.deferredRenderQueue.push(i),1===this.deferredRenderQueue.length&&i()}))}createPreview(t){const e=new class{constructor(t,e){this.engine=e,this.transform=KT.IDENTITY,this.canvasPivot={x:0,y:0},this.previewQuality=1,this.canvas=t}get quality(){return this.previewQuality}setQuality(t){this.previewQuality=Math.min(Math.max(t,.01),1)}getTransform(){return this.transform}setTransform(t){this.transform=t}getPosition(){return this.transform.position}setPosition(t,e){let i;i="number"===typeof t?{x:t,y:void 0===e?t:e}:t;const{scale:s}=this.transform,{rotation:r}=this.transform;this.setTransform(new KT(i,s,r))}getScale(){return this.transform.scale}setScale(t,e){let i;i="number"!==typeof t?t:{x:t,y:void 0===e?t:e};const{position:s}=this.transform,{rotation:r}=this.transform;this.setTransform(new KT(s,i,r))}getRotation(){return this.transform.rotation}setRotation(t){const{position:e}=this.transform,{scale:i}=this.transform;this.setTransform(new KT(e,i,t))}getCanvasPivot(){return this.canvasPivot}setCanvasPivot(t,e){this.canvasPivot="number"===typeof t?{x:t,y:void 0===typeof e?t:e}:t}getCanvasBounds(){const t=this.canvasPivot,{width:e,height:i}=this.canvas;return new BT(-t.x*e,-t.y*i,e,i)}}(t,this);return this.previews.push(e),e}async export(t=FD.IMAGE,e=SD.PNG,i=1,s=!0){return new Promise((r=>{const n=()=>new Promise((n=>this.sdk.export(this.mapToRenderType(t),this.mapToImageFormat(e),i,s).then((t=>{r(t),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?Promise.resolve(this.deferredRenderQueue[0]().then(n)):n()}))));this.deferredRenderQueue.push(n),1===this.deferredRenderQueue.length&&n()}))}getRootContainers(){return[this.rootContainer]}getOutputContainer(){return this.outputContainer}findContainerByID(t){return t===this.rootContainer.getID()?this.rootContainer:this.rootOperationStack.find((e=>e.getID()===t))}findEffectByID(t){return this.rootOperationStack.find((e=>e.getID()===t))}addImage(t,e,i){if(this.rootContainer)throw new Error("A background image already exists - did you mean to use addSticker?");const s=new PC(t,this);if(this.rootContainer=s,!this.outputContainer){const{width:t,height:e}=s.getBounds(),i={resolution:{width:t,height:e},flipHorizontally:!1,flipVertically:!1},r=this.sdk.createOperation("output",{},!1),n=this.sdk.createOperation("flip",{},!1);this.insertIntoOperationsStack(r,this.operationStackOffset-1),this.insertIntoOperationsStack(n,this.operationStackOffset),this.outputContainer=new UC(i,r,n,this)}return s}addSticker(t,e,i){if(!e)throw new Error("This engine does not support adding stickers as root elements.");this.ensureContainerIsRoot(e);const s=new VC(t,this);return this.addToStackAtIndex(s,i),s}addStickerFromAssets(t,e,i){if(!e)throw new Error("This engine does not support adding stickers as root elements.");return this.ensureContainerIsRoot(e),new Promise(((e,s)=>{const r=new Image;r.onload=()=>{const t=new VC({image:r,opacity:1},this);this.addToStackAtIndex(t,i),e(t)},r.onerror=t=>{s(t)},r.crossOrigin=this.config.crossOrigin||null,r.src=this.assetProvider.getAssetSource("sticker",t)}))}addText(t,e,i){if(!e)throw new Error("This engine does not support adding text as root elements.");if(!this.assetProvider.getFontManager().isFontLoaded(t.fontIdentifier||KC))throw new Error("Adding text synchronously only works if the required font is already loded! Consider using the asynchronous addTextWithFontLoading function instead!");this.ensureContainerIsRoot(e);const s={text:"",fontIdentifier:KC,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100,...t},r=new qC(s,this);return this.addToStackAtIndex(r,i),r}addTextWithFontLoading(t,e,i){if(!e)throw new Error("This engine does not support adding text as root elements.");const s=this.assetProvider.getFontManager(),r=t.fontIdentifier||KC;return new Promise(((n,o)=>{s.loadFontWithIdentifier(r).then((()=>{this.ensureContainerIsRoot(e);const s={text:"",fontIdentifier:KC,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100,...t},r=new qC(s,this);this.addToStackAtIndex(r,i),n(r)})).catch(o)}))}async addTextDesignAsync(t="imgly_text_design_blocks",e,i,s){if(!i)throw new Error("This engine does not support adding TextDesign as a root element.");const r={seed:Date.now(),padding:0,text:"",color:[0,0,0],inverted:!1,width:100,...e},n=this.wrapper.getTextDesignLayoutByID(t);if(!n)throw new Error(`The layout could not be loaded for the given id: ${t}`);const o=n.getImagePaths().map((t=>{const e=t.split("/").pop()||"";return{path:t,fullPath:this.assetProvider.getAssetSource("textdesign",e)}})),a=this.wrapper.getTextDesignAssetManager(),l=this.wrapper.getTextDesignFontManager().getVariationsByIdentifier();a.setFonts(l),await a.loadImages(o),n.onImagesLoaded();const h=Object.keys(l);return this.assetProvider.getFontManager().loadFontsWithIdentifiers(h).then((()=>{this.ensureContainerIsRoot(i);const t=new YC(r,n,this);return this.addToStackAtIndex(t,s),Promise.resolve(t)}))}addDrawing(t,e,i){if(!e)throw new Error("This engine does not support DrawingContainers as root elements.");this.ensureContainerIsRoot(e);const s=new OC(t,this);return this.addToStackAtIndex(s,i),s}addGaussianBlur(t,e,i){this.ensureContainerIsRoot(e);const s=new MC(t,this,this.sdk.createOperation("blur",{},!1));return this.addToStackAtIndex(s,i),s}addRadialBlur(t,e,i){this.ensureContainerIsRoot(e);const s=new jC(t,this,this.sdk.createOperation("radial-focus",{},!1));return this.addToStackAtIndex(s,i),s}addMirroredBlur(t,e,i){this.ensureContainerIsRoot(e);const s=new NC(t,this,this.sdk.createOperation("mirrored-focus",{},!1));return this.addToStackAtIndex(s,i),s}addLinearBlur(t,e,i){this.ensureContainerIsRoot(e);const s=new LC(t,this,this.sdk.createOperation("linear-focus",{},!1));return this.addToStackAtIndex(s,i),s}addDuoToneFilter(t,e,i){throw new Error("Not supported! Use addDuoToneFilterFromAssets instead")}addDuoToneFilterFromAssets(t,e,i){this.ensureContainerIsRoot(e);const s=this.sdk.getOperationsStack().getByIdentifier("filter");s&&s.getIdentifier()!==t&&this.sdk.removeOperation(s);const r=s||this.sdk.createOperation("filter",{identifier:t},!1);return new Promise(((e,s)=>{try{const s=this.assetProvider.getDuotoneFilterAsset(t),n={colorIntensity:s.defaultIntensity||0},o=new vf.Operations.FilterOperation.Filters.DuoToneFilter({intensity:n.colorIntensity,lightColor:vf.Color.fromHex(s.lightColor),darkColor:vf.Color.fromHex(s.darkColor)}),a=new AC(o,r,n,this);this.addToStackAtIndex(a,i),e(a)}catch(lk){lk&&s(lk)}}))}addLUTFilter(t,e,i){throw new Error("Not supported! Use addLUTFilterFromAssets instead")}addLUTFilterFromAssets(t,e,i){this.ensureContainerIsRoot(e);const s=this.sdk.getOperationsStack().getByIdentifier("filter");s&&s.getIdentifier()!==t&&this.sdk.removeOperation(s);const r=s||this.sdk.createOperation("filter",{identifier:t},!1);return this.getLutFilterImage(t).then((e=>{const s=this.assetProvider.getLUTFilterAsset(t),n={horizontalTileCount:s.horizontalTileCount||5,verticalTileCount:s.verticalTileCount||5,intensity:s.defaultIntensity||1},o=new vf.Operations.FilterOperation.Filters.ThreeDLUTFilter({...n,image:e}),a={...n,lutImage:new Image},l=new zC(o,r,a,this);return this.addToStackAtIndex(l,i),l}))}getLutFilterImage(t){return new Promise(((e,i)=>{uT({src:this.assetProvider.getAssetSource("filter",t),crossOrigin:this.config.crossOrigin||null,key:"filter",resolve:e,reject:i})}))}addAdjustments(t,e,i){this.ensureContainerIsRoot(e);const s=new IC(t,this,this.sdk.createOperation("adjustments",{},!1));return this.addToStackAtIndex(s,i),s}addOverlay(t,e,i){this.ensureContainerIsRoot(e);const s=new GC(this.sdk.createOperation("overlay",{},!1),t,this);return this.addToStackAtIndex(s,i),s}addOverlayFromAssets(t,e,i){return this.ensureContainerIsRoot(e),new Promise(((e,s)=>{uT({src:this.assetProvider.getAssetSource("overlay",t),crossOrigin:this.config.crossOrigin||null,key:"overlay",resolve:s=>{const r=this.sdk.getOperationsStack(),n=r.getByIdentifier("overlay");n&&n.getIdentifier()!==t&&r.remove(n);const o=n||this.sdk.createOperation("overlay",{},!1),a={image:s,opacity:1,blendMode:ak.NORMAL},l=new GC(o,a,this);this.addToStackAtIndex(l,i),e(l)},reject:s})}))}addFrame(t,e,i){throw new Error("Not supported!")}async addFrameFromAssets(t,e,i){this.ensureContainerIsRoot(e);const s=this.assetProvider.getFrameAsset(t);if(!s)throw new Error(`The requested asset does not exist! ${t}`);const r=new class{constructor(t,e){this.engine=e,this.loaded=!1,this.loading=!1,this.asset={...t}}async load(){if(this.loaded)return Promise.resolve();if(this.loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this.loading=!0;const{imageGroups:t}=this.asset,e=[];return["top","left","right","bottom"].forEach((i=>{if(!t[i])return;const s=t[i];["start","mid","end"].forEach((t=>{t in s&&e.push(this.loadPart(i,t))}))})),Promise.all(e).then((()=>{this.loaded=!0,this.loading=!1})).catch((()=>{this.loaded=!1,this.loading=!1}))}getFrame(){return{...this.asset,defaultName:this.asset.name,thumbnail:this.asset.thumbnailURI}}getIdentifier(){return this.asset.identifier}getDefaultName(){return this.asset.name}getThumbnail(){return this.asset.thumbnailURI}getTintable(){return this.asset.tintable||!1}getLayoutMode(){return this.asset.layoutMode}getImageGroups(){return this.asset.imageGroups}async loadPart(t,e){return new Promise(((i,s)=>{const{imageGroups:r}=this.asset,n=r[t][e];let o=n;"string"!==typeof n&&"image"in n&&(o=n.image);const a=new Image;a.addEventListener("load",(()=>{"string"!==typeof n?this.asset.imageGroups[t][e].image=a:this.asset.imageGroups[t][e]=a,i(a)})),a.addEventListener("error",(()=>{s(new Error(`Failed to load image at ${a.src}`))})),a.crossOrigin=this.engine.configuration.crossOrigin||"anonymus",a.src=this.engine.assetProvider.getAssetSource("frame",o)}))}}(s,this);await r.load();const n=this.getOutputContainer().getBounds(),o=Math.min(n.width,n.height),a=this.sdk.createOperation("frame",{},!1);a.setFrame(r.getFrame());const l={opacity:1,tintColor:[1,1,1],tintable:!1,width:Math.max(1,.1*o),imageGroups:r.getFrame().imageGroups},h=new BC(a,l,this);return this.addToStackAtIndex(h,i),Promise.resolve(h)}removeEffect(t){if(!t.isValid())return;const e=t.getOperation();this.sdk.removeOperation(e),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(t.getIndexInParent(),1)}removeContainer(t){if(!t.isValid()||"output"===t.type)return;const e=t.getOperation();this.sdk.removeOperation(e),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(t.getIndexInParent(),1)}refreshOutputIndex(){const t=this.sdk.getOperationsStack().getIndexByIdentifier("output");this.moveInOperationsStack(t,this.operationStackOffset-1)}refreshFlipIndex(){const t=this.sdk.getOperationsStack().getIndexByIdentifier("flip"),e=this.sdk.getOperationsStack().getStack().length-1;t!==e&&this.moveInOperationsStack(t,e)}refreshFrameIndex(){const t=this.sdk.getOperationsStack().getIndexByIdentifier("frame"),e=this.sdk.getOperationsStack().getStack().length-1;-1!==t&&t!==e&&this.moveInOperationsStack(t,e)}mapToRenderType(t){switch(t){case FD.IMAGE:return vf.RenderType.IMAGE;case FD.DATA_URL:return vf.RenderType.DATAURL;case FD.BLOB:return vf.RenderType.BLOB;case FD.MSBLOB:return vf.RenderType.MSBLOB;default:return vf.RenderType.IMAGE}}mapToImageFormat(t){switch(t){case SD.PNG:return vf.ImageFormat.PNG;case SD.JPEG:return vf.ImageFormat.JPEG;default:return null}}mapBlendMode(t){switch(t){case JC.NORMAL:return ak.NORMAL;case JC.OVERLAY:return ak.OVERLAY;case JC.HARD_LIGHT:return ak.HARD_LIGHT;case JC.SOFT_LIGHT:return ak.SOFT_LIGHT;case JC.MULTIPLY:return ak.MULTIPLY;case JC.DARKEN:return ak.DARKEN;case JC.LIGHTEN:return ak.LIGHTEN;case JC.SCREEN:return ak.SCREEN;case JC.COLOR_BURN:return ak.COLOR_BURN;default:return ak.NORMAL}}reverseMapBlendMode(t){switch(t){case ak.NORMAL:return JC.NORMAL;case ak.OVERLAY:return JC.OVERLAY;case ak.HARD_LIGHT:return JC.HARD_LIGHT;case ak.SOFT_LIGHT:return JC.SOFT_LIGHT;case ak.MULTIPLY:return JC.MULTIPLY;case ak.DARKEN:return JC.DARKEN;case ak.LIGHTEN:return JC.LIGHTEN;case ak.SCREEN:return JC.SCREEN;case ak.COLOR_BURN:return JC.COLOR_BURN;default:return JC.NORMAL}}createSpriteOperation(){return this.sdk.createOperation("sprite",{},!1)}moveIndex(t,e){const i=this.getSiblingIndex(t);if(-1===i)throw new Error("The item to be moved is not part of any stack.");this.moveInStack(this.rootOperationStack,i,e);const s=this.operationStackOffset;this.moveInOperationsStack(i+s,e+s),this.enforceOperationOrder()}ensureContainerIsRoot(t){if(t.getID()!==this.rootContainer.getID())throw new Error("This engine doesn't support adding this effect/container to anything other than the root image container")}addToStackAtIndex(t,e){if(e&&e<0)throw new Error(`The given index may not be negative: ${e}`);void 0===e?this.rootOperationStack.push(t):this.rootOperationStack.splice(e,0,t);const i=this.rootOperationStack.length-1;let s=void 0!==e?e:i;s+=this.operationStackOffset,function(t){t.getContainer}(t),this.insertIntoOperationsStack(t.getOperation(),s),this.sdk.setAllOperationsToDirty()}insertIntoOperationsStack(t,e){const i=this.sdk.getOperationsStack().getStack(),s=i.length,r=Math.max(Math.min(e,s),0);for(let n=s-1;n>=r;n-=1){const t=i[n];i[n+1]=t}i[r]=t,this.sdk.setAllOperationsToDirty(),this.enforceOperationOrder()}moveInStack(t,e,i){const s=t.length,r=Math.max(Math.min(e,s-1),0),n=Math.max(Math.min(i,s-1),0);if(r===n)return;const o=t[r];if(r<n)for(let a=r+1;a<=n;a+=1)t[a-1]=t[a];else for(let a=r-1;a>=n;a-=1)t[a+1]=t[a];t[n]=o}moveInOperationsStack(t,e){const i=this.sdk.getOperationsStack().getStack(),s=i.length,r=Math.min(Math.max(0,t),s-1),n=Math.min(Math.max(0,e),s-1);if(r===n)return;const o=i[r];if(r<n)for(let a=r+1;a<=n;a+=1)i[a-1]=i[a];else for(let a=r-1;a>=n;a-=1)i[a+1]=i[a];i[n]=o,this.sdk.getOperationsStack().setAllToDirty()}getSiblingIndex(t){return t.getIndexInParent()}resolveAssetForSDK(t,e){switch(e=e,t){case"filter":return this.assetProvider.getAssetSource("filter",e.identifier);case"overlay":return this.assetProvider.getAssetSource("overlay",e.identifier);case"font":return this.assetProvider.getAssetSource("font",e.identifier);default:return""}return""}},QC=class{constructor(t){this.isEmpty=!1,this.isValid=!1,this.isWhiteLabel=()=>this.isValid&&this.licenseChecker.isWhiteLabel(),this.areCustomAssetsAllowed=()=>this.isEmpty||!this.isValid||this.licenseChecker.areCustomAssetsAllowed(),t&&0!==t.length?(this.licenseChecker=new vf.LicenseChecker(t),this.isValid=this.licenseChecker.validate()):""===t&&(this.isEmpty=!0)}isToolAllowed(t){return!this.licenseChecker||!this.isValid||t===gD.CUSTOM||this.licenseChecker.isToolAllowed(t)}}}}]);